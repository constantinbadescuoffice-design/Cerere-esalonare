<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Arhitectura Roboescu - DiagramÄƒ LogicÄƒ</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: Georgia, 'Times New Roman', serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 75%, #00f2fe 100%);
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
      padding: 40px 20px;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background:
        radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.10) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.10) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }

    .container {
      max-width: 1400px;
      padding-left: 60px;
      padding-right: 60px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 30px;
      padding: 50px;
      box-shadow: 0 30px 80px rgba(0, 0, 0, 0.2), 0 0 0 1px rgba(255, 255, 255, 0.3);
      position: relative;
      z-index: 1;
      animation: fadeInUp 0.8s ease-out;
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    h1 {
      text-align: center;
      background: linear-gradient(135deg, #22507a 0%, #3576b0 50%, #6fa3ef 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-size: 3rem;
      margin-bottom: 15px;
      font-weight: bold;
      position: relative;
    }

    h1::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 110px;
      height: 4px;
      background: linear-gradient(90deg, transparent, #3576b0, transparent);
      border-radius: 2px;
    }

    .subtitle {
      text-align: center;
      color: #555;
      font-size: 1.25rem;
      margin-bottom: 42px;
      font-style: italic;
    }

    .diagram-container {
      width: 100%;
      display: flex;
      justify-content: flex-start;
      overflow: auto;
      overflow-x: auto;
      overflow-y: auto;
      flex: 1;
      min-height: 0;
      max-height: 100%;
      max-width: 100%;
      background: rgba(255, 255, 255, 0.5);
      border-radius: 20px;
      padding: 26px;
      box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.05);
      -webkit-overflow-scrolling: touch;
    }

    /* Specific styling for report diagrams section */
    #secDiag .diagram-container {
      flex: 1;
      min-height: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
    }
    
    .report-diagram {
      width: 100%;
      overflow: visible;
      min-width: 100%;
      height: 100%;
    }
    
    .report-diagram svg {
      min-width: 1200px;
      min-height: 950px;
      width: auto;
      height: auto;
      display: block;
    }
    
    /* Pentru diagramele mai largi (ex: Portal JustiÈ›ie) */
    .report-diagram svg[viewBox*="1400"] {
      min-width: 1400px;
    }

    .report-diagram svg[viewBox*="1600"] {
      min-width: 1600px;
    }

    .report-diagram svg[viewBox*="1800"] {
      min-width: 1800px;
    }

    svg { font-family: Georgia, 'Times New Roman', serif; }

    .layer {
      fill: none;
      stroke: rgba(53, 118, 176, 0.28);
      stroke-width: 2;
      stroke-dasharray: 8,4;
      opacity: 0.75;
    }

    /* Node (box) styling */
    .node rect {
      stroke-width: 3;
      rx: 16;
      ry: 16;
      filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15));
      transition: transform 0.25s ease, filter 0.25s ease;
      transform-origin: center;
    }

    .node:hover rect {
      filter: drop-shadow(0 14px 26px rgba(0, 0, 0, 0.25));
      transform: translateY(-2px);
    }

    .box-frontend { fill: url(#gradientFrontend); stroke: #2196F3; }
    .box-backend  { fill: url(#gradientBackend);  stroke: #FF9800; }
    .box-database { fill: url(#gradientDatabase); stroke: #9C27B0; }
    .box-deploy   { fill: url(#gradientDeployment); stroke: #4CAF50; }

    .layer-label {
      font-size: 20px;
      font-weight: 800;
      fill: #22507a;
      paint-order: stroke fill;
      stroke: rgba(255,255,255,0.95);
      stroke-width: 6px;
      stroke-linejoin: round;
    }

    .arrow {
      stroke: #3576b0;
      stroke-width: 3;
      fill: none;
      marker-end: url(#arrowhead);
      filter: drop-shadow(0 2px 4px rgba(53, 118, 176, 0.3));
      opacity: 0.9;
      animation: arrowFlow 2s ease-in-out infinite;
    }
    @keyframes arrowFlow { 0%,100% { opacity: 0.7; } 50% { opacity: 1; } }

    .arrow-dashed {
      stroke-dasharray: 8,4;
      stroke: #6fa3ef;
      animation: arrowFlowDashed 3s ease-in-out infinite;
    }
    @keyframes arrowFlowDashed { 0%,100% { stroke-dashoffset: 0; opacity: 0.65; } 50% { stroke-dashoffset: -12; opacity: 1; } }

    /* Wrapped text inside SVG via foreignObject */
    .fo {
      overflow: visible;
      pointer-events: none; /* allow hover to hit node */
    }
    .card {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 14px 14px;
      text-align: center;
      color: #2c3e50;
    }
    .card .title {
      font-weight: 800;
      font-size: 15px;
      color: #1a237e;
      line-height: 1.1;
      word-break: break-word;
    }
    .card .line {
      font-size: 12px;
      color: #546e7a;
      line-height: 1.15;
      word-break: break-word;
    }

    /* Slightly more compact for tall cards */
    .card.compact { gap: 5px; padding: 12px 14px; }
    .card.compact .line { font-size: 11.5px; }

    .legend {
      margin-top: 46px;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 26px;
      padding: 22px;
      background: rgba(255, 255, 255, 0.6);
      border-radius: 15px;
      backdrop-filter: blur(10px);
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 18px;
      background: rgba(255, 255, 255, 0.82);
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transition: transform 0.25s ease, box-shadow 0.25s ease;
    }
    .legend-item:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.15); }

    .legend-color {
      width: 40px;
      height: 25px;
      border-radius: 8px;
      border: 3px solid rgba(255, 255, 255, 0.8);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .legend-text { font-size: 15px; color: #2c3e50; font-weight: 600; }
    .icon { font-size: 22px; margin-right: 6px; }
  
    /* Documentation section (from Markdown) */
    .doc-section{
      margin-top: 34px;
      margin-bottom: 26px;
      background: rgba(255,255,255,0.70);
      border-radius: 18px;
      padding: 26px 26px;
      box-shadow: 0 10px 24px rgba(0,0,0,0.08);
      border: 1px solid rgba(53,118,176,0.15);
    }
    .doc-section h2, .doc-section h3, .doc-section h4{
      color:#22507a;
      margin: 18px 0 10px;
      line-height: 1.2;
    }
    .doc-section h1{ display:none; } /* avoid duplicate big title */
    .doc-section p{
      color:#2c3e50;
      font-size: 1.02rem;
      line-height: 1.65;
      margin: 10px 0;
    }
    .doc-section ul, .doc-section ol{
      margin: 10px 0 10px 24px;
      color:#2c3e50;
      line-height: 1.6;
    }
    .doc-section li{ margin: 6px 0; }
    .doc-section code{
      background: rgba(111,163,239,0.15);
      padding: 2px 6px;
      border-radius: 8px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      font-size: 0.95em;
    }
    .doc-section pre{
      background: rgba(34,80,122,0.08);
      border: 1px solid rgba(34,80,122,0.12);
      border-radius: 14px;
      padding: 14px 16px;
      overflow:auto;
      margin: 14px 0;
    }
    .doc-section pre code{ background: transparent; padding:0; }
    .doc-section table{
      width: 100%;
      border-collapse: collapse;
      margin: 14px 0;
      overflow: hidden;
      border-radius: 14px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.06);
    }
    .doc-section th, .doc-section td{
      border: 1px solid rgba(53,118,176,0.18);
      padding: 10px 12px;
      text-align: left;
      color:#2c3e50;
    }
    .doc-section th{
      background: rgba(53,118,176,0.10);
      font-weight: 800;
    }
    .doc-header{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 14px;
      margin-bottom: 10px;
    }
    .doc-header .badge{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding: 10px 14px;
      background: rgba(34,80,122,0.08);
      border: 1px solid rgba(34,80,122,0.10);
      border-radius: 999px;
      color:#22507a;
      font-weight: 800;
    }
    .doc-toggle{
      cursor:pointer;
      user-select:none;
      display:inline-flex;
      align-items:center;
      gap: 10px;
      padding: 10px 14px;
      background: rgba(255,255,255,0.82);
      border: 1px solid rgba(53,118,176,0.20);
      border-radius: 999px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.06);
      color:#22507a;
      font-weight: 800;
    }
    .doc-toggle:hover{ transform: translateY(-1px); }

  
    .hidden{display:none !important;}

    /* Nav Tabs (classic) */
    .nav-tabs-wrap{
      margin: 18px auto 26px;
      border-bottom: 3px solid rgba(53,118,176,0.22);
      display:flex;
      justify-content: center;
      width: 100%;
    }
    .nav-tabs{
      list-style:none;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
      padding: 0;
      margin: 0;
      width: 100%;
      max-width: 1400px;
    }
    .nav-tabs .nav-item{ 
      margin: 0;
      display: flex;
    }
    .nav-tabs .nav-link{
      border: none;
      cursor:pointer;
      background: linear-gradient(135deg, rgba(255,255,255,0.85) 0%, rgba(255,255,255,0.75) 100%);
      padding: 14px 18px;
      border-radius: 14px;
      font-family: Georgia, 'Times New Roman', serif;
      font-weight: 700;
      font-size: 0.95rem;
      color:#1f2a44;
      display:flex;
      align-items:center;
      justify-content: flex-start;
      gap: 10px;
      width: 100%;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 2px solid rgba(53,118,176,0.15);
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
      position: relative;
      overflow: hidden;
    }
    .nav-tabs .nav-link::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      transition: left 0.5s ease;
    }
    .nav-tabs .nav-link:hover::before {
      left: 100%;
    }
    .nav-tabs .nav-link:hover{
      transform: translateY(-3px) scale(1.02);
      background: linear-gradient(135deg, rgba(53,118,176,0.12) 0%, rgba(111,163,239,0.08) 100%);
      border-color: rgba(53,118,176,0.35);
      box-shadow: 0 8px 24px rgba(53,118,176,0.2);
      color: #003D7A;
    }
    .nav-tabs .nav-link.active{
      color:#003D7A;
      background: linear-gradient(135deg, rgba(53,118,176,0.18) 0%, rgba(111,163,239,0.12) 100%);
      box-shadow: 0 8px 24px rgba(53,118,176,0.25), inset 0 2px 4px rgba(255,255,255,0.3);
      border-color: #3576b0;
      border-width: 2px;
      transform: translateY(-2px);
      font-weight: 800;
    }
    .nav-tabs .nav-link.active::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, #3576b0, #6fa3ef, #3576b0);
      animation: shimmer 2s ease-in-out infinite;
    }
    @keyframes shimmer {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    .nav-tabs .nav-link span:first-child {
      font-size: 1.2rem;
      transition: transform 0.3s ease;
    }
    .nav-tabs .nav-link:hover span:first-child {
      transform: scale(1.15) rotate(5deg);
    }
    .nav-tabs .nav-link.active span:first-child {
      transform: scale(1.1);
      filter: drop-shadow(0 2px 4px rgba(53,118,176,0.3));
    }

    /* Report Tab Buttons - Modern Styling */
    .report-tab-btn {
      padding: 12px 20px;
      background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%);
      color: #2c3e50;
      border: 2px solid rgba(53, 118, 176, 0.2);
      border-radius: 12px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      font-family: Georgia, 'Times New Roman', serif;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08), 0 2px 4px rgba(0, 0, 0, 0.05);
      position: relative;
      overflow: hidden;
      min-width: 140px;
      text-align: center;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .report-tab-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.5), transparent);
      transition: left 0.5s ease;
    }

    .report-tab-btn:hover::before {
      left: 100%;
    }

    .report-tab-btn:hover {
      transform: translateY(-2px) scale(1.02);
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      border-color: rgba(53, 118, 176, 0.4);
      box-shadow: 0 8px 20px rgba(53, 118, 176, 0.25), 0 4px 8px rgba(0, 0, 0, 0.1);
      color: #1a237e;
    }

    .report-tab-btn.active {
      background: linear-gradient(135deg, #22507a 0%, #3576b0 50%, #6fa3ef 100%);
      color: white;
      border-color: #22507a;
      box-shadow: 0 8px 24px rgba(34, 80, 122, 0.4), 
                  0 4px 12px rgba(53, 118, 176, 0.3),
                  inset 0 2px 4px rgba(255, 255, 255, 0.2);
      font-weight: 700;
      transform: translateY(-2px);
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }

    .report-tab-btn.active::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.6));
      animation: shimmerActive 2s ease-in-out infinite;
    }

    @keyframes shimmerActive {
      0%, 100% { opacity: 0.8; }
      50% { opacity: 1; }
    }

    .report-tab-btn:active {
      transform: translateY(0) scale(0.98);
    }

    /* DFD Tab Buttons - Same styling as report tabs */
    .dfd-tab-btn {
      padding: 12px 20px;
      background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%);
      color: #2c3e50;
      border: 2px solid rgba(53, 118, 176, 0.2);
      border-radius: 12px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      font-family: Georgia, 'Times New Roman', serif;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08), 0 2px 4px rgba(0, 0, 0, 0.05);
      position: relative;
      overflow: hidden;
      min-width: 140px;
      text-align: center;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .dfd-tab-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.5), transparent);
      transition: left 0.5s ease;
    }

    .dfd-tab-btn:hover::before {
      left: 100%;
    }

    .dfd-tab-btn:hover {
      transform: translateY(-2px) scale(1.02);
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      border-color: rgba(53, 118, 176, 0.4);
      box-shadow: 0 8px 20px rgba(53, 118, 176, 0.25), 0 4px 8px rgba(0, 0, 0, 0.1);
      color: #1a237e;
    }

    .dfd-tab-btn.active {
      background: linear-gradient(135deg, #22507a 0%, #3576b0 50%, #6fa3ef 100%);
      color: white;
      border-color: #22507a;
      box-shadow: 0 8px 24px rgba(34, 80, 122, 0.4), 
                  0 4px 12px rgba(53, 118, 176, 0.3),
                  inset 0 2px 4px rgba(255, 255, 255, 0.2);
      font-weight: 700;
      transform: translateY(-2px);
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }

    .dfd-tab-btn.active::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.6));
      animation: shimmerActive 2s ease-in-out infinite;
    }

    .dfd-tab-btn:active {
      transform: translateY(0) scale(0.98);
    }

    /* DFD Report Sections */
    .dfd-report {
      display: none;
    }

    .dfd-report.active {
      display: block;
    }

    /* Navigation container for report tabs */
    nav[style*="display: flex"] {
      display: flex !important;
      flex-wrap: wrap !important;
      gap: 10px !important;
      padding: 15px 0 !important;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 15px;
      padding: 15px !important;
      backdrop-filter: blur(10px);
    }

    /* Physical Tab Buttons - Same styling as report tabs */
    .physical-tab-btn {
      padding: 12px 20px;
      background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%);
      color: #2c3e50;
      border: 2px solid rgba(53, 118, 176, 0.2);
      border-radius: 12px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      font-family: Georgia, 'Times New Roman', serif;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08), 0 2px 4px rgba(0, 0, 0, 0.05);
      position: relative;
      overflow: hidden;
      min-width: 140px;
      text-align: center;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .physical-tab-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.5), transparent);
      transition: left 0.5s ease;
    }

    .physical-tab-btn:hover::before {
      left: 100%;
    }

    .physical-tab-btn:hover {
      transform: translateY(-2px) scale(1.02);
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      border-color: rgba(53, 118, 176, 0.4);
      box-shadow: 0 8px 20px rgba(53, 118, 176, 0.25), 0 4px 8px rgba(0, 0, 0, 0.1);
      color: #1a237e;
    }

    .physical-tab-btn.active {
      background: linear-gradient(135deg, #22507a 0%, #3576b0 50%, #6fa3ef 100%);
      color: white;
      border-color: #22507a;
      box-shadow: 0 8px 24px rgba(34, 80, 122, 0.4), 
                  0 4px 12px rgba(53, 118, 176, 0.3),
                  inset 0 2px 4px rgba(255, 255, 255, 0.2);
      font-weight: 700;
      transform: translateY(-2px);
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }

    .physical-tab-btn.active::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.6));
      animation: shimmerActive 2s ease-in-out infinite;
    }

    .physical-tab-btn:active {
      transform: translateY(0) scale(0.98);
    }

    /* Physical diagrams wrapper */
    #secFizic .section-body {
      display: flex;
      flex-direction: column;
      max-height: calc(100vh - 200px);
      overflow: hidden;
      padding: 18px;
    }

    #secFizic .section-body > div:first-child {
      flex-shrink: 0;
      margin-bottom: 20px;
    }

    .physical-diagram {
      flex: 1;
      min-height: 0;
      overflow: hidden;
      display: none;
      flex-direction: column;
    }

    .physical-diagram.active {
      display: flex;
    }
    .nav-badge{
      font-size: 11px;
      font-weight: 900;
      text-transform: uppercase;
      letter-spacing: .4px;
      padding: 4px 10px;
      border-radius: 999px;
      background: linear-gradient(135deg, #FFD700 0%, #FFC500 60%, #FFB800 100%);
      color:#003D7A;
      border: 1px solid #B8860B;
      box-shadow: 0 5px 12px rgba(255, 215, 0, 0.25);
    }
    /* prevent any overlay from blocking clicks */
    .nav-tabs-wrap, .nav-tabs, .nav-link{ position: relative; z-index: 5; }


    .content-section{
      margin-top: 22px;
      border-radius: 22px;
      overflow: hidden;
      border: 1px solid rgba(53,118,176,0.14);
      box-shadow: 0 14px 34px rgba(0,0,0,0.08);
      background: rgba(255,255,255,0.70);
    }
    .content-section .section-head{
      padding: 16px 20px;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 12px;
      background: linear-gradient(135deg, rgba(34,80,122,0.10) 0%, rgba(111,163,239,0.06) 100%);
      border-bottom: 1px solid rgba(53,118,176,0.14);
    }
    .content-section .section-head .title{
      font-weight: 900;
      color:#22507a;
      display:flex;
      align-items:center;
      gap: 10px;
      font-size: 1.05rem;
    }
    .content-section .section-body{
      padding: 18px 18px;
      background: rgba(255,255,255,0.72);
    }

    /* Special styling for diagram section - scrollable container */
    #secDiag .section-body {
      display: flex;
      flex-direction: column;
      max-height: calc(100vh - 200px);
      overflow: hidden;
      padding: 18px;
    }

    /* Navigation buttons container - fixed height */
    #secDiag .section-body > div:first-child {
      flex-shrink: 0;
      margin-bottom: 20px;
    }

    /* Report diagrams wrapper - takes remaining space and scrollable */
    #secDiag .report-diagram {
      flex: 1;
      min-height: 0;
      overflow: hidden;
      display: none;
      flex-direction: column;
    }

    #secDiag .report-diagram.active {
      display: flex;
    }

    /* Physical diagram styles */
    .box-phys {
      stroke-width: 3;
      transition: transform 0.25s ease, filter 0.25s ease;
    }
    .box-phys:hover {
      filter: drop-shadow(0 14px 26px rgba(0, 0, 0, 0.25));
      transform: translateY(-2px);
    }
    .box-cloud { fill: url(#gradientCloud); stroke: #4CAF50; }
    .box-server { fill: url(#gradientServer); stroke: #FF9800; }
    .box-db { fill: url(#gradientDB); stroke: #9C27B0; }
    .box-client { fill: url(#gradientClient); stroke: #2196F3; }
    .arrow-phys {
      stroke: #3576b0;
      stroke-width: 3;
      fill: none;
      marker-end: url(#arrowhead-phys);
      filter: drop-shadow(0 2px 4px rgba(53, 118, 176, 0.3));
      opacity: 0.9;
      animation: arrowFlow 2s ease-in-out infinite;
    }

</style>
</head>
<body>
  <div class="container">
    <h1><i class="fas fa-file-lines"></i> DocumentaÈ›ia - Roboescu</h1>

    <nav class="nav-tabs-wrap" aria-label="Navigare secÈ›iuni">
      <ul class="nav-tabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="tabDoc" role="tab" aria-controls="secDoc" aria-selected="true" type="button">
            <span>ğŸ“„</span><span>Context &amp; Scop</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tabDiag" role="tab" aria-controls="secDiag" aria-selected="false" type="button">
            <span>ğŸ§©</span><span>DiagramÄƒ (logicÄƒ)</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tabFizic" role="tab" aria-controls="secFizic" aria-selected="false" type="button">
            <span>ğŸ—ï¸</span><span>DiagramÄƒ (fizicÄƒ)</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tabRegistru" role="tab" aria-controls="secRegistru" aria-selected="false" type="button">
            <span>ğŸ“‹</span><span>Registrul Activelor Informatice</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tabFirewall" role="tab" aria-controls="secFirewall" aria-selected="false" type="button">
            <span>ğŸ›¡ï¸</span><span>Reguli Firewall &amp; Separare LogicÄƒ</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tabSoftware" role="tab" aria-controls="secSoftware" aria-selected="false" type="button">
            <span>ğŸ’»</span><span>Software &amp; StaÈ›ii de Lucru</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tabDFD" role="tab" aria-controls="secDFD" aria-selected="false" type="button">
            <span>ğŸ”„</span><span>Fluxuri de Date (DFD)</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tabAcces" role="tab" aria-controls="secAcces" aria-selected="false" type="button">
            <span>ğŸ”</span><span>Nivele Acces &amp; Securitate</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tabProtectie" role="tab" aria-controls="secProtectie" aria-selected="false" type="button">
            <span>ğŸ›¡ï¸</span><span>ProtecÈ›ie &amp; Validare</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tabObfuscare" role="tab" aria-controls="secObfuscare" aria-selected="false" type="button">
            <span>ğŸ”’</span><span>ProtecÈ›ie &amp; Obfuscare</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tabDatePersonale" role="tab" aria-controls="secDatePersonale" aria-selected="false" type="button">
            <span>ğŸ“‹</span><span>ProtecÈ›ie Date Personale</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tabFunctionala" role="tab" aria-controls="secFunctionala" aria-selected="false" type="button">
            <span>âš™ï¸</span><span>Descriere FuncÈ›ionalÄƒ</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tabProcese" role="tab" aria-controls="secProcese" aria-selected="false" type="button">
            <span>ğŸ”„</span><span>Descrierea Proceselor</span>
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tabContact" role="tab" aria-controls="secContact" aria-selected="false" type="button">
            <span>ğŸ“§</span><span>Contact</span>
          </button>
        </li>
      </ul>
    </nav>


    <section class="content-section" id="secDoc">
      <div class="section-head">
        <div class="title">ğŸ“„ Context &amp; Scop</div>
        <div style="opacity:.75; font-weight:700; color:#22507a;">DocumentaÈ›ie proiect</div>
      </div>
      <div class="section-body">
        <section class="doc-section" id="documentatie">
      <div class="doc-header">
        <div class="badge"><i class="fa-solid fa-file-lines"></i> DocumentaÈ›ie</div>
        <div class="doc-toggle" id="docToggle" aria-controls="docBody" aria-expanded="true">
          <i class="fa-solid fa-chevron-up" id="docIcon"></i> Ascunde / AfiÈ™eazÄƒ
        </div>
      </div>
      <div id="docBody">
        <h1>Arhitectura Proiectului Roboescu</h1>
<p></p>

<div style="background: #f8f9fa; border-left: 4px solid #22507a; padding: 20px; margin: 20px 0; border-radius: 4px;">
  <h2 style="margin-top: 0; color: #22507a;">Versiunea DocumentaÈ›iei</h2>
  <table style="width: 100%; border-collapse: collapse; font-family: Georgia, serif;">
    <thead>
      <tr style="background: #e3f2fd;">
        <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Versiune</th>
        <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Data</th>
        <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">ModificÄƒri</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">1.0</td>
        <td style="padding: 10px; border: 1px solid #ddd;">2026-01-01</td>
        <td style="padding: 10px; border: 1px solid #ddd;">DocumentaÈ›ie iniÈ›ialÄƒ - acoperÄƒ 13 rapoarte finalizate (54% din obiectivul total de 24 rapoarte planificate pÃ¢nÄƒ Ã®n iunie 2026)</td>
      </tr>
    </tbody>
  </table>
  
  <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin: 20px 0; border-radius: 4px;">
    <h3 style="margin-top: 0; color: #856404; font-size: 1.1rem;">ğŸ“Š Status Rapoarte</h3>
    <p style="margin: 10px 0; color: #856404; line-height: 1.6;">
      <strong>Rapoarte finalizate È™i operaÈ›ionale:</strong> <strong style="color: #22507a;">13 tipologii</strong> (54% din obiectivul total)<br>
      <strong>Rapoarte planificate:</strong> 24 tipologii<br>
      <strong>Termen finalizare:</strong> Iunie 2026<br>
      <strong>NotÄƒ:</strong> DocumentaÈ›ia actualÄƒ reflectÄƒ doar rapoartele finalizate pÃ¢nÄƒ Ã®n prezent. Ãn iunie 2026, documentaÈ›ia va fi actualizatÄƒ pentru a include toate cele 24 de rapoarte planificate.
    </p>
  </div>
  
  <div style="background: #e7f3ff; border-left: 4px solid #2196F3; padding: 15px; margin: 20px 0; border-radius: 4px;">
    <h3 style="margin-top: 0; color: #22507a; font-size: 1.1rem;">âœ… Rapoarte Finalizate (13 tipologii)</h3>
    <ul style="margin: 10px 0; padding-left: 20px; color: #2c3e50; line-height: 1.8;">
      <li>Raportare lunarÄƒ cu dosare active per client</li>
      <li>Raport creanÈ›e sub 500 RON</li>
      <li>Raport expunere Ã®n executare â€“ dosare ICC cesionate</li>
      <li>Raport termene licitaÈ›ii imobile garanÈ›ie</li>
      <li>Raport termene licitaÈ›ie imobile identificate</li>
      <li>Raport incidente È™i riscuri â€“ dosare ICC cesionate</li>
      <li>Raport productivitate echipÄƒ BT</li>
      <li>Raport productivitate echipÄƒ dosare cesionate</li>
      <li>Raport creanÈ›e perimate BT</li>
      <li>Raport interogare Portal JustiÈ›ie (API) â€“ preluare informaÈ›ii litigii</li>
      <li>Interogare SIUI</li>
      <li>AnalizÄƒ perimare BT</li>
      <li>Raport dosare perimate È™i fÄƒrÄƒ acÈ›iuni â€“ ICC cesionate</li>
    </ul>
  </div>
</div>

<h2>Descriere GeneralÄƒ</h2>
<p></p>
<p><strong>Roboescu</strong> este o aplicaÈ›ie desktop enterprise dezvoltatÄƒ complet in-house de cÄƒtre <strong>ICC</strong> pentru automatizarea È™i standardizarea proceselor de reporting. AplicaÈ›ia transformÄƒ procesele manuale repetitive de prelucrare Excel Ã®n fluxuri automate, predictibile È™i controlate, reducÃ¢nd semnificativ timpul de execuÈ›ie È™i erorile umane.</p>
<p></p>
<p>AplicaÈ›ia este conceputÄƒ È™i operatÄƒ pentru procesarea automatÄƒ a rapoartelor Excel, generarea de rapoarte standardizate, trimiterea automatÄƒ de email-uri È™i programarea rulÄƒrilor automate. Sistemul funcÈ›ioneazÄƒ local pe staÈ›iile de lucru Windows, utilizÃ¢nd interfaÈ›Äƒ graficÄƒ modernÄƒ (CustomTkinter) È™i integrare cu Outlook pentru trimiterea email-urilor.</p>
<p></p>
<p>Roboescu proceseazÄƒ date din fiÈ™iere Excel Master, aplicÄƒ logici de procesare specifice fiecÄƒrui tip de raport, genereazÄƒ fiÈ™iere Excel formatate profesional È™i trimite automat email-uri cÄƒtre destinatarii configuraÈ›i. AplicaÈ›ia nu colecteazÄƒ date personale Ã®n sensul GDPR, ci proceseazÄƒ doar date operaÈ›ionale necesare pentru generarea rapoartelor.</p>
<p></p>
<p>AplicaÈ›ia oferÄƒ suport pentru procesarea automatÄƒ a rapoartelor, dar nu Ã®nlocuieÈ™te deciziile umane sau validarea profesionalÄƒ a rezultatelor. Utilizarea informaÈ›iilor generate se face pe propria rÄƒspundere a utilizatorului.</p>
<p></p>
<h2>Componente Principale</h2>
<p></p>
<h3>1. InterfaÈ›Äƒ GraficÄƒ (GUI Layer)</h3>
<p></p>
<h4>Module InterfaÈ›Äƒ:</h4>
<ul>
<li><strong>main.py</strong> - AplicaÈ›ia principalÄƒ - orchestrator È™i meniu principal</li>
<li><strong>screen.py</strong> - InterfaÈ›Äƒ graficÄƒ pentru fiecare modul de raport (11 module)</li>
<li><strong>StartScreen</strong> - Ecran de start cu buton de acces</li>
<li><strong>MainMenu</strong> - Meniu principal cu lista rapoartelor disponibile</li>
</ul>
<p></p>
<h4>Caracteristici InterfaÈ›Äƒ:</h4>
<ul>
<li>InterfaÈ›Äƒ modernÄƒ cu CustomTkinter (dark theme)</li>
<li>Navigare intuitivÄƒ Ã®ntre module</li>
<li>Configurare persistentÄƒ (salvare/Ã®ncÄƒrcare setÄƒri)</li>
<li>Logging Ã®n timp real Ã®n interfaÈ›Äƒ</li>
<li>Scheduler integrat pentru rulÄƒri automate</li>
</ul>
<p></p>
<h3>2. Layer de Procesare (Processing Layer)</h3>
<p></p>
<h4>Module Procesare (`processor.py` pentru fiecare raport):</h4>
<ul>
<li><strong>Raport Creditori</strong> - Procesare Master, concatenare sheeturi, filtrare pe creditori</li>
<li><strong>Raport CreanÈ›e &lt; 500 RON</strong> - Filtrare automatÄƒ dupÄƒ valoare</li>
<li><strong>Raport Termene Licitatie Garantii</strong> - Separare termene active/expirate</li>
<li><strong>Raport Portal Just</strong> - Integrare API portal.just.ro, normalizare instanÈ›e</li>
<li><strong>Raport Expunere Executare</strong> - AnalizÄƒ complexÄƒ expunere È™i execuÈ›ie</li>
<li><strong>Raport Incidente Riscuri</strong> - Procesare È™i clasificare incidente</li>
<li><strong>Raport Perimate È™i FÄƒrÄƒ AcÈ›iuni</strong> - Identificare dosare perimate</li>
<li><strong>Raport Productivitate</strong> - AnalizÄƒ productivitate BT È™i Cesionate</li>
<li><strong>Raport Interogare SIUI</strong> - Parsing CNP, interogare CASAN automatÄƒ</li>
<li><strong>Raport Analiza Perimare BT</strong> - Cel mai complex modul (9 tipuri email-uri)</li>
<li><strong>Raport CreanÈ›e Perimate BT</strong> - Procesare creanÈ›e perimate</li>
</ul>
<p></p>
<h4>FuncÈ›ionalitÄƒÈ›i Procesare:</h4>
<ul>
<li>Citire/scriere Excel cu openpyxl</li>
<li>Manipulare date cu pandas</li>
<li>Validare È™i filtrare automatÄƒ</li>
<li>Formatare profesionalÄƒ Excel (font Georgia 11pt)</li>
<li>ProtecÈ›ie parolÄƒ Excel</li>
<li>Generare grafice interactive (Plotly)</li>
</ul>
<p></p>
<h3>3. Layer de Comunicare (Communication Layer)</h3>
<p></p>
<h4>Trimitere Email:</h4>
<ul>
<li><strong>win32com.client</strong> - Integrare Outlook pentru trimitere email-uri</li>
<li>Email-uri HTML È™i text</li>
<li>AtaÈ™amente multiple (Excel, HTML)</li>
<li>Destinatari configurabili (TO, CC, BCC)</li>
<li>Draft email personalizat</li>
</ul>
<p></p>
<h4>Tipuri Email-uri:</h4>
<ul>
<li>Email-uri automate per raport</li>
<li>Email-uri per BRLI (Raport Portal Just)</li>
<li>Email-uri per creditor (Raport Incidente Riscuri)</li>
<li>Email-uri cu statistici È™i diagrame</li>
<li>Email-uri condiÈ›ionale (doar dacÄƒ existÄƒ date)</li>
</ul>
<p></p>
<h3>4. Layer de Automatizare Web (Web Automation Layer)</h3>
<p></p>
<h4>IntegrÄƒri Web:</h4>
<ul>
<li><strong>Playwright</strong> - Browser automation pentru interogÄƒri web</li>
<li><strong>Zeep</strong> - Client SOAP pentru API portal.just.ro</li>
<li><strong>Tesseract OCR</strong> - RecunoaÈ™tere CAPTCHA automatÄƒ</li>
<li><strong>OpenCV</strong> - Preprocesare imagini CAPTCHA</li>
</ul>
<p></p>
<h4>FuncÈ›ionalitÄƒÈ›i:</h4>
<ul>
<li>Interogare automatÄƒ CASAN (Raport Interogare SIUI)</li>
<li>Rezolvare CAPTCHA automatÄƒ cu OCR</li>
<li>Actualizare dosare portal.just.ro (Raport Portal Just)</li>
<li>Normalizare instanÈ›e (248 corecÈ›ii manuale)</li>
<li>Generare HTML sumar litigii cu grafice</li>
</ul>
<p></p>
<h3>5. Layer de Programare (Scheduling Layer)</h3>
<p></p>
<h4>Scheduler:</h4>
<ul>
<li><strong>schedule</strong> - BibliotecÄƒ Python pentru programare</li>
<li><strong>threading</strong> - ExecuÈ›ie asincronÄƒ pentru UI</li>
<li>Configurare zi/orÄƒ pentru rulÄƒri automate</li>
<li>Suport pentru zile lucrÄƒtoare specifice</li>
</ul>
<p></p>
<h4>FuncÈ›ionalitÄƒÈ›i:</h4>
<ul>
<li>RulÄƒri programate per raport</li>
<li>Threading pentru UI non-blocking</li>
<li>Configurare persistentÄƒ Ã®n JSON</li>
<li>Start/Stop scheduler din interfaÈ›Äƒ</li>
</ul>
<p></p>
<h2>Flux de Date</h2>
<p></p>
<h3>1. Flux de Procesare Raport:</h3>
<pre><code>Utilizator selecteazÄƒ raport Ã®n GUI
    â†“
Selectare fiÈ™ier input (Excel Master)
    â†“
Configurare opÈ›iuni (email, CASAN, etc.)
    â†“
Procesare (processor.py)
    â”œâ”€â”€ Citire Excel
    â”œâ”€â”€ Validare date
    â”œâ”€â”€ Procesare logicÄƒ specificÄƒ
    â”œâ”€â”€ Formatare Excel
    â””â”€â”€ Generare output
    â†“
Trimitere email (dacÄƒ activat)
    â†“
Salvare rezultate Ã®n folder configurat</code></pre>
<p></p>
<h3>2. Flux de Interogare CASAN (Raport Interogare SIUI):</h3>
<pre><code>Extragere CNP-uri din Excel
    â†“
Pentru fiecare CNP:
    â”œâ”€â”€ Deschidere browser Playwright (headless)
    â”œâ”€â”€ Rezolvare CAPTCHA cu OCR
    â”œâ”€â”€ Completare formular
    â”œâ”€â”€ Extragere rezultat
    â””â”€â”€ Salvare Ã®n Excel
    â†“
Actualizare Excel cu status CASAN
    â†“
Salvare fiÈ™ier final</code></pre>
<p></p>
<h3>3. Flux de Trimitere Email:</h3>
<pre><code>Generare raport Excel
    â†“
Creare email HTML (dacÄƒ necesar)
    â†“
Conectare Outlook (win32com)
    â†“
Configurare destinatari (TO, CC, BCC)
    â†“
AtaÈ™are fiÈ™iere (Excel, HTML)
    â†“
Trimitere email
    â†“
Confirmare trimitere</code></pre>
<p></p>
<h2>Tehnologii Utilizate</h2>
<p></p>
<h3>Limbaj de Programare:</h3>
<ul>
<li><strong>Python 3.x</strong> (recomandat 3.8+) - limbaj principal</li>
<li>Type hints pentru claritate</li>
<li>F-strings pentru formatare</li>
</ul>
<p></p>
<h3>InterfaÈ›Äƒ GraficÄƒ:</h3>
<ul>
<li><strong>CustomTkinter</strong> - GUI modern cu dark theme</li>
<li><strong>PIL (Pillow)</strong> - Procesare imagini pentru interfaÈ›Äƒ</li>
</ul>
<p></p>
<h3>Prelucrare Excel:</h3>
<ul>
<li><strong>openpyxl</strong> - Citire/scriere fiÈ™iere Excel (.xlsx)</li>
<li><strong>pandas</strong> - Manipulare date, DataFrame operations</li>
</ul>
<p></p>
<h3>Automatizare Web:</h3>
<ul>
<li><strong>playwright</strong> - Browser automation</li>
<li><strong>pytesseract</strong> - Wrapper Python pentru Tesseract OCR</li>
<li><strong>opencv-python</strong> - Preprocesare imagini CAPTCHA</li>
<li><strong>numpy</strong> - Procesare numericÄƒ È™i imagini</li>
<li><strong>zeep</strong> - Client SOAP pentru API portal.just.ro</li>
<li><strong>requests</strong> - HTTP client</li>
</ul>
<p></p>
<h3>Comunicare:</h3>
<ul>
<li><strong>win32com.client</strong> - Integrare Outlook pentru email-uri</li>
</ul>
<p></p>
<h3>Vizualizare:</h3>
<ul>
<li><strong>plotly</strong> - Grafice interactive HTML</li>
<li><strong>kaleido</strong> - Export imagini PNG (opÈ›ional)</li>
</ul>
<p></p>
<h3>Programare:</h3>
<ul>
<li><strong>schedule</strong> - Scheduler pentru rulÄƒri automate</li>
<li><strong>threading</strong> - ExecuÈ›ie asincronÄƒ</li>
</ul>
<p></p>
<h2>Structura Proiectului</h2>
<p></p>
<pre><code>Roboescu/
â”œâ”€â”€ main.py                    # AplicaÈ›ia principalÄƒ - orchestrator
â”œâ”€â”€ config.py                  # Configurare globalÄƒ
â”œâ”€â”€ config.json                # SetÄƒri persistente
â”œâ”€â”€ rapoarte_status.json       # Status rapoarte (activ/mentenanÈ›Äƒ/dezactivat)
â”‚
â”œâ”€â”€ utils/                     # Utilitare comune
â”‚   â”œâ”€â”€ email_sender.py        # Trimitere email-uri Outlook
â”‚   â””â”€â”€ scheduler.py           # Scheduler pentru rulÄƒri automate
â”‚
â””â”€â”€ raport_[nume]/             # Module rapoarte (11 module)
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ processor.py           # LogicÄƒ procesare
    â”œâ”€â”€ screen.py              # InterfaÈ›Äƒ graficÄƒ
    â”œâ”€â”€ config.json            # Configurare specificÄƒ
    â”œâ”€â”€ scheduler.py           # Scheduler local (dacÄƒ existÄƒ)
    â”œâ”€â”€ README.md              # DocumentaÈ›ie
    â”œâ”€â”€ Master/                # FiÈ™iere input
    â””â”€â”€ Rezultate/             # FiÈ™iere output</code></pre>
<p></p>
<h2>Securitate</h2>
<p></p>
<ol>
<li><strong>ProtecÈ›ie Excel</strong>: FiÈ™ierele Excel sunt protejate cu parolÄƒ Ã®nainte de salvare È™i trimitere</li>
<li><strong>Validare Date</strong>: Validare automatÄƒ a datelor de intrare (CNP, date, valori)</li>
<li><strong>Error Handling</strong>: Try-except cu logging detaliat pentru gestionarea erorilor</li>
<li><strong>Configurare</strong>: SetÄƒri persistente Ã®n JSON cu validare</li>
<li><strong>Encoding</strong>: Fix encoding UTF-8 pentru Windows pentru suport caractere romÃ¢neÈ™ti</li>
<li><strong>DependenÈ›e</strong>: Verificare dependenÈ›e Ã®nainte de utilizare (CASAN, Playwright, etc.)</li>
</ol>
<p></p>
<h2>Scalabilitate</h2>
<p></p>
<ul>
<li><strong>ArhitecturÄƒ ModularÄƒ</strong>: Fiecare raport este un modul independent, uÈ™or de extins</li>
<li><strong>Procesare Batch</strong>: Suport pentru procesare pÃ¢nÄƒ la 1000+ Ã®nregistrÄƒri</li>
<li><strong>Threading</strong>: UI non-blocking pentru procesÄƒri lungi</li>
<li><strong>Configurare FlexibilÄƒ</strong>: SetÄƒri per modul È™i globale</li>
<li><strong>Logging</strong>: Sistem de logare detaliat pentru debugging È™i monitorizare</li>
</ul>
<p></p>      </div>
    </section>


            </section>
      </div>
    </section>

    <section class="content-section hidden" id="secDiag">
      <div class="section-head">
        <div class="title">ğŸ§© DiagramÄƒ (logicÄƒ)</div>
        <div style="opacity:.75; font-weight:700; color:#22507a;">Flux logic per raport implementat</div>
      </div>
      <div class="section-body">
        <!-- Tab Navigation pentru Rapoarte -->
        <div style="margin-bottom: 25px; border-bottom: 3px solid rgba(34, 80, 122, 0.2); padding-bottom: 10px;">
          <nav style="display: flex; flex-wrap: wrap; gap: 10px; padding: 15px; background: rgba(255, 255, 255, 0.3); border-radius: 15px; backdrop-filter: blur(10px);">
            <button class="report-tab-btn active" data-report="1">ğŸ“Š 1. Creditori</button>
            <button class="report-tab-btn" data-report="2">ğŸ’° 2. CreanÈ›e &lt;500</button>
            <button class="report-tab-btn" data-report="3">ğŸ“Š 3. Expunere Exec</button>
            <button class="report-tab-btn" data-report="4">ğŸ“… 4. Termene Lic</button>
            <button class="report-tab-btn" data-report="5">âš ï¸ 5. Incidente</button>
            <button class="report-tab-btn" data-report="6">ğŸ“ˆ 6. Productivitate</button>
            <button class="report-tab-btn" data-report="7">ğŸ“‹ 7. CreanÈ›e Perimate</button>
            <button class="report-tab-btn" data-report="8">âš–ï¸ 8. Portal Just</button>
            <button class="report-tab-btn" data-report="9">ğŸ†” 9. SIUI</button>
            <button class="report-tab-btn" data-report="10">ğŸ“Š 10. AnalizÄƒ Perimare</button>
            <button class="report-tab-btn" data-report="11">ğŸ“‹ 11. Perimate FÄƒrÄƒ AcÈ›iuni</button>
            <button class="report-tab-btn" data-report="12">ğŸ  12. Termene Lic Identif</button>
            <button class="report-tab-btn" data-report="13">ğŸ“Š 13. Dosare Active</button>
          </nav>
        </div>

        <!-- DiagramÄƒ LogicÄƒ Raport 1: Creditori -->
        <div class="report-diagram active" id="diagram-report-1">
        <div class="diagram-container">
            <svg width="1200" height="900" viewBox="0 0 1200 900" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ logicÄƒ - Raport Creditori">
        <defs>
                <linearGradient id="gradientInput-r1" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
          </linearGradient>
                <linearGradient id="gradientProcess-r1" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientOutput-r1" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientExternal-r1" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-r1" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                  <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                </marker>
              </defs>
              
              <!-- Title -->
              <text x="600" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ“Š RAPORT CREDITORI - FLUX LOGIC COMPLET</text>
              
              <!-- INPUT SECTION -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¥ INPUT</text>
              <rect x="50" y="100" width="250" height="120" fill="url(#gradientInput-r1)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="100" width="250" height="120">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Master</strong><br/>
                  <strong>2 Sheeturi:</strong><br/>
                  â€¢ Sheet 1 (skiprows=1)<br/>
                  â€¢ Sheet 2<br/>
                  Dosare active per client<br/>
                  Folder: Master/
                </div>
              </foreignObject>
              
              <!-- PROCESSING SECTION -->
              <text x="50" y="280" style="font-size: 16px; font-weight: bold; fill: #22507a;">âš™ï¸ PROCESARE</text>
              
              <!-- Step 1: Citire Sheeturi -->
              <rect x="50" y="290" width="220" height="100" fill="url(#gradientProcess-r1)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="290" width="220" height="100">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 10px;">
                  <strong>1. Citire Sheeturi</strong><br/>
                  pandas.read_excel()<br/>
                  Sheet 1: skiprows=1<br/>
                  Sheet 2: normal<br/>
                  Validare date
                </div>
              </foreignObject>
              
              <!-- Step 2: Concatenare -->
              <rect x="290" y="290" width="220" height="100" fill="url(#gradientProcess-r1)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="290" y="290" width="220" height="100">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 10px;">
                  <strong>2. Concatenare</strong><br/>
                  pd.concat([df1, df2])<br/>
                  ignore_index=True<br/>
                  Validare coloane<br/>
                  Mapare PORTFOLIO (index 21)
                </div>
              </foreignObject>
              
              <!-- Step 3: Mapare Coloane -->
              <rect x="530" y="290" width="220" height="100" fill="url(#gradientProcess-r1)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="530" y="290" width="220" height="100">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 10px;">
                  <strong>3. Mapare Coloane</strong><br/>
                  PORTFOLIO â†’ index 21<br/>
                  NUME_TITULAR â†’ detectare<br/>
                  Creare coloane placeholder<br/>
                  Validare structurÄƒ
                </div>
              </foreignObject>
              
              <!-- Step 4: Separare Creditori -->
              <rect x="770" y="290" width="220" height="100" fill="url(#gradientProcess-r1)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="770" y="290" width="220" height="100">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 10px;">
                  <strong>4. Filtrare &amp; Separare</strong><br/>
                  Filtrare inteligentÄƒ<br/>
                  Separare pe 6 creditori:<br/>
                  EOS | BTD CREDITE | BTD CARDURI<br/>
                  SALT | BT MIC | BT LEASING
                </div>
              </foreignObject>
              
              <!-- Step 5: Formatare -->
              <rect x="1010" y="290" width="150" height="100" fill="url(#gradientProcess-r1)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1010" y="290" width="150" height="100">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 10px;">
                  <strong>5. Formatare</strong><br/>
                  Font: Georgia 11pt<br/>
                  openpyxl styles<br/>
                  ProtecÈ›ie parolÄƒ<br/>
                  Salvare Excel
                </div>
              </foreignObject>
              
              <!-- OUTPUT SECTION -->
              <text x="50" y="470" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¤ OUTPUT</text>
              
              <!-- 6 Excel Parolate -->
              <rect x="50" y="480" width="280" height="140" fill="url(#gradientOutput-r1)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="480" width="280" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">6 Excel Parolate</strong><br/>
                  <strong>Per Creditor:</strong><br/>
                  â€¢ EOS.xlsx (parolat)<br/>
                  â€¢ BTD_CREDITE.xlsx<br/>
                  â€¢ BTD_CARDURI.xlsx<br/>
                  â€¢ SALT.xlsx<br/>
                  â€¢ BT_MIC.xlsx<br/>
                  â€¢ BT_LEASING.xlsx<br/>
                  <strong>+ 1 Master_unificat.xlsx</strong>
                </div>
              </foreignObject>
              
              <!-- Email Output -->
              <rect x="350" y="480" width="250" height="140" fill="url(#gradientExternal-r1)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="350" y="480" width="250" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ Email (OpÈ›ional)</strong><br/>
                  <strong>Outlook Integration:</strong><br/>
                  win32com.client<br/>
                  AtaÈ™amente Excel<br/>
                  Destinatari configuraÈ›i<br/>
                  TO/CC/BCC<br/>
                  Flag: --no-email (skip)
                </div>
              </foreignObject>
              
              <!-- Scheduler -->
              <rect x="620" y="480" width="200" height="140" fill="url(#gradientExternal-r1)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="620" y="480" width="200" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">â° Scheduler</strong><br/>
                  <strong>Rulare AutomatÄƒ:</strong><br/>
                  schedule library<br/>
                  Threading<br/>
                  Rulare lunarÄƒ<br/>
                  Configurabil
                </div>
              </foreignObject>
              
              <!-- Arrows: Input to Processing -->
              <path d="M 175 220 L 160 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r1)"/>
              <path d="M 175 220 L 400 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r1)"/>
              
              <!-- Arrows: Processing Steps -->
              <path d="M 270 340 L 290 340" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r1)"/>
              <path d="M 510 340 L 530 340" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r1)"/>
              <path d="M 750 340 L 770 340" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r1)"/>
              <path d="M 990 340 L 1010 340" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r1)"/>
              
              <!-- Arrows: Processing to Output -->
              <path d="M 190 390 L 190 480" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r1)"/>
              <path d="M 430 390 L 475 480" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r1)"/>
              <path d="M 670 390 L 720 480" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r1)"/>
              
              <!-- Arrows: Output to Email -->
              <path d="M 330 550 L 350 550" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r1)"/>
              
            </svg>
          </div>
        </div>
          </div>
        </div>

        <!-- DiagramÄƒ LogicÄƒ Raport 2: CreanÈ›e < 500 -->
        <div class="report-diagram" id="diagram-report-2">
          <div class="diagram-container">
            <svg width="1350" height="1000" viewBox="0 0 1350 1000" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ logicÄƒ - Raport CreanÈ›e < 500 RON">
              <defs>
                <linearGradient id="gradientInput-r2" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientProcess-r2" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
          </linearGradient>
                <linearGradient id="gradientOutput-r2" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientExternal-r2" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-r2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                  <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                </marker>
              </defs>
              
              <!-- Title -->
              <text x="675" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ’° RAPORT CREANÈšE &lt; 500 RON - FLUX LOGIC COMPLET</text>
              
              <!-- INPUT SECTION -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¥ INPUT</text>
              <rect x="50" y="100" width="250" height="120" fill="url(#gradientInput-r2)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="100" width="250" height="120">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Master</strong><br/>
                  <strong>3 Sheeturi:</strong><br/>
                  â€¢ Sheet 1 (skiprows=1)<br/>
                  â€¢ Sheet 2 (skiprows=1)<br/>
                  â€¢ Sheet 3 (skiprows=1)<br/>
                  Dosare cu creanÈ›e<br/>
                  Folder: Master/
                </div>
              </foreignObject>
              
              <!-- PROCESSING SECTION -->
              <text x="50" y="280" style="font-size: 16px; font-weight: bold; fill: #22507a;">âš™ï¸ PROCESARE</text>
              
              <!-- Step 1: Citire & Aliniere -->
              <rect x="50" y="290" width="180" height="110" fill="url(#gradientProcess-r2)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="290" width="180" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>1. Citire Sheeturi</strong><br/>
                  pandas.read_excel()<br/>
                  skiprows=1 (toate)<br/>
                  <strong>Aliniere coloane:</strong><br/>
                  reindex() + rename()<br/>
                  Validare structurÄƒ
                </div>
              </foreignObject>
              
              <!-- Step 2: Concatenare -->
              <rect x="250" y="290" width="180" height="110" fill="url(#gradientProcess-r2)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="250" y="290" width="180" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>2. Concatenare</strong><br/>
                  pd.concat([df1, df2, df3])<br/>
                  ignore_index=True<br/>
                  <strong>Redenumire:</strong><br/>
                  ID_CONT_FLEX â†’ CONT_CREDIT<br/>
                  Validare date
                </div>
              </foreignObject>
              
              <!-- Step 3: Filtrare RezoluÈ›ii -->
              <rect x="450" y="290" width="200" height="110" fill="url(#gradientProcess-r2)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="450" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>3. Eliminare RezoluÈ›ii</strong><br/>
                  Filtrare REZOLUTIE_INCHIDERE:<br/>
                  â€¢ Balanta = 0<br/>
                  â€¢ PV insolvabilitate<br/>
                  â€¢ Client cesionat<br/>
                  â€¢ Titular decedat<br/>
                  â€¢ Write Off<br/>
                  â€¢ + 9 alte rezoluÈ›ii
                </div>
              </foreignObject>
              
              <!-- Step 4: Filtrare Valoare -->
              <rect x="670" y="290" width="180" height="110" fill="url(#gradientProcess-r2)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="670" y="290" width="180" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>4. Filtrare Valoare</strong><br/>
                  EXP_TOT_CLIENT_RON<br/>
                  pd.to_numeric()<br/>
                  <strong>Filtru: &lt;= 500 RON</strong><br/>
                  Validare numericÄƒ
                </div>
              </foreignObject>
              
              <!-- Step 5: Reordonare & AnalizÄƒ -->
              <rect x="870" y="290" width="280" height="110" fill="url(#gradientProcess-r2)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="870" y="290" width="280" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>5. Reordonare &amp; AnalizÄƒ</strong><br/>
                  <strong>Coloane prioritare:</strong><br/>
                  EXEC_FILE_NO, CONT_CREDIT, etc.<br/>
                  <strong>AnalizÄƒ COMMENTS:</strong><br/>
                  â€¢ Prioritate luna curentÄƒ<br/>
                  â€¢ Prioritate luna trecutÄƒ<br/>
                  â€¢ AnalizÄƒ Ã®ncasÄƒri 6M
                </div>
              </foreignObject>
              
              <!-- Step 6: Normalizare & Formatare -->
              <rect x="1170" y="290" width="150" height="110" fill="url(#gradientProcess-r2)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1170" y="290" width="150" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>6. Normalizare</strong><br/>
                  Normalizare coloane "|"<br/>
                  CurÄƒÈ›are caractere ilegale<br/>
                  <strong>Formatare:</strong><br/>
                  Header bold + color<br/>
                  Auto-width coloane
                </div>
              </foreignObject>
              
              <!-- OUTPUT SECTION -->
              <text x="50" y="480" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¤ OUTPUT</text>
              
              <!-- Excel Rezultat -->
              <rect x="50" y="490" width="280" height="140" fill="url(#gradientOutput-r2)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="490" width="280" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Rezultat</strong><br/>
                  <strong>Sheet: Raport_Creante_500</strong><br/>
                  Dosare filtrate (&lt;= 500 RON)<br/>
                  <strong>Formatare:</strong><br/>
                  â€¢ Header: Bold + #366092<br/>
                  â€¢ Auto-width coloane<br/>
                  â€¢ Sortare dupÄƒ prioritate<br/>
                  Folder: rapoarte_generate/
                </div>
              </foreignObject>
              
              <!-- Istoric JSON -->
              <rect x="350" y="490" width="220" height="140" fill="url(#gradientExternal-r2)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="350" y="490" width="220" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“Š Istoric ProcesÄƒri</strong><br/>
                  <strong>JSON Tracking:</strong><br/>
                  Data procesÄƒrii<br/>
                  NumÄƒr dosare procesate<br/>
                  Statistici filtrare<br/>
                  Validare procesÄƒri anterioare<br/>
                  Raportare progres
                </div>
              </foreignObject>
              
              <!-- Email (optional) -->
              <rect x="590" y="490" width="200" height="140" fill="url(#gradientExternal-r2)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="590" y="490" width="200" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ Email (OpÈ›ional)</strong><br/>
                  <strong>Outlook Integration:</strong><br/>
                  win32com.client<br/>
                  AtaÈ™amente Excel<br/>
                  Destinatari configuraÈ›i<br/>
                  Flag: --no-email (skip)
                </div>
              </foreignObject>
              
              <!-- Arrows: Input to Processing -->
              <path d="M 175 220 L 140 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r2)"/>
              <path d="M 175 220 L 340 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r2)"/>
              
              <!-- Arrows: Processing Steps -->
              <path d="M 230 345 L 250 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r2)"/>
              <path d="M 430 345 L 450 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r2)"/>
              <path d="M 650 345 L 670 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r2)"/>
              <path d="M 850 345 L 870 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r2)"/>
              <path d="M 1150 345 L 1170 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r2)"/>
              
              <!-- Arrows: Processing to Output -->
              <path d="M 140 400 L 190 490" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r2)"/>
              <path d="M 340 400 L 460 490" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r2)"/>
              <path d="M 760 400 L 690 490" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r2)"/>
              
              <!-- Arrows: Output to Email -->
              <path d="M 330 560 L 590 560" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r2)"/>
              
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ LogicÄƒ Raport 3: Expunere Executare -->
        <div class="report-diagram" id="diagram-report-3">
          <div class="diagram-container">
            <svg width="1200" height="950" viewBox="0 0 1200 950" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ logicÄƒ - Raport Expunere Executare">
              <defs>
                <linearGradient id="gradientInput-r3" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientProcess-r3" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientOutput-r3" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
          </linearGradient>
                <linearGradient id="gradientExternal-r3" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-r3" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                  <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                </marker>
              </defs>
              
              <!-- Title -->
              <text x="600" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ“Š RAPORT EXPUNERE EXECUTARE - FLUX LOGIC COMPLET</text>
              
              <!-- INPUT SECTION -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¥ INPUT</text>
              <rect x="50" y="100" width="240" height="120" fill="url(#gradientInput-r3)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="100" width="240" height="120">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Raport-Restantieri_*</strong><br/>
                  Multiple sheeturi<br/>
                  Dosare ICC Cesionate<br/>
                  <strong>Lista Derulanta.xlsx</strong><br/>
                  Mapping Portofoliu â†’ Creditor<br/>
                  Folder: Master/
                </div>
              </foreignObject>
              
              <!-- PROCESSING SECTION -->
              <text x="50" y="280" style="font-size: 16px; font-weight: bold; fill: #22507a;">âš™ï¸ PROCESARE</text>
              
              <!-- Step 1: Citire & Mapping -->
              <rect x="50" y="290" width="200" height="110" fill="url(#gradientProcess-r3)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>1. Citire &amp; Mapping</strong><br/>
                  Citire Lista Derulanta<br/>
                  Mapping Portofoliu â†’ Creditor<br/>
                  Citire Raport-Restantieri<br/>
                  Sheet 1: header=1 (skip row 1)
                </div>
              </foreignObject>
              
              <!-- Step 2: Concatenare Sheeturi -->
              <rect x="270" y="290" width="200" height="110" fill="url(#gradientProcess-r3)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="270" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>2. Concatenare Sheeturi</strong><br/>
                  Sheet 1 (header=1)<br/>
                  Sheet 2+ (skiprows=1)<br/>
                  Aliniere coloane<br/>
                  pd.concat() combinat
                </div>
              </foreignObject>
              
              <!-- Step 3: Filtrare EXECUTARE -->
              <rect x="490" y="290" width="200" height="110" fill="url(#gradientProcess-r3)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="490" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>3. Filtrare EXECUTARE</strong><br/>
                  Eliminare rÃ¢nduri<br/>
                  EXECUTARE = "NU"<br/>
                  Validare coloanÄƒ<br/>
                  PÄƒstreazÄƒ doar "DA"
                </div>
              </foreignObject>
              
              <!-- Step 4: Filtrare DATA_PREDARE_BEJ -->
              <rect x="710" y="290" width="220" height="110" fill="url(#gradientProcess-r3)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="710" y="290" width="220" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>4. Filtrare DATA_PREDARE_BEJ</strong><br/>
                  Eliminare luna curentÄƒ<br/>
                  Eliminare Blank<br/>
                  Format MM/YYYY, YYYY-MM<br/>
                  PÄƒstreazÄƒ doar luni anterioare
                </div>
              </foreignObject>
              
              <!-- Step 5: Calcul & AnalizÄƒ -->
              <rect x="950" y="290" width="200" height="110" fill="url(#gradientProcess-r3)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="950" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>5. Calcul &amp; AnalizÄƒ</strong><br/>
                  Calcul expunere<br/>
                  Calcul execuÈ›ie<br/>
                  Grupare pe creditor<br/>
                  Statistici sumare
                </div>
              </foreignObject>
              
              <!-- OUTPUT SECTION -->
              <text x="50" y="480" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¤ OUTPUT</text>
              
              <!-- Excel Rezultat -->
              <rect x="50" y="490" width="280" height="140" fill="url(#gradientOutput-r3)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="490" width="280" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Rezultat</strong><br/>
                  <strong>Folder: Prelucrare - [luna]</strong><br/>
                  Raport expunere/execuÈ›ie<br/>
                  Formatare Georgia 11pt<br/>
                  Grafice matplotlib<br/>
                  Statistici per creditor<br/>
                  Folder: rapoarte_generate/
                </div>
              </foreignObject>
              
              <!-- Email (optional) -->
              <rect x="350" y="490" width="220" height="140" fill="url(#gradientExternal-r3)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="350" y="490" width="220" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ Email (OpÈ›ional)</strong><br/>
                  <strong>Outlook Integration:</strong><br/>
                  win32com.client<br/>
                  AtaÈ™amente Excel<br/>
                  Grafice Ã®ncorporate<br/>
                  Destinatari configuraÈ›i<br/>
                  Flag: --no-email (skip)
                </div>
              </foreignObject>
              
              <!-- Arrows: Input to Processing -->
              <path d="M 170 220 L 150 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r3)"/>
              <path d="M 170 220 L 370 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r3)"/>
              
              <!-- Arrows: Processing Steps -->
              <path d="M 250 345 L 270 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r3)"/>
              <path d="M 470 345 L 490 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r3)"/>
              <path d="M 690 345 L 710 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r3)"/>
              <path d="M 930 345 L 950 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r3)"/>
              
              <!-- Arrows: Processing to Output -->
              <path d="M 150 400 L 190 490" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r3)"/>
              <path d="M 370 400 L 460 490" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r3)"/>
              
              <!-- Arrows: Output to Email -->
              <path d="M 330 560 L 350 560" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r3)"/>
              
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ LogicÄƒ Raport 4: Termene Licitatie Garantii -->
        <div class="report-diagram" id="diagram-report-4">
          <div class="diagram-container">
            <svg width="1200" height="950" viewBox="0 0 1200 950" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ logicÄƒ - Raport Termene Licitatie Garantii">
              <defs>
                <linearGradient id="gradientInput-r4" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientProcess-r4" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientOutput-r4" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientExternal-r4" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
          </linearGradient>
                <marker id="arrowhead-r4" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                  <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                </marker>
              </defs>
              
              <!-- Title -->
              <text x="600" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ“… RAPORT TERMENE LICITAÈšIE GARANÈšII - FLUX LOGIC COMPLET</text>
              
              <!-- INPUT SECTION -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¥ INPUT</text>
              <rect x="50" y="100" width="240" height="120" fill="url(#gradientInput-r4)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="100" width="240" height="120">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">2 FiÈ™iere Excel:</strong><br/>
                  <strong>1. Rap 7</strong><br/>
                  Sheet: "baza finala rap.3-sursa2"<br/>
                  ColoanÄƒ: ID garantie Capone<br/>
                  <strong>2. raportGarantiiExecutareICC</strong><br/>
                  2 Sheeturi (concatenate)<br/>
                  Folder: Master/
                </div>
              </foreignObject>
              
              <!-- PROCESSING SECTION -->
              <text x="50" y="280" style="font-size: 16px; font-weight: bold; fill: #22507a;">âš™ï¸ PROCESARE</text>
              
              <!-- Step 1: Citire FiÈ™iere -->
              <rect x="50" y="290" width="200" height="110" fill="url(#gradientProcess-r4)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>1. Citire FiÈ™iere</strong><br/>
                  Rap 7: sheet specific<br/>
                  raportGarantii: Sheet 1+2<br/>
                  Sheet 1: skiprows=1<br/>
                  Validare structurÄƒ
                </div>
              </foreignObject>
              
              <!-- Step 2: Concatenare & CurÄƒÈ›are -->
              <rect x="270" y="290" width="200" height="110" fill="url(#gradientProcess-r4)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="270" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>2. Concatenare</strong><br/>
                  pd.concat([df1, df2])<br/>
                  <strong>CurÄƒÈ›are AUCTION_NO:</strong><br/>
                  Extrage cifre (1-1000)<br/>
                  Eliminare "?", "reevaluare"
                </div>
              </foreignObject>
              
              <!-- Step 3: Conectare Date -->
              <rect x="490" y="290" width="200" height="110" fill="url(#gradientProcess-r4)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="490" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>3. Conectare Date</strong><br/>
                  ID garantie Capone<br/>
                  (Rap 7) â†” AUCTION_NO<br/>
                  (raportGarantii)<br/>
                  Filtrare match-uri
                </div>
              </foreignObject>
              
              <!-- Step 4: Separare Termene -->
              <rect x="710" y="290" width="220" height="110" fill="url(#gradientProcess-r4)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="710" y="290" width="220" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>4. Separare Termene</strong><br/>
                  <strong>Termene active:</strong><br/>
                  Data > data curentÄƒ<br/>
                  <strong>Termene expirate:</strong><br/>
                  Data &lt;= data curentÄƒ<br/>
                  Validare date
                </div>
              </foreignObject>
              
              <!-- Step 5: Formatare -->
              <rect x="950" y="290" width="200" height="110" fill="url(#gradientProcess-r4)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="950" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>5. Formatare</strong><br/>
                  Font: Georgia 11pt<br/>
                  openpyxl styles<br/>
                  ProtecÈ›ie parolÄƒ<br/>
                  Salvare Excel
                </div>
              </foreignObject>
              
              <!-- OUTPUT SECTION -->
              <text x="50" y="480" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¤ OUTPUT</text>
              
              <!-- Excel Rezultat -->
              <rect x="50" y="490" width="280" height="140" fill="url(#gradientOutput-r4)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="490" width="280" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Rezultat</strong><br/>
                  <strong>Sheets:</strong><br/>
                  â€¢ Termene Active<br/>
                  â€¢ Termene Expirate<br/>
                  â€¢ Rap7_Analiza<br/>
                  â€¢ Garantii_Analiza<br/>
                  Formatare Georgia 11pt<br/>
                  Folder: Rapoarte_Termene_Licitatie/
                </div>
              </foreignObject>
              
              <!-- Email & Scheduler -->
              <rect x="350" y="490" width="250" height="140" fill="url(#gradientExternal-r4)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="350" y="490" width="250" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ Email &amp; Scheduler</strong><br/>
                  <strong>Outlook Integration:</strong><br/>
                  win32com.client<br/>
                  Draft email personalizat<br/>
                  AtaÈ™amente Excel<br/>
                  <strong>Scheduler:</strong><br/>
                  Rulare a 2-a zi<br/>
                  Flag: --no-email (skip)
                </div>
              </foreignObject>
              
              <!-- Arrows: Input to Processing -->
              <path d="M 170 220 L 150 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r4)"/>
              <path d="M 170 220 L 370 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r4)"/>
              
              <!-- Arrows: Processing Steps -->
              <path d="M 250 345 L 270 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r4)"/>
              <path d="M 470 345 L 490 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r4)"/>
              <path d="M 690 345 L 710 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r4)"/>
              <path d="M 930 345 L 950 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r4)"/>
              
              <!-- Arrows: Processing to Output -->
              <path d="M 150 400 L 190 490" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r4)"/>
              <path d="M 370 400 L 475 490" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r4)"/>
              
              <!-- Arrows: Output to Email -->
              <path d="M 330 560 L 350 560" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r4)"/>
              
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ LogicÄƒ Raport 5: Incidente Riscuri -->
        <div class="report-diagram" id="diagram-report-5">
          <div class="diagram-container">
            <svg width="1200" height="950" viewBox="0 0 1200 950" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ logicÄƒ - Raport Incidente Riscuri">
              <defs>
                <linearGradient id="gradientInput-r5" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientProcess-r5" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientOutput-r5" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientExternal-r5" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-r5" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                  <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                </marker>
              </defs>
              
              <!-- Title -->
              <text x="600" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">âš ï¸ RAPORT INCIDENTE È˜I RISCURI - FLUX LOGIC COMPLET</text>
              
              <!-- INPUT SECTION -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¥ INPUT</text>
              <rect x="50" y="100" width="240" height="120" fill="url(#gradientInput-r5)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="100" width="240" height="120">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Lista derulanta.xlsx</strong><br/>
                  Dosare ICC Cesionate<br/>
                  <strong>Mapping Creditori:</strong><br/>
                  Creditor â†’ Email TO/CC<br/>
                  ConfiguraÈ›ie email<br/>
                  Folder: Master/
                </div>
              </foreignObject>
              
              <!-- PROCESSING SECTION -->
              <text x="50" y="280" style="font-size: 16px; font-weight: bold; fill: #22507a;">âš™ï¸ PROCESARE</text>
              
              <!-- Step 1: Citire & Mapping -->
              <rect x="50" y="290" width="200" height="110" fill="url(#gradientProcess-r5)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>1. Citire &amp; Mapping</strong><br/>
                  Citire Lista derulanta<br/>
                  Extragere Creditori<br/>
                  Mapping Creditor â†’ Email<br/>
                  Identificare creditor (exact/partial)
                </div>
              </foreignObject>
              
              <!-- Step 2: Procesare Master -->
              <rect x="270" y="290" width="200" height="110" fill="url(#gradientProcess-r5)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="270" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>2. Procesare Master</strong><br/>
                  Citire sheet-uri<br/>
                  Clasificare automatÄƒ<br/>
                  Identificare incidente<br/>
                  Evaluare riscuri
                </div>
              </foreignObject>
              
              <!-- Step 3: Grupare pe Creditor -->
              <rect x="490" y="290" width="200" height="110" fill="url(#gradientProcess-r5)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="490" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>3. Grupare pe Creditor</strong><br/>
                  Separare dosare<br/>
                  Per creditor<br/>
                  Raportare structuratÄƒ<br/>
                  Validare date
                </div>
              </foreignObject>
              
              <!-- Step 4: Formatare -->
              <rect x="710" y="290" width="200" height="110" fill="url(#gradientProcess-r5)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="710" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>4. Formatare</strong><br/>
                  Font: Georgia 11pt<br/>
                  openpyxl styles<br/>
                  ProtecÈ›ie parolÄƒ<br/>
                  Salvare Excel
                </div>
              </foreignObject>
              
              <!-- OUTPUT SECTION -->
              <text x="50" y="480" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¤ OUTPUT</text>
              
              <!-- Excel Rezultat -->
              <rect x="50" y="490" width="280" height="140" fill="url(#gradientOutput-r5)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="490" width="280" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Rezultat</strong><br/>
                  Raport incidente/riscuri<br/>
                  <strong>Per Creditor:</strong><br/>
                  â€¢ BT Microfinantare<br/>
                  â€¢ BTD CARDURI (ERS)<br/>
                  â€¢ BTD CREDITE (BTD)<br/>
                  â€¢ SALT BANK SA<br/>
                  Formatare Georgia 11pt<br/>
                  Folder: Rezultate/
                </div>
              </foreignObject>
              
              <!-- Email per Creditor -->
              <rect x="350" y="490" width="250" height="140" fill="url(#gradientExternal-r5)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="350" y="490" width="250" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ Email per Creditor</strong><br/>
                  <strong>Outlook Integration:</strong><br/>
                  win32com.client<br/>
                  <strong>Destinatari:</strong><br/>
                  TO: juridic@iccollect.ro<br/>
                  CC: rpa@iccollect.ro<br/>
                  AtaÈ™amente Excel<br/>
                  HTML body (Georgia 11pt)
                </div>
              </foreignObject>
              
              <!-- Arrows: Input to Processing -->
              <path d="M 170 220 L 150 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r5)"/>
              <path d="M 170 220 L 370 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r5)"/>
              
              <!-- Arrows: Processing Steps -->
              <path d="M 250 345 L 270 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r5)"/>
              <path d="M 470 345 L 490 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r5)"/>
              <path d="M 690 345 L 710 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r5)"/>
              
              <!-- Arrows: Processing to Output -->
              <path d="M 150 400 L 190 490" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r5)"/>
              <path d="M 370 400 L 475 490" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r5)"/>
              
              <!-- Arrows: Output to Email -->
              <path d="M 330 560 L 350 560" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r5)"/>
              
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ LogicÄƒ Raport 6: Productivitate -->
        <div class="report-diagram" id="diagram-report-6">
          <div class="diagram-container">
            <svg width="1200" height="950" viewBox="0 0 1200 950" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ logicÄƒ - Raport Productivitate">
              <defs>
                <linearGradient id="gradientInput-r6" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientProcess-r6" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientOutput-r6" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientExternal-r6" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-r6" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                  <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                </marker>
              </defs>
              
              <!-- Title -->
              <text x="600" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ“ˆ RAPORT PRODUCTIVITATE - FLUX LOGIC COMPLET</text>
              
              <!-- INPUT SECTION -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¥ INPUT</text>
              <rect x="50" y="100" width="240" height="120" fill="url(#gradientInput-r6)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="100" width="240" height="120">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">2 Seturi de FiÈ™iere:</strong><br/>
                  <strong>1. Master BT:</strong><br/>
                  owner_cesionat.xlsx<br/>
                  Raport-Productivitate-Tasks<br/>
                  <strong>2. Master Cesionate:</strong><br/>
                  owner_cesionat.xlsx<br/>
                  Raport-Productivitate-Tasks<br/>
                  Folder: Master BT/ &amp; Master Cesionate/
                </div>
              </foreignObject>
              
              <!-- PROCESSING SECTION -->
              <text x="50" y="280" style="font-size: 16px; font-weight: bold; fill: #22507a;">âš™ï¸ PROCESARE</text>
              
              <!-- Step 1: Citire & Mapping -->
              <rect x="50" y="290" width="200" height="110" fill="url(#gradientProcess-r6)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>1. Citire &amp; Mapping</strong><br/>
                  Citire owner files<br/>
                  Sheet: "Ã®ncadrare task"<br/>
                  Mapping Task â†’ Owner<br/>
                  Validare structurÄƒ
                </div>
              </foreignObject>
              
              <!-- Step 2: Procesare BT -->
              <rect x="270" y="290" width="200" height="110" fill="url(#gradientProcess-r6)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="270" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>2. Procesare BT</strong><br/>
                  Citire Raport BT<br/>
                  Calcul indicatori<br/>
                  Grupare pe owner<br/>
                  Statistici productivitate
                </div>
              </foreignObject>
              
              <!-- Step 3: Procesare Cesionate -->
              <rect x="490" y="290" width="200" height="110" fill="url(#gradientProcess-r6)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="490" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>3. Procesare Cesionate</strong><br/>
                  Citire Raport Cesionate<br/>
                  Calcul indicatori<br/>
                  Grupare pe owner<br/>
                  Statistici productivitate
                </div>
              </foreignObject>
              
              <!-- Step 4: Analize Comparative -->
              <rect x="710" y="290" width="200" height="110" fill="url(#gradientProcess-r6)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="710" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>4. Analize Comparative</strong><br/>
                  Comparare BT vs Cesionate<br/>
                  Calcul diferenÈ›e<br/>
                  Identificare tendinÈ›e<br/>
                  Validare date
                </div>
              </foreignObject>
              
              <!-- Step 5: Formatare -->
              <rect x="930" y="290" width="200" height="110" fill="url(#gradientProcess-r6)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="930" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>5. Formatare</strong><br/>
                  Font: Georgia 11pt<br/>
                  openpyxl styles<br/>
                  Salvare Excel<br/>
                  Determinare luna din date
                </div>
              </foreignObject>
              
              <!-- OUTPUT SECTION -->
              <text x="50" y="480" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¤ OUTPUT</text>
              
              <!-- Excel Rezultat -->
              <rect x="50" y="490" width="280" height="140" fill="url(#gradientOutput-r6)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="490" width="280" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Rezultat</strong><br/>
                  <strong>Rapoarte:</strong><br/>
                  â€¢ Productivitate BT<br/>
                  â€¢ Productivitate Cesionate<br/>
                  â€¢ Analize comparative<br/>
                  Formatare profesionalÄƒ<br/>
                  Folder: rapoarte_generate/
                </div>
              </foreignObject>
              
              <!-- Email Automat -->
              <rect x="350" y="490" width="250" height="140" fill="url(#gradientExternal-r6)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="350" y="490" width="250" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ Email Automat</strong><br/>
                  <strong>Outlook Integration:</strong><br/>
                  email_sender.py<br/>
                  AtaÈ™amente Excel<br/>
                  Rezultate È™i statistici<br/>
                  Destinatari configuraÈ›i<br/>
                  users_config.json
                </div>
              </foreignObject>
              
              <!-- Arrows: Input to Processing -->
              <path d="M 170 220 L 150 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r6)"/>
              <path d="M 170 220 L 370 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r6)"/>
              <path d="M 170 220 L 590 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r6)"/>
              
              <!-- Arrows: Processing Steps -->
              <path d="M 250 345 L 270 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r6)"/>
              <path d="M 470 345 L 490 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r6)"/>
              <path d="M 690 345 L 710 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r6)"/>
              <path d="M 910 345 L 930 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r6)"/>
              
              <!-- Arrows: Processing to Output -->
              <path d="M 150 400 L 190 490" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r6)"/>
              <path d="M 370 400 L 475 490" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r6)"/>
              
              <!-- Arrows: Output to Email -->
              <path d="M 330 560 L 350 560" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r6)"/>
              
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ LogicÄƒ Raport 7: CreanÈ›e Perimate BT -->
        <div class="report-diagram" id="diagram-report-7">
          <div class="diagram-container">
            <svg width="1200" height="950" viewBox="0 0 1200 950" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ logicÄƒ - Raport CreanÈ›e Perimate BT">
              <defs>
                <linearGradient id="gradientInput-r7" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientProcess-r7" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientOutput-r7" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientExternal-r7" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-r7" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                  <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                </marker>
              </defs>
              
              <!-- Title -->
              <text x="600" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ“‹ RAPORT CREANÈšE PERIMATE BT - FLUX LOGIC COMPLET</text>
              
              <!-- INPUT SECTION -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¥ INPUT</text>
              <rect x="50" y="100" width="240" height="120" fill="url(#gradientInput-r7)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="100" width="240" height="120">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Master</strong><br/>
                  <strong>3 Sheeturi:</strong><br/>
                  â€¢ Sheet 1 (skiprows=1)<br/>
                  â€¢ Sheet 2 (skiprows=1)<br/>
                  â€¢ Sheet 3 (skiprows=1)<br/>
                  Dosare BT<br/>
                  Folder: Master/
                </div>
              </foreignObject>
              
              <!-- PROCESSING SECTION -->
              <text x="50" y="280" style="font-size: 16px; font-weight: bold; fill: #22507a;">âš™ï¸ PROCESARE</text>
              
              <!-- Step 1: Citire & Concatenare -->
              <rect x="50" y="290" width="200" height="110" fill="url(#gradientProcess-r7)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>1. Citire &amp; Concatenare</strong><br/>
                  pandas.read_excel()<br/>
                  skiprows=1 (toate)<br/>
                  Aliniere coloane<br/>
                  pd.concat([df1, df2, df3])
                </div>
              </foreignObject>
              
              <!-- Step 2: Filtrare Luna AnterioarÄƒ -->
              <rect x="270" y="290" width="200" height="110" fill="url(#gradientProcess-r7)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="270" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>2. Filtrare Luna AnterioarÄƒ</strong><br/>
                  DATA_INCHIDERE_DOSAR<br/>
                  pd.to_datetime()<br/>
                  Filtrare MM.YYYY<br/>
                  PÄƒstreazÄƒ doar luna anterioarÄƒ
                </div>
              </foreignObject>
              
              <!-- Step 3: Identificare Perimate -->
              <rect x="490" y="290" width="200" height="110" fill="url(#gradientProcess-r7)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="490" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>3. Identificare Perimate</strong><br/>
                  STADIU_DOSAR<br/>
                  REZOLUTIE_INCHIDERE<br/>
                  CÄƒutare "perimare"<br/>
                  Case-insensitive
                </div>
              </foreignObject>
              
              <!-- Step 4: Formatare & Salvare -->
              <rect x="710" y="290" width="200" height="110" fill="url(#gradientProcess-r7)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="710" y="290" width="200" height="110">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>4. Formatare &amp; Salvare</strong><br/>
                  <strong>Sheets:</strong><br/>
                  â€¢ Toate_Dosarele_Luna<br/>
                  â€¢ Dosare_Perimate<br/>
                  â€¢ Sumar<br/>
                  Formatare profesionalÄƒ
                </div>
              </foreignObject>
              
              <!-- OUTPUT SECTION -->
              <text x="50" y="480" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¤ OUTPUT</text>
              
              <!-- Excel Rezultat -->
              <rect x="50" y="490" width="280" height="140" fill="url(#gradientOutput-r7)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="490" width="280" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Rezultat</strong><br/>
                  <strong>Nume: Raport_Perimate_BT_[MM.YYYY]_[timestamp].xlsx</strong><br/>
                  <strong>Sheets:</strong><br/>
                  â€¢ Toate_Dosarele_Luna<br/>
                  â€¢ Dosare_Perimate<br/>
                  â€¢ Sumar (statistici)<br/>
                  Formatare profesionalÄƒ<br/>
                  Folder: rapoarte_generate/
                </div>
              </foreignObject>
              
              <!-- Email (optional) -->
              <rect x="350" y="490" width="220" height="140" fill="url(#gradientExternal-r7)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="350" y="490" width="220" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ Email (OpÈ›ional)</strong><br/>
                  <strong>Outlook Integration:</strong><br/>
                  win32com.client<br/>
                  AtaÈ™amente Excel<br/>
                  Destinatari configuraÈ›i<br/>
                  Flag: --no-email (skip)
                </div>
              </foreignObject>
              
              <!-- Arrows: Input to Processing -->
              <path d="M 170 220 L 150 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r7)"/>
              <path d="M 170 220 L 370 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r7)"/>
              
              <!-- Arrows: Processing Steps -->
              <path d="M 250 345 L 270 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r7)"/>
              <path d="M 470 345 L 490 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r7)"/>
              <path d="M 690 345 L 710 345" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r7)"/>
              
              <!-- Arrows: Processing to Output -->
              <path d="M 150 400 L 190 490" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r7)"/>
              <path d="M 370 400 L 460 490" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r7)"/>
              
              <!-- Arrows: Output to Email -->
              <path d="M 330 560 L 350 560" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r7)"/>
              
            </svg>
          </div>
        </div>
              <path d="M 150 190 L 150 260" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r7)"/>
              <path d="M 150 360 L 150 440" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r7)"/>
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ LogicÄƒ Raport 8: Portal Just -->
        <div class="report-diagram" id="diagram-report-8">
          <div class="diagram-container">
            <svg width="1800" height="1600" viewBox="0 0 1800 1600" min-width="1800" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ logicÄƒ - Raport Portal JustiÈ›ie">
              <defs>
                <linearGradient id="gradientInput-r8" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientProcess-r8" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientOutput-r8" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientExternal-r8" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-r8" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                  <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                </marker>
              </defs>
              
              <!-- Title -->
              <text x="900" y="40" text-anchor="middle" style="font-size: 24px; font-weight: bold; fill: #22507a;">âš–ï¸ RAPORT PORTAL JUSTIÈšIE - FLUX LOGIC COMPLET</text>
              
              <!-- INPUT SECTION -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¥ INPUT</text>
              <rect x="50" y="100" width="320" height="160" fill="url(#gradientInput-r8)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="100" width="320" height="160">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Master</strong><br/>
                  Dosare judiciare<br/>
                  <strong>ColoanÄƒ:</strong> "Dosar instanta"<br/>
                  Format: XXX/YYYY/ZZZZ<br/>
                  Validare format dosar<br/>
                  Folder: Master/<br/>
                  <strong>Auto-detection:</strong> Most recent file
                </div>
              </foreignObject>
              
              <!-- PROCESSING SECTION -->
              <text x="50" y="320" style="font-size: 16px; font-weight: bold; fill: #22507a;">âš™ï¸ PROCESARE</text>
              
              <!-- Step 1: Citire & IniÈ›ializare -->
              <rect x="50" y="330" width="240" height="150" fill="url(#gradientProcess-r8)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="330" width="240" height="150">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>1. Citire &amp; IniÈ›ializare</strong><br/>
                  pandas.read_excel()<br/>
                  <strong>IniÈ›ializare API:</strong><br/>
                  Zeep Client (SOAP)<br/>
                  WSDL: portalquery.just.ro<br/>
                  HistoryPlugin (debug)<br/>
                  Session timeout: 10s
                </div>
              </foreignObject>
              
              <!-- Step 2: Normalizare InstanÈ›e -->
              <rect x="310" y="330" width="240" height="150" fill="url(#gradientProcess-r8)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="310" y="330" width="240" height="150">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>2. Normalizare InstanÈ›e</strong><br/>
                  instanta_normalizer.py<br/>
                  <strong>248 InstanÈ›e:</strong><br/>
                  â€¢ JudecÄƒtorii<br/>
                  â€¢ Tribunale<br/>
                  â€¢ CurÈ›i de Apel<br/>
                  â€¢ ÃCCJ<br/>
                  Mapping complet
                </div>
              </foreignObject>
              
              <!-- Step 3: Loop Dosare -->
              <rect x="570" y="330" width="260" height="150" fill="url(#gradientProcess-r8)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="570" y="330" width="260" height="150">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>3. Loop Dosare</strong><br/>
                  Pentru fiecare dosar:<br/>
                  â€¢ Validare format<br/>
                  â€¢ Checkpoint system<br/>
                  â€¢ Resume from checkpoint<br/>
                  â€¢ Progress tracking<br/>
                  â€¢ Suspend/Resume
                </div>
              </foreignObject>
              
              <!-- Step 4: API Query -->
              <rect x="850" y="330" width="240" height="150" fill="url(#gradientProcess-r8)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="850" y="330" width="240" height="150">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>4. API Query</strong><br/>
                  CautareDosare()<br/>
                  numarDosar<br/>
                  obiectDosar=None<br/>
                  Filtrare rezultate<br/>
                  Sortare desc (data)
                </div>
              </foreignObject>
              
              <!-- Step 5: Extragere Info -->
              <rect x="1110" y="330" width="280" height="150" fill="url(#gradientProcess-r8)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1110" y="330" width="280" height="150">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>5. Extragere Info</strong><br/>
                  <strong>BazÄƒ:</strong> InstanÈ›Äƒ, Obiect, Data, Categorie<br/>
                  <strong>È˜edinÈ›e:</strong> Termen, SoluÈ›ie, Complet, CamerÄƒ, Tip<br/>
                  <strong>PÄƒrÈ›i:</strong> TerÈ› poprit, Reclamant, PÃ¢rÃ¢t<br/>
                  <strong>Statistici:</strong> NumÄƒr È™edinÈ›e, Ultima modificare
                </div>
              </foreignObject>
              
              <!-- Step 6: Normalizare & Formatare -->
              <rect x="1410" y="330" width="220" height="150" fill="url(#gradientProcess-r8)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1410" y="330" width="220" height="150">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>6. Normalizare &amp; Formatare</strong><br/>
                  Normalizare instanÈ›e<br/>
                  <strong>Formatare Excel:</strong><br/>
                  â€¢ Tabel cu filtre<br/>
                  â€¢ Benzi colorate<br/>
                  â€¢ Auto-width<br/>
                  â€¢ Header #4472C4
                </div>
              </foreignObject>
              
              <!-- EXTERNAL SECTION -->
              <text x="50" y="550" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ EXTERNAL</text>
              <rect x="50" y="560" width="320" height="140" fill="url(#gradientExternal-r8)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="560" width="320" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">portal.just.ro</strong><br/>
                  <strong>SOAP API:</strong><br/>
                  HTTPS Connection<br/>
                  Query.asmx?WSDL<br/>
                  CautareDosare service<br/>
                  Timeout: 10 secunde
                </div>
              </foreignObject>
              
              <!-- OUTPUT SECTION -->
              <text x="50" y="780" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¤ OUTPUT</text>
              
              <!-- Excel Rezultat -->
              <rect x="50" y="790" width="320" height="180" fill="url(#gradientOutput-r8)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="790" width="320" height="180">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Rezultat</strong><br/>
                  <strong>Nume: [base]_actualizat_api.xlsx</strong><br/>
                  <strong>Formatare:</strong><br/>
                  â€¢ Tabel Excel (filtre)<br/>
                  â€¢ Benzi colorate alternante<br/>
                  â€¢ Header #4472C4<br/>
                  â€¢ Auto-width coloane<br/>
                  â€¢ Checkpoint JSON<br/>
                  Folder: Rezultate/
                </div>
              </foreignObject>
              
              <!-- HTML Sumar -->
              <rect x="390" y="790" width="320" height="180" fill="url(#gradientOutput-r8)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="390" y="790" width="320" height="180">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“Š HTML Sumar Litigii</strong><br/>
                  <strong>Nume: Sumar Executiv â€“ Analiza Litigii NaÈ›ionale.html</strong><br/>
                  Dashboard interactiv<br/>
                  <strong>ConÈ›inut:</strong><br/>
                  â€¢ Grafice interactive<br/>
                  â€¢ Statistici cheie<br/>
                  â€¢ DistribuÈ›ii BRLI/InstanÈ›e<br/>
                  â€¢ Date hardcodate (JSON)
                </div>
              </foreignObject>
              
              <!-- Grafice Plotly -->
              <rect x="730" y="790" width="320" height="180" fill="url(#gradientOutput-r8)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="730" y="790" width="320" height="180">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“ˆ Grafice Plotly</strong><br/>
                  <strong>chart_generator.py:</strong><br/>
                  â€¢ PDF: Grafic_[BRLI].pdf<br/>
                  â€¢ HTML: Sunburst chart<br/>
                  â€¢ Grafice interactive<br/>
                  â€¢ DistribuÈ›ii multiple<br/>
                  â€¢ Kaleido (PNG export)
                </div>
              </foreignObject>
              
              <!-- Email per BRLI -->
              <rect x="1070" y="790" width="360" height="180" fill="url(#gradientExternal-r8)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1070" y="790" width="360" height="180">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ Email per BRLI (8)</strong><br/>
                  <strong>Outlook Integration:</strong><br/>
                  win32com.client<br/>
                  <strong>BRLI-uri:</strong><br/>
                  Moldova, Constanta, Pitesti, Tg. Jiu,<br/>
                  Arad, Cluj, Tg. Mures, Bucuresti<br/>
                  <strong>AtaÈ™amente:</strong> Excel + HTML Sumar<br/>
                  email_config.json
                </div>
              </foreignObject>
              
              <!-- Email General -->
              <rect x="1450" y="790" width="300" height="180" fill="url(#gradientExternal-r8)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1450" y="790" width="300" height="180">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ Email General</strong><br/>
                  <strong>Destinatari:</strong><br/>
                  TO: juridic@iccollect.ro<br/>
                  CC: rpa@iccollect.ro<br/>
                  <strong>AtaÈ™amente:</strong><br/>
                  Excel complet<br/>
                  HTML Sumar<br/>
                  Font: Georgia 11pt
                </div>
              </foreignObject>
              
              <!-- Arrows: Input to Processing -->
              <path d="M 210 260 L 170 330" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r8)"/>
              <path d="M 210 260 L 430 330" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r8)"/>
              
              <!-- Arrows: Processing Steps -->
              <path d="M 290 405 L 310 405" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r8)"/>
              <path d="M 550 405 L 570 405" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r8)"/>
              <path d="M 810 405 L 850 405" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r8)"/>
              <path d="M 1090 405 L 1110 405" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r8)"/>
              <path d="M 1390 405 L 1410 405" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r8)"/>
              
              <!-- Arrows: Processing to External -->
              <path d="M 170 480 L 210 560" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r8)"/>
              <path d="M 970 480 L 210 700" stroke="#3576b0" stroke-width="2.5" fill="none" stroke-dasharray="3,3" marker-end="url(#arrowhead-r8)" opacity="0.7"/>
              
              <!-- Arrows: Processing to Output -->
              <path d="M 170 480 L 210 790" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r8)"/>
              <path d="M 430 480 L 550 790" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r8)"/>
              <path d="M 1250 480 L 890 790" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r8)"/>
              <path d="M 1250 480 L 1250 790" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r8)"/>
              <path d="M 1630 480 L 1600 790" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r8)"/>
              
              <!-- Arrows: Output to Email -->
              <path d="M 370 970 L 1070 970" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r8)"/>
              <path d="M 1050 970 L 1450 970" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r8)"/>
              
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ LogicÄƒ Raport 9: SIUI -->
        <div class="report-diagram" id="diagram-report-9">
          <div class="diagram-container">
            <svg width="1600" height="1400" viewBox="0 0 1600 1400" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ logicÄƒ - Interogare SIUI (CASAN)">
              <defs>
                <linearGradient id="gradientInput-r9" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientProcess-r9" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientExternal-r9" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientOutput-r9" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-r9" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                  <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                </marker>
              </defs>
              
              <!-- Title -->
              <text x="800" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ†” INTEROGARE SIUI (CASAN) - FLUX LOGIC COMPLET</text>
              
              <!-- INPUT SECTION -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¥ INPUT</text>
              <rect x="50" y="100" width="280" height="140" fill="url(#gradientInput-r9)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="100" width="280" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Master</strong><br/>
                  <strong>FiÈ™ier:</strong> Master_SIUI_*.xlsx<br/>
                  <strong>Coloane:</strong><br/>
                  â€¢ CNP (coloana B)<br/>
                  â€¢ Alte date dosare<br/>
                  <strong>Folder:</strong> Master/<br/>
                  <strong>Format:</strong> .xlsx (openpyxl)
                </div>
              </foreignObject>
              
              <!-- PROCESSING SECTION -->
              <text x="50" y="300" style="font-size: 16px; font-weight: bold; fill: #22507a;">âš™ï¸ PROCESARE</text>
              
              <!-- Step 1: Validare & Parsing CNP -->
              <rect x="50" y="310" width="240" height="130" fill="url(#gradientProcess-r9)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>1. Validare &amp; Parsing CNP</strong><br/>
                  <strong>Validare:</strong><br/>
                  â€¢ Lungime = 13 cifre<br/>
                  â€¢ Cifre de control<br/>
                  â€¢ Format valid<br/>
                  <strong>Extragere info:</strong><br/>
                  â€¢ Sex (cifra 1)<br/>
                  â€¢ Data naÈ™terii<br/>
                  â€¢ VÃ¢rstÄƒ calculatÄƒ<br/>
                  â€¢ JudeÈ› (cifre 7-8)<br/>
                  â€¢ CJP (cifre 9-10)
                </div>
              </foreignObject>
              
              <!-- Step 2: Verificare DependenÈ›e -->
              <rect x="310" y="310" width="240" height="130" fill="url(#gradientProcess-r9)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="310" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>2. Verificare DependenÈ›e</strong><br/>
                  <strong>Python packages:</strong><br/>
                  â€¢ playwright<br/>
                  â€¢ opencv-python (cv2)<br/>
                  â€¢ pytesseract<br/>
                  â€¢ numpy<br/>
                  â€¢ Pillow (PIL)<br/>
                  <strong>External tools:</strong><br/>
                  â€¢ Tesseract OCR<br/>
                  â€¢ Playwright Chromium<br/>
                  <strong>Fallback:</strong> Skip CASAN dacÄƒ lipsesc
                </div>
              </foreignObject>
              
              <!-- Step 3: IniÈ›ializare Browser -->
              <rect x="570" y="310" width="240" height="130" fill="url(#gradientProcess-r9)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="570" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>3. IniÈ›ializare Browser</strong><br/>
                  <strong>Playwright Chromium:</strong><br/>
                  â€¢ headless=True (ascuns)<br/>
                  â€¢ --disable-blink-features<br/>
                  â€¢ User-agent rotation<br/>
                  â€¢ Context nou per sesiune<br/>
                  â€¢ Timeout: 30 secunde<br/>
                  <strong>Navigare:</strong><br/>
                  https://siui.casan.ro/asigurati/
                </div>
              </foreignObject>
              
              <!-- Step 4: Loop CNP-uri -->
              <rect x="830" y="310" width="240" height="130" fill="url(#gradientProcess-r9)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="830" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>4. Loop pentru fiecare CNP</strong><br/>
                  <strong>Iterare rÃ¢nduri Excel:</strong><br/>
                  â€¢ Skip CNP invalid<br/>
                  â€¢ Skip deja procesat<br/>
                  â€¢ Progres tracking<br/>
                  â€¢ Checkpoint salvare<br/>
                  <strong>Retry logic:</strong><br/>
                  â€¢ Max 3 Ã®ncercÄƒri/CNP<br/>
                  â€¢ Delay random 5-10s<br/>
                  â€¢ Anti-detecÈ›ie
                </div>
              </foreignObject>
              
              <!-- Step 5: Rezolvare CAPTCHA -->
              <rect x="1090" y="310" width="240" height="130" fill="url(#gradientProcess-r9)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1090" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>5. Rezolvare CAPTCHA</strong><br/>
                  <strong>GÄƒsire:</strong><br/>
                  img[src*="Captcha.aspx"]<br/>
                  <strong>Screenshot:</strong><br/>
                  captcha_{cnp}_{attempt}.png<br/>
                  <strong>OCR (4 metode):</strong><br/>
                  â€¢ Otsu Threshold<br/>
                  â€¢ Adaptive Mean<br/>
                  â€¢ Adaptive Gaussian<br/>
                  â€¢ Morphology Close<br/>
                  <strong>Preprocesare:</strong><br/>
                  Resize 3x, Grayscale, Denoise
                </div>
              </foreignObject>
              
              <!-- Step 6: Completare Formular -->
              <rect x="1350" y="310" width="220" height="130" fill="url(#gradientProcess-r9)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1350" y="310" width="220" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>6. Completare Formular</strong><br/>
                  <strong>CNP field:</strong><br/>
                  input#MainContent_tbCNP<br/>
                  Multiple selectors fallback<br/>
                  <strong>Checkbox CID:</strong><br/>
                  cbCIDFromCNP (bifat)<br/>
                  <strong>CAPTCHA field:</strong><br/>
                  input#MainContent_textCaptcha<br/>
                  <strong>Submit:</strong><br/>
                  input[name*="btnSearch"]
                </div>
              </foreignObject>
              
              <!-- Step 7: AÈ™teptare & Extragere -->
              <rect x="50" y="460" width="280" height="130" fill="url(#gradientProcess-r9)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="460" width="280" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>7. AÈ™teptare &amp; Extragere Rezultat</strong><br/>
                  <strong>wait_for_result_message:</strong><br/>
                  â€¢ JavaScript detection<br/>
                  â€¢ Timeout: 10 secunde<br/>
                  â€¢ Pattern matching<br/>
                  <strong>Metode extragere (4):</strong><br/>
                  â€¢ span.text_content()<br/>
                  â€¢ body.text_content()<br/>
                  â€¢ validationSummary<br/>
                  â€¢ ul li items<br/>
                  <strong>Patterns:</strong><br/>
                  "este asiguratÄƒ", "nu este asiguratÄƒ", "decedatÄƒ"
                </div>
              </foreignObject>
              
              <!-- Step 8: Validare & Salvare -->
              <rect x="350" y="460" width="280" height="130" fill="url(#gradientProcess-r9)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="350" y="460" width="280" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>8. Validare &amp; Salvare</strong><br/>
                  <strong>Rezultate posibile:</strong><br/>
                  â€¢ ASIGURAT<br/>
                  â€¢ NEASIGURAT<br/>
                  â€¢ DECEDAT<br/>
                  â€¢ CNP INVALID<br/>
                  â€¢ EROARE_MAX_RETRY<br/>
                  <strong>Salvare Excel:</strong><br/>
                  â€¢ Coloana H (Status CASAN)<br/>
                  â€¢ Checkpoint la fiecare 5 CNP<br/>
                  â€¢ Progres tracking<br/>
                  â€¢ Timp estimat rÄƒmas
                </div>
              </foreignObject>
              
              <!-- EXTERNAL SECTION -->
              <text x="50" y="650" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ EXTERNAL</text>
              <rect x="50" y="660" width="300" height="140" fill="url(#gradientExternal-r9)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="660" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸŒ CASAN Website</strong><br/>
                  <strong>URL:</strong> https://siui.casan.ro/asigurati/<br/>
                  <strong>ProtecÈ›ie:</strong><br/>
                  â€¢ CAPTCHA 6 cifre<br/>
                  â€¢ JavaScript rendering<br/>
                  <strong>RÄƒspuns:</strong><br/>
                  â€¢ "Persoana selectatÄƒ este asiguratÄƒ"<br/>
                  â€¢ "Persoana selectatÄƒ nu este asiguratÄƒ"<br/>
                  â€¢ "Este decedatÄƒ/decedat"<br/>
                  <strong>Timeout:</strong> 30 secunde
                </div>
              </foreignObject>
              
              <!-- OUTPUT SECTION -->
              <text x="50" y="870" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¤ OUTPUT</text>
              
              <!-- Excel Rezultat -->
              <rect x="50" y="880" width="300" height="140" fill="url(#gradientOutput-r9)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="880" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Rezultat</strong><br/>
                  <strong>FiÈ™ier:</strong><br/>
                  Master_SIUI_CASAN_AUTO_YYYYMMDD_HHMMSS.xlsx<br/>
                  <strong>ConÈ›inut:</strong><br/>
                  â€¢ CNP (validat)<br/>
                  â€¢ Info CNP (Sex, Data, VÃ¢rstÄƒ, JudeÈ›, CJP)<br/>
                  â€¢ Status CASAN (coloana H)<br/>
                  <strong>Formatare:</strong> Georgia 11pt
                </div>
              </foreignObject>
              
              <!-- Logging -->
              <rect x="370" y="880" width="250" height="140" fill="url(#gradientExternal-r9)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="370" y="880" width="250" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“‹ Logging &amp; Tracking</strong><br/>
                  <strong>FiÈ™ier log:</strong><br/>
                  siui_casan.log<br/>
                  <strong>ConÈ›inut:</strong><br/>
                  â€¢ Progres procesare<br/>
                  â€¢ Erori CAPTCHA<br/>
                  â€¢ Rezultate interogÄƒri<br/>
                  â€¢ Timp estimat rÄƒmas<br/>
                  <strong>Statistici:</strong><br/>
                  Total, Succes, Erori
                </div>
              </foreignObject>
              
              <!-- Arrows: Input to Processing -->
              <path d="M 190 240 L 170 310" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r9)"/>
              <path d="M 190 240 L 430 310" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r9)"/>
              
              <!-- Arrows: Processing Steps -->
              <path d="M 290 375 L 310 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r9)"/>
              <path d="M 550 375 L 570 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r9)"/>
              <path d="M 810 375 L 830 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r9)"/>
              <path d="M 1070 375 L 1090 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r9)"/>
              <path d="M 1330 375 L 1350 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r9)"/>
              
              <!-- Arrow: Step 6 to Step 7 -->
              <path d="M 1460 375 L 1460 460 L 190 460" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r9)" stroke-dasharray="3,3" opacity="0.7"/>
              
              <!-- Arrow: Step 7 to Step 8 -->
              <path d="M 330 525 L 350 525" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r9)"/>
              
              <!-- Arrow: Processing to External -->
              <path d="M 200 590 L 200 660" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r9)"/>
              
              <!-- Arrow: External to Processing (response) -->
              <path d="M 200 800 L 200 730 L 630 730 L 630 590" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r9)" stroke-dasharray="3,3" opacity="0.7"/>
              
              <!-- Arrow: Processing to Output -->
              <path d="M 490 590 L 490 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r9)"/>
              
              <!-- Arrow: Output to Logging -->
              <path d="M 350 950 L 370 950" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r9)"/>
              
              <!-- Separator line -->
              <line x1="50" y1="620" x2="1570" y2="620" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="840" x2="1570" y2="840" stroke="#22507a" stroke-width="2" opacity="0.3"/>
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ LogicÄƒ Raport 10: AnalizÄƒ Perimare BT -->
        <div class="report-diagram" id="diagram-report-10">
          <div class="diagram-container">
            <svg width="1800" height="1600" viewBox="0 0 1800 1600" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ logicÄƒ - AnalizÄƒ Perimare BT">
              <defs>
                <linearGradient id="gradientInput-r10" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientProcess-r10" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientExternal-r10" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientOutput-r10" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-r10" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                  <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                </marker>
              </defs>
              
              <!-- Title -->
              <text x="900" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ“Š ANALIZÄ‚ PERIMARE BT - FLUX LOGIC COMPLET</text>
              
              <!-- INPUT SECTION -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¥ INPUT</text>
              <rect x="50" y="100" width="300" height="140" fill="url(#gradientInput-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="100" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Master</strong><br/>
                  <strong>FiÈ™ier:</strong> Raport-Master-ICC_*.xlsx<br/>
                  <strong>3 Sheeturi:</strong><br/>
                  â€¢ Sheet 1 (header=1, skip row 1)<br/>
                  â€¢ Sheet 2 (skiprows=1, header=None)<br/>
                  â€¢ Sheet 3 (skiprows=1, header=None)<br/>
                  <strong>Folder:</strong> Master/
                </div>
              </foreignObject>
              
              <rect x="370" y="100" width="300" height="140" fill="url(#gradientInput-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="370" y="100" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel AnalizÄƒ Perimare</strong><br/>
                  <strong>FiÈ™ier:</strong> Analiza perimare BT.xlsx<br/>
                  <strong>Coloane:</strong><br/>
                  â€¢ File Number (B)<br/>
                  â€¢ Analiza perimare (C)<br/>
                  <strong>Folosit pentru:</strong> VLOOKUP
                </div>
              </foreignObject>
              
              <!-- PROCESSING SECTION -->
              <text x="50" y="300" style="font-size: 16px; font-weight: bold; fill: #22507a;">âš™ï¸ PROCESARE</text>
              
              <!-- Step 1: Citire & Concatenare -->
              <rect x="50" y="310" width="240" height="130" fill="url(#gradientProcess-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>1. Citire &amp; Concatenare</strong><br/>
                  <strong>Sheet 1:</strong><br/>
                  pd.read_excel(header=1)<br/>
                  <strong>Sheet 2 &amp; 3:</strong><br/>
                  pd.read_excel(skiprows=1)<br/>
                  <strong>Aliniere coloane:</strong><br/>
                  reindex() + rename()<br/>
                  <strong>Concat:</strong><br/>
                  pd.concat(ignore_index=True)
                </div>
              </foreignObject>
              
              <!-- Step 2: AdÄƒugare ColoanÄƒ -->
              <rect x="310" y="310" width="240" height="130" fill="url(#gradientProcess-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="310" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>2. AdÄƒugare ColoanÄƒ</strong><br/>
                  <strong>ColoanÄƒ nouÄƒ:</strong><br/>
                  "Analiza perimare BT"<br/>
                  <strong>PoziÈ›ie:</strong><br/>
                  Ãntre EXEC_FILE_NO<br/>
                  È™i DOSAR_B<br/>
                  <strong>Valoare iniÈ›ialÄƒ:</strong> ""
                </div>
              </foreignObject>
              
              <!-- Step 3: VLOOKUP -->
              <rect x="570" y="310" width="240" height="130" fill="url(#gradientProcess-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="570" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>3. VLOOKUP</strong><br/>
                  <strong>Match:</strong><br/>
                  EXEC_FILE_NO = File Number<br/>
                  <strong>Extragere:</strong><br/>
                  Analiza perimare (C)<br/>
                  <strong>Filtrare:</strong><br/>
                  È˜terge rÃ¢nduri<br/>
                  nepotrivite (no match)
                </div>
              </foreignObject>
              
              <!-- Step 4: Filtrare Status-uri -->
              <rect x="830" y="310" width="240" height="130" fill="url(#gradientProcess-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="830" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>4. Filtrare Status-uri</strong><br/>
                  <strong>STADIU_DOSAR:</strong><br/>
                  â€¢ InsolvenÈ›a â€“ Ã®nchis<br/>
                  â€¢ Faliment<br/>
                  â€¢ InsolvenÈ›a - Suspendat<br/>
                  â€¢ + 20 variante<br/>
                  <strong>AcÈ›iune:</strong> È˜terge rÃ¢nduri
                </div>
              </foreignObject>
              
              <!-- Step 5: Completare OWNER_ICC -->
              <rect x="1090" y="310" width="240" height="130" fill="url(#gradientProcess-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1090" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>5. Completare OWNER_ICC</strong><br/>
                  <strong>Verificare:</strong><br/>
                  DacÄƒ conÈ›ine @iccollect.ro<br/>
                  <strong>Completare:</strong><br/>
                  value + "@iccollect.ro"<br/>
                  <strong>Skip:</strong><br/>
                  DacÄƒ deja completat<br/>
                  sau gol
                </div>
              </foreignObject>
              
              <!-- Step 6: Separare Categorii -->
              <rect x="1350" y="310" width="240" height="130" fill="url(#gradientProcess-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1350" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>6. Separare Categorii</strong><br/>
                  <strong>9 Categorii:</strong><br/>
                  â€¢ Ãnchise (REZOLUTIE)<br/>
                  â€¢ La incuviintat<br/>
                  â€¢ Ãnchidere blank<br/>
                  â€¢ Suspendate blank<br/>
                  â€¢ Angajament blank<br/>
                  â€¢ LicitaÈ›ii blank<br/>
                  â€¢ Dosar incuviintat<br/>
                  â€¢ Restul (consolidat)<br/>
                  â€¢ Statistici finale
                </div>
              </foreignObject>
              
              <!-- Step 7: Generare Excel-uri -->
              <rect x="50" y="460" width="280" height="130" fill="url(#gradientProcess-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="460" width="280" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>7. Generare Excel-uri Cosmetizate</strong><br/>
                  <strong>Formatare:</strong><br/>
                  â€¢ Header: Bold + #4472C4<br/>
                  â€¢ Font: Georgia 11pt<br/>
                  â€¢ Auto-width coloane<br/>
                  â€¢ Freeze panes A2<br/>
                  â€¢ Border + Alignment<br/>
                  <strong>FiÈ™iere:</strong> 9 Excel-uri separate
                </div>
              </foreignObject>
              
              <!-- Step 8: Trimitere Email-uri -->
              <rect x="350" y="460" width="280" height="130" fill="url(#gradientProcess-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="350" y="460" width="280" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>8. Trimitere Email-uri</strong><br/>
                  <strong>Outlook Integration:</strong><br/>
                  win32com.client<br/>
                  <strong>9 Tipuri Email:</strong><br/>
                  â€¢ actualizari@iccollect.ro<br/>
                  â€¢ dosare@iccollect.ro<br/>
                  â€¢ Per owner (OWNER_ICC)<br/>
                  â€¢ juridic@iccollect.ro<br/>
                  <strong>HTML Body:</strong> Georgia 11pt
                </div>
              </foreignObject>
              
              <!-- EXTERNAL SECTION -->
              <text x="50" y="650" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ EXTERNAL</text>
              <rect x="50" y="660" width="300" height="140" fill="url(#gradientExternal-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="660" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ Outlook Email</strong><br/>
                  <strong>Protocol:</strong> MAPI<br/>
                  <strong>Destinatari:</strong><br/>
                  â€¢ actualizari@iccollect.ro<br/>
                  â€¢ dosare@iccollect.ro<br/>
                  â€¢ juridic@iccollect.ro<br/>
                  â€¢ rpa@iccollect.ro<br/>
                  â€¢ OWNER_ICC (din Excel)<br/>
                  <strong>Format:</strong> HTML (Georgia 11pt)
                </div>
              </foreignObject>
              
              <!-- OUTPUT SECTION -->
              <text x="50" y="870" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¤ OUTPUT</text>
              
              <!-- Excel Consolidat -->
              <rect x="50" y="880" width="280" height="140" fill="url(#gradientOutput-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="880" width="280" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Consolidat</strong><br/>
                  <strong>FiÈ™ier:</strong><br/>
                  Analiza_perimare_BT_consolidat_YYYYMMDD_HHMMSS.xlsx<br/>
                  <strong>ConÈ›inut:</strong><br/>
                  â€¢ Toate datele procesate<br/>
                  â€¢ Coloana "Analiza perimare BT"<br/>
                  â€¢ OWNER_ICC completat<br/>
                  <strong>Formatare:</strong> Standard
                </div>
              </foreignObject>
              
              <!-- Excel-uri Email -->
              <rect x="350" y="880" width="300" height="140" fill="url(#gradientOutput-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="350" y="880" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">9 Excel-uri Cosmetizate</strong><br/>
                  <strong>FiÈ™iere:</strong><br/>
                  â€¢ Dosare_inchise_Capone_*.xlsx<br/>
                  â€¢ Dosare_incuviintat_Capone_*.xlsx<br/>
                  â€¢ Dosare_inchidere_blank_*.xlsx<br/>
                  â€¢ Task_Analiza_perimare_deschis_dosare_suspendate_*.xlsx<br/>
                  â€¢ Dosare_angajament_Capone_*.xlsx<br/>
                  â€¢ Dosare_licitatii_Capone_*.xlsx<br/>
                  â€¢ Dosare_dosar_incuviintat_*.xlsx<br/>
                  â€¢ Dosare_restul_*.xlsx<br/>
                  â€¢ Statistici_final_*.xlsx
                </div>
              </foreignObject>
              
              <!-- Email-uri -->
              <rect x="670" y="880" width="300" height="140" fill="url(#gradientExternal-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="670" y="880" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ 9 Email-uri Trimise</strong><br/>
                  <strong>Destinatari:</strong><br/>
                  â€¢ actualizari@iccollect.ro (Ã®nchise)<br/>
                  â€¢ dosare@iccollect.ro (incuviintat)<br/>
                  â€¢ actualizari@iccollect.ro (blank)<br/>
                  â€¢ Per owner (suspendate, angajament, licitaÈ›ii, dosar incuviintat)<br/>
                  â€¢ juridic@iccollect.ro (statistici)<br/>
                  <strong>ConÈ›inut:</strong> HTML + AtaÈ™amente
                </div>
              </foreignObject>
              
              <!-- Statistici -->
              <rect x="990" y="880" width="280" height="140" fill="url(#gradientOutput-r10)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="990" y="880" width="280" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“Š Statistici Finale</strong><br/>
                  <strong>ConÈ›inut:</strong><br/>
                  â€¢ Total dosare procesate<br/>
                  â€¢ Per categorie<br/>
                  â€¢ Per owner<br/>
                  â€¢ Diagrame Plotly<br/>
                  <strong>Email:</strong><br/>
                  juridic@iccollect.ro<br/>
                  <strong>Format:</strong> HTML + Excel
                </div>
              </foreignObject>
              
              <!-- Arrows: Input to Processing -->
              <path d="M 200 240 L 170 310" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r10)"/>
              <path d="M 520 240 L 690 310" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r10)"/>
              
              <!-- Arrows: Processing Steps -->
              <path d="M 290 375 L 310 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r10)"/>
              <path d="M 550 375 L 570 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r10)"/>
              <path d="M 810 375 L 830 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r10)"/>
              <path d="M 1070 375 L 1090 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r10)"/>
              <path d="M 1330 375 L 1350 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r10)"/>
              
              <!-- Arrow: Step 6 to Step 7 -->
              <path d="M 1470 375 L 1470 460 L 190 460" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r10)" stroke-dasharray="3,3" opacity="0.7"/>
              
              <!-- Arrow: Step 7 to Step 8 -->
              <path d="M 330 525 L 350 525" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r10)"/>
              
              <!-- Arrow: Processing to External -->
              <path d="M 490 590 L 200 660" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r10)"/>
              
              <!-- Arrow: External to Processing (response) -->
              <path d="M 200 800 L 200 730 L 630 730 L 630 590" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r10)" stroke-dasharray="3,3" opacity="0.7"/>
              
              <!-- Arrow: Processing to Output -->
              <path d="M 490 590 L 190 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r10)"/>
              <path d="M 490 590 L 500 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r10)"/>
              <path d="M 490 590 L 820 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r10)"/>
              <path d="M 490 590 L 1120 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r10)"/>
              
              <!-- Separator lines -->
              <line x1="50" y1="600" x2="1750" y2="600" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="850" x2="1750" y2="850" stroke="#22507a" stroke-width="2" opacity="0.3"/>
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ LogicÄƒ Raport 11: Perimate FÄƒrÄƒ AcÈ›iuni -->
        <div class="report-diagram" id="diagram-report-11">
          <div class="diagram-container">
            <svg width="1800" height="1500" viewBox="0 0 1800 1500" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ logicÄƒ - Raport Perimate È™i FÄƒrÄƒ AcÈ›iuni">
              <defs>
                <linearGradient id="gradientInput-r11" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientProcess-r11" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientExternal-r11" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientOutput-r11" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-r11" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                  <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                </marker>
              </defs>
              
              <!-- Title -->
              <text x="900" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ“‹ RAPORT PERIMATE È˜I FÄ‚RÄ‚ ACÈšIUNI - FLUX LOGIC COMPLET</text>
              
              <!-- INPUT SECTION -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¥ INPUT</text>
              <rect x="50" y="100" width="300" height="140" fill="url(#gradientInput-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="100" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Master</strong><br/>
                  <strong>FiÈ™ier:</strong> Raport_Master_*.xlsx<br/>
                  <strong>Multiple Sheeturi:</strong><br/>
                  â€¢ Toate sheet-urile procesate<br/>
                  â€¢ skiprows=1 (È™terge linia 1)<br/>
                  â€¢ header=0 (linia 2 = header)<br/>
                  <strong>Folder:</strong> Master perimate fara actiuni/
                </div>
              </foreignObject>
              
              <!-- PROCESSING SECTION -->
              <text x="50" y="300" style="font-size: 16px; font-weight: bold; fill: #22507a;">âš™ï¸ PROCESARE</text>
              
              <!-- Step 1: Citire & Concatenare -->
              <rect x="50" y="310" width="240" height="130" fill="url(#gradientProcess-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>1. Citire &amp; Concatenare</strong><br/>
                  <strong>Pentru fiecare sheet:</strong><br/>
                  pd.read_excel(skiprows=1, header=0)<br/>
                  <strong>Concat:</strong><br/>
                  pd.concat(ignore_index=True)<br/>
                  <strong>Validare:</strong><br/>
                  Skip sheet-uri goale
                </div>
              </foreignObject>
              
              <!-- Step 2: Filtrare PORTFOLIO -->
              <rect x="310" y="310" width="240" height="130" fill="url(#gradientProcess-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="310" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>2. Filtrare PORTFOLIO</strong><br/>
                  <strong>È˜terge menÈ›iuni:</strong><br/>
                  â€¢ "|" repetat<br/>
                  â€¢ MenÈ›iuni specifice<br/>
                  <strong>Mapping:</strong><br/>
                  ABSOLUT â†’ SALT BANK SA<br/>
                  BTD â†’ BTD CREDITE (BTD)<br/>
                  ERS â†’ BTD CARDURI (ERS)<br/>
                  BT MICRO â†’ BT MIC<br/>
                  <strong>Filtrare:</strong> 4 creditori acceptaÈ›i
                </div>
              </foreignObject>
              
              <!-- Step 3: Filtrare RezoluÈ›ie -->
              <rect x="570" y="310" width="240" height="130" fill="url(#gradientProcess-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="570" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>3. Filtrare RezoluÈ›ie</strong><br/>
                  <strong>ColoanÄƒ:</strong><br/>
                  REZOLUTIE / REZOLUTIA<br/>
                  <strong>Filtrare:</strong><br/>
                  È˜terge liniile cu<br/>
                  rezoluÈ›ia = "Sterge"<br/>
                  <strong>Case-insensitive:</strong><br/>
                  str.upper() comparare
                </div>
              </foreignObject>
              
              <!-- Step 4: Filtrare REZOLUTIE_INCHIDERE -->
              <rect x="830" y="310" width="240" height="130" fill="url(#gradientProcess-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="830" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>4. Filtrare REZOLUTIE_INCHIDERE</strong><br/>
                  <strong>CondiÈ›ie:</strong><br/>
                  REZOLUTIE_INCHIDERE = blank<br/>
                  <strong>Verificare:</strong><br/>
                  â€¢ isna()<br/>
                  â€¢ str.strip() == ''<br/>
                  â€¢ str.upper() == 'NAN'<br/>
                  <strong>AcÈ›iune:</strong><br/>
                  PÄƒstreazÄƒ doar blank
                </div>
              </foreignObject>
              
              <!-- Step 5: Filtrare DATA_PREDARE_BEJ -->
              <rect x="1090" y="310" width="240" height="130" fill="url(#gradientProcess-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1090" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>5. Filtrare DATA_PREDARE_BEJ</strong><br/>
                  <strong>CondiÈ›ie:</strong><br/>
                  DATA_PREDARE_BEJ<br/>
                  NU din luna curentÄƒ<br/>
                  <strong>Formate:</strong><br/>
                  MM/YYYY, YYYY-MM, etc.<br/>
                  <strong>AcÈ›iune:</strong><br/>
                  È˜terge liniile cu<br/>
                  luna curentÄƒ
                </div>
              </foreignObject>
              
              <!-- Step 6: Creare Sheet 2 -->
              <rect x="1350" y="310" width="240" height="130" fill="url(#gradientProcess-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1350" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>6. Creare Sheet 2</strong><br/>
                  <strong>Coloane:</strong><br/>
                  EXEC_FILE_NO<br/>
                  PORTFOLIO<br/>
                  <strong>Eliminare duplicate:</strong><br/>
                  drop_duplicates()<br/>
                  <strong>Rezultat:</strong><br/>
                  RÃ¢nduri unice
                </div>
              </foreignObject>
              
              <!-- Step 7: Creare Pivot Table -->
              <rect x="50" y="460" width="280" height="130" fill="url(#gradientProcess-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="460" width="280" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>7. Creare Pivot Table</strong><br/>
                  <strong>Grupare:</strong><br/>
                  groupby(PORTFOLIO)<br/>
                  <strong>Agregare:</strong><br/>
                  count(EXEC_FILE_NO)<br/>
                  <strong>Sortare:</strong><br/>
                  DescrescÄƒtor dupÄƒ count<br/>
                  <strong>Grand Total:</strong><br/>
                  SumÄƒ totalÄƒ adÄƒugatÄƒ
                </div>
              </foreignObject>
              
              <!-- Step 8: Salvare Excel -->
              <rect x="350" y="460" width="280" height="130" fill="url(#gradientProcess-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="350" y="460" width="280" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>8. Salvare Excel</strong><br/>
                  <strong>3 Sheet-uri:</strong><br/>
                  â€¢ Sheet1: Date complete<br/>
                  â€¢ Sheet2: EXEC_FILE_NO + PORTFOLIO<br/>
                  â€¢ Sheet3: Pivot Table<br/>
                  <strong>FiÈ™ier:</strong><br/>
                  Raport_Perimate_Fara_Actiuni_YYYYMMDD_HHMMSS.xlsx
                </div>
              </foreignObject>
              
              <!-- Step 9: Trimitere Email-uri -->
              <rect x="650" y="460" width="280" height="130" fill="url(#gradientProcess-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="650" y="460" width="280" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>9. Trimitere Email-uri</strong><br/>
                  <strong>Per portofolio (4):</strong><br/>
                  â€¢ BTD CARDURI (ERS)<br/>
                  â€¢ BTD CREDITE (BTD)<br/>
                  â€¢ BT Microfinantare IFN S.A<br/>
                  â€¢ SALT BANK SA<br/>
                  <strong>Email ICC:</strong><br/>
                  juridic@iccollect.ro<br/>
                  (cu pivot table)
                </div>
              </foreignObject>
              
              <!-- EXTERNAL SECTION -->
              <text x="50" y="650" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ EXTERNAL</text>
              <rect x="50" y="660" width="300" height="140" fill="url(#gradientExternal-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="660" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ Outlook Email</strong><br/>
                  <strong>Protocol:</strong> MAPI<br/>
                  <strong>Destinatari per portofolio:</strong><br/>
                  â€¢ TO: rpa@iccollect.ro<br/>
                  â€¢ CC: juridic@iccollect.ro; cesionate@iccollect.ro<br/>
                  <strong>Email ICC:</strong><br/>
                  â€¢ TO: juridic@iccollect.ro<br/>
                  â€¢ CC: rpa@iccollect.ro<br/>
                  <strong>Format:</strong> HTML (Georgia 11pt)
                </div>
              </foreignObject>
              
              <!-- OUTPUT SECTION -->
              <text x="50" y="870" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¤ OUTPUT</text>
              
              <!-- Excel Principal -->
              <rect x="50" y="880" width="300" height="140" fill="url(#gradientOutput-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="880" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Principal</strong><br/>
                  <strong>FiÈ™ier:</strong><br/>
                  Raport_Perimate_Fara_Actiuni_YYYYMMDD_HHMMSS.xlsx<br/>
                  <strong>3 Sheet-uri:</strong><br/>
                  â€¢ Sheet1: Date complete procesate<br/>
                  â€¢ Sheet2: EXEC_FILE_NO + PORTFOLIO<br/>
                  â€¢ Sheet3: Pivot Table<br/>
                  <strong>Formatare:</strong> Standard
                </div>
              </foreignObject>
              
              <!-- Excel-uri per Portofolio -->
              <rect x="370" y="880" width="300" height="140" fill="url(#gradientOutput-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="370" y="880" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">4 Excel-uri per Portofolio</strong><br/>
                  <strong>FiÈ™iere:</strong><br/>
                  â€¢ dosare active_BTD_CARDURI_ERS_*.xlsx<br/>
                  â€¢ dosare active_BTD_CREDITE_BTD_*.xlsx<br/>
                  â€¢ dosare active_BT_Microfinantare_*.xlsx<br/>
                  â€¢ dosare active_SALT_BANK_SA_*.xlsx<br/>
                  <strong>ConÈ›inut:</strong> Sheet1 filtrat per portofolio
                </div>
              </foreignObject>
              
              <!-- Excel Pivot ICC -->
              <rect x="690" y="880" width="300" height="140" fill="url(#gradientOutput-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="690" y="880" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Pivot ICC</strong><br/>
                  <strong>FiÈ™ier:</strong><br/>
                  Pivot_Perimate_Fara_Actiuni_YYYYMMDD_HHMMSS.xlsx<br/>
                  <strong>ConÈ›inut:</strong><br/>
                  â€¢ Sheet3: Pivot Table<br/>
                  â€¢ Grupare dupÄƒ PORTFOLIO<br/>
                  â€¢ Count EXEC_FILE_NO<br/>
                  â€¢ Grand Total<br/>
                  <strong>Destinat:</strong> juridic@iccollect.ro
                </div>
              </foreignObject>
              
              <!-- Email-uri -->
              <rect x="1010" y="880" width="300" height="140" fill="url(#gradientExternal-r11)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1010" y="880" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ 5 Email-uri Trimise</strong><br/>
                  <strong>4 Email-uri per portofolio:</strong><br/>
                  â€¢ BTD CARDURI (ERS)<br/>
                  â€¢ BTD CREDITE (BTD)<br/>
                  â€¢ BT Microfinantare IFN S.A<br/>
                  â€¢ SALT BANK SA<br/>
                  <strong>1 Email ICC:</strong><br/>
                  Sumar cu pivot table<br/>
                  <strong>ConÈ›inut:</strong> HTML + AtaÈ™amente
                </div>
              </foreignObject>
              
              <!-- Arrows: Input to Processing -->
              <path d="M 200 240 L 170 310" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r11)"/>
              
              <!-- Arrows: Processing Steps -->
              <path d="M 290 375 L 310 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)"/>
              <path d="M 550 375 L 570 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)"/>
              <path d="M 810 375 L 830 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)"/>
              <path d="M 1070 375 L 1090 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)"/>
              <path d="M 1330 375 L 1350 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)"/>
              
              <!-- Arrow: Step 5 to Step 6 -->
              <path d="M 1210 375 L 1210 460 L 190 460" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)" stroke-dasharray="3,3" opacity="0.7"/>
              
              <!-- Arrow: Step 6 to Step 7 -->
              <path d="M 1470 460 L 1470 460 L 330 460" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)" stroke-dasharray="3,3" opacity="0.7"/>
              
              <!-- Arrow: Step 7 to Step 8 -->
              <path d="M 330 525 L 350 525" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)"/>
              
              <!-- Arrow: Step 8 to Step 9 -->
              <path d="M 630 525 L 650 525" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)"/>
              
              <!-- Arrow: Processing to External -->
              <path d="M 790 590 L 200 660" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)"/>
              
              <!-- Arrow: External to Processing (response) -->
              <path d="M 200 800 L 200 730 L 1160 730 L 1160 590" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)" stroke-dasharray="3,3" opacity="0.7"/>
              
              <!-- Arrow: Processing to Output -->
              <path d="M 490 590 L 200 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)"/>
              <path d="M 490 590 L 520 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)"/>
              <path d="M 490 590 L 840 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)"/>
              <path d="M 790 590 L 1160 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r11)"/>
              
              <!-- Separator lines -->
              <line x1="50" y1="600" x2="1750" y2="600" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="850" x2="1750" y2="850" stroke="#22507a" stroke-width="2" opacity="0.3"/>
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ LogicÄƒ Raport 12: Termene LicitaÈ›ie Imobile Identificate -->
        <div class="report-diagram" id="diagram-report-12">
          <div class="diagram-container">
            <svg width="1800" height="1500" viewBox="0 0 1800 1500" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ logicÄƒ - Raport Termene LicitaÈ›ie Imobile Identificate">
              <defs>
                <linearGradient id="gradientInput-r12" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientProcess-r12" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientExternal-r12" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientOutput-r12" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-r12" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                  <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                </marker>
              </defs>
              
              <!-- Title -->
              <text x="900" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ  RAPORT TERMENE LICITAÈšIE IMOBILE IDENTIFICATE - FLUX LOGIC COMPLET</text>
              
              <!-- INPUT SECTION -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¥ INPUT</text>
              <rect x="50" y="100" width="300" height="140" fill="url(#gradientInput-r12)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="100" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel GaranÈ›ii Executare</strong><br/>
                  <strong>FiÈ™ier:</strong> raportGarantiiExecutareICC_*.xlsx<br/>
                  <strong>2 Sheeturi:</strong><br/>
                  â€¢ Sheet 1 (skiprows=1)<br/>
                  â€¢ Sheet 2 (normal)<br/>
                  <strong>Coloane:</strong><br/>
                  CATEGORIE_GARANTIE,<br/>
                  AUCTION_NO, TASK_PRINCIPAL,<br/>
                  ID garantie Capone<br/>
                  <strong>Folder:</strong> Master/
                </div>
              </foreignObject>
              
              <!-- PROCESSING SECTION -->
              <text x="50" y="300" style="font-size: 16px; font-weight: bold; fill: #22507a;">âš™ï¸ PROCESARE</text>
              
              <!-- Step 1: Citire & Concatenare -->
              <rect x="50" y="310" width="240" height="130" fill="url(#gradientProcess-r12)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>1. Citire &amp; Concatenare</strong><br/>
                  <strong>Sheet 1:</strong><br/>
                  pd.read_excel(skiprows=1)<br/>
                  <strong>Sheet 2:</strong><br/>
                  pd.read_excel()<br/>
                  <strong>Concat:</strong><br/>
                  pd.concat(ignore_index=True)<br/>
                  <strong>Engine:</strong> openpyxl/xlrd
                </div>
              </foreignObject>
              
              <!-- Step 2: Filtrare CATEGORIE_GARANTIE -->
              <rect x="310" y="310" width="240" height="130" fill="url(#gradientProcess-r12)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="310" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>2. Filtrare CATEGORIE_GARANTIE</strong><br/>
                  <strong>CondiÈ›ie:</strong><br/>
                  CATEGORIE_GARANTIE =<br/>
                  "Bun identificat Imobil"<br/>
                  <strong>Verificare:</strong><br/>
                  Validare coloanÄƒ existÄƒ<br/>
                  <strong>Statistici:</strong><br/>
                  AfiÈ™are categorii disponibile<br/>
                  <strong>Rezultat:</strong> Filtrare imobile
                </div>
              </foreignObject>
              
              <!-- Step 3: Filtrare AUCTION_NO -->
              <rect x="570" y="310" width="240" height="130" fill="url(#gradientProcess-r12)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="570" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>3. Filtrare AUCTION_NO</strong><br/>
                  <strong>CondiÈ›ie:</strong><br/>
                  AUCTION_NO notna()<br/>
                  (completat, nu null)<br/>
                  <strong>Statistici:</strong><br/>
                  â€¢ Total cazuri<br/>
                  â€¢ AUCTION_NO completat<br/>
                  â€¢ AUCTION_NO gol<br/>
                  <strong>AcÈ›iune:</strong> PÄƒstreazÄƒ completat
                </div>
              </foreignObject>
              
              <!-- Step 4: Filtrare TASK_PRINCIPAL -->
              <rect x="830" y="310" width="240" height="130" fill="url(#gradientProcess-r12)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="830" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>4. Filtrare TASK_PRINCIPAL</strong><br/>
                  <strong>10 Task-uri acceptate:</strong><br/>
                  â€¢ EXEC Decizie reluare licitatie (TERTI)<br/>
                  â€¢ EXEC Decizie reluare licitatie IMOB<br/>
                  â€¢ EXEC Gen cerere reluare licitatie<br/>
                  â€¢ EXEC Generare cerere staruire<br/>
                  â€¢ EXEC Pregatire licitatie (TERTI)<br/>
                  â€¢ EXEC Pregatire licitatie IMOB<br/>
                  â€¢ EXEC Publ vanz, data, detalii<br/>
                  â€¢ EXEC Publicatie vanzare<br/>
                  â€¢ EXEC PV Licitatie (TERTI)<br/>
                  â€¢ EXEC PV licitatie IMOB
                </div>
              </foreignObject>
              
              <!-- Step 5: Eliminare Duplicate -->
              <rect x="1090" y="310" width="240" height="130" fill="url(#gradientProcess-r12)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1090" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>5. Eliminare Duplicate</strong><br/>
                  <strong>ColoanÄƒ:</strong><br/>
                  ID garantie Capone<br/>
                  <strong>MetodÄƒ:</strong><br/>
                  drop_duplicates(keep='first')<br/>
                  <strong>Statistici:</strong><br/>
                  â€¢ Total Ã®nainte<br/>
                  â€¢ ID-uri unice<br/>
                  â€¢ Duplicate eliminate<br/>
                  <strong>Rezultat:</strong> Cazuri unice
                </div>
              </foreignObject>
              
              <!-- Step 6: CurÄƒÈ›are AUCTION_NO -->
              <rect x="1350" y="310" width="240" height="130" fill="url(#gradientProcess-r12)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1350" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>6. CurÄƒÈ›are AUCTION_NO</strong><br/>
                  <strong>Extragere:</strong><br/>
                  re.findall(r'\d+')<br/>
                  <strong>Validare:</strong><br/>
                  NumÄƒr Ã®ntre 1-1000<br/>
                  <strong>Eliminare:</strong><br/>
                  "?", "reevaluare", "tert", "-"<br/>
                  <strong>ColoanÄƒ nouÄƒ:</strong><br/>
                  AUCTION_NO_CLEANED
                </div>
              </foreignObject>
              
              <!-- Step 7: Creare Pivot Table -->
              <rect x="50" y="460" width="280" height="130" fill="url(#gradientProcess-r12)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="460" width="280" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>7. Creare Pivot Table</strong><br/>
                  <strong>Intervale de 10:</strong><br/>
                  â€¢ 1-10, 11-20, ..., 101-110<br/>
                  <strong>Grupare:</strong><br/>
                  groupby(Interval)<br/>
                  <strong>Agregare:</strong><br/>
                  size() â†’ 'Nr active'<br/>
                  <strong>Procentaje:</strong><br/>
                  Calculat per interval<br/>
                  <strong>Grand Total:</strong> AdÄƒugat
                </div>
              </foreignObject>
              
              <!-- Step 8: Salvare Excel -->
              <rect x="350" y="460" width="280" height="130" fill="url(#gradientProcess-r12)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="350" y="460" width="280" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>8. Salvare Excel</strong><br/>
                  <strong>2 Sheet-uri:</strong><br/>
                  â€¢ ImobileIdentificate_Data<br/>
                  â€¢ Pivot_Intervale_Imobile<br/>
                  <strong>FiÈ™ier:</strong><br/>
                  Raport_Imobile_Identificate_Final.xlsx<br/>
                  <strong>ProtecÈ›ie:</strong><br/>
                  ProtecÈ›ie parolÄƒ activÄƒ<br/>
                  <strong>Formatare:</strong> Georgia 11pt
                </div>
              </foreignObject>
              
              <!-- Step 9: Trimitere Email -->
              <rect x="650" y="460" width="280" height="130" fill="url(#gradientProcess-r12)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="650" y="460" width="280" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>9. Trimitere Email</strong><br/>
                  <strong>Outlook Integration:</strong><br/>
                  win32com.client<br/>
                  <strong>ConÈ›inut:</strong><br/>
                  â€¢ Pivot Table GaranÈ›ii<br/>
                  â€¢ Pivot Table Imobile<br/>
                  <strong>AtaÈ™amente:</strong><br/>
                  â€¢ Raport GaranÈ›ii<br/>
                  â€¢ Raport Imobile<br/>
                  <strong>HTML Body:</strong> Georgia 11pt
                </div>
              </foreignObject>
              
              <!-- EXTERNAL SECTION -->
              <text x="50" y="650" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ EXTERNAL</text>
              <rect x="50" y="660" width="300" height="140" fill="url(#gradientExternal-r12)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="660" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ Outlook Email</strong><br/>
                  <strong>Protocol:</strong> MAPI<br/>
                  <strong>Destinatari:</strong><br/>
                  â€¢ juridic@iccollect.ro<br/>
                  â€¢ rpa@iccollect.ro<br/>
                  â€¢ cesionate@iccollect.ro<br/>
                  <strong>Subiect:</strong><br/>
                  "Raport termene licitatie garantii vs identificate"<br/>
                  <strong>Format:</strong> HTML (Georgia 11pt)
                </div>
              </foreignObject>
              
              <!-- OUTPUT SECTION -->
              <text x="50" y="870" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¤ OUTPUT</text>
              
              <!-- Excel Imobile Identificate -->
              <rect x="50" y="880" width="300" height="140" fill="url(#gradientOutput-r12)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="880" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Imobile Identificate</strong><br/>
                  <strong>FiÈ™ier:</strong><br/>
                  Raport_Imobile_Identificate_Final.xlsx<br/>
                  <strong>2 Sheet-uri:</strong><br/>
                  â€¢ ImobileIdentificate_Data<br/>
                  â€¢ Pivot_Intervale_Imobile<br/>
                  <strong>ProtecÈ›ie:</strong><br/>
                  ProtecÈ›ie parolÄƒ activÄƒ<br/>
                  <strong>Formatare:</strong> Georgia 11pt
                </div>
              </foreignObject>
              
              <!-- Pivot Table -->
              <rect x="370" y="880" width="300" height="140" fill="url(#gradientOutput-r12)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="370" y="880" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Pivot Table Intervale</strong><br/>
                  <strong>Coloane:</strong><br/>
                  â€¢ Numar termene licitatii<br/>
                  â€¢ Nr active<br/>
                  â€¢ Procent (%)<br/>
                  <strong>Intervale:</strong><br/>
                  1-10, 11-20, ..., 101-110<br/>
                  <strong>Total:</strong> 11 intervale + Grand Total<br/>
                  <strong>Sortare:</strong> NumericÄƒ
                </div>
              </foreignObject>
              
              <!-- Email -->
              <rect x="690" y="880" width="300" height="140" fill="url(#gradientExternal-r12)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="690" y="880" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ Email Trimis</strong><br/>
                  <strong>ConÈ›inut:</strong><br/>
                  â€¢ Pivot Table GaranÈ›ii<br/>
                  â€¢ Pivot Table Imobile<br/>
                  <strong>AtaÈ™amente:</strong><br/>
                  â€¢ Raport_Termene_Licitatie_Garantii_*.xlsx<br/>
                  â€¢ Raport_Imobile_Identificate_Final.xlsx<br/>
                  <strong>Format:</strong> HTML + AtaÈ™amente
                </div>
              </foreignObject>
              
              <!-- Arrows: Input to Processing -->
              <path d="M 200 240 L 170 310" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r12)"/>
              
              <!-- Arrows: Processing Steps -->
              <path d="M 290 375 L 310 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r12)"/>
              <path d="M 550 375 L 570 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r12)"/>
              <path d="M 810 375 L 830 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r12)"/>
              <path d="M 1070 375 L 1090 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r12)"/>
              <path d="M 1330 375 L 1350 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r12)"/>
              
              <!-- Arrow: Step 5 to Step 6 -->
              <path d="M 1210 375 L 1210 460 L 190 460" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r12)" stroke-dasharray="3,3" opacity="0.7"/>
              
              <!-- Arrow: Step 6 to Step 7 -->
              <path d="M 1470 460 L 1470 460 L 330 460" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r12)" stroke-dasharray="3,3" opacity="0.7"/>
              
              <!-- Arrow: Step 7 to Step 8 -->
              <path d="M 330 525 L 350 525" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r12)"/>
              
              <!-- Arrow: Step 8 to Step 9 -->
              <path d="M 630 525 L 650 525" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r12)"/>
              
              <!-- Arrow: Processing to External -->
              <path d="M 790 590 L 200 660" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r12)"/>
              
              <!-- Arrow: External to Processing (response) -->
              <path d="M 200 800 L 200 730 L 1160 730 L 1160 590" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r12)" stroke-dasharray="3,3" opacity="0.7"/>
              
              <!-- Arrow: Processing to Output -->
              <path d="M 490 590 L 200 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r12)"/>
              <path d="M 490 590 L 520 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r12)"/>
              <path d="M 790 590 L 840 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r12)"/>
              
              <!-- Separator lines -->
              <line x1="50" y1="600" x2="1750" y2="600" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="850" x2="1750" y2="850" stroke="#22507a" stroke-width="2" opacity="0.3"/>
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ LogicÄƒ Raport 13: Dosare Active Per Client -->
        <div class="report-diagram" id="diagram-report-13">
          <div class="diagram-container">
            <svg width="1800" height="1600" viewBox="0 0 1800 1600" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ logicÄƒ - Raportare LunarÄƒ Dosare Active Per Client">
              <defs>
                <linearGradient id="gradientInput-r13" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientProcess-r13" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientExternal-r13" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientOutput-r13" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-r13" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                  <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                </marker>
              </defs>
              
              <!-- Title -->
              <text x="900" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ“Š RAPORTARE LUNARÄ‚ - DOSARE ACTIVE PER CLIENT - FLUX LOGIC COMPLET</text>
              
              <!-- INPUT SECTION -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¥ INPUT</text>
              <rect x="50" y="100" width="300" height="140" fill="url(#gradientInput-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="100" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Master</strong><br/>
                  <strong>FiÈ™ier:</strong> Raport_Master_*.xlsx<br/>
                  <strong>2 Sheeturi:</strong><br/>
                  â€¢ Sheet 1 (skiprows=1)<br/>
                  â€¢ Sheet 2 (normal)<br/>
                  <strong>Coloane:</strong><br/>
                  PORTFOLIO (index 21),<br/>
                  NUME_TITULAR, DATA_PREDARE_BEJ,<br/>
                  DATA_INCHEIERE_DOSAR<br/>
                  <strong>Folder:</strong> Master/
                </div>
              </foreignObject>
              
              <!-- PROCESSING SECTION -->
              <text x="50" y="300" style="font-size: 16px; font-weight: bold; fill: #22507a;">âš™ï¸ PROCESARE</text>
              
              <!-- Step 1: Localizare & Citire -->
              <rect x="50" y="310" width="240" height="130" fill="url(#gradientProcess-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>1. Localizare &amp; Citire</strong><br/>
                  <strong>Localizare:</strong><br/>
                  glob.glob("*Raport_Master*.xlsx")<br/>
                  Selectare cel mai recent<br/>
                  <strong>Citire:</strong><br/>
                  Sheet 1: skiprows=1<br/>
                  Sheet 2: normal<br/>
                  <strong>Concat:</strong><br/>
                  pd.concat(ignore_index=True)
                </div>
              </foreignObject>
              
              <!-- Step 2: Mapare Coloane -->
              <rect x="310" y="310" width="240" height="130" fill="url(#gradientProcess-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="310" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>2. Mapare Coloane</strong><br/>
                  <strong>PORTFOLIO:</strong><br/>
                  df.columns[21] = "PORTFOLIO"<br/>
                  <strong>NUME_TITULAR:</strong><br/>
                  Detectare automatÄƒ<br/>
                  (nume cu 2+ cuvinte)<br/>
                  <strong>Placeholder:</strong><br/>
                  DATA_PREDARE_BEJ,<br/>
                  DATA_INCHEIERE_DOSAR
                </div>
              </foreignObject>
              
              <!-- Step 3: FiltrÄƒri -->
              <rect x="570" y="310" width="240" height="130" fill="url(#gradientProcess-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="570" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>3. FiltrÄƒri</strong><br/>
                  <strong>PORTFOLIO:</strong><br/>
                  â€¢ BANCPOST<br/>
                  â€¢ GB01, AXIOMA, CdF<br/>
                  â€¢ Idea Leasing<br/>
                  â€¢ Blank/NaN<br/>
                  <strong>NUME_TITULAR:</strong><br/>
                  â€¢ GDPR<br/>
                  <strong>AcÈ›iune:</strong> È˜terge rÃ¢nduri
                </div>
              </foreignObject>
              
              <!-- Step 4: Completare DATA_PREDARE_BEJ -->
              <rect x="830" y="310" width="240" height="130" fill="url(#gradientProcess-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="830" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>4. Completare DATA_PREDARE_BEJ</strong><br/>
                  <strong>CondiÈ›ie:</strong><br/>
                  DATA_PREDARE_BEJ blank<br/>
                  È˜I DATA_INCHEIERE_DOSAR blank<br/>
                  <strong>Valoare:</strong><br/>
                  DATA_RAPORT (coloana 0)<br/>
                  sau data curentÄƒ<br/>
                  <strong>Format:</strong> dd.mm.yyyy
                </div>
              </foreignObject>
              
              <!-- Step 5: Formatare & CurÄƒÈ›are -->
              <rect x="1090" y="310" width="240" height="130" fill="url(#gradientProcess-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1090" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>5. Formatare &amp; CurÄƒÈ›are</strong><br/>
                  <strong>Font:</strong> Georgia 11pt<br/>
                  <strong>Date:</strong> MM/DD/YYYY<br/>
                  <strong>PORTFOLIO:</strong><br/>
                  â€¢ CurÄƒÈ›are "|" repetat<br/>
                  â€¢ Mapping: ABSOLUTâ†’SALT,<br/>
                  BTDâ†’BTD CRED, ERSâ†’BTD CARD,<br/>
                  BT MICROâ†’BT MIC,<br/>
                  BT LEASINGâ†’BT LEASIN
                </div>
              </foreignObject>
              
              <!-- Step 6: Separare Creditori -->
              <rect x="1350" y="310" width="240" height="130" fill="url(#gradientProcess-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1350" y="310" width="240" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>6. Separare Creditori</strong><br/>
                  <strong>6 Creditori:</strong><br/>
                  â€¢ EOS<br/>
                  â€¢ BTD CREDITE<br/>
                  â€¢ BTD CARDURI<br/>
                  â€¢ SALT<br/>
                  â€¢ BT MIC<br/>
                  â€¢ BT LEASING<br/>
                  <strong>Filtrare:</strong><br/>
                  df[PORTFOLIO == creditor]
                </div>
              </foreignObject>
              
              <!-- Step 7: Separare Active/Ãnchise -->
              <rect x="50" y="460" width="280" height="130" fill="url(#gradientProcess-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="460" width="280" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>7. Separare Active/Ãnchise</strong><br/>
                  <strong>split_active_closed():</strong><br/>
                  <strong>Active:</strong><br/>
                  DATA_INCHEIERE_DOSAR isna()<br/>
                  È˜I DATA_PREDARE_BEJ<br/>
                  NU din luna curentÄƒ<br/>
                  <strong>Ãnchise:</strong><br/>
                  DATA_INCHEIERE_DOSAR notna()<br/>
                  <strong>Rezultat:</strong> 2 DataFrame-uri
                </div>
              </foreignObject>
              
              <!-- Step 8: Salvare Excel Parolat -->
              <rect x="350" y="460" width="280" height="130" fill="url(#gradientProcess-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="350" y="460" width="280" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>8. Salvare Excel Parolat</strong><br/>
                  <strong>save_protected_excel():</strong><br/>
                  â€¢ xlsxwriter (creare)<br/>
                  â€¢ msoffcrypto (criptare)<br/>
                  <strong>Parole:</strong><br/>
                  â€¢ EOS, BTD CREDITE, SALT,<br/>
                  BT MIC, BT LEASING:<br/>
                  ProtecÈ›ie parolÄƒ activÄƒ<br/>
                  â€¢ BTD CARDURI:<br/>
                  ProtecÈ›ie parolÄƒ activÄƒ<br/>
                  <strong>Formatare:</strong> Georgia 11pt
                </div>
              </foreignObject>
              
              <!-- Step 9: Trimitere Email-uri -->
              <rect x="650" y="460" width="280" height="130" fill="url(#gradientProcess-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="650" y="460" width="280" height="130">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 8px; font-size: 9px;">
                  <strong>9. Trimitere Email-uri</strong><br/>
                  <strong>Outlook Integration:</strong><br/>
                  win32com.client<br/>
                  <strong>6 Email-uri:</strong><br/>
                  â€¢ EOS: "Raport dosare executare EOS"<br/>
                  â€¢ BTD CREDITE: "Raport dosare executare BTD Credite"<br/>
                  â€¢ BTD CARDURI: "Raport dosare executare BTD Carduri"<br/>
                  â€¢ SALT: "Rapoarte executare si amiabil SALT"<br/>
                  â€¢ BT MIC: "Raport executare si insolventa BT MIC"<br/>
                  â€¢ BT LEASING: "Raport dosare executare BT Leasing"<br/>
                  <strong>HTML Body:</strong> Georgia 11pt
                </div>
              </foreignObject>
              
              <!-- EXTERNAL SECTION -->
              <text x="50" y="650" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ EXTERNAL</text>
              <rect x="50" y="660" width="300" height="140" fill="url(#gradientExternal-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="660" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ Outlook Email</strong><br/>
                  <strong>Protocol:</strong> MAPI<br/>
                  <strong>Destinatari:</strong><br/>
                  â€¢ rpa@iccollect.ro<br/>
                  â€¢ juridic@iccollect.ro<br/>
                  <strong>Subiect:</strong> Personalizat per creditor<br/>
                  <strong>Format:</strong> HTML (Georgia 11pt)<br/>
                  <strong>Salvare:</strong> Folder Sent
                </div>
              </foreignObject>
              
              <!-- OUTPUT SECTION -->
              <text x="50" y="870" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ“¤ OUTPUT</text>
              
              <!-- Excel Master Consolidat -->
              <rect x="50" y="880" width="300" height="140" fill="url(#gradientOutput-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="50" y="880" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">Excel Master Consolidat</strong><br/>
                  <strong>FiÈ™ier:</strong><br/>
                  Raport_Master_Concatenat_Filtrat.xlsx<br/>
                  <strong>Sheet:</strong> Date_Concatenate<br/>
                  <strong>ConÈ›inut:</strong><br/>
                  â€¢ Toate datele procesate<br/>
                  â€¢ PORTFOLIO curÄƒÈ›at<br/>
                  â€¢ DATA_PREDARE_BEJ completat<br/>
                  <strong>Formatare:</strong> Georgia 11pt
                </div>
              </foreignObject>
              
              <!-- 6 Excel-uri Creditori -->
              <rect x="370" y="880" width="300" height="140" fill="url(#gradientOutput-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="370" y="880" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">6 Excel-uri Creditori</strong><br/>
                  <strong>FiÈ™iere:</strong><br/>
                  â€¢ Raport_EOS.xlsx<br/>
                  â€¢ Raport_BTD_CREDITE.xlsx<br/>
                  â€¢ Raport_BTD_CARDURI.xlsx<br/>
                  â€¢ Raport_SALT.xlsx<br/>
                  â€¢ Raport_BT_MIC.xlsx<br/>
                  â€¢ Raport_BT_LEASING.xlsx<br/>
                  <strong>Sheet-uri:</strong> ds active, ds inchise<br/>
                  <strong>ProtecÈ›ie:</strong> ParolÄƒ per creditor
                </div>
              </foreignObject>
              
              <!-- Email-uri -->
              <rect x="690" y="880" width="300" height="140" fill="url(#gradientExternal-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="690" y="880" width="300" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“§ 6 Email-uri Trimise</strong><br/>
                  <strong>Per creditor:</strong><br/>
                  â€¢ EOS<br/>
                  â€¢ BTD CREDITE<br/>
                  â€¢ BTD CARDURI<br/>
                  â€¢ SALT<br/>
                  â€¢ BT MIC<br/>
                  â€¢ BT LEASING<br/>
                  <strong>ConÈ›inut:</strong> HTML + AtaÈ™ament Excel<br/>
                  <strong>Destinatari:</strong> rpa@iccollect.ro, juridic@iccollect.ro
                </div>
              </foreignObject>
              
              <!-- Scheduler -->
              <rect x="1010" y="880" width="280" height="140" fill="url(#gradientOutput-r13)" stroke="#22507a" stroke-width="2" rx="5"/>
              <foreignObject x="1010" y="880" width="280" height="140">
                <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                  <strong style="font-size: 13px;">ğŸ“… Scheduler Lunar</strong><br/>
                  <strong>Programare:</strong><br/>
                  A 2-a zi lucrÄƒtoare<br/>
                  a lunii<br/>
                  <strong>Ora:</strong> 08:30<br/>
                  <strong>Mod:</strong> Lunar<br/>
                  <strong>Configurare:</strong><br/>
                  config.json<br/>
                  <strong>Rulare:</strong> scheduler.py
                </div>
              </foreignObject>
              
              <!-- Arrows: Input to Processing -->
              <path d="M 200 240 L 170 310" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-r13)"/>
              
              <!-- Arrows: Processing Steps -->
              <path d="M 290 375 L 310 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)"/>
              <path d="M 550 375 L 570 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)"/>
              <path d="M 810 375 L 830 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)"/>
              <path d="M 1070 375 L 1090 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)"/>
              <path d="M 1330 375 L 1350 375" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)"/>
              
              <!-- Arrow: Step 5 to Step 6 -->
              <path d="M 1210 375 L 1210 460 L 190 460" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)" stroke-dasharray="3,3" opacity="0.7"/>
              
              <!-- Arrow: Step 6 to Step 7 -->
              <path d="M 1470 460 L 1470 460 L 330 460" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)" stroke-dasharray="3,3" opacity="0.7"/>
              
              <!-- Arrow: Step 7 to Step 8 -->
              <path d="M 330 525 L 350 525" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)"/>
              
              <!-- Arrow: Step 8 to Step 9 -->
              <path d="M 630 525 L 650 525" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)"/>
              
              <!-- Arrow: Processing to External -->
              <path d="M 790 590 L 200 660" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)"/>
              
              <!-- Arrow: External to Processing (response) -->
              <path d="M 200 800 L 200 730 L 1160 730 L 1160 590" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)" stroke-dasharray="3,3" opacity="0.7"/>
              
              <!-- Arrow: Processing to Output -->
              <path d="M 490 590 L 200 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)"/>
              <path d="M 490 590 L 520 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)"/>
              <path d="M 790 590 L 840 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)"/>
              <path d="M 790 590 L 1150 880" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-r13)"/>
              
              <!-- Separator lines -->
              <line x1="50" y1="600" x2="1750" y2="600" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="850" x2="1750" y2="850" stroke="#22507a" stroke-width="2" opacity="0.3"/>
            </svg>
          </div>
        </div>

      </div>
    </section>

    <section class="content-section hidden" id="secFizic">
      <div class="section-head">
        <div class="title">ğŸ—ï¸ DiagramÄƒ (fizicÄƒ)</div>
        <div style="opacity:.75; font-weight:700; color:#22507a;">InfrastructurÄƒ &amp; Deployment per raport implementat</div>
      </div>
      <div class="section-body">
        <!-- Tab Navigation pentru Diagrame Fizice -->
        <div style="margin-bottom: 25px; border-bottom: 3px solid rgba(34, 80, 122, 0.2); padding-bottom: 10px;">
          <nav style="display: flex; flex-wrap: wrap; gap: 10px; padding: 15px; background: rgba(255, 255, 255, 0.3); border-radius: 15px; backdrop-filter: blur(10px);">
            <button class="physical-tab-btn active" data-physical="1">ğŸ“Š 1. Creditori</button>
            <button class="physical-tab-btn" data-physical="2">ğŸ’° 2. CreanÈ›e &lt;500</button>
            <button class="physical-tab-btn" data-physical="3">ğŸ“Š 3. Expunere Exec</button>
            <button class="physical-tab-btn" data-physical="4">ğŸ“… 4. Termene Lic</button>
            <button class="physical-tab-btn" data-physical="5">âš ï¸ 5. Incidente</button>
            <button class="physical-tab-btn" data-physical="6">ğŸ“ˆ 6. Productivitate</button>
            <button class="physical-tab-btn" data-physical="7">ğŸ“‹ 7. CreanÈ›e Perimate</button>
            <button class="physical-tab-btn" data-physical="8">âš–ï¸ 8. Portal Just</button>
            <button class="physical-tab-btn" data-physical="9">ğŸ†” 9. SIUI</button>
            <button class="physical-tab-btn" data-physical="10">ğŸ“Š 10. AnalizÄƒ Perimare</button>
            <button class="physical-tab-btn" data-physical="11">ğŸ“‹ 11. Perimate FÄƒrÄƒ AcÈ›iuni</button>
            <button class="physical-tab-btn" data-physical="12">ğŸ  12. Termene Lic Identif</button>
            <button class="physical-tab-btn" data-physical="13">ğŸ“Š 13. Dosare Active</button>
          </nav>
        </div>

        <!-- DiagramÄƒ FizicÄƒ Raport 1: Creditori -->
        <div class="physical-diagram active" id="physical-diagram-1">
          <div class="diagram-container">
            <svg width="1600" height="1200" viewBox="0 0 1600 1200" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ fizicÄƒ - Raport Creditori">
              <defs>
                <linearGradient id="gradientCloud-p1" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientServer-p1" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientDB-p1" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientClient-p1" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-phys-p1" markerWidth="12" markerHeight="12" refX="10" refY="4" orient="auto">
            <polygon points="0 0, 12 4, 0 8" fill="#3576b0" />
          </marker>
              </defs>

              <!-- Background -->
              <rect width="1600" height="1200" fill="rgba(255,255,255,0.3)" rx="20"/>
              
              <!-- Title -->
              <text x="800" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ—ï¸ DIAGRAMÄ‚ FIZICÄ‚ - RAPORT CREDITORI</text>

              <!-- Layer separators -->
              <line x1="50" y1="200" x2="1550" y2="200" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="500" x2="1550" y2="500" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="800" x2="1550" y2="800" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1050" x2="1550" y2="1050" stroke="#22507a" stroke-width="2" opacity="0.3"/>

              <!-- LAYER 1: EXTERNAL SERVICES -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ SERVICII EXTERNE</text>
              
              <!-- Outlook Email Service -->
              <g class="node-phys">
                <rect x="50" y="110" width="300" height="80" rx="15" fill="url(#gradientCloud-p1)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="110" width="300" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“§ Microsoft Outlook</strong><br/>
                    <strong>Protocol:</strong> COM Interface (win32com)<br/>
                    <strong>Location:</strong> Local Installation<br/>
                    <strong>Function:</strong> Email Sending (6 emails)<br/>
                    <strong>Attachments:</strong> Excel Files
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 2: WINDOWS WORKSTATION -->
              <text x="50" y="250" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’» WINDOWS WORKSTATION - DEPLOYMENT FIZIC</text>
              
              <!-- Main Workstation Container -->
              <g class="node-phys">
                <rect x="50" y="270" width="1500" height="220" rx="20" fill="url(#gradientServer-p1)" stroke="#22507a" stroke-width="3" filter="drop-shadow(0 12px 24px rgba(0, 0, 0, 0.2))"/>
                
                <!-- Python Runtime Section -->
                <g class="node-phys">
                  <rect x="70" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="70" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ Python Runtime</div>
                      <div style="line-height: 1.6;">
                        <strong>Python 3.8+</strong><br/>
                        <strong>pandas</strong> - Data Processing<br/>
                        <strong>openpyxl</strong> - Excel I/O<br/>
                        <strong>xlsxwriter</strong> - Excel Creation<br/>
                        <strong>win32com</strong> - Outlook COM<br/>
                        <strong>msoffcrypto</strong> - Password Protection
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Raport Creditori Module -->
                <g class="node-phys">
                  <rect x="370" y="290" width="320" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="370" y="290" width="320" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“Š Raport Creditori Module</div>
                      <div style="line-height: 1.6;">
                        <strong>processor.py</strong> - Logic Processing<br/>
                        <strong>screen.py</strong> - GUI Interface<br/>
                        <strong>scheduler.py</strong> - Auto-run Lunar<br/>
                        <strong>config.json</strong> - Configuration<br/>
                        <strong>utils/excel_processor.py</strong> - Excel Utils<br/>
                        <strong>6 Creditori:</strong> EOS, BTD CREDITE,<br/>
                        BTD CARDURI, SALT, BT MIC, BT LEASING
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Excel Processing Engine -->
                <g class="node-phys">
                  <rect x="710" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="710" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">âš¡ Excel Processing</div>
                      <div style="line-height: 1.6;">
                        <strong>openpyxl</strong> - Read/Write<br/>
                        <strong>xlsxwriter</strong> - Create Protected<br/>
                        <strong>msoffcrypto</strong> - Encryption<br/>
                        <strong>pandas</strong> - Data Manipulation<br/>
                        <strong>Georgia 11pt</strong> - Formatting<br/>
                        <strong>Password:</strong> ProtecÈ›ie parolÄƒ activÄƒ
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Scheduler Service -->
                <g class="node-phys">
                  <rect x="1010" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1010" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“… Scheduler Service</div>
                      <div style="line-height: 1.6;">
                        <strong>schedule</strong> - Task Scheduling<br/>
                        <strong>threading</strong> - Background Thread<br/>
                        <strong>scheduler.py</strong> - Module Scheduler<br/>
                        <strong>Trigger:</strong> A 2-a zi lucrÄƒtoare<br/>
                        <strong>Time:</strong> 08:30<br/>
                        <strong>Mode:</strong> Lunar
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Email Service -->
                <g class="node-phys">
                  <rect x="1310" y="290" width="220" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1310" y="290" width="220" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“§ Email Service</div>
                      <div style="line-height: 1.6;">
                        <strong>win32com.client</strong> - Outlook<br/>
                        <strong>6 Email-uri</strong> - Per Creditor<br/>
                        <strong>HTML Body</strong> - Georgia 11pt<br/>
                        <strong>Attachments:</strong> Excel Files<br/>
                        <strong>TO:</strong> rpa@iccollect.ro,<br/>
                        juridic@iccollect.ro
                      </div>
                    </div>
                  </foreignObject>
                </g>
              </g>

              <!-- LAYER 3: FILE STORAGE -->
              <text x="50" y="550" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’¾ STOCARE DATE LOCALE</text>
              
              <!-- Master Files -->
              <g class="node-phys">
                <rect x="50" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p1)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¥ Master Files (Input)</strong><br/>
                    <strong>Folder:</strong> raport_creditori/Master/<br/>
                    <strong>File Pattern:</strong> Raport_Master_*.xlsx<br/>
                    <strong>Auto-detection:</strong> glob.glob()<br/>
                    <strong>Sheets:</strong> 2 (Sheet 1 skiprows=1, Sheet 2 normal)<br/>
                    <strong>Columns:</strong> PORTFOLIO (index 21), NUME_TITULAR,<br/>
                    DATA_PREDARE_BEJ, DATA_INCHEIERE_DOSAR
                  </div>
                </foreignObject>
              </g>

              <!-- Result Files -->
              <g class="node-phys">
                <rect x="430" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p1)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="430" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¤ Result Files (Output)</strong><br/>
                    <strong>Folder:</strong> rapoarte_generate/<br/>
                    <strong>Master:</strong> Raport_Master_Concatenat_Filtrat.xlsx<br/>
                    <strong>6 Excel-uri:</strong> Raport_EOS.xlsx,<br/>
                    Raport_BTD_CREDITE.xlsx, Raport_BTD_CARDURI.xlsx,<br/>
                    Raport_SALT.xlsx, Raport_BT_MIC.xlsx,<br/>
                    Raport_BT_LEASING.xlsx<br/>
                    <strong>ProtecÈ›ie:</strong> ParolÄƒ per creditor
                  </div>
                </foreignObject>
              </g>

              <!-- Configuration -->
              <g class="node-phys">
                <rect x="810" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p1)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="810" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">âš™ï¸ Configuration Files</strong><br/>
                    <strong>config.json</strong> - Module Config<br/>
                    â€¢ Master folder path<br/>
                    â€¢ Output folder path<br/>
                    â€¢ Email recipients (TO/CC)<br/>
                    â€¢ Scheduler settings (day/time)<br/>
                    <strong>rapoarte_status.json</strong> - Status tracking
                  </div>
                </foreignObject>
              </g>

              <!-- Logs -->
              <g class="node-phys">
                <rect x="1190" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p1)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1190" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“ Logging System</strong><br/>
                    <strong>File:</strong> raport_creditori.log<br/>
                    <strong>Encoding:</strong> UTF-8 (Windows fix)<br/>
                    <strong>Levels:</strong> DEBUG/INFO/WARNING/ERROR<br/>
                    <strong>Real-time:</strong> GUI logging<br/>
                    <strong>Format:</strong> [TIMESTAMP] [LEVEL] Message
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 4: USER INTERFACE -->
              <text x="50" y="850" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ‘¤ INTERFAÈšÄ‚ UTILIZATOR</text>
              
              <!-- GUI Application -->
              <g class="node-phys">
                <rect x="50" y="870" width="1500" height="160" rx="15" fill="url(#gradientClient-p1)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="870" width="1500" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 15px; font-size: 10px;">
                    <div style="font-weight: bold; font-size: 14px; margin-bottom: 10px;">ğŸ–¥ï¸ CustomTkinter GUI - Raport Creditori Screen</div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                      <div>
                        <strong>screen.py:</strong><br/>
                        â€¢ Folder selection (Master/Output)<br/>
                        â€¢ Email configuration<br/>
                        â€¢ Process button<br/>
                        â€¢ Real-time logging display
                      </div>
                      <div>
                        <strong>Features:</strong><br/>
                        â€¢ Dark theme<br/>
                        â€¢ Progress indicators<br/>
                        â€¢ Error messages<br/>
                        â€¢ Status updates
                      </div>
                      <div>
                        <strong>Scheduler UI:</strong><br/>
                        â€¢ Day/hour selection<br/>
                        â€¢ Start/Stop controls<br/>
                        â€¢ Status display<br/>
                        â€¢ Config save/load
                      </div>
                      <div>
                        <strong>Integration:</strong><br/>
                        â€¢ Calls processor.py<br/>
                        â€¢ Subprocess execution<br/>
                        â€¢ Output capture<br/>
                        â€¢ Error handling
                      </div>
                    </div>
                  </div>
                </foreignObject>
              </g>

              <!-- ARROWS: External to Workstation -->
              <path d="M 200 190 L 200 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p1)"/>
              
              <!-- ARROWS: Workstation Internal -->
              <path d="M 350 380 L 370 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p1)"/>
              <path d="M 650 380 L 710 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p1)"/>
              <path d="M 990 380 L 1010 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p1)"/>
              <path d="M 1290 380 L 1310 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p1)"/>
              
              <!-- ARROWS: Workstation to File Storage -->
              <path d="M 230 490 L 230 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p1)"/>
              <path d="M 610 490 L 610 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p1)"/>
              <path d="M 990 490 L 990 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p1)"/>
              <path d="M 1370 490 L 1370 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p1)"/>
              
              <!-- ARROWS: Workstation to GUI -->
              <path d="M 800 490 L 800 870" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p1)"/>
              
              <!-- ARROWS: File Storage to Workstation (feedback) -->
              <path d="M 230 570 L 230 490" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p1)" opacity="0.7"/>
              <path d="M 800 870 L 800 490" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p1)" opacity="0.7"/>
              <path d="M 200 270 L 200 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p1)" opacity="0.7"/>

            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ FizicÄƒ Raport 2: CreanÈ›e < 500 -->
        <div class="physical-diagram" id="physical-diagram-2">
          <div class="diagram-container">
            <svg width="1600" height="1100" viewBox="0 0 1600 1100" min-width="1600" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ fizicÄƒ - Raport CreanÈ›e < 500 RON">
              <defs>
                <linearGradient id="gradientCloud-p2" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientServer-p2" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientDB-p2" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientClient-p2" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-phys-p2" markerWidth="12" markerHeight="12" refX="10" refY="4" orient="auto">
                  <polygon points="0 0, 12 4, 0 8" fill="#3576b0" />
                </marker>
        </defs>

              <!-- Background -->
              <rect width="1600" height="1100" fill="rgba(255,255,255,0.3)" rx="20"/>

              <!-- Title -->
              <text x="800" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ—ï¸ DIAGRAMÄ‚ FIZICÄ‚ - RAPORT CREANÈšE &lt; 500 RON</text>

<!-- Layer separators -->
              <line x1="50" y1="200" x2="1550" y2="200" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="500" x2="1550" y2="500" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="800" x2="1550" y2="800" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1030" x2="1550" y2="1030" stroke="#22507a" stroke-width="2" opacity="0.3"/>

              <!-- LAYER 1: EXTERNAL SERVICES -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ SERVICII EXTERNE</text>
              
              <!-- Outlook Email Service -->
              <g class="node-phys">
                <rect x="50" y="110" width="300" height="80" rx="15" fill="url(#gradientCloud-p2)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="110" width="300" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“§ Microsoft Outlook</strong><br/>
                    <strong>Protocol:</strong> COM Interface (win32com)<br/>
                    <strong>Location:</strong> Local Installation<br/>
                    <strong>Function:</strong> Email Sending (1 email)<br/>
                    <strong>Attachments:</strong> Excel File
            </div>
          </foreignObject>
        </g>

              <!-- LAYER 2: WINDOWS WORKSTATION -->
              <text x="50" y="250" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’» WINDOWS WORKSTATION - DEPLOYMENT FIZIC</text>
              
              <!-- Main Workstation Container -->
              <g class="node-phys">
                <rect x="50" y="270" width="1500" height="220" rx="20" fill="url(#gradientServer-p2)" stroke="#22507a" stroke-width="3" filter="drop-shadow(0 12px 24px rgba(0, 0, 0, 0.2))"/>
                
                <!-- Python Runtime Section -->
                <g class="node-phys">
                  <rect x="70" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="70" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ Python Runtime</div>
                      <div style="line-height: 1.6;">
                        <strong>Python 3.8+</strong><br/>
                        <strong>pandas</strong> - Data Processing<br/>
                        <strong>openpyxl</strong> - Excel I/O<br/>
                        <strong>win32com</strong> - Outlook COM<br/>
                        <strong>glob</strong> - File Discovery<br/>
                        <strong>re</strong> - Regex Processing<br/>
                        <strong>datetime</strong> - Date Handling
                      </div>
            </div>
          </foreignObject>
        </g>

                <!-- Raport CreanÈ›e < 500 Module -->
                <g class="node-phys">
                  <rect x="370" y="290" width="320" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="370" y="290" width="320" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ’° Raport CreanÈ›e &lt; 500 Module</div>
                      <div style="line-height: 1.6;">
                        <strong>processor.py</strong> - Logic Processing<br/>
                        <strong>screen.py</strong> - GUI Interface<br/>
                        <strong>config.json</strong> - Configuration<br/>
                        <strong>Processing:</strong> 3 Sheeturi Excel<br/>
                        <strong>Filtrare:</strong> EXP_TOT_CLIENT_RON &lt;= 500<br/>
                        <strong>AnalizÄƒ:</strong> COMMENTS (prioritizare)<br/>
                        <strong>Tracking:</strong> JSON History
                      </div>
            </div>
          </foreignObject>
        </g>

                <!-- Excel Processing Engine -->
                <g class="node-phys">
                  <rect x="710" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="710" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">âš¡ Excel Processing</div>
                      <div style="line-height: 1.6;">
                        <strong>openpyxl</strong> - Read/Write<br/>
                        <strong>pandas</strong> - Data Manipulation<br/>
                        <strong>3 Sheeturi:</strong> skiprows=1<br/>
                        <strong>Aliniere:</strong> Column Alignment<br/>
                        <strong>Formatting:</strong> Header Bold<br/>
                        <strong>Auto-width:</strong> Columns<br/>
                        <strong>Color Coding:</strong> Yellow/Green/Blue
                      </div>
            </div>
          </foreignObject>
        </g>

                <!-- Data Analysis Engine -->
                <g class="node-phys">
                  <rect x="1010" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1010" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“Š Data Analysis</div>
                      <div style="line-height: 1.6;">
                        <strong>Prioritizare:</strong> COMMENTS Analysis<br/>
                        <strong>Luna CurentÄƒ:</strong> .mm.yyyy<br/>
                        <strong>Luna TrecutÄƒ:</strong> Pattern Matching<br/>
                        <strong>6M IncasÄƒri:</strong> Transaction Check<br/>
                        <strong>Sortare:</strong> Priority Column<br/>
                        <strong>Filtrare:</strong> 14 RezoluÈ›ii
                      </div>
            </div>
          </foreignObject>
        </g>

                <!-- Email Service -->
                <g class="node-phys">
                  <rect x="1310" y="290" width="220" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1310" y="290" width="220" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“§ Email Service</div>
                      <div style="line-height: 1.6;">
                        <strong>win32com.client</strong> - Outlook<br/>
                        <strong>1 Email</strong> - Trimis<br/>
                        <strong>HTML Body</strong> - Georgia 11pt<br/>
                        <strong>Attachments:</strong> Excel File<br/>
                        <strong>TO:</strong> actualizari@iccollect.ro<br/>
                        <strong>CC:</strong> rpa@iccollect.ro,<br/>
                        juridic@iccollect.ro
                      </div>
            </div>
          </foreignObject>
                </g>
              </g>

              <!-- LAYER 3: FILE STORAGE -->
              <text x="50" y="550" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’¾ STOCARE DATE LOCALE</text>
              
              <!-- Master Files -->
              <g class="node-phys">
                <rect x="50" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p2)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¥ Master Files (Input)</strong><br/>
                    <strong>Folder:</strong> raport_creante_500/Master/<br/>
                    <strong>File Pattern:</strong> *.xlsx (exclude ~$)<br/>
                    <strong>Auto-detection:</strong> glob.glob()<br/>
                    <strong>Selection:</strong> Most Recent (mtime)<br/>
                    <strong>Sheets:</strong> 3 (Sheet 0, 1, 2)<br/>
                    <strong>Skiprows:</strong> 1 (all sheets)
            </div>
          </foreignObject>
        </g>

              <!-- Result Files -->
              <g class="node-phys">
                <rect x="430" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p2)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="430" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¤ Result Files (Output)</strong><br/>
                    <strong>Folder:</strong> rapoarte_generate/<br/>
                    <strong>File:</strong> Situatie_dosare_sub_500_RON.xlsx<br/>
                    <strong>Formatting:</strong> Header Bold, Auto-width<br/>
                    <strong>Color Coding:</strong> Yellow/Green/Blue rows<br/>
                    <strong>Columns:</strong> Reordered (priority first)<br/>
                    <strong>History:</strong> JSON tracking file
            </div>
          </foreignObject>
        </g>

              <!-- Configuration -->
              <g class="node-phys">
                <rect x="810" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p2)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="810" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">âš™ï¸ Configuration Files</strong><br/>
                    <strong>config.json</strong> - Module Config<br/>
                    â€¢ Master folder path<br/>
                    â€¢ Output folder path<br/>
                    â€¢ Email recipients (TO/CC)<br/>
                    <strong>history.json</strong> - Processing History<br/>
                    â€¢ Timestamp tracking<br/>
                    â€¢ File processed info
            </div>
          </foreignObject>
        </g>

              <!-- Logs -->
              <g class="node-phys">
                <rect x="1190" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p2)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1190" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“ Logging System</strong><br/>
                    <strong>File:</strong> raport_creante_500.log<br/>
                    <strong>Encoding:</strong> UTF-8 (Windows fix)<br/>
                    <strong>Levels:</strong> DEBUG/INFO/WARNING/ERROR<br/>
                    <strong>Real-time:</strong> GUI logging<br/>
                    <strong>Format:</strong> [TIMESTAMP] [LEVEL] Message
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 4: USER INTERFACE -->
              <text x="50" y="850" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ‘¤ INTERFAÈšÄ‚ UTILIZATOR</text>
              
              <!-- GUI Application -->
              <g class="node-phys">
                <rect x="50" y="870" width="1500" height="160" rx="15" fill="url(#gradientClient-p2)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="870" width="1500" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 15px; font-size: 10px;">
                    <div style="font-weight: bold; font-size: 14px; margin-bottom: 10px;">ğŸ–¥ï¸ CustomTkinter GUI - Raport CreanÈ›e &lt; 500 Screen</div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                      <div>
                        <strong>screen.py:</strong><br/>
                        â€¢ Folder selection (Master/Output)<br/>
                        â€¢ Email configuration<br/>
                        â€¢ Process button<br/>
                        â€¢ Real-time logging display
                      </div>
                      <div>
                        <strong>Features:</strong><br/>
                        â€¢ Dark theme<br/>
                        â€¢ Progress indicators<br/>
                        â€¢ Error messages<br/>
                        â€¢ Status updates
                      </div>
                      <div>
                        <strong>Processing Info:</strong><br/>
                        â€¢ File selection display<br/>
                        â€¢ Row count preview<br/>
                        â€¢ Filter status<br/>
                        â€¢ Output file path
                      </div>
                      <div>
                        <strong>Integration:</strong><br/>
                        â€¢ Calls processor.py<br/>
                        â€¢ Subprocess execution<br/>
                        â€¢ Output capture<br/>
                        â€¢ Error handling
                      </div>
                    </div>
                  </div>
                </foreignObject>
              </g>

              <!-- ARROWS: External to Workstation -->
              <path d="M 200 190 L 200 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p2)"/>
              
              <!-- ARROWS: Workstation Internal -->
              <path d="M 350 380 L 370 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p2)"/>
              <path d="M 690 380 L 710 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p2)"/>
              <path d="M 990 380 L 1010 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p2)"/>
              <path d="M 1290 380 L 1310 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p2)"/>
              
              <!-- ARROWS: Workstation to File Storage -->
              <path d="M 230 490 L 230 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p2)"/>
              <path d="M 610 490 L 610 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p2)"/>
              <path d="M 990 490 L 990 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p2)"/>
              <path d="M 1370 490 L 1370 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p2)"/>
              
              <!-- ARROWS: Workstation to GUI -->
              <path d="M 800 490 L 800 870" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p2)"/>
              
              <!-- ARROWS: File Storage to Workstation (feedback) -->
              <path d="M 230 570 L 230 490" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p2)" opacity="0.7"/>
              <path d="M 800 870 L 800 490" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p2)" opacity="0.7"/>
              <path d="M 200 270 L 200 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p2)" opacity="0.7"/>
      </svg>
          </div>
    </div>

        <!-- DiagramÄƒ FizicÄƒ Raport 3: Expunere Executare -->
        <div class="physical-diagram" id="physical-diagram-3">
          <div class="diagram-container">
            <svg width="1600" height="1100" viewBox="0 0 1600 1100" min-width="1600" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ fizicÄƒ - Raport Expunere Executare">
              <defs>
                <linearGradient id="gradientCloud-p3" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientServer-p3" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientDB-p3" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientClient-p3" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-phys-p3" markerWidth="12" markerHeight="12" refX="10" refY="4" orient="auto">
                  <polygon points="0 0, 12 4, 0 8" fill="#3576b0" />
                </marker>
              </defs>

              <!-- Background -->
              <rect width="1600" height="1100" fill="rgba(255,255,255,0.3)" rx="20"/>
              
              <!-- Title -->
              <text x="800" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ—ï¸ DIAGRAMÄ‚ FIZICÄ‚ - RAPORT EXPUNERE EXECUTARE</text>
              
              <!-- Layer separators -->
              <line x1="50" y1="200" x2="1550" y2="200" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="500" x2="1550" y2="500" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="800" x2="1550" y2="800" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1030" x2="1550" y2="1030" stroke="#22507a" stroke-width="2" opacity="0.3"/>

              <!-- LAYER 1: EXTERNAL SERVICES -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ SERVICII EXTERNE</text>
              
              <!-- Outlook Email Service -->
              <g class="node-phys">
                <rect x="50" y="110" width="300" height="80" rx="15" fill="url(#gradientCloud-p3)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="110" width="300" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“§ Microsoft Outlook</strong><br/>
                    <strong>Protocol:</strong> COM Interface (win32com)<br/>
                    <strong>Location:</strong> Local Installation<br/>
                    <strong>Function:</strong> Email Sending (1 email)<br/>
                    <strong>Attachments:</strong> Excel + Charts (embedded)
      </div>
                </foreignObject>
              </g>

              <!-- LAYER 2: WINDOWS WORKSTATION -->
              <text x="50" y="250" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’» WINDOWS WORKSTATION - DEPLOYMENT FIZIC</text>
              
              <!-- Main Workstation Container -->
              <g class="node-phys">
                <rect x="50" y="270" width="1500" height="220" rx="20" fill="url(#gradientServer-p3)" stroke="#22507a" stroke-width="3" filter="drop-shadow(0 12px 24px rgba(0, 0, 0, 0.2))"/>
                
                <!-- Python Runtime Section -->
                <g class="node-phys">
                  <rect x="70" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="70" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ Python Runtime</div>
                      <div style="line-height: 1.6;">
                        <strong>Python 3.8+</strong><br/>
                        <strong>pandas</strong> - Data Processing<br/>
                        <strong>openpyxl</strong> - Excel I/O<br/>
                        <strong>win32com</strong> - Outlook COM<br/>
                        <strong>matplotlib</strong> - Charts Generation<br/>
                        <strong>base64</strong> - Image Encoding<br/>
                        <strong>logging</strong> - Logging System
      </div>
      </div>
                  </foreignObject>
                </g>

                <!-- Raport Expunere Executare Module -->
                <g class="node-phys">
                  <rect x="370" y="290" width="320" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="370" y="290" width="320" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“Š Raport Expunere Exec Module</div>
                      <div style="line-height: 1.6;">
                        <strong>processor.py</strong> - Logic Processing<br/>
                        <strong>screen.py</strong> - GUI Interface<br/>
                        <strong>config.json</strong> - Configuration<br/>
                        <strong>Input:</strong> Lista Derulanta.xlsx<br/>
                        <strong>Input:</strong> Raport-Restantieri_*.xlsx<br/>
                        <strong>Filtrare:</strong> EXECUTARE="NU"<br/>
                        <strong>Filtrare:</strong> DATA_PREDARE_BEJ
      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Excel Processing Engine -->
                <g class="node-phys">
                  <rect x="710" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="710" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">âš¡ Excel Processing</div>
                      <div style="line-height: 1.6;">
                        <strong>openpyxl</strong> - Read/Write<br/>
                        <strong>pandas</strong> - Data Manipulation<br/>
                        <strong>Multiple Sheets:</strong> Concatenate<br/>
                        <strong>Formatting:</strong> Georgia 11pt<br/>
                        <strong>Header:</strong> Colored, Bold<br/>
                        <strong>Auto-width:</strong> Columns<br/>
                        <strong>Charts:</strong> Embedded Images
      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Chart Generation Engine -->
                <g class="node-phys">
                  <rect x="1010" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1010" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“ˆ Chart Generation</div>
                      <div style="line-height: 1.6;">
                        <strong>matplotlib</strong> - Chart Library<br/>
                        <strong>Font:</strong> Georgia (rcParams)<br/>
                        <strong>Charts:</strong> Bar/Line Charts<br/>
                        <strong>Encoding:</strong> base64<br/>
                        <strong>Embedding:</strong> Excel Cells<br/>
                        <strong>Format:</strong> PNG Images
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Email Service -->
                <g class="node-phys">
                  <rect x="1310" y="290" width="220" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1310" y="290" width="220" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“§ Email Service</div>
                      <div style="line-height: 1.6;">
                        <strong>win32com.client</strong> - Outlook<br/>
                        <strong>1 Email</strong> - Trimis<br/>
                        <strong>HTML Body</strong> - Georgia 11pt<br/>
                        <strong>Attachments:</strong> Excel File<br/>
                        <strong>Charts:</strong> Embedded in Email<br/>
                        <strong>TO:</strong> Configurable<br/>
                        <strong>CC:</strong> Configurable
                      </div>
                    </div>
                  </foreignObject>
                </g>
              </g>

              <!-- LAYER 3: FILE STORAGE -->
              <text x="50" y="550" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’¾ STOCARE DATE LOCALE</text>
              
              <!-- Master Files -->
              <g class="node-phys">
                <rect x="50" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p3)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¥ Master Files (Input)</strong><br/>
                    <strong>Folder:</strong> raport_expunere_executare/Master/<br/>
                    <strong>File 1:</strong> Lista Derulanta.xlsx<br/>
                    <strong>File Pattern:</strong> Raport-Restantieri_*.xlsx<br/>
                    <strong>Auto-detection:</strong> os.listdir()<br/>
                    <strong>Multiple Files:</strong> All matching files<br/>
                    <strong>Sheets:</strong> Multiple (skiprows=1, header=1)
                  </div>
                </foreignObject>
              </g>

              <!-- Result Files -->
              <g class="node-phys">
                <rect x="430" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p3)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="430" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¤ Result Files (Output)</strong><br/>
                    <strong>Folder:</strong> Rezultate expunere/<br/>
                    <strong>Subfolder:</strong> Prelucrare - [luna]<br/>
                    <strong>File:</strong> Raport_Expunere_Executare.xlsx<br/>
                    <strong>Formatting:</strong> Georgia 11pt, Charts<br/>
                    <strong>Charts:</strong> Embedded PNG images<br/>
                    <strong>Backup:</strong> Files copied to Prelucrare
                  </div>
                </foreignObject>
              </g>

              <!-- Configuration -->
              <g class="node-phys">
                <rect x="810" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p3)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="810" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">âš™ï¸ Configuration Files</strong><br/>
                    <strong>config.json</strong> - Module Config<br/>
                    â€¢ Master folder path<br/>
                    â€¢ Output folder path<br/>
                    â€¢ Email recipients (TO/CC)<br/>
                    <strong>Mapping:</strong> Lista Derulanta.xlsx<br/>
                    â€¢ Portofoliu â†’ Denumire creditor<br/>
                    â€¢ Portfolio information
                  </div>
                </foreignObject>
              </g>

              <!-- Logs -->
              <g class="node-phys">
                <rect x="1190" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p3)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1190" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“ Logging System</strong><br/>
                    <strong>File:</strong> raport_expunere_executare.log<br/>
                    <strong>Encoding:</strong> UTF-8 (Windows fix)<br/>
                    <strong>Levels:</strong> DEBUG/INFO/WARNING/ERROR<br/>
                    <strong>Real-time:</strong> GUI logging<br/>
                    <strong>Format:</strong> [TIMESTAMP] [LEVEL] Message<br/>
                    <strong>Details:</strong> File processing steps
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 4: USER INTERFACE -->
              <text x="50" y="850" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ‘¤ INTERFAÈšÄ‚ UTILIZATOR</text>
              
              <!-- GUI Application -->
              <g class="node-phys">
                <rect x="50" y="870" width="1500" height="160" rx="15" fill="url(#gradientClient-p3)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="870" width="1500" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 15px; font-size: 10px;">
                    <div style="font-weight: bold; font-size: 14px; margin-bottom: 10px;">ğŸ–¥ï¸ CustomTkinter GUI - Raport Expunere Executare Screen</div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                      <div>
                        <strong>screen.py:</strong><br/>
                        â€¢ Folder selection (Master/Output)<br/>
                        â€¢ Email configuration<br/>
                        â€¢ Process button<br/>
                        â€¢ Real-time logging display
                      </div>
                      <div>
                        <strong>Features:</strong><br/>
                        â€¢ Dark theme<br/>
                        â€¢ Progress indicators<br/>
                        â€¢ Error messages<br/>
                        â€¢ Status updates
                      </div>
                      <div>
                        <strong>Processing Info:</strong><br/>
                        â€¢ File selection display<br/>
                        â€¢ Multiple files detection<br/>
                        â€¢ Chart generation preview<br/>
                        â€¢ Output file path
                      </div>
                      <div>
                        <strong>Integration:</strong><br/>
                        â€¢ Calls processor.py<br/>
                        â€¢ Subprocess execution<br/>
                        â€¢ Output capture<br/>
                        â€¢ Error handling
                      </div>
                    </div>
                  </div>
                </foreignObject>
              </g>

              <!-- ARROWS: External to Workstation -->
              <path d="M 200 190 L 200 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p3)"/>
              
              <!-- ARROWS: Workstation Internal -->
              <path d="M 350 380 L 370 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p3)"/>
              <path d="M 690 380 L 710 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p3)"/>
              <path d="M 990 380 L 1010 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p3)"/>
              <path d="M 1290 380 L 1310 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p3)"/>
              
              <!-- ARROWS: Workstation to File Storage -->
              <path d="M 230 490 L 230 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p3)"/>
              <path d="M 610 490 L 610 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p3)"/>
              <path d="M 990 490 L 990 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p3)"/>
              <path d="M 1370 490 L 1370 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p3)"/>
              
              <!-- ARROWS: Workstation to GUI -->
              <path d="M 800 490 L 800 870" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p3)"/>
              
              <!-- ARROWS: File Storage to Workstation (feedback) -->
              <path d="M 230 570 L 230 490" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p3)" opacity="0.7"/>
              <path d="M 800 870 L 800 490" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p3)" opacity="0.7"/>
              <path d="M 200 270 L 200 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p3)" opacity="0.7"/>
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ FizicÄƒ Raport 4: Termene LicitaÈ›ie -->
        <div class="physical-diagram" id="physical-diagram-4">
        <div class="diagram-container">
            <svg width="1600" height="1100" viewBox="0 0 1600 1100" min-width="1600" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ fizicÄƒ - Raport Termene LicitaÈ›ie GaranÈ›ii">
            <defs>
                <linearGradient id="gradientCloud-p4" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
              </linearGradient>
                <linearGradient id="gradientServer-p4" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
              </linearGradient>
                <linearGradient id="gradientDB-p4" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
              </linearGradient>
                <linearGradient id="gradientClient-p4" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
              </linearGradient>
                <marker id="arrowhead-phys-p4" markerWidth="12" markerHeight="12" refX="10" refY="4" orient="auto">
                <polygon points="0 0, 12 4, 0 8" fill="#3576b0" />
              </marker>
            </defs>

            <!-- Background -->
              <rect width="1600" height="1100" fill="rgba(255,255,255,0.3)" rx="20"/>
              
              <!-- Title -->
              <text x="800" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ—ï¸ DIAGRAMÄ‚ FIZICÄ‚ - RAPORT TERMENE LICITAÈšIE GARANÈšII</text>
              
              <!-- Layer separators -->
              <line x1="50" y1="200" x2="1550" y2="200" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="500" x2="1550" y2="500" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="800" x2="1550" y2="800" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1030" x2="1550" y2="1030" stroke="#22507a" stroke-width="2" opacity="0.3"/>

              <!-- LAYER 1: EXTERNAL SERVICES -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ SERVICII EXTERNE</text>
              
              <!-- Outlook Email Service -->
            <g class="node-phys">
                <rect x="50" y="110" width="300" height="80" rx="15" fill="url(#gradientCloud-p4)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="110" width="300" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“§ Microsoft Outlook</strong><br/>
                    <strong>Protocol:</strong> COM Interface (win32com)<br/>
                    <strong>Location:</strong> Local Installation<br/>
                    <strong>Function:</strong> Email Sending (1 email)<br/>
                    <strong>Attachments:</strong> Excel Parolat
                </div>
              </foreignObject>
            </g>

              <!-- LAYER 2: WINDOWS WORKSTATION -->
              <text x="50" y="250" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’» WINDOWS WORKSTATION - DEPLOYMENT FIZIC</text>
              
              <!-- Main Workstation Container -->
            <g class="node-phys">
                <rect x="50" y="270" width="1500" height="220" rx="20" fill="url(#gradientServer-p4)" stroke="#22507a" stroke-width="3" filter="drop-shadow(0 12px 24px rgba(0, 0, 0, 0.2))"/>
                
                <!-- Python Runtime Section -->
                <g class="node-phys">
                  <rect x="70" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="70" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ Python Runtime</div>
                      <div style="line-height: 1.6;">
                        <strong>Python 3.8+</strong><br/>
                        <strong>pandas</strong> - Data Processing<br/>
                        <strong>openpyxl</strong> - Excel I/O (.xlsx)<br/>
                        <strong>xlsxwriter</strong> - Excel Creation<br/>
                        <strong>xlrd</strong> - Excel I/O (.xls)<br/>
                        <strong>pyxlsb</strong> - Excel I/O (.xlsb)<br/>
                        <strong>win32com</strong> - Outlook COM
                      </div>
                </div>
              </foreignObject>
            </g>

                <!-- Raport Termene LicitaÈ›ie Module -->
            <g class="node-phys">
                  <rect x="370" y="290" width="320" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="370" y="290" width="320" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“… Raport Termene Lic Module</div>
                      <div style="line-height: 1.6;">
                        <strong>processor.py</strong> - Logic Processing<br/>
                        <strong>screen.py</strong> - GUI Interface<br/>
                        <strong>scheduler.py</strong> - Auto-run Lunar<br/>
                        <strong>config.json</strong> - Configuration<br/>
                        <strong>Input 1:</strong> Rap 7 (sheet specific)<br/>
                        <strong>Input 2:</strong> raportGarantiiExecutareICC<br/>
                        <strong>Connection:</strong> ID garantie Capone
                      </div>
                </div>
              </foreignObject>
            </g>

                <!-- Excel Processing Engine -->
            <g class="node-phys">
                  <rect x="710" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="710" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">âš¡ Excel Processing</div>
                      <div style="line-height: 1.6;">
                        <strong>Multiple Engines:</strong> xlrd/openpyxl/pyxlsb<br/>
                        <strong>Sheet Detection:</strong> Auto<br/>
                        <strong>Concatenation:</strong> 2 Sheeturi<br/>
                        <strong>Data Cleaning:</strong> AUCTION_NO (1-1000)<br/>
                        <strong>Formatting:</strong> Georgia 11pt<br/>
                        <strong>Password:</strong> ProtecÈ›ie parolÄƒ activÄƒ<br/>
                        <strong>Separation:</strong> Active vs. Expired
                      </div>
                </div>
              </foreignObject>
            </g>

                <!-- Scheduler Service -->
            <g class="node-phys">
                  <rect x="1010" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1010" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“… Scheduler Service</div>
                      <div style="line-height: 1.6;">
                        <strong>schedule</strong> - Task Scheduling<br/>
                        <strong>threading</strong> - Background Thread<br/>
                        <strong>scheduler.py</strong> - Module Scheduler<br/>
                        <strong>Trigger:</strong> A 2-a zi lucrÄƒtoare<br/>
                        <strong>Time:</strong> 08:30 (default)<br/>
                        <strong>Mode:</strong> Lunar<br/>
                        <strong>Auto-email:</strong> Enabled
                      </div>
                </div>
              </foreignObject>
            </g>

                <!-- Email Service -->
            <g class="node-phys">
                  <rect x="1310" y="290" width="220" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1310" y="290" width="220" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“§ Email Service</div>
                      <div style="line-height: 1.6;">
                        <strong>win32com.client</strong> - Outlook<br/>
                        <strong>1 Email</strong> - Trimis<br/>
                        <strong>HTML Body</strong> - Georgia 11pt<br/>
                        <strong>Attachments:</strong> Excel Parolat<br/>
                        <strong>TO:</strong> executari@iccollect.ro,<br/>
                        actualizari@iccollect.ro<br/>
                        <strong>CC:</strong> juridic@iccollect.ro,<br/>
                        rpa@iccollect.ro
                      </div>
                </div>
              </foreignObject>
                </g>
            </g>

              <!-- LAYER 3: FILE STORAGE -->
              <text x="50" y="550" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’¾ STOCARE DATE LOCALE</text>
              
              <!-- Master Files -->
            <g class="node-phys">
                <rect x="50" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p4)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¥ Master Files (Input)</strong><br/>
                    <strong>Folder:</strong> raport_termene_licitatie_garantii/Master/<br/>
                    <strong>File 1:</strong> Rap 7*.xlsx/.xls/.xlsb<br/>
                    <strong>Sheet:</strong> "baza finala rap.3-sursa2"<br/>
                    <strong>File 2:</strong> raportGarantiiExecutareICC*.xlsx<br/>
                    <strong>Sheets:</strong> 2 (skiprows=1 sheet 1)<br/>
                    <strong>Auto-detection:</strong> os.listdir()
                </div>
              </foreignObject>
            </g>

              <!-- Result Files -->
            <g class="node-phys">
                <rect x="430" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p4)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="430" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¤ Result Files (Output)</strong><br/>
                    <strong>Folder:</strong> rapoarte_generate/<br/>
                    <strong>Subfolder:</strong> Rapoarte_Termene_Licitatie/<br/>
                    <strong>File:</strong> Raport_Termene_Licitatie_Garantii.xlsx<br/>
                    <strong>Sheets:</strong> Termene_Licitatie, Sumar<br/>
                    <strong>ProtecÈ›ie:</strong> ProtecÈ›ie parolÄƒ activÄƒ<br/>
                    <strong>Separation:</strong> Active vs. Expired
                </div>
              </foreignObject>
            </g>

              <!-- Configuration -->
              <g class="node-phys">
                <rect x="810" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p4)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="810" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">âš™ï¸ Configuration Files</strong><br/>
                    <strong>config.json</strong> - Module Config<br/>
                    â€¢ Master folder path<br/>
                    â€¢ Output folder path<br/>
                    â€¢ Email recipients (TO/CC)<br/>
                    â€¢ Scheduler settings (day/time)<br/>
                    <strong>Connection:</strong> ID garantie Capone<br/>
                    â†” AUCTION_NO (cleaned 1-1000)
                  </div>
                </foreignObject>
              </g>

              <!-- Logs -->
              <g class="node-phys">
                <rect x="1190" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p4)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1190" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“ Logging System</strong><br/>
                    <strong>File:</strong> raport_termene_licitatie.log<br/>
                    <strong>Encoding:</strong> UTF-8 (Windows fix)<br/>
                    <strong>Levels:</strong> DEBUG/INFO/WARNING/ERROR<br/>
                    <strong>Real-time:</strong> GUI logging<br/>
                    <strong>Format:</strong> [TIMESTAMP] [LEVEL] Message<br/>
                    <strong>Progress:</strong> Step-by-step tracking
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 4: USER INTERFACE -->
              <text x="50" y="850" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ‘¤ INTERFAÈšÄ‚ UTILIZATOR</text>
              
              <!-- GUI Application -->
              <g class="node-phys">
                <rect x="50" y="870" width="1500" height="160" rx="15" fill="url(#gradientClient-p4)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="870" width="1500" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 15px; font-size: 10px;">
                    <div style="font-weight: bold; font-size: 14px; margin-bottom: 10px;">ğŸ–¥ï¸ CustomTkinter GUI - Raport Termene LicitaÈ›ie GaranÈ›ii Screen</div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                      <div>
                        <strong>screen.py:</strong><br/>
                        â€¢ Folder selection (Master/Output)<br/>
                        â€¢ Email configuration<br/>
                        â€¢ Process button<br/>
                        â€¢ Real-time logging display
                      </div>
                      <div>
                        <strong>Features:</strong><br/>
                        â€¢ Dark theme<br/>
                        â€¢ Progress indicators<br/>
                        â€¢ Error messages<br/>
                        â€¢ Status updates
                      </div>
                      <div>
                        <strong>Scheduler UI:</strong><br/>
                        â€¢ Day/hour selection<br/>
                        â€¢ Start/Stop controls<br/>
                        â€¢ Status display<br/>
                        â€¢ Config save/load
                      </div>
                      <div>
                        <strong>Integration:</strong><br/>
                        â€¢ Calls processor.py<br/>
                        â€¢ Subprocess execution<br/>
                        â€¢ Output capture<br/>
                        â€¢ Error handling
                      </div>
                    </div>
                  </div>
                </foreignObject>
              </g>

              <!-- ARROWS: External to Workstation -->
              <path d="M 200 190 L 200 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p4)"/>
              
              <!-- ARROWS: Workstation Internal -->
              <path d="M 350 380 L 370 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p4)"/>
              <path d="M 690 380 L 710 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p4)"/>
              <path d="M 990 380 L 1010 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p4)"/>
              <path d="M 1290 380 L 1310 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p4)"/>
              
              <!-- ARROWS: Workstation to File Storage -->
              <path d="M 230 490 L 230 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p4)"/>
              <path d="M 610 490 L 610 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p4)"/>
              <path d="M 990 490 L 990 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p4)"/>
              <path d="M 1370 490 L 1370 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p4)"/>
              
              <!-- ARROWS: Workstation to GUI -->
              <path d="M 800 490 L 800 870" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p4)"/>
              
              <!-- ARROWS: File Storage to Workstation (feedback) -->
              <path d="M 230 570 L 230 490" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p4)" opacity="0.7"/>
              <path d="M 800 870 L 800 490" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p4)" opacity="0.7"/>
              <path d="M 200 270 L 200 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p4)" opacity="0.7"/>
          </svg>
          </div>
        </div>

        <!-- DiagramÄƒ FizicÄƒ Raport 5: Incidente -->
        <div class="physical-diagram" id="physical-diagram-5">
          <div class="diagram-container">
            <svg width="1600" height="1100" viewBox="0 0 1600 1100" min-width="1600" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ fizicÄƒ - Raport Incidente È™i Riscuri">
              <defs>
                <linearGradient id="gradientCloud-p5" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientServer-p5" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientDB-p5" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientClient-p5" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-phys-p5" markerWidth="12" markerHeight="12" refX="10" refY="4" orient="auto">
                  <polygon points="0 0, 12 4, 0 8" fill="#3576b0" />
                </marker>
              </defs>

              <!-- Background -->
              <rect width="1600" height="1100" fill="rgba(255,255,255,0.3)" rx="20"/>
              
              <!-- Title -->
              <text x="800" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ—ï¸ DIAGRAMÄ‚ FIZICÄ‚ - RAPORT INCIDENTE È˜I RISCURI</text>
              
              <!-- Layer separators -->
              <line x1="50" y1="200" x2="1550" y2="200" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="500" x2="1550" y2="500" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="800" x2="1550" y2="800" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1030" x2="1550" y2="1030" stroke="#22507a" stroke-width="2" opacity="0.3"/>

              <!-- LAYER 1: EXTERNAL SERVICES -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ SERVICII EXTERNE</text>
              
              <!-- Outlook Email Service -->
              <g class="node-phys">
                <rect x="50" y="110" width="300" height="80" rx="15" fill="url(#gradientCloud-p5)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="110" width="300" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“§ Microsoft Outlook</strong><br/>
                    <strong>Protocol:</strong> COM Interface (win32com)<br/>
                    <strong>Location:</strong> Local Installation<br/>
                    <strong>Function:</strong> Email Sending (N+1 emails)<br/>
                    <strong>Attachments:</strong> Excel Parolat per Creditor
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 2: WINDOWS WORKSTATION -->
              <text x="50" y="250" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’» WINDOWS WORKSTATION - DEPLOYMENT FIZIC</text>
              
              <!-- Main Workstation Container -->
              <g class="node-phys">
                <rect x="50" y="270" width="1500" height="220" rx="20" fill="url(#gradientServer-p5)" stroke="#22507a" stroke-width="3" filter="drop-shadow(0 12px 24px rgba(0, 0, 0, 0.2))"/>
                
                <!-- Python Runtime Section -->
                <g class="node-phys">
                  <rect x="70" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="70" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ Python Runtime</div>
                      <div style="line-height: 1.6;">
                        <strong>Python 3.8+</strong><br/>
                        <strong>pandas</strong> - Data Processing<br/>
                        <strong>openpyxl</strong> - Excel I/O<br/>
                        <strong>win32com</strong> - Outlook COM<br/>
                        <strong>secrets</strong> - Password Generation<br/>
                        <strong>string</strong> - String Utils<br/>
                        <strong>shutil</strong> - File Operations
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Raport Incidente Riscuri Module -->
                <g class="node-phys">
                  <rect x="370" y="290" width="320" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="370" y="290" width="320" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">âš ï¸ Raport Incidente Module</div>
                      <div style="line-height: 1.6;">
                        <strong>processor.py</strong> - Logic Processing<br/>
                        <strong>screen.py</strong> - GUI Interface<br/>
                        <strong>config.json</strong> - Configuration<br/>
                        <strong>Input:</strong> Lista derulanta.xlsx<br/>
                        <strong>Processing:</strong> Per Creditor<br/>
                        <strong>Mapping:</strong> Creditor â†’ Email<br/>
                        <strong>Password:</strong> Random per Excel
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Excel Processing Engine -->
                <g class="node-phys">
                  <rect x="710" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="710" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">âš¡ Excel Processing</div>
                      <div style="line-height: 1.6;">
                        <strong>openpyxl</strong> - Read/Write<br/>
                        <strong>pandas</strong> - Data Manipulation<br/>
                        <strong>Formatting:</strong> Georgia 11pt<br/>
                        <strong>Header:</strong> Colored, Bold<br/>
                        <strong>Auto-width:</strong> Columns<br/>
                        <strong>Password:</strong> secrets.token_urlsafe()<br/>
                        <strong>Per Creditor:</strong> Separate Excel
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Creditor Identification Engine -->
                <g class="node-phys">
                  <rect x="1010" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1010" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ” Creditor Identification</div>
                      <div style="line-height: 1.6;">
                        <strong>Source 1:</strong> Excel (email_to/cc)<br/>
                        <strong>Source 2:</strong> Internal Mapping<br/>
                        <strong>Source 3:</strong> Default Config<br/>
                        <strong>Matching:</strong> Exact/Partial/Keywords<br/>
                        <strong>Creditori:</strong> BT Micro, BTD CARDURI,<br/>
                        BTD CREDITE, SALT BANK<br/>
                        <strong>Fallback:</strong> juridic@iccollect.ro
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Email Service -->
                <g class="node-phys">
                  <rect x="1310" y="290" width="220" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1310" y="290" width="220" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“§ Email Service</div>
                      <div style="line-height: 1.6;">
                        <strong>win32com.client</strong> - Outlook<br/>
                        <strong>N+1 Emails</strong> - Per Creditor<br/>
                        <strong>1 Email Rezumat</strong> - ICC<br/>
                        <strong>HTML Body</strong> - Georgia 11pt<br/>
                        <strong>Attachments:</strong> Excel Parolat<br/>
                        <strong>TO/CC:</strong> Per Creditor Config
                      </div>
                    </div>
                  </foreignObject>
                </g>
              </g>

              <!-- LAYER 3: FILE STORAGE -->
              <text x="50" y="550" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’¾ STOCARE DATE LOCALE</text>
              
              <!-- Master Files -->
              <g class="node-phys">
                <rect x="50" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p5)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¥ Master Files (Input)</strong><br/>
                    <strong>Folder:</strong> raport_incidente_riscuri/Master/<br/>
                    <strong>File:</strong> Lista derulanta.xlsx<br/>
                    <strong>Columns:</strong> Creditor, email_to, email_cc<br/>
                    <strong>Auto-detection:</strong> find_lista_derulanta()<br/>
                    <strong>Processing:</strong> Read creditor list<br/>
                    <strong>Mapping:</strong> Creditor identification
                  </div>
                </foreignObject>
              </g>

              <!-- Result Files -->
              <g class="node-phys">
                <rect x="430" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p5)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="430" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¤ Result Files (Output)</strong><br/>
                    <strong>Folder:</strong> rapoarte_generate/<br/>
                    <strong>Subfolder:</strong> Incidente_Riscuri_[luna]/<br/>
                    <strong>Files:</strong> N Excel-uri (per creditor)<br/>
                    <strong>File:</strong> Rezumat_Incidente_Riscuri.xlsx<br/>
                    <strong>ProtecÈ›ie:</strong> Random password per file<br/>
                    <strong>Formatting:</strong> Georgia 11pt
                  </div>
                </foreignObject>
              </g>

              <!-- Configuration -->
              <g class="node-phys">
                <rect x="810" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p5)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="810" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">âš™ï¸ Configuration Files</strong><br/>
                    <strong>config.json</strong> - Module Config<br/>
                    â€¢ Master folder path<br/>
                    â€¢ Output folder path<br/>
                    <strong>Creditor Mapping:</strong> Internal dict<br/>
                    â€¢ BT Microfinantare IFN S.A<br/>
                    â€¢ BTD CARDURI (ERS)<br/>
                    â€¢ BTD CREDITE (BTD)<br/>
                    â€¢ SALT BANK SA<br/>
                    <strong>Default Email:</strong> juridic@iccollect.ro
                  </div>
                </foreignObject>
              </g>

              <!-- Logs -->
              <g class="node-phys">
                <rect x="1190" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p5)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1190" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“ Logging System</strong><br/>
                    <strong>File:</strong> raport_incidente_riscuri.log<br/>
                    <strong>Encoding:</strong> UTF-8 (Windows fix)<br/>
                    <strong>Levels:</strong> DEBUG/INFO/WARNING/ERROR<br/>
                    <strong>Real-time:</strong> GUI logging<br/>
                    <strong>Format:</strong> [TIMESTAMP] [LEVEL] Message<br/>
                    <strong>Tracking:</strong> Per creditor processing
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 4: USER INTERFACE -->
              <text x="50" y="850" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ‘¤ INTERFAÈšÄ‚ UTILIZATOR</text>
              
              <!-- GUI Application -->
              <g class="node-phys">
                <rect x="50" y="870" width="1500" height="160" rx="15" fill="url(#gradientClient-p5)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="870" width="1500" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 15px; font-size: 10px;">
                    <div style="font-weight: bold; font-size: 14px; margin-bottom: 10px;">ğŸ–¥ï¸ CustomTkinter GUI - Raport Incidente È™i Riscuri Screen</div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                      <div>
                        <strong>screen.py:</strong><br/>
                        â€¢ Folder selection (Master/Output)<br/>
                        â€¢ Email configuration<br/>
                        â€¢ Process button<br/>
                        â€¢ Real-time logging display
                      </div>
                      <div>
                        <strong>Features:</strong><br/>
                        â€¢ Dark theme<br/>
                        â€¢ Progress indicators<br/>
                        â€¢ Error messages<br/>
                        â€¢ Status updates
                      </div>
                      <div>
                        <strong>Processing Info:</strong><br/>
                        â€¢ Creditor list display<br/>
                        â€¢ Email status per creditor<br/>
                        â€¢ Password generation info<br/>
                        â€¢ Output file paths
                      </div>
                      <div>
                        <strong>Integration:</strong><br/>
                        â€¢ Calls processor.py<br/>
                        â€¢ Subprocess execution<br/>
                        â€¢ Output capture<br/>
                        â€¢ Error handling
                      </div>
                    </div>
                  </div>
                </foreignObject>
              </g>

              <!-- ARROWS: External to Workstation -->
              <path d="M 200 190 L 200 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p5)"/>
              
              <!-- ARROWS: Workstation Internal -->
              <path d="M 350 380 L 370 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p5)"/>
              <path d="M 690 380 L 710 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p5)"/>
              <path d="M 990 380 L 1010 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p5)"/>
              <path d="M 1290 380 L 1310 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p5)"/>
              
              <!-- ARROWS: Workstation to File Storage -->
              <path d="M 230 490 L 230 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p5)"/>
              <path d="M 610 490 L 610 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p5)"/>
              <path d="M 990 490 L 990 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p5)"/>
              <path d="M 1370 490 L 1370 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p5)"/>
              
              <!-- ARROWS: Workstation to GUI -->
              <path d="M 800 490 L 800 870" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p5)"/>
              
              <!-- ARROWS: File Storage to Workstation (feedback) -->
              <path d="M 230 570 L 230 490" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p5)" opacity="0.7"/>
              <path d="M 800 870 L 800 490" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p5)" opacity="0.7"/>
              <path d="M 200 270 L 200 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p5)" opacity="0.7"/>
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ FizicÄƒ Raport 6: Productivitate -->
        <div class="physical-diagram" id="physical-diagram-6">
          <div class="diagram-container">
            <svg width="1600" height="1100" viewBox="0 0 1600 1100" min-width="1600" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ fizicÄƒ - Raport Productivitate">
              <defs>
                <linearGradient id="gradientCloud-p6" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientServer-p6" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientDB-p6" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientClient-p6" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-phys-p6" markerWidth="12" markerHeight="12" refX="10" refY="4" orient="auto">
                  <polygon points="0 0, 12 4, 0 8" fill="#3576b0" />
                </marker>
              </defs>

              <!-- Background -->
              <rect width="1600" height="1100" fill="rgba(255,255,255,0.3)" rx="20"/>
              
              <!-- Title -->
              <text x="800" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ—ï¸ DIAGRAMÄ‚ FIZICÄ‚ - RAPORT PRODUCTIVITATE</text>
              
              <!-- Layer separators -->
              <line x1="50" y1="200" x2="1550" y2="200" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="500" x2="1550" y2="500" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="800" x2="1550" y2="800" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1030" x2="1550" y2="1030" stroke="#22507a" stroke-width="2" opacity="0.3"/>

              <!-- LAYER 1: EXTERNAL SERVICES -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ SERVICII EXTERNE</text>
              
              <!-- Outlook Email Service -->
              <g class="node-phys">
                <rect x="50" y="110" width="300" height="80" rx="15" fill="url(#gradientCloud-p6)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="110" width="300" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“§ Microsoft Outlook</strong><br/>
                    <strong>Protocol:</strong> COM Interface (win32com)<br/>
                    <strong>Location:</strong> Local Installation<br/>
                    <strong>Function:</strong> Email Sending (2 emails)<br/>
                    <strong>Attachments:</strong> Excel Files (BT + Cesionate)
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 2: WINDOWS WORKSTATION -->
              <text x="50" y="250" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’» WINDOWS WORKSTATION - DEPLOYMENT FIZIC</text>
              
              <!-- Main Workstation Container -->
              <g class="node-phys">
                <rect x="50" y="270" width="1500" height="220" rx="20" fill="url(#gradientServer-p6)" stroke="#22507a" stroke-width="3" filter="drop-shadow(0 12px 24px rgba(0, 0, 0, 0.2))"/>
                
                <!-- Python Runtime Section -->
                <g class="node-phys">
                  <rect x="70" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="70" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ Python Runtime</div>
                      <div style="line-height: 1.6;">
                        <strong>Python 3.8+</strong><br/>
                        <strong>pandas</strong> - Data Processing<br/>
                        <strong>openpyxl</strong> - Excel I/O<br/>
                        <strong>win32com</strong> - Outlook COM<br/>
                        <strong>json</strong> - Config Management<br/>
                        <strong>datetime</strong> - Date Handling<br/>
                        <strong>threading</strong> - Parallel Processing
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Raport Productivitate Module -->
                <g class="node-phys">
                  <rect x="370" y="290" width="320" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="370" y="290" width="320" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“ˆ Raport Productivitate Module</div>
                      <div style="line-height: 1.6;">
                        <strong>process_bt_productivitate.py</strong> - BT ICC<br/>
                        <strong>process_cesionate_productivitate.py</strong> - Cesionate<br/>
                        <strong>screen.py</strong> - GUI Interface<br/>
                        <strong>scheduler.py</strong> - Auto-run<br/>
                        <strong>config.json</strong> - Configuration<br/>
                        <strong>email_sender.py</strong> - Email Service<br/>
                        <strong>Processing:</strong> Parallel (BT + Cesionate)
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Excel Processing Engine -->
                <g class="node-phys">
                  <rect x="710" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="710" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">âš¡ Excel Processing</div>
                      <div style="line-height: 1.6;">
                        <strong>openpyxl</strong> - Read/Write<br/>
                        <strong>pandas</strong> - Data Manipulation<br/>
                        <strong>Owner Mapping:</strong> Task â†’ Owner<br/>
                        <strong>Formatting:</strong> Georgia 11pt<br/>
                        <strong>Header:</strong> Colored, Bold<br/>
                        <strong>Auto-width:</strong> Columns<br/>
                        <strong>Date Detection:</strong> Auto luna
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Data Analysis Engine -->
                <g class="node-phys">
                  <rect x="1010" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1010" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“Š Data Analysis</div>
                      <div style="line-height: 1.6;">
                        <strong>Productivity Metrics:</strong> Calculare<br/>
                        <strong>Grouping:</strong> Per Owner<br/>
                        <strong>Date Analysis:</strong> DATA_REZOLUTIE<br/>
                        <strong>Luna Detection:</strong> Auto from data<br/>
                        <strong>Comparative:</strong> BT vs. Cesionate<br/>
                        <strong>Statistics:</strong> Per owner metrics
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Email Service -->
                <g class="node-phys">
                  <rect x="1310" y="290" width="220" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1310" y="290" width="220" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“§ Email Service</div>
                      <div style="line-height: 1.6;">
                        <strong>win32com.client</strong> - Outlook<br/>
                        <strong>2 Emails</strong> - BT + Cesionate<br/>
                        <strong>HTML Body</strong> - Georgia 11pt<br/>
                        <strong>Attachments:</strong> Excel Files<br/>
                        <strong>TO:</strong> Configurable<br/>
                        <strong>CC:</strong> Configurable<br/>
                        <strong>Auto-send:</strong> Enabled
                      </div>
                    </div>
                  </foreignObject>
                </g>
              </g>

              <!-- LAYER 3: FILE STORAGE -->
              <text x="50" y="550" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’¾ STOCARE DATE LOCALE</text>
              
              <!-- Master Files BT -->
              <g class="node-phys">
                <rect x="50" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p6)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¥ Master Files BT (Input)</strong><br/>
                    <strong>Folder:</strong> Master BT/<br/>
                    <strong>File 1:</strong> owner.xlsx<br/>
                    <strong>File 2:</strong> Raport-Productivitate-Tasks_BT.xlsx<br/>
                    <strong>Auto-detection:</strong> File search<br/>
                    <strong>Mapping:</strong> Task â†’ Owner<br/>
                    <strong>Processing:</strong> BTProductivitateProcessor
                  </div>
                </foreignObject>
              </g>

              <!-- Master Files Cesionate -->
              <g class="node-phys">
                <rect x="430" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p6)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="430" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¥ Master Files Cesionate (Input)</strong><br/>
                    <strong>Folder:</strong> Master Cesionate/<br/>
                    <strong>File 1:</strong> owner_cesionat.xlsx<br/>
                    <strong>File 2:</strong> Raport-Productivitate-Tasks-Owner_CESIONATE.xlsx<br/>
                    <strong>Auto-detection:</strong> _find_master_files()<br/>
                    <strong>Sheet Detection:</strong> Auto pick sheet<br/>
                    <strong>Processing:</strong> CesionateProductivitateProcessor
                  </div>
                </foreignObject>
              </g>

              <!-- Result Files -->
              <g class="node-phys">
                <rect x="810" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p6)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="810" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¤ Result Files (Output)</strong><br/>
                    <strong>Folder:</strong> rapoarte_generate/<br/>
                    <strong>File BT:</strong> Raport_Productivitate_BT_[luna].xlsx<br/>
                    <strong>File Cesionate:</strong> Raport_Productivitate_Cesionate_[luna].xlsx<br/>
                    <strong>Formatting:</strong> Georgia 11pt<br/>
                    <strong>Luna:</strong> Auto-detected from data<br/>
                    <strong>Statistics:</strong> Per owner metrics
                  </div>
                </foreignObject>
              </g>

              <!-- Configuration -->
              <g class="node-phys">
                <rect x="1190" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p6)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1190" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">âš™ï¸ Configuration Files</strong><br/>
                    <strong>config.json</strong> - Module Config<br/>
                    â€¢ Master BT folder path<br/>
                    â€¢ Master Cesionate folder path<br/>
                    â€¢ Output folder path<br/>
                    â€¢ Email recipients (TO/CC)<br/>
                    â€¢ Scheduler settings<br/>
                    <strong>Auto-send:</strong> Email enabled
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 4: USER INTERFACE -->
              <text x="50" y="850" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ‘¤ INTERFAÈšÄ‚ UTILIZATOR</text>
              
              <!-- GUI Application -->
              <g class="node-phys">
                <rect x="50" y="870" width="1500" height="160" rx="15" fill="url(#gradientClient-p6)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="870" width="1500" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 15px; font-size: 10px;">
                    <div style="font-weight: bold; font-size: 14px; margin-bottom: 10px;">ğŸ–¥ï¸ CustomTkinter GUI - Raport Productivitate Screen</div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                      <div>
                        <strong>screen.py:</strong><br/>
                        â€¢ Folder selection (BT/Cesionate)<br/>
                        â€¢ Email configuration<br/>
                        â€¢ Process button<br/>
                        â€¢ Real-time logging display
                      </div>
                      <div>
                        <strong>Features:</strong><br/>
                        â€¢ Dark theme<br/>
                        â€¢ Dual progress bars (BT + Cesionate)<br/>
                        â€¢ Error messages<br/>
                        â€¢ Status updates
                      </div>
                      <div>
                        <strong>Scheduler UI:</strong><br/>
                        â€¢ Day/hour selection<br/>
                        â€¢ Start/Stop controls<br/>
                        â€¢ Status display<br/>
                        â€¢ Config save/load
                      </div>
                      <div>
                        <strong>Integration:</strong><br/>
                        â€¢ Calls process_bt_productivitate.py<br/>
                        â€¢ Calls process_cesionate_productivitate.py<br/>
                        â€¢ Parallel processing<br/>
                        â€¢ Error handling
                      </div>
                    </div>
                  </div>
                </foreignObject>
              </g>

              <!-- ARROWS: External to Workstation -->
              <path d="M 200 190 L 200 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p6)"/>
              
              <!-- ARROWS: Workstation Internal -->
              <path d="M 350 380 L 370 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p6)"/>
              <path d="M 690 380 L 710 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p6)"/>
              <path d="M 990 380 L 1010 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p6)"/>
              <path d="M 1290 380 L 1310 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p6)"/>
              
              <!-- ARROWS: Workstation to File Storage -->
              <path d="M 230 490 L 230 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p6)"/>
              <path d="M 610 490 L 610 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p6)"/>
              <path d="M 990 490 L 990 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p6)"/>
              <path d="M 1370 490 L 1370 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p6)"/>
              
              <!-- ARROWS: Workstation to GUI -->
              <path d="M 800 490 L 800 870" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p6)"/>
              
              <!-- ARROWS: File Storage to Workstation (feedback) -->
              <path d="M 230 570 L 230 490" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p6)" opacity="0.7"/>
              <path d="M 800 870 L 800 490" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p6)" opacity="0.7"/>
              <path d="M 200 270 L 200 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p6)" opacity="0.7"/>
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ FizicÄƒ Raport 7: CreanÈ›e Perimate -->
        <div class="physical-diagram" id="physical-diagram-7">
          <div class="diagram-container">
            <svg width="1600" height="1100" viewBox="0 0 1600 1100" min-width="1600" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ fizicÄƒ - Raport CreanÈ›e Perimate BT">
              <defs>
                <linearGradient id="gradientCloud-p7" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientServer-p7" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientDB-p7" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientClient-p7" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-phys-p7" markerWidth="12" markerHeight="12" refX="10" refY="4" orient="auto">
                  <polygon points="0 0, 12 4, 0 8" fill="#3576b0" />
                </marker>
              </defs>

              <!-- Background -->
              <rect width="1600" height="1100" fill="rgba(255,255,255,0.3)" rx="20"/>
              
              <!-- Title -->
              <text x="800" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ—ï¸ DIAGRAMÄ‚ FIZICÄ‚ - RAPORT CREANÈšE PERIMATE BT</text>
              
              <!-- Layer separators -->
              <line x1="50" y1="200" x2="1550" y2="200" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="500" x2="1550" y2="500" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="800" x2="1550" y2="800" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1030" x2="1550" y2="1030" stroke="#22507a" stroke-width="2" opacity="0.3"/>

              <!-- LAYER 1: EXTERNAL SERVICES -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ SERVICII EXTERNE</text>
              
              <!-- Outlook Email Service -->
              <g class="node-phys">
                <rect x="50" y="110" width="300" height="80" rx="15" fill="url(#gradientCloud-p7)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="110" width="300" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“§ Microsoft Outlook</strong><br/>
                    <strong>Protocol:</strong> COM Interface (win32com)<br/>
                    <strong>Location:</strong> Local Installation<br/>
                    <strong>Function:</strong> Email Sending (1 email)<br/>
                    <strong>Attachments:</strong> Excel Report (3 sheets)
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 2: WINDOWS WORKSTATION -->
              <text x="50" y="250" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’» WINDOWS WORKSTATION - DEPLOYMENT FIZIC</text>
              
              <!-- Main Workstation Container -->
              <g class="node-phys">
                <rect x="50" y="270" width="1500" height="220" rx="20" fill="url(#gradientServer-p7)" stroke="#22507a" stroke-width="3" filter="drop-shadow(0 12px 24px rgba(0, 0, 0, 0.2))"/>
                
                <!-- Python Runtime Section -->
                <g class="node-phys">
                  <rect x="70" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="70" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ Python Runtime</div>
                      <div style="line-height: 1.6;">
                        <strong>Python 3.8+</strong><br/>
                        <strong>pandas</strong> - Data Processing<br/>
                        <strong>openpyxl</strong> - Excel I/O<br/>
                        <strong>win32com</strong> - Outlook COM<br/>
                        <strong>argparse</strong> - CLI Arguments<br/>
                        <strong>datetime</strong> - Date Handling<br/>
                        <strong>logging</strong> - Logging System
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Raport CreanÈ›e Perimate BT Module -->
                <g class="node-phys">
                  <rect x="370" y="290" width="320" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="370" y="290" width="320" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“‹ Raport Perimate BT Module</div>
                      <div style="line-height: 1.6;">
                        <strong>processor.py</strong> - Logic Processing<br/>
                        <strong>screen.py</strong> - GUI Interface<br/>
                        <strong>config.json</strong> - Configuration<br/>
                        <strong>Input:</strong> Master Excel (latest)<br/>
                        <strong>Processing:</strong> 3 sheets read<br/>
                        <strong>Filter:</strong> Previous month<br/>
                        <strong>Detection:</strong> Perimare cases
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Excel Processing Engine -->
                <g class="node-phys">
                  <rect x="710" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="710" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">âš¡ Excel Processing</div>
                      <div style="line-height: 1.6;">
                        <strong>openpyxl</strong> - Read/Write<br/>
                        <strong>pandas</strong> - Data Manipulation<br/>
                        <strong>3 Sheets:</strong> Read & Concatenate<br/>
                        <strong>Alignment:</strong> Column matching<br/>
                        <strong>Filter:</strong> DATA_INCHIDERE_DOSAR<br/>
                        <strong>Search:</strong> "perimare" in STADIU/REZOLUTIE<br/>
                        <strong>Output:</strong> 3 sheets Excel
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Date Analysis Engine -->
                <g class="node-phys">
                  <rect x="1010" y="290" width="280" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1010" y="290" width="280" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“… Date Analysis</div>
                      <div style="line-height: 1.6;">
                        <strong>Previous Month:</strong> Auto-calculate<br/>
                        <strong>Format:</strong> MM.YYYY & RomÃ¢nÄƒ<br/>
                        <strong>Filter:</strong> DATA_INCHIDERE_DOSAR<br/>
                        <strong>Perimare Detection:</strong> Case-insensitive<br/>
                        <strong>Columns:</strong> STADIU_DOSAR,<br/>
                        REZOLUTIE_INCHIDERE<br/>
                        <strong>Summary:</strong> Statistics generation
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Email Service -->
                <g class="node-phys">
                  <rect x="1310" y="290" width="220" height="180" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1310" y="290" width="220" height="180">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“§ Email Service</div>
                      <div style="line-height: 1.6;">
                        <strong>win32com.client</strong> - Outlook<br/>
                        <strong>1 Email</strong> - Conditional content<br/>
                        <strong>HTML Body</strong> - Georgia 11pt<br/>
                        <strong>TO:</strong> alexandru.cristescu@iccollect.ro<br/>
                        <strong>CC:</strong> rpa@iccollect.ro, juridic@iccollect.ro<br/>
                        <strong>Subject:</strong> Conditional (has perimare?)
                      </div>
                    </div>
                  </foreignObject>
                </g>
              </g>

              <!-- LAYER 3: FILE STORAGE -->
              <text x="50" y="550" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’¾ STOCARE DATE LOCALE</text>
              
              <!-- Master Files -->
              <g class="node-phys">
                <rect x="50" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p7)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¥ Master Files (Input)</strong><br/>
                    <strong>Folder:</strong> raport_creante_perimate_bt/Master/<br/>
                    <strong>Selection:</strong> Latest Excel file (by mtime)<br/>
                    <strong>Exclude:</strong> ~$ temp files, Master_unificat.xlsx<br/>
                    <strong>Sheets:</strong> 3 sheets (skiprows=1)<br/>
                    <strong>Columns:</strong> DATA_INCHIDERE_DOSAR,<br/>
                    STADIU_DOSAR, REZOLUTIE_INCHIDERE
                  </div>
                </foreignObject>
              </g>

              <!-- Result Files -->
              <g class="node-phys">
                <rect x="430" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p7)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="430" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¤ Result Files (Output)</strong><br/>
                    <strong>Folder:</strong> rapoarte_generate/<br/>
                    <strong>File:</strong> Raport_Perimate_BT_[MM.YYYY]_[timestamp].xlsx<br/>
                    <strong>Sheet 1:</strong> Toate_Dosarele_Luna<br/>
                    <strong>Sheet 2:</strong> Dosare_Perimate<br/>
                    <strong>Sheet 3:</strong> Sumar (statistics)<br/>
                    <strong>Formatting:</strong> Default pandas style
                  </div>
                </foreignObject>
              </g>

              <!-- Configuration -->
              <g class="node-phys">
                <rect x="810" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p7)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="810" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">âš™ï¸ Configuration Files</strong><br/>
                    <strong>config.json</strong> - Module Config<br/>
                    â€¢ Master folder path<br/>
                    â€¢ Output folder path<br/>
                    <strong>Email Recipients:</strong> Hardcoded<br/>
                    â€¢ TO: alexandru.cristescu@iccollect.ro<br/>
                    â€¢ CC: rpa@iccollect.ro, juridic@iccollect.ro<br/>
                    <strong>CLI Args:</strong> --output, --no-email
                  </div>
                </foreignObject>
              </g>

              <!-- Logs -->
              <g class="node-phys">
                <rect x="1190" y="570" width="360" height="140" rx="15" fill="url(#gradientDB-p7)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1190" y="570" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“ Logging System</strong><br/>
                    <strong>Output:</strong> Console (print statements)<br/>
                    <strong>Format:</strong> Progress messages<br/>
                    <strong>Tracking:</strong> File selection, row counts,<br/>
                    perimare detection, report generation<br/>
                    <strong>Error Handling:</strong> FileNotFoundError,<br/>
                    Missing columns validation
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 4: USER INTERFACE -->
              <text x="50" y="850" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ‘¤ INTERFAÈšÄ‚ UTILIZATOR</text>
              
              <!-- GUI Application -->
              <g class="node-phys">
                <rect x="50" y="870" width="1500" height="160" rx="15" fill="url(#gradientClient-p7)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="870" width="1500" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 15px; font-size: 10px;">
                    <div style="font-weight: bold; font-size: 14px; margin-bottom: 10px;">ğŸ–¥ï¸ CustomTkinter GUI - Raport CreanÈ›e Perimate BT Screen</div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                      <div>
                        <strong>screen.py:</strong><br/>
                        â€¢ Folder selection (Master/Output)<br/>
                        â€¢ Email checkbox<br/>
                        â€¢ Process button<br/>
                        â€¢ Real-time logging display
                      </div>
                      <div>
                        <strong>Features:</strong><br/>
                        â€¢ Dark theme<br/>
                        â€¢ Progress indicators<br/>
                        â€¢ Error messages<br/>
                        â€¢ Status updates
                      </div>
                      <div>
                        <strong>Processing Info:</strong><br/>
                        â€¢ Previous month display<br/>
                        â€¢ Perimare cases count<br/>
                        â€¢ Report file path<br/>
                        â€¢ Email status
                      </div>
                      <div>
                        <strong>Integration:</strong><br/>
                        â€¢ Calls processor.py<br/>
                        â€¢ Subprocess execution<br/>
                        â€¢ CLI arguments passing<br/>
                        â€¢ Error handling
                      </div>
                    </div>
                  </div>
                </foreignObject>
              </g>

              <!-- ARROWS: External to Workstation -->
              <path d="M 200 190 L 200 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p7)"/>
              
              <!-- ARROWS: Workstation Internal -->
              <path d="M 350 380 L 370 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p7)"/>
              <path d="M 690 380 L 710 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p7)"/>
              <path d="M 990 380 L 1010 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p7)"/>
              <path d="M 1290 380 L 1310 380" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p7)"/>
              
              <!-- ARROWS: Workstation to File Storage -->
              <path d="M 230 490 L 230 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p7)"/>
              <path d="M 610 490 L 610 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p7)"/>
              <path d="M 990 490 L 990 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p7)"/>
              <path d="M 1370 490 L 1370 570" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p7)"/>
              
              <!-- ARROWS: Workstation to GUI -->
              <path d="M 800 490 L 800 870" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p7)"/>
              
              <!-- ARROWS: File Storage to Workstation (feedback) -->
              <path d="M 230 570 L 230 490" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p7)" opacity="0.7"/>
              <path d="M 800 870 L 800 490" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p7)" opacity="0.7"/>
              <path d="M 200 270 L 200 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p7)" opacity="0.7"/>
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ FizicÄƒ Raport 8: Portal Just -->
        <div class="physical-diagram" id="physical-diagram-8">
          <div class="diagram-container">
            <svg width="2000" height="1600" viewBox="0 0 2000 1600" min-width="2000" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ fizicÄƒ - Raport Portal JustiÈ›ie">
              <defs>
                <linearGradient id="gradientCloud-p8" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientServer-p8" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientDB-p8" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientClient-p8" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-phys-p8" markerWidth="12" markerHeight="12" refX="10" refY="4" orient="auto">
                  <polygon points="0 0, 12 4, 0 8" fill="#3576b0" />
                </marker>
              </defs>

              <!-- Background -->
              <rect width="2000" height="1600" fill="rgba(255,255,255,0.3)" rx="20"/>
              
              <!-- Title -->
              <text x="1000" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ—ï¸ DIAGRAMÄ‚ FIZICÄ‚ - RAPORT PORTAL JUSTIÈšIE</text>
              
              <!-- Layer separators -->
              <line x1="50" y1="200" x2="1950" y2="200" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="650" x2="1950" y2="650" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1100" x2="1950" y2="1100" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1500" x2="1950" y2="1500" stroke="#22507a" stroke-width="2" opacity="0.3"/>

              <!-- LAYER 1: EXTERNAL SERVICES -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ SERVICII EXTERNE</text>
              
              <!-- portal.just.ro API -->
              <g class="node-phys">
                <rect x="50" y="110" width="300" height="80" rx="15" fill="url(#gradientCloud-p8)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="110" width="300" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">âš–ï¸ portal.just.ro API</strong><br/>
                    <strong>Protocol:</strong> SOAP (Zeep)<br/>
                    <strong>Endpoint:</strong> portalquery.just.ro<br/>
                    <strong>Method:</strong> CautareDosare<br/>
                    <strong>Timeout:</strong> 10 seconds<br/>
                    <strong>Function:</strong> Query litigation data
                  </div>
                </foreignObject>
              </g>

              <!-- Outlook Email Service -->
              <g class="node-phys">
                <rect x="370" y="110" width="300" height="80" rx="15" fill="url(#gradientCloud-p8)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="370" y="110" width="300" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“§ Microsoft Outlook</strong><br/>
                    <strong>Protocol:</strong> COM Interface (win32com)<br/>
                    <strong>Location:</strong> Local Installation<br/>
                    <strong>Function:</strong> Email Sending (9 emails)<br/>
                    <strong>Recipients:</strong> 8 BRLI + 1 General
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 2: WINDOWS WORKSTATION -->
              <text x="50" y="250" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’» WINDOWS WORKSTATION - DEPLOYMENT FIZIC</text>
              
              <!-- Main Workstation Container -->
              <g class="node-phys">
                <rect x="50" y="270" width="1900" height="370" rx="20" fill="url(#gradientServer-p8)" stroke="#22507a" stroke-width="3" filter="drop-shadow(0 12px 24px rgba(0, 0, 0, 0.2))"/>
                
                <!-- Python Runtime Section -->
                <g class="node-phys">
                  <rect x="70" y="290" width="280" height="300" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="70" y="290" width="280" height="300">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ Python Runtime</div>
                      <div style="line-height: 1.6;">
                        <strong>Python 3.8+</strong><br/>
                        <strong>zeep</strong> - SOAP Client<br/>
                        <strong>requests</strong> - HTTP Session<br/>
                        <strong>pandas</strong> - Data Processing<br/>
                        <strong>openpyxl</strong> - Excel I/O<br/>
                        <strong>win32com</strong> - Outlook COM<br/>
                        <strong>plotly</strong> - Charts<br/>
                        <strong>kaleido</strong> - Chart Export<br/>
                        <strong>json</strong> - Data Serialization
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Portal JustiÈ›ie Module -->
                <g class="node-phys">
                  <rect x="410" y="290" width="360" height="350" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="410" y="290" width="360" height="350">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">âš–ï¸ Portal JustiÈ›ie Module</div>
                      <div style="line-height: 1.6;">
                        <strong>actualizare_portal_just.py</strong> - Main Logic<br/>
                        <strong>screen.py</strong> - GUI Interface<br/>
                        <strong>instanta_normalizer.py</strong> - Court Normalizer<br/>
                        <strong>chart_generator.py</strong> - Plotly Charts<br/>
                        <strong>generate_html_from_excel.py</strong> - HTML Generator<br/>
                        <strong>Input:</strong> Excel Master (Dosar instanta)<br/>
                        <strong>Processing:</strong> API Query Loop<br/>
                        <strong>Output:</strong> Excel, HTML, Charts, Emails
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- API Client -->
                <g class="node-phys">
                  <rect x="790" y="290" width="320" height="350" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="790" y="290" width="320" height="350">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸŒ API Client</div>
                      <div style="line-height: 1.6;">
                        <strong>zeep.Client</strong> - SOAP Client<br/>
                        <strong>HistoryPlugin</strong> - Debugging<br/>
                        <strong>Session</strong> - HTTP Transport<br/>
                        <strong>Timeout:</strong> 10 seconds<br/>
                        <strong>Method:</strong> CautareDosare<br/>
                        <strong>Input:</strong> numarDosar<br/>
                        <strong>Output:</strong> Litigation data<br/>
                        <strong>Error Handling:</strong> Retry logic
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Data Extraction -->
                <g class="node-phys">
                  <rect x="1130" y="290" width="320" height="350" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1130" y="290" width="320" height="350">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“Š Data Extraction</div>
                      <div style="line-height: 1.6;">
                        <strong>Extract:</strong> Instanta, Obiect, Data,<br/>
                        Categorie, Termen, Solutie,<br/>
                        Complet, Camera, Tip sedinta,<br/>
                        Numar sedinte, Tert poprit,<br/>
                        Reclamant, Parat, Toate partile<br/>
                        <strong>Filter:</strong> Newest dossier<br/>
                        <strong>Normalize:</strong> Court names<br/>
                        <strong>Validate:</strong> Data format
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Excel Formatting -->
                <g class="node-phys">
                  <rect x="1470" y="290" width="230" height="350" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1470" y="290" width="230" height="350">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“‹ Excel Formatting</div>
                      <div style="line-height: 1.6;">
                        <strong>openpyxl</strong> - Table Format<br/>
                        <strong>Table Style:</strong> Professional<br/>
                        <strong>Header:</strong> Colored<br/>
                        <strong>Auto-width:</strong> Columns<br/>
                        <strong>Filters:</strong> Enabled<br/>
                        <strong>Font:</strong> Georgia 11pt<br/>
                        <strong>Output:</strong> Professional table
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Chart Generator -->
                <g class="node-phys">
                  <rect x="1720" y="290" width="210" height="350" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1720" y="290" width="210" height="350">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“Š Chart Generator</div>
                      <div style="line-height: 1.6;">
                        <strong>plotly</strong> - Interactive Charts<br/>
                        <strong>kaleido</strong> - PDF Export<br/>
                        <strong>Types:</strong> Sunburst, Bar, Pie<br/>
                        <strong>Format:</strong> PDF + HTML<br/>
                        <strong>Embedded:</strong> In HTML Sumar<br/>
                        <strong>Output:</strong> Charts folder
                      </div>
                    </div>
                  </foreignObject>
                </g>
              </g>

              <!-- HTML Summary Generator -->
              <g class="node-phys" style="transform: translate(50px, 650px);">
                <rect x="0" y="0" width="400" height="160" rx="15" fill="url(#gradientServer-p8)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="0" y="0" width="400" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“„ HTML Summary Generator</strong><br/>
                    <strong>generate_html_from_excel.py</strong> - HTML Template<br/>
                    <strong>analyze_data()</strong> - Data Analysis<br/>
                    <strong>generate_html_with_data()</strong> - HTML Generation<br/>
                    <strong>Output:</strong> "Sumar Executiv â€“ Analiza Litigii NaÈ›ionale.html"<br/>
                    <strong>Data:</strong> Hardcoded in HTML<br/>
                    <strong>JSON:</strong> litigii_data.json<br/>
                    <strong>Content:</strong> Dashboard with statistics
                  </div>
                </foreignObject>
              </g>

              <!-- Email Service -->
              <g class="node-phys" style="transform: translate(470px, 650px);">
                <rect x="0" y="0" width="400" height="160" rx="15" fill="url(#gradientServer-p8)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="0" y="0" width="400" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“§ Email Service</strong><br/>
                    <strong>win32com</strong> - Outlook<br/>
                    <strong>9 Emails:</strong> 8 BRLI + 1 General<br/>
                    <strong>BRLI:</strong> Moldova, Constanta, Pitesti,<br/>
                    Tg. Jiu, Arad, Cluj, Tg. Mures, Bucuresti<br/>
                    <strong>General:</strong> juridic@iccollect.ro<br/>
                    <strong>Attachments:</strong> Filtered Excel + HTML<br/>
                    <strong>Format:</strong> HTML body
                  </div>
                </foreignObject>
              </g>

              <!-- Checkpoint System -->
              <g class="node-phys" style="transform: translate(890px, 650px);">
                <rect x="0" y="0" width="400" height="160" rx="15" fill="url(#gradientServer-p8)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="0" y="0" width="400" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ’¾ Checkpoint System</strong><br/>
                    <strong>Function:</strong> Suspend/Resume<br/>
                    <strong>Storage:</strong> checkpoint.json<br/>
                    <strong>Data:</strong> Processed dosare list<br/>
                    <strong>Resume:</strong> Skip processed<br/>
                    <strong>Error Recovery:</strong> Continue from last<br/>
                    <strong>Location:</strong> Output folder<br/>
                    <strong>Auto-clean:</strong> On completion
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 3: FILE STORAGE -->
              <text x="50" y="1100" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’¾ STOCARE DATE LOCALE</text>
              
              <!-- Master Files -->
              <g class="node-phys">
                <rect x="50" y="1120" width="400" height="160" rx="15" fill="url(#gradientDB-p8)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="1120" width="400" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¥ Master Files (Input)</strong><br/>
                    <strong>Folder:</strong> raport_portal_just/Master/<br/>
                    <strong>File:</strong> Excel with "Dosar instanta" column<br/>
                    <strong>Column:</strong> Dosar instanta (dossier numbers)<br/>
                    <strong>Format:</strong> Various formats<br/>
                    <strong>Validation:</strong> Format check<br/>
                    <strong>Processing:</strong> Loop per dossier
                  </div>
                </foreignObject>
              </g>

              <!-- Result Files -->
              <g class="node-phys">
                <rect x="470" y="1120" width="400" height="160" rx="15" fill="url(#gradientDB-p8)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="470" y="1120" width="400" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¤ Result Files (Output)</strong><br/>
                    <strong>Folder:</strong> raport_portal_just/Rezultate/<br/>
                    <strong>Excel:</strong> Litigii_*.xlsx<br/>
                    <strong>HTML:</strong> "Sumar Executiv â€“ Analiza Litigii NaÈ›ionale.html"<br/>
                    <strong>JSON:</strong> litigii_data.json<br/>
                    <strong>Charts:</strong> PDF + HTML (Plotly)<br/>
                    <strong>Checkpoint:</strong> checkpoint.json<br/>
                    <strong>Formatting:</strong> Professional table
                  </div>
                </foreignObject>
              </g>

              <!-- Configuration -->
              <g class="node-phys">
                <rect x="890" y="1120" width="400" height="160" rx="15" fill="url(#gradientDB-p8)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="890" y="1120" width="400" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">âš™ï¸ Configuration Files</strong><br/>
                    <strong>portal_just_config.json</strong> - API Config<br/>
                    <strong>email_config.json</strong> - Email Recipients<br/>
                    <strong>BRLI Mapping:</strong> 8 BRLI emails<br/>
                    <strong>API Timeout:</strong> 10 seconds<br/>
                    <strong>Retry Logic:</strong> Configurable<br/>
                    <strong>Output Paths:</strong> Configurable
                  </div>
                </foreignObject>
              </g>

              <!-- Logs -->
              <g class="node-phys">
                <rect x="1310" y="1120" width="400" height="160" rx="15" fill="url(#gradientDB-p8)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1310" y="1120" width="400" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“ Logging System</strong><br/>
                    <strong>Output:</strong> Console + GUI<br/>
                    <strong>Format:</strong> Real-time updates<br/>
                    <strong>Tracking:</strong> API queries, data extraction,<br/>
                    Excel generation, HTML generation,<br/>
                    chart generation, email sending,<br/>
                    checkpoint saves, error handling<br/>
                    <strong>Progress:</strong> Per dossier status
                  </div>
                </foreignObject>
              </g>

              <!-- External Tools -->
              <g class="node-phys">
                <rect x="1730" y="1120" width="220" height="160" rx="15" fill="url(#gradientDB-p8)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1730" y="1120" width="220" height="160">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ”§ External Tools</strong><br/>
                    <strong>instanta_normalizer.py</strong> - Court name normalization<br/>
                    <strong>chart_generator.py</strong> - Plotly chart creation<br/>
                    <strong>generate_html_from_excel.py</strong> - HTML template engine<br/>
                    <strong>Location:</strong> Module folder + subfolders
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 4: USER INTERFACE -->
              <text x="50" y="1320" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ‘¤ INTERFAÈšÄ‚ UTILIZATOR</text>
              
              <!-- GUI Application -->
              <g class="node-phys">
                <rect x="50" y="1340" width="1900" height="200" rx="15" fill="url(#gradientClient-p8)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="1340" width="1900" height="200">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 15px; font-size: 10px;">
                    <div style="font-weight: bold; font-size: 14px; margin-bottom: 10px;">ğŸ–¥ï¸ CustomTkinter GUI - Portal JustiÈ›ie Screen</div>
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px;">
                      <div>
                        <strong>screen.py:</strong><br/>
                        â€¢ Folder selection (Master/Output)<br/>
                        â€¢ Email checkbox<br/>
                        â€¢ Process button<br/>
                        â€¢ Real-time logging display<br/>
                        â€¢ Progress bar
                      </div>
                      <div>
                        <strong>Features:</strong><br/>
                        â€¢ Dark theme<br/>
                        â€¢ Progress indicators<br/>
                        â€¢ Error messages<br/>
                        â€¢ Status updates<br/>
                        â€¢ Checkpoint status
                      </div>
                      <div>
                        <strong>Processing Info:</strong><br/>
                        â€¢ API query status<br/>
                        â€¢ Data extraction progress<br/>
                        â€¢ Excel generation<br/>
                        â€¢ HTML generation<br/>
                        â€¢ Chart generation<br/>
                        â€¢ Email sending status
                      </div>
                      <div>
                        <strong>Integration:</strong><br/>
                        â€¢ Calls actualizare_portal_just.py<br/>
                        â€¢ Subprocess execution<br/>
                        â€¢ CLI arguments passing<br/>
                        â€¢ Error handling<br/>
                        â€¢ Checkpoint resume
                      </div>
                      <div>
                        <strong>Output Display:</strong><br/>
                        â€¢ Excel file generated<br/>
                        â€¢ HTML summary created<br/>
                        â€¢ Charts generated<br/>
                        â€¢ 9 emails sent<br/>
                        â€¢ File paths display<br/>
                        â€¢ Statistics summary
                      </div>
                    </div>
                  </div>
                </foreignObject>
              </g>

              <!-- ARROWS: External to Workstation -->
              <path d="M 200 190 L 200 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              <path d="M 520 190 L 520 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              
              <!-- ARROWS: Workstation Internal -->
              <path d="M 350 440 L 370 440" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              <path d="M 690 440 L 710 440" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              <path d="M 990 440 L 1010 440" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              <path d="M 1290 440 L 1310 440" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              <path d="M 1510 440 L 1530 440" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              
              <!-- ARROWS: Workstation to Additional Services -->
              <path d="M 250 640 L 250 650" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              <path d="M 670 640 L 670 650" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              <path d="M 1090 640 L 1090 650" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              
              <!-- ARROWS: Workstation to File Storage -->
              <path d="M 250 810 L 250 1120" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              <path d="M 670 810 L 670 1120" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              <path d="M 1090 810 L 1090 1120" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              <path d="M 1510 810 L 1510 1120" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              <path d="M 1840 810 L 1840 1120" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              
              <!-- ARROWS: Workstation to GUI -->
              <path d="M 1000 810 L 1000 1340" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p8)"/>
              
              <!-- ARROWS: File Storage to Workstation (feedback) -->
              <path d="M 250 1120 L 250 810" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p8)" opacity="0.7"/>
              <path d="M 1000 1340 L 1000 810" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p8)" opacity="0.7"/>
              <path d="M 200 270 L 200 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p8)" opacity="0.7"/>
              <path d="M 520 270 L 520 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p8)" opacity="0.7"/>
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ FizicÄƒ Raport 9: SIUI -->
        <div class="physical-diagram" id="physical-diagram-9">
          <div class="diagram-container">
            <svg width="1800" height="1300" viewBox="0 0 1800 1300" min-width="1800" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ fizicÄƒ - Raport SIUI CASAN">
              <defs>
                <linearGradient id="gradientCloud-p9" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientServer-p9" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientDB-p9" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientClient-p9" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-phys-p9" markerWidth="12" markerHeight="12" refX="10" refY="4" orient="auto">
                  <polygon points="0 0, 12 4, 0 8" fill="#3576b0" />
                </marker>
              </defs>

              <!-- Background -->
              <rect width="1800" height="1300" fill="rgba(255,255,255,0.3)" rx="20"/>
              
              <!-- Title -->
              <text x="900" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ—ï¸ DIAGRAMÄ‚ FIZICÄ‚ - INTEROGARE SIUI (CASAN)</text>
              
              <!-- Layer separators -->
              <line x1="50" y1="200" x2="1750" y2="200" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="550" x2="1750" y2="550" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="900" x2="1750" y2="900" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1230" x2="1750" y2="1230" stroke="#22507a" stroke-width="2" opacity="0.3"/>

              <!-- LAYER 1: EXTERNAL SERVICES -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ SERVICII EXTERNE</text>
              
              <!-- CASAN Web Service -->
              <g class="node-phys">
                <rect x="50" y="110" width="350" height="80" rx="15" fill="url(#gradientCloud-p9)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="110" width="350" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ†” CASAN Web Portal</strong><br/>
                    <strong>URL:</strong> https://siui.casan.ro/asigurati/<br/>
                    <strong>Protocol:</strong> HTTP/HTTPS<br/>
                    <strong>Function:</strong> CNP Query + CAPTCHA<br/>
                    <strong>Response:</strong> Asigurat/Neasigurat/Decedat<br/>
                    <strong>Protection:</strong> CAPTCHA challenge
                  </div>
                </foreignObject>
              </g>

              <!-- Outlook Email Service -->
              <g class="node-phys">
                <rect x="420" y="110" width="300" height="80" rx="15" fill="url(#gradientCloud-p9)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="420" y="110" width="300" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“§ Microsoft Outlook</strong><br/>
                    <strong>Protocol:</strong> COM Interface (win32com)<br/>
                    <strong>Location:</strong> Local Installation<br/>
                    <strong>Function:</strong> Email Sending (optional)<br/>
                    <strong>Attachments:</strong> Excel Report
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 2: WINDOWS WORKSTATION -->
              <text x="50" y="250" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’» WINDOWS WORKSTATION - DEPLOYMENT FIZIC</text>
              
              <!-- Main Workstation Container -->
              <g class="node-phys">
                <rect x="50" y="270" width="1700" height="270" rx="20" fill="url(#gradientServer-p9)" stroke="#22507a" stroke-width="3" filter="drop-shadow(0 12px 24px rgba(0, 0, 0, 0.2))"/>
                
                <!-- Python Runtime Section -->
                <g class="node-phys">
                  <rect x="70" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="70" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ Python Runtime</div>
                      <div style="line-height: 1.6;">
                        <strong>Python 3.8+</strong><br/>
                        <strong>pandas</strong> - Data Processing<br/>
                        <strong>openpyxl</strong> - Excel I/O<br/>
                        <strong>playwright</strong> - Browser Automation<br/>
                        <strong>pytesseract</strong> - OCR Engine<br/>
                        <strong>opencv-python</strong> - Image Processing<br/>
                        <strong>Pillow</strong> - Image I/O<br/>
                        <strong>numpy</strong> - Array Operations<br/>
                        <strong>win32com</strong> - Outlook COM
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Raport SIUI Module -->
                <g class="node-phys">
                  <rect x="370" y="290" width="320" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="370" y="290" width="320" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ†” Raport SIUI Module</div>
                      <div style="line-height: 1.6;">
                        <strong>processor.py</strong> - Main Logic<br/>
                        <strong>screen.py</strong> - GUI Interface<br/>
                        <strong>casan_scraper.py</strong> - Web Scraper<br/>
                        <strong>check_dependencies.py</strong> - Validation<br/>
                        <strong>install_dependencies.py</strong> - Setup<br/>
                        <strong>Input:</strong> Excel Master (CNP column)<br/>
                        <strong>Processing:</strong> CNP parsing + CASAN query<br/>
                        <strong>Output:</strong> Excel with Status CASAN
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Browser Automation Engine -->
                <g class="node-phys">
                  <rect x="710" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="710" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸŒ Browser Automation</div>
                      <div style="line-height: 1.6;">
                        <strong>playwright</strong> - Chromium Browser<br/>
                        <strong>Mode:</strong> Headless (hidden)<br/>
                        <strong>User-Agent:</strong> Rotation (4 variants)<br/>
                        <strong>Delays:</strong> Random 3-8 seconds<br/>
                        <strong>Navigation:</strong> CASAN URL<br/>
                        <strong>Form Fill:</strong> CNP input<br/>
                        <strong>CAPTCHA:</strong> Image extraction<br/>
                        <strong>Submit:</strong> Form submission
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- OCR & Image Processing -->
                <g class="node-phys">
                  <rect x="1010" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1010" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ” OCR & Image Processing</div>
                      <div style="line-height: 1.6;">
                        <strong>Tesseract OCR</strong> - Text Recognition<br/>
                        <strong>OpenCV</strong> - Image Preprocessing<br/>
                        <strong>4 Methods:</strong> Threshold, Adaptive,<br/>
                        Otsu, Mean<br/>
                        <strong>Pillow</strong> - Image I/O<br/>
                        <strong>Retry Logic:</strong> Max 3 attempts<br/>
                        <strong>Success Rate:</strong> 70-90%
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- CNP Processing Engine -->
                <g class="node-phys">
                  <rect x="1310" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1310" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ†” CNP Processing</div>
                      <div style="line-height: 1.6;">
                        <strong>Validation:</strong> Control digit check<br/>
                        <strong>Parsing:</strong> Sex, Birth Date, Age<br/>
                        <strong>JudeÈ›:</strong> County lookup (52 codes)<br/>
                        <strong>CJP:</strong> Age >= 65 check<br/>
                        <strong>Excel:</strong> Column insertion<br/>
                        <strong>Format:</strong> Date, Age, Text
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Email Service -->
                <g class="node-phys">
                  <rect x="1610" y="290" width="120" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1610" y="290" width="120" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“§ Email Service</div>
                      <div style="line-height: 1.6;">
                        <strong>win32com</strong> - Outlook<br/>
                        <strong>Optional:</strong> --no-email flag<br/>
                        <strong>HTML Body</strong> - Georgia 11pt<br/>
                        <strong>Attachments:</strong> Excel Report<br/>
                        <strong>Recipients:</strong> Configurable
                      </div>
                    </div>
                  </foreignObject>
                </g>
              </g>

              <!-- LAYER 3: FILE STORAGE -->
              <text x="50" y="600" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’¾ STOCARE DATE LOCALE</text>
              
              <!-- Master Files -->
              <g class="node-phys">
                <rect x="50" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p9)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¥ Master Files (Input)</strong><br/>
                    <strong>Folder:</strong> raport_interogare_siui/Master/<br/>
                    <strong>File:</strong> *Master*.xlsx/.xls<br/>
                    <strong>Column A:</strong> Nume<br/>
                    <strong>Column B:</strong> CNP<br/>
                    <strong>Auto-detection:</strong> find_master_file()<br/>
                    <strong>Validation:</strong> CNP format check
                  </div>
                </foreignObject>
              </g>

              <!-- Result Files -->
              <g class="node-phys">
                <rect x="430" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p9)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="430" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¤ Result Files (Output)</strong><br/>
                    <strong>Folder:</strong> rapoarte_generate/<br/>
                    <strong>File:</strong> Interogare_SIUI_[timestamp].xlsx<br/>
                    <strong>Columns:</strong> Sex, Data naÈ™terii, VÃ¢rsta,<br/>
                    JudeÈ›, CJP, Status CASAN<br/>
                    <strong>Formatting:</strong> Default openpyxl<br/>
                    <strong>Progress:</strong> Save every 10 CNP-uri
                  </div>
                </foreignObject>
              </g>

              <!-- Configuration -->
              <g class="node-phys">
                <rect x="810" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p9)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="810" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">âš™ï¸ Configuration Files</strong><br/>
                    <strong>Tesseract Path:</strong> Auto-detection<br/>
                    â€¢ C:\Program Files\Tesseract-OCR\<br/>
                    â€¢ System PATH<br/>
                    <strong>CLI Args:</strong> --output, --no-email,<br/>
                    --casan-auto<br/>
                    <strong>JudeÈ›e:</strong> 52 codes hardcoded
                  </div>
                </foreignObject>
              </g>

              <!-- Logs -->
              <g class="node-phys">
                <rect x="1190" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p9)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1190" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“ Logging System</strong><br/>
                    <strong>File:</strong> siui_casan.log<br/>
                    <strong>Encoding:</strong> UTF-8 (Windows fix)<br/>
                    <strong>Levels:</strong> DEBUG/INFO/WARNING/ERROR<br/>
                    <strong>Tracking:</strong> Per CNP processing,<br/>
                    CAPTCHA attempts, API calls, errors<br/>
                    <strong>Real-time:</strong> GUI logging display
                  </div>
                </foreignObject>
              </g>

              <!-- External Tools -->
              <g class="node-phys">
                <rect x="1570" y="620" width="180" height="140" rx="15" fill="url(#gradientDB-p9)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1570" y="620" width="180" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ”§ External Tools</strong><br/>
                    <strong>Tesseract OCR:</strong> System install<br/>
                    â€¢ Windows: C:\Program Files\<br/>
                    â€¢ Linux: apt-get install<br/>
                    <strong>Playwright:</strong> Chromium browser<br/>
                    â€¢ playwright install chromium<br/>
                    <strong>Check:</strong> check_dependencies.py
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 4: USER INTERFACE -->
              <text x="50" y="950" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ‘¤ INTERFAÈšÄ‚ UTILIZATOR</text>
              
              <!-- GUI Application -->
              <g class="node-phys">
                <rect x="50" y="970" width="1700" height="260" rx="15" fill="url(#gradientClient-p9)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="970" width="1700" height="260">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 15px; font-size: 10px;">
                    <div style="font-weight: bold; font-size: 14px; margin-bottom: 10px;">ğŸ–¥ï¸ CustomTkinter GUI - Interogare SIUI Screen</div>
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px;">
                      <div>
                        <strong>screen.py:</strong><br/>
                        â€¢ Folder selection (Master/Output)<br/>
                        â€¢ CASAN checkbox (--casan-auto)<br/>
                        â€¢ Email checkbox<br/>
                        â€¢ Process button<br/>
                        â€¢ Real-time logging display
                      </div>
                      <div>
                        <strong>Features:</strong><br/>
                        â€¢ Dark theme<br/>
                        â€¢ Progress indicators<br/>
                        â€¢ Error messages<br/>
                        â€¢ Status updates<br/>
                        â€¢ Dependency warnings
                      </div>
                      <div>
                        <strong>Processing Info:</strong><br/>
                        â€¢ CNP count display<br/>
                        â€¢ CASAN query progress<br/>
                        â€¢ CAPTCHA success rate<br/>
                        â€¢ Output file path<br/>
                        â€¢ Processing time
                      </div>
                      <div>
                        <strong>Integration:</strong><br/>
                        â€¢ Calls processor.py<br/>
                        â€¢ Subprocess execution<br/>
                        â€¢ CLI arguments passing<br/>
                        â€¢ UTF-8 encoding fix<br/>
                        â€¢ Error handling
                      </div>
                      <div>
                        <strong>Dependencies:</strong><br/>
                        â€¢ check_dependencies.py<br/>
                        â€¢ install_dependencies.py<br/>
                        â€¢ Auto-validation<br/>
                        â€¢ Warning messages<br/>
                        â€¢ Graceful degradation
                      </div>
                    </div>
                  </div>
                </foreignObject>
              </g>

              <!-- ARROWS: External to Workstation -->
              <path d="M 225 190 L 225 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p9)"/>
              <path d="M 570 190 L 570 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p9)"/>
              
              <!-- ARROWS: Workstation Internal -->
              <path d="M 350 410 L 370 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p9)"/>
              <path d="M 690 410 L 710 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p9)"/>
              <path d="M 990 410 L 1010 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p9)"/>
              <path d="M 1290 410 L 1310 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p9)"/>
              <path d="M 1590 410 L 1610 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p9)"/>
              
              <!-- ARROWS: Workstation to File Storage -->
              <path d="M 230 540 L 230 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p9)"/>
              <path d="M 610 540 L 610 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p9)"/>
              <path d="M 990 540 L 990 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p9)"/>
              <path d="M 1370 540 L 1370 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p9)"/>
              <path d="M 1660 540 L 1660 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p9)"/>
              
              <!-- ARROWS: Workstation to GUI -->
              <path d="M 900 540 L 900 970" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p9)"/>
              
              <!-- ARROWS: File Storage to Workstation (feedback) -->
              <path d="M 230 620 L 230 540" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p9)" opacity="0.7"/>
              <path d="M 900 970 L 900 540" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p9)" opacity="0.7"/>
              <path d="M 225 270 L 225 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p9)" opacity="0.7"/>
              <path d="M 570 270 L 570 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p9)" opacity="0.7"/>
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ FizicÄƒ Raport 10: AnalizÄƒ Perimare -->
        <div class="physical-diagram" id="physical-diagram-10">
          <div class="diagram-container">
            <svg width="1800" height="1300" viewBox="0 0 1800 1300" min-width="1800" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ fizicÄƒ - Raport AnalizÄƒ Perimare BT">
              <defs>
                <linearGradient id="gradientCloud-p10" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientServer-p10" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientDB-p10" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientClient-p10" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-phys-p10" markerWidth="12" markerHeight="12" refX="10" refY="4" orient="auto">
                  <polygon points="0 0, 12 4, 0 8" fill="#3576b0" />
                </marker>
              </defs>

              <!-- Background -->
              <rect width="1800" height="1300" fill="rgba(255,255,255,0.3)" rx="20"/>
              
              <!-- Title -->
              <text x="900" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ—ï¸ DIAGRAMÄ‚ FIZICÄ‚ - ANALIZÄ‚ PERIMARE BT</text>
              
              <!-- Layer separators -->
              <line x1="50" y1="200" x2="1750" y2="200" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="550" x2="1750" y2="550" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="900" x2="1750" y2="900" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1230" x2="1750" y2="1230" stroke="#22507a" stroke-width="2" opacity="0.3"/>

              <!-- LAYER 1: EXTERNAL SERVICES -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ SERVICII EXTERNE</text>
              
              <!-- Outlook Email Service -->
              <g class="node-phys">
                <rect x="50" y="110" width="300" height="80" rx="15" fill="url(#gradientCloud-p10)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="110" width="300" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“§ Microsoft Outlook</strong><br/>
                    <strong>Protocol:</strong> COM Interface (win32com)<br/>
                    <strong>Location:</strong> Local Installation<br/>
                    <strong>Function:</strong> Email Sending (9+1 emails)<br/>
                    <strong>Attachments:</strong> Excel Files (9 cosmetizate)
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 2: WINDOWS WORKSTATION -->
              <text x="50" y="250" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’» WINDOWS WORKSTATION - DEPLOYMENT FIZIC</text>
              
              <!-- Main Workstation Container -->
              <g class="node-phys">
                <rect x="50" y="270" width="1700" height="270" rx="20" fill="url(#gradientServer-p10)" stroke="#22507a" stroke-width="3" filter="drop-shadow(0 12px 24px rgba(0, 0, 0, 0.2))"/>
                
                <!-- Python Runtime Section -->
                <g class="node-phys">
                  <rect x="70" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="70" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ Python Runtime</div>
                      <div style="line-height: 1.6;">
                        <strong>Python 3.8+</strong><br/>
                        <strong>pandas</strong> - Data Processing<br/>
                        <strong>openpyxl</strong> - Excel I/O<br/>
                        <strong>win32com</strong> - Outlook COM<br/>
                        <strong>plotly</strong> - Charts Generation<br/>
                        <strong>kaleido</strong> - PNG Export (optional)<br/>
                        <strong>base64</strong> - Image Encoding<br/>
                        <strong>logging</strong> - Logging System
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Raport AnalizÄƒ Perimare BT Module -->
                <g class="node-phys">
                  <rect x="370" y="290" width="320" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="370" y="290" width="320" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“Š AnalizÄƒ Perimare Module</div>
                      <div style="line-height: 1.6;">
                        <strong>processor.py</strong> - Main Logic<br/>
                        <strong>screen.py</strong> - GUI Interface<br/>
                        <strong>config.json</strong> - Configuration<br/>
                        <strong>Input:</strong> 2 Excel files<br/>
                        <strong>Processing:</strong> VLOOKUP + Filtering<br/>
                        <strong>Categories:</strong> 9 separations<br/>
                        <strong>Output:</strong> 9 Excel + 9 Emails
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Excel Processing Engine -->
                <g class="node-phys">
                  <rect x="710" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="710" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">âš¡ Excel Processing</div>
                      <div style="line-height: 1.6;">
                        <strong>openpyxl</strong> - Read/Write<br/>
                        <strong>pandas</strong> - Data Manipulation<br/>
                        <strong>3 Sheets:</strong> Read & Concatenate<br/>
                        <strong>VLOOKUP:</strong> EXEC_FILE_NO â†” File Number<br/>
                        <strong>Filter:</strong> STADIU_DOSAR exclusion<br/>
                        <strong>Complete:</strong> OWNER_ICC + @iccollect.ro<br/>
                        <strong>Formatting:</strong> Georgia 11pt, Colors
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Data Analysis Engine -->
                <g class="node-phys">
                  <rect x="1010" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1010" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“Š Data Analysis</div>
                      <div style="line-height: 1.6;">
                        <strong>9 Categories:</strong> Ãnchise, Ãncuviiat,<br/>
                        Ãnchidere blank, Suspendate,<br/>
                        Angajament, Licitatii,<br/>
                        Dosar incuviintat, Restul,<br/>
                        Statistici Finale<br/>
                        <strong>Separation:</strong> Per category<br/>
                        <strong>Statistics:</strong> Per category count
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Chart Generator -->
                <g class="node-phys">
                  <rect x="1310" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1310" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“ˆ Chart Generator</div>
                      <div style="line-height: 1.6;">
                        <strong>plotly</strong> - Interactive Charts<br/>
                        <strong>kaleido</strong> - PNG Export (optional)<br/>
                        <strong>base64</strong> - Image Encoding<br/>
                        <strong>Embedded:</strong> Charts in Email<br/>
                        <strong>Types:</strong> Bar, Pie, Line<br/>
                        <strong>Output:</strong> HTML + PNG
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Email Service -->
                <g class="node-phys">
                  <rect x="1610" y="290" width="120" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1610" y="290" width="120" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“§ Email Service</div>
                      <div style="line-height: 1.6;">
                        <strong>win32com</strong> - Outlook<br/>
                        <strong>9 Emails</strong> - Per category<br/>
                        <strong>1 Email</strong> - Statistici Finale<br/>
                        <strong>HTML Body</strong> - Georgia 11pt<br/>
                        <strong>Attachments:</strong> Excel per category<br/>
                        <strong>TO/CC:</strong> Per category config
                      </div>
                    </div>
                  </foreignObject>
                </g>
              </g>

              <!-- LAYER 3: FILE STORAGE -->
              <text x="50" y="600" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’¾ STOCARE DATE LOCALE</text>
              
              <!-- Master Files -->
              <g class="node-phys">
                <rect x="50" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p10)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¥ Master Files (Input)</strong><br/>
                    <strong>Folder:</strong> raport_analiza_perimare_bt/Master/<br/>
                    <strong>File 1:</strong> Analiza perimare BT.xlsx<br/>
                    <strong>File 2:</strong> Raport-Master-ICC_*.xlsx<br/>
                    <strong>Columns:</strong> File Number, Analiza perimare<br/>
                    <strong>Sheets:</strong> 3 sheets (Master)<br/>
                    <strong>Auto-detection:</strong> find_analiza_perimare_file()
                  </div>
                </foreignObject>
              </g>

              <!-- Result Files -->
              <g class="node-phys">
                <rect x="430" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p10)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="430" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¤ Result Files (Output)</strong><br/>
                    <strong>Folder:</strong> rapoarte_generate/<br/>
                    <strong>File 1:</strong> Analiza_Perimare_BT_[timestamp].xlsx<br/>
                    <strong>Files 2-10:</strong> 9 Excel-uri cosmetizate<br/>
                    <strong>Formatting:</strong> Georgia 11pt, Colored header<br/>
                    <strong>Auto-width:</strong> Columns<br/>
                    <strong>Freeze:</strong> Panes
                  </div>
                </foreignObject>
              </g>

              <!-- Configuration -->
              <g class="node-phys">
                <rect x="810" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p10)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="810" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">âš™ï¸ Configuration Files</strong><br/>
                    <strong>config.json</strong> - Module Config<br/>
                    â€¢ Master folder path<br/>
                    â€¢ Output folder path<br/>
                    <strong>Email Recipients:</strong> Per category<br/>
                    â€¢ 9 different TO/CC configs<br/>
                    <strong>CLI Args:</strong> --output, --no-email
                  </div>
                </foreignObject>
              </g>

              <!-- Logs -->
              <g class="node-phys">
                <rect x="1190" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p10)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1190" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“ Logging System</strong><br/>
                    <strong>Output:</strong> Console + File<br/>
                    <strong>Format:</strong> Progress messages<br/>
                    <strong>Tracking:</strong> File reading, VLOOKUP,<br/>
                    filtering, category separation,<br/>
                    Excel generation, email sending<br/>
                    <strong>Error Handling:</strong> FileNotFoundError,<br/>
                    Missing columns validation
                  </div>
                </foreignObject>
              </g>

              <!-- Category Storage -->
              <g class="node-phys">
                <rect x="1570" y="620" width="180" height="140" rx="15" fill="url(#gradientDB-p10)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1570" y="620" width="180" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“ Category Files</strong><br/>
                    <strong>9 Categories:</strong> Ãnchise,<br/>
                    Ãncuviiat, Ãnchidere blank,<br/>
                    Suspendate, Angajament,<br/>
                    Licitatii, Dosar incuviintat,<br/>
                    Restul, Statistici Finale<br/>
                    <strong>Per Category:</strong> Excel + Email
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 4: USER INTERFACE -->
              <text x="50" y="950" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ‘¤ INTERFAÈšÄ‚ UTILIZATOR</text>
              
              <!-- GUI Application -->
              <g class="node-phys">
                <rect x="50" y="970" width="1700" height="260" rx="15" fill="url(#gradientClient-p10)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="970" width="1700" height="260">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 15px; font-size: 10px;">
                    <div style="font-weight: bold; font-size: 14px; margin-bottom: 10px;">ğŸ–¥ï¸ CustomTkinter GUI - AnalizÄƒ Perimare BT Screen</div>
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px;">
                      <div>
                        <strong>screen.py:</strong><br/>
                        â€¢ Folder selection (Master/Output)<br/>
                        â€¢ Email checkbox<br/>
                        â€¢ Process button<br/>
                        â€¢ Real-time logging display
                      </div>
                      <div>
                        <strong>Features:</strong><br/>
                        â€¢ Dark theme<br/>
                        â€¢ Progress indicators<br/>
                        â€¢ Error messages<br/>
                        â€¢ Status updates
                      </div>
                      <div>
                        <strong>Processing Info:</strong><br/>
                        â€¢ File reading status<br/>
                        â€¢ VLOOKUP progress<br/>
                        â€¢ Category separation count<br/>
                        â€¢ Excel generation status<br/>
                        â€¢ Email sending status
                      </div>
                      <div>
                        <strong>Integration:</strong><br/>
                        â€¢ Calls processor.py<br/>
                        â€¢ Subprocess execution<br/>
                        â€¢ CLI arguments passing<br/>
                        â€¢ Error handling
                      </div>
                      <div>
                        <strong>Output Display:</strong><br/>
                        â€¢ 9 Excel files generated<br/>
                        â€¢ 9+1 emails sent<br/>
                        â€¢ Statistics summary<br/>
                        â€¢ File paths display
                      </div>
                    </div>
                  </div>
                </foreignObject>
              </g>

              <!-- ARROWS: External to Workstation -->
              <path d="M 200 190 L 200 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p10)"/>
              
              <!-- ARROWS: Workstation Internal -->
              <path d="M 350 410 L 370 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p10)"/>
              <path d="M 690 410 L 710 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p10)"/>
              <path d="M 990 410 L 1010 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p10)"/>
              <path d="M 1290 410 L 1310 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p10)"/>
              <path d="M 1590 410 L 1610 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p10)"/>
              
              <!-- ARROWS: Workstation to File Storage -->
              <path d="M 230 540 L 230 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p10)"/>
              <path d="M 610 540 L 610 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p10)"/>
              <path d="M 990 540 L 990 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p10)"/>
              <path d="M 1370 540 L 1370 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p10)"/>
              <path d="M 1660 540 L 1660 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p10)"/>
              
              <!-- ARROWS: Workstation to GUI -->
              <path d="M 900 540 L 900 970" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p10)"/>
              
              <!-- ARROWS: File Storage to Workstation (feedback) -->
              <path d="M 230 620 L 230 540" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p10)" opacity="0.7"/>
              <path d="M 900 970 L 900 540" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p10)" opacity="0.7"/>
              <path d="M 200 270 L 200 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p10)" opacity="0.7"/>
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ FizicÄƒ Raport 11: Perimate FÄƒrÄƒ AcÈ›iuni -->
        <div class="physical-diagram" id="physical-diagram-11">
          <div class="diagram-container">
            <svg width="1800" height="1300" viewBox="0 0 1800 1300" min-width="1800" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ fizicÄƒ - Raport Perimate È™i FÄƒrÄƒ AcÈ›iuni">
              <defs>
                <linearGradient id="gradientCloud-p11" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientServer-p11" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientDB-p11" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientClient-p11" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-phys-p11" markerWidth="12" markerHeight="12" refX="10" refY="4" orient="auto">
                  <polygon points="0 0, 12 4, 0 8" fill="#3576b0" />
                </marker>
              </defs>

              <!-- Background -->
              <rect width="1800" height="1300" fill="rgba(255,255,255,0.3)" rx="20"/>
              
              <!-- Title -->
              <text x="900" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ—ï¸ DIAGRAMÄ‚ FIZICÄ‚ - RAPORT PERIMATE È˜I FÄ‚RÄ‚ ACÈšIUNI</text>
              
              <!-- Layer separators -->
              <line x1="50" y1="200" x2="1750" y2="200" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="550" x2="1750" y2="550" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="900" x2="1750" y2="900" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1230" x2="1750" y2="1230" stroke="#22507a" stroke-width="2" opacity="0.3"/>

              <!-- LAYER 1: EXTERNAL SERVICES -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ SERVICII EXTERNE</text>
              
              <!-- Outlook Email Service -->
              <g class="node-phys">
                <rect x="50" y="110" width="300" height="80" rx="15" fill="url(#gradientCloud-p11)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="110" width="300" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“§ Microsoft Outlook</strong><br/>
                    <strong>Protocol:</strong> COM Interface (win32com)<br/>
                    <strong>Location:</strong> Local Installation<br/>
                    <strong>Function:</strong> Email Sending (4+1 emails)<br/>
                    <strong>Attachments:</strong> Excel Files (filtered per portfolio)
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 2: WINDOWS WORKSTATION -->
              <text x="50" y="250" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’» WINDOWS WORKSTATION - DEPLOYMENT FIZIC</text>
              
              <!-- Main Workstation Container -->
              <g class="node-phys">
                <rect x="50" y="270" width="1700" height="270" rx="20" fill="url(#gradientServer-p11)" stroke="#22507a" stroke-width="3" filter="drop-shadow(0 12px 24px rgba(0, 0, 0, 0.2))"/>
                
                <!-- Python Runtime Section -->
                <g class="node-phys">
                  <rect x="70" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="70" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ Python Runtime</div>
                      <div style="line-height: 1.6;">
                        <strong>Python 3.8+</strong><br/>
                        <strong>pandas</strong> - Data Processing<br/>
                        <strong>openpyxl</strong> - Excel I/O (.xlsx)<br/>
                        <strong>xlrd</strong> - Excel I/O (.xls)<br/>
                        <strong>pyxlsb</strong> - Excel I/O (.xlsb)<br/>
                        <strong>win32com</strong> - Outlook COM<br/>
                        <strong>datetime</strong> - Date Handling<br/>
                        <strong>logging</strong> - Logging System
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Raport Perimate Module -->
                <g class="node-phys">
                  <rect x="370" y="290" width="320" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="370" y="290" width="320" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“‹ Perimate Module</div>
                      <div style="line-height: 1.6;">
                        <strong>processor.py</strong> - Main Logic<br/>
                        <strong>screen.py</strong> - GUI Interface<br/>
                        <strong>config.json</strong> - Configuration<br/>
                        <strong>Input:</strong> Raport_Master Excel<br/>
                        <strong>Processing:</strong> Multi-sheet read<br/>
                        <strong>Filters:</strong> PORTFOLIO, REZOLUTIE,<br/>
                        REZOLUTIE_INCHIDERE, DATA_PREDARE_BEJ<br/>
                        <strong>Output:</strong> 3 sheets Excel
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Excel Processing Engine -->
                <g class="node-phys">
                  <rect x="710" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="710" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">âš¡ Excel Processing</div>
                      <div style="line-height: 1.6;">
                        <strong>Multi-engine:</strong> xlrd/openpyxl/pyxlsb<br/>
                        <strong>Auto-detection:</strong> File extension<br/>
                        <strong>All Sheets:</strong> Read & Concatenate<br/>
                        <strong>Skiprows:</strong> 1 (delete row 1)<br/>
                        <strong>Header:</strong> Row 2<br/>
                        <strong>Alignment:</strong> Column matching<br/>
                        <strong>Formatting:</strong> Default pandas
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Data Analysis Engine -->
                <g class="node-phys">
                  <rect x="1010" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1010" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“Š Data Analysis</div>
                      <div style="line-height: 1.6;">
                        <strong>4 Filters:</strong> PORTFOLIO mapping,<br/>
                        REZOLUTIE exclude,<br/>
                        REZOLUTIE_INCHIDERE blank,<br/>
                        DATA_PREDARE_BEJ exclude current month<br/>
                        <strong>Sheet 2:</strong> Unique EXEC_FILE_NO + PORTFOLIO<br/>
                        <strong>Sheet 3:</strong> Pivot Table (groupby PORTFOLIO,<br/>
                        count EXEC_FILE_NO, Grand Total)
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Pivot Table Generator -->
                <g class="node-phys">
                  <rect x="1310" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1310" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“Š Pivot Table Generator</div>
                      <div style="line-height: 1.6;">
                        <strong>pandas</strong> - groupby & count<br/>
                        <strong>Groupby:</strong> PORTFOLIO<br/>
                        <strong>Aggregation:</strong> Count EXEC_FILE_NO<br/>
                        <strong>Sort:</strong> Count descending<br/>
                        <strong>Grand Total:</strong> Sum row<br/>
                        <strong>Output:</strong> Sheet 3 Excel<br/>
                        <strong>HTML:</strong> Embedded in email
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Email Service -->
                <g class="node-phys">
                  <rect x="1610" y="290" width="120" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1610" y="290" width="120" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“§ Email Service</div>
                      <div style="line-height: 1.6;">
                        <strong>win32com</strong> - Outlook<br/>
                        <strong>4 Emails</strong> - Per portfolio<br/>
                        <strong>1 Email</strong> - ICC Summary<br/>
                        <strong>HTML Body</strong> - Georgia 11pt<br/>
                        <strong>Attachments:</strong> Excel filtered<br/>
                        <strong>TO/CC:</strong> Per portfolio config
                      </div>
                    </div>
                  </foreignObject>
                </g>
              </g>

              <!-- LAYER 3: FILE STORAGE -->
              <text x="50" y="600" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’¾ STOCARE DATE LOCALE</text>
              
              <!-- Master Files -->
              <g class="node-phys">
                <rect x="50" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p11)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¥ Master Files (Input)</strong><br/>
                    <strong>Folder:</strong> raport_perimate_fara_actiuni/Master/<br/>
                    <strong>File:</strong> *Raport_Master*.xlsx/.xls/.xlsb<br/>
                    <strong>Sheets:</strong> All sheets (skiprows=1, header=0)<br/>
                    <strong>Auto-detection:</strong> find_raport_master_file()<br/>
                    <strong>Selection:</strong> Most recent if multiple
                  </div>
                </foreignObject>
              </g>

              <!-- Result Files -->
              <g class="node-phys">
                <rect x="430" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p11)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="430" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¤ Result Files (Output)</strong><br/>
                    <strong>Folder:</strong> rapoarte_generate/<br/>
                    <strong>File:</strong> Raport_Perimate_Fara_Actiuni_[timestamp].xlsx<br/>
                    <strong>Sheet 1:</strong> Processed data<br/>
                    <strong>Sheet 2:</strong> Unique EXEC_FILE_NO + PORTFOLIO<br/>
                    <strong>Sheet 3:</strong> Pivot Table<br/>
                    <strong>Formatting:</strong> Default pandas
                  </div>
                </foreignObject>
              </g>

              <!-- Configuration -->
              <g class="node-phys">
                <rect x="810" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p11)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="810" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">âš™ï¸ Configuration Files</strong><br/>
                    <strong>config.json</strong> - Module Config<br/>
                    â€¢ Master folder path<br/>
                    â€¢ Output folder path<br/>
                    <strong>Portfolio Mapping:</strong> Hardcoded<br/>
                    â€¢ 4 accepted creditors<br/>
                    <strong>Email Recipients:</strong> Per portfolio<br/>
                    <strong>CLI Args:</strong> --output, --no-email
                  </div>
                </foreignObject>
              </g>

              <!-- Logs -->
              <g class="node-phys">
                <rect x="1190" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p11)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1190" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“ Logging System</strong><br/>
                    <strong>Output:</strong> Console (print statements)<br/>
                    <strong>Format:</strong> [PERIMATE] prefix<br/>
                    <strong>Tracking:</strong> File reading, sheet processing,<br/>
                    filtering, pivot table creation,<br/>
                    email sending<br/>
                    <strong>Error Handling:</strong> FileNotFoundError,<br/>
                    Missing columns validation
                  </div>
                </foreignObject>
              </g>

              <!-- Portfolio Storage -->
              <g class="node-phys">
                <rect x="1570" y="620" width="180" height="140" rx="15" fill="url(#gradientDB-p11)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1570" y="620" width="180" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“ Portfolio Files</strong><br/>
                    <strong>4 Portfolios:</strong> BTD CARDURI,<br/>
                    BTD CREDITE,<br/>
                    BT Microfinantare,<br/>
                    SALT BANK SA<br/>
                    <strong>Per Portfolio:</strong> Filtered Excel + Email<br/>
                    <strong>ICC:</strong> Pivot Table + Email
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 4: USER INTERFACE -->
              <text x="50" y="950" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ‘¤ INTERFAÈšÄ‚ UTILIZATOR</text>
              
              <!-- GUI Application -->
              <g class="node-phys">
                <rect x="50" y="970" width="1700" height="260" rx="15" fill="url(#gradientClient-p11)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="970" width="1700" height="260">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 15px; font-size: 10px;">
                    <div style="font-weight: bold; font-size: 14px; margin-bottom: 10px;">ğŸ–¥ï¸ CustomTkinter GUI - Perimate È™i FÄƒrÄƒ AcÈ›iuni Screen</div>
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px;">
                      <div>
                        <strong>screen.py:</strong><br/>
                        â€¢ Folder selection (Master/Output)<br/>
                        â€¢ Email checkbox<br/>
                        â€¢ Process button<br/>
                        â€¢ Real-time logging display
                      </div>
                      <div>
                        <strong>Features:</strong><br/>
                        â€¢ Dark theme<br/>
                        â€¢ Progress indicators<br/>
                        â€¢ Error messages<br/>
                        â€¢ Status updates
                      </div>
                      <div>
                        <strong>Processing Info:</strong><br/>
                        â€¢ File reading status<br/>
                        â€¢ Sheet processing count<br/>
                        â€¢ Filtering progress<br/>
                        â€¢ Pivot table creation<br/>
                        â€¢ Email sending status
                      </div>
                      <div>
                        <strong>Integration:</strong><br/>
                        â€¢ Calls processor.py<br/>
                        â€¢ Subprocess execution<br/>
                        â€¢ CLI arguments passing<br/>
                        â€¢ Error handling
                      </div>
                      <div>
                        <strong>Output Display:</strong><br/>
                        â€¢ 3 sheets Excel generated<br/>
                        â€¢ 4+1 emails sent<br/>
                        â€¢ Portfolio filtering status<br/>
                        â€¢ File paths display
                      </div>
                    </div>
                  </div>
                </foreignObject>
              </g>

              <!-- ARROWS: External to Workstation -->
              <path d="M 200 190 L 200 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p11)"/>
              
              <!-- ARROWS: Workstation Internal -->
              <path d="M 350 410 L 370 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p11)"/>
              <path d="M 690 410 L 710 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p11)"/>
              <path d="M 990 410 L 1010 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p11)"/>
              <path d="M 1290 410 L 1310 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p11)"/>
              <path d="M 1590 410 L 1610 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p11)"/>
              
              <!-- ARROWS: Workstation to File Storage -->
              <path d="M 230 540 L 230 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p11)"/>
              <path d="M 610 540 L 610 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p11)"/>
              <path d="M 990 540 L 990 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p11)"/>
              <path d="M 1370 540 L 1370 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p11)"/>
              <path d="M 1660 540 L 1660 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p11)"/>
              
              <!-- ARROWS: Workstation to GUI -->
              <path d="M 900 540 L 900 970" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p11)"/>
              
              <!-- ARROWS: File Storage to Workstation (feedback) -->
              <path d="M 230 620 L 230 540" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p11)" opacity="0.7"/>
              <path d="M 900 970 L 900 540" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p11)" opacity="0.7"/>
              <path d="M 200 270 L 200 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p11)" opacity="0.7"/>
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ FizicÄƒ Raport 12: Termene LicitaÈ›ie Imobile -->
        <div class="physical-diagram" id="physical-diagram-12">
          <div class="diagram-container">
            <svg width="1800" height="1300" viewBox="0 0 1800 1300" min-width="1800" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ fizicÄƒ - Raport Termene LicitaÈ›ie Imobile Identificate">
              <defs>
                <linearGradient id="gradientCloud-p12" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientServer-p12" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientDB-p12" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientClient-p12" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-phys-p12" markerWidth="12" markerHeight="12" refX="10" refY="4" orient="auto">
                  <polygon points="0 0, 12 4, 0 8" fill="#3576b0" />
                </marker>
              </defs>

              <!-- Background -->
              <rect width="1800" height="1300" fill="rgba(255,255,255,0.3)" rx="20"/>
              
              <!-- Title -->
              <text x="900" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ—ï¸ DIAGRAMÄ‚ FIZICÄ‚ - RAPORT TERMENE LICITAÈšIE IMOBILE IDENTIFICATE</text>
              
              <!-- Layer separators -->
              <line x1="50" y1="200" x2="1750" y2="200" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="550" x2="1750" y2="550" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="900" x2="1750" y2="900" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1230" x2="1750" y2="1230" stroke="#22507a" stroke-width="2" opacity="0.3"/>

              <!-- LAYER 1: EXTERNAL SERVICES -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ SERVICII EXTERNE</text>
              
              <!-- Outlook Email Service -->
              <g class="node-phys">
                <rect x="50" y="110" width="300" height="80" rx="15" fill="url(#gradientCloud-p12)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="110" width="300" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“§ Microsoft Outlook</strong><br/>
                    <strong>Protocol:</strong> COM Interface (win32com)<br/>
                    <strong>Location:</strong> Local Installation<br/>
                    <strong>Function:</strong> Email Sending (1 email)<br/>
                    <strong>Attachments:</strong> Excel Report (2 sheets)
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 2: WINDOWS WORKSTATION -->
              <text x="50" y="250" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’» WINDOWS WORKSTATION - DEPLOYMENT FIZIC</text>
              
              <!-- Main Workstation Container -->
              <g class="node-phys">
                <rect x="50" y="270" width="1700" height="270" rx="20" fill="url(#gradientServer-p12)" stroke="#22507a" stroke-width="3" filter="drop-shadow(0 12px 24px rgba(0, 0, 0, 0.2))"/>
                
                <!-- Python Runtime Section -->
                <g class="node-phys">
                  <rect x="70" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="70" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ Python Runtime</div>
                      <div style="line-height: 1.6;">
                        <strong>Python 3.8+</strong><br/>
                        <strong>pandas</strong> - Data Processing<br/>
                        <strong>openpyxl</strong> - Excel I/O (.xlsx)<br/>
                        <strong>xlrd</strong> - Excel I/O (.xls)<br/>
                        <strong>pyxlsb</strong> - Excel I/O (.xlsb)<br/>
                        <strong>xlsxwriter</strong> - Excel Write<br/>
                        <strong>win32com</strong> - Outlook COM<br/>
                        <strong>matplotlib</strong> - Charts<br/>
                        <strong>base64</strong> - Image Encoding
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Raport Termene Imobile Module -->
                <g class="node-phys">
                  <rect x="370" y="290" width="320" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="370" y="290" width="320" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ  Termene Imobile Module</div>
                      <div style="line-height: 1.6;">
                        <strong>processor.py</strong> - Main Logic<br/>
                        <strong>screen.py</strong> - GUI Interface<br/>
                        <strong>config.json</strong> - Configuration<br/>
                        <strong>Input:</strong> raportGarantiiExecutareICC<br/>
                        <strong>Processing:</strong> Filter Imobile<br/>
                        <strong>Filters:</strong> CATEGORIE_GARANTIE,<br/>
                        AUCTION_NO, TASK_PRINCIPAL<br/>
                        <strong>Output:</strong> 2 sheets Excel
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Excel Processing Engine -->
                <g class="node-phys">
                  <rect x="710" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="710" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">âš¡ Excel Processing</div>
                      <div style="line-height: 1.6;">
                        <strong>Multi-engine:</strong> xlrd/openpyxl/pyxlsb<br/>
                        <strong>Auto-detection:</strong> File extension<br/>
                        <strong>2 Sheets:</strong> Read & Concatenate<br/>
                        <strong>Skiprows:</strong> 1 (sheet 1)<br/>
                        <strong>Filter:</strong> CATEGORIE_GARANTIE =<br/>
                        "Bun identificat Imobil"<br/>
                        <strong>Clean:</strong> AUCTION_NO (1-1000)
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Data Analysis Engine -->
                <g class="node-phys">
                  <rect x="1010" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1010" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“Š Data Analysis</div>
                      <div style="line-height: 1.6;">
                        <strong>4 Filters:</strong> CATEGORIE_GARANTIE,<br/>
                        AUCTION_NO (not null),<br/>
                        TASK_PRINCIPAL (10 tasks),<br/>
                        Duplicate removal<br/>
                        <strong>Clean Function:</strong> clean_auction_no_imobile()<br/>
                        <strong>Extract:</strong> Numbers 1-1000<br/>
                        <strong>Column:</strong> AUCTION_NO_CLEANED
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Pivot Table Generator -->
                <g class="node-phys">
                  <rect x="1310" y="290" width="280" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1310" y="290" width="280" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“Š Pivot Table Generator</div>
                      <div style="line-height: 1.6;">
                        <strong>pandas</strong> - groupby & count<br/>
                        <strong>Intervals:</strong> 10 (1-10, 11-20, ...)<br/>
                        <strong>Range:</strong> 1-110 (all intervals)<br/>
                        <strong>Empty:</strong> Include empty intervals<br/>
                        <strong>Percentage:</strong> Calculate per interval<br/>
                        <strong>Grand Total:</strong> Sum row<br/>
                        <strong>Output:</strong> Sheet 2 Excel
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Email Service -->
                <g class="node-phys">
                  <rect x="1610" y="290" width="120" height="240" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1610" y="290" width="120" height="240">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“§ Email Service</div>
                      <div style="line-height: 1.6;">
                        <strong>win32com</strong> - Outlook<br/>
                        <strong>1 Email</strong> - Combined report<br/>
                        <strong>HTML Body</strong> - Georgia 11pt<br/>
                        <strong>Charts:</strong> matplotlib (base64)<br/>
                        <strong>Attachments:</strong> Excel (2 sheets)<br/>
                        <strong>TO:</strong> rpa@iccollect.ro,<br/>
                        juridic@iccollect.ro
                      </div>
                    </div>
                  </foreignObject>
                </g>
              </g>

              <!-- LAYER 3: FILE STORAGE -->
              <text x="50" y="600" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’¾ STOCARE DATE LOCALE</text>
              
              <!-- Master Files -->
              <g class="node-phys">
                <rect x="50" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p12)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¥ Master Files (Input)</strong><br/>
                    <strong>Folder:</strong> raport_termene_licitatie_garantii/Master/<br/>
                    <strong>File:</strong> raportGarantiiExecutareICC*.xlsx/.xls/.xlsb<br/>
                    <strong>Sheets:</strong> 2 sheets (skiprows=1 sheet 1)<br/>
                    <strong>Auto-detection:</strong> File search<br/>
                    <strong>Columns:</strong> CATEGORIE_GARANTIE,<br/>
                    AUCTION_NO, TASK_PRINCIPAL
                  </div>
                </foreignObject>
              </g>

              <!-- Result Files -->
              <g class="node-phys">
                <rect x="430" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p12)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="430" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¤ Result Files (Output)</strong><br/>
                    <strong>Folder:</strong> rapoarte_generate/<br/>
                    <strong>File:</strong> Raport_Imobile_Identificate_Final.xlsx<br/>
                    <strong>Sheet 1:</strong> ImobileIdentificate_Data<br/>
                    <strong>Sheet 2:</strong> Pivot_Intervale_Imobile<br/>
                    <strong>ProtecÈ›ie:</strong> ProtecÈ›ie parolÄƒ activÄƒ<br/>
                    <strong>Formatting:</strong> Georgia 11pt
                  </div>
                </foreignObject>
              </g>

              <!-- Configuration -->
              <g class="node-phys">
                <rect x="810" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p12)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="810" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">âš™ï¸ Configuration Files</strong><br/>
                    <strong>config.json</strong> - Module Config<br/>
                    â€¢ Master folder path<br/>
                    â€¢ Output folder path<br/>
                    <strong>Email Recipients:</strong> Hardcoded<br/>
                    â€¢ TO: rpa@iccollect.ro, juridic@iccollect.ro<br/>
                    <strong>CLI Args:</strong> --output, --no-email<br/>
                    <strong>Password:</strong> ProtecÈ›ie parolÄƒ activÄƒ
                  </div>
                </foreignObject>
              </g>

              <!-- Logs -->
              <g class="node-phys">
                <rect x="1190" y="620" width="360" height="140" rx="15" fill="url(#gradientDB-p12)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1190" y="620" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“ Logging System</strong><br/>
                    <strong>Output:</strong> Console (print statements)<br/>
                    <strong>Format:</strong> [IMOBILE IDENTIFICATE] prefix<br/>
                    <strong>Tracking:</strong> File reading, filtering,<br/>
                    duplicate removal, cleaning,<br/>
                    pivot table creation, email sending<br/>
                    <strong>Error Handling:</strong> FileNotFoundError,<br/>
                    Missing columns validation
                  </div>
                </foreignObject>
              </g>

              <!-- Chart Storage -->
              <g class="node-phys">
                <rect x="1570" y="620" width="180" height="140" rx="15" fill="url(#gradientDB-p12)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1570" y="620" width="180" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“Š Chart Storage</strong><br/>
                    <strong>matplotlib</strong> - Bar chart<br/>
                    <strong>Type:</strong> Grouped bar (GaranÈ›ii vs. Imobile)<br/>
                    <strong>Format:</strong> PNG base64<br/>
                    <strong>Embedded:</strong> In email HTML<br/>
                    <strong>Font:</strong> Georgia 11pt<br/>
                    <strong>Size:</strong> 18x10 inches
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 4: USER INTERFACE -->
              <text x="50" y="950" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ‘¤ INTERFAÈšÄ‚ UTILIZATOR</text>
              
              <!-- GUI Application -->
              <g class="node-phys">
                <rect x="50" y="970" width="1700" height="260" rx="15" fill="url(#gradientClient-p12)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="970" width="1700" height="260">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 15px; font-size: 10px;">
                    <div style="font-weight: bold; font-size: 14px; margin-bottom: 10px;">ğŸ–¥ï¸ CustomTkinter GUI - Termene LicitaÈ›ie GaranÈ›ii Screen</div>
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px;">
                      <div>
                        <strong>screen.py:</strong><br/>
                        â€¢ Folder selection (Master/Output)<br/>
                        â€¢ Email checkbox<br/>
                        â€¢ Process button<br/>
                        â€¢ Real-time logging display
                      </div>
                      <div>
                        <strong>Features:</strong><br/>
                        â€¢ Dark theme<br/>
                        â€¢ Progress indicators<br/>
                        â€¢ Error messages<br/>
                        â€¢ Status updates
                      </div>
                      <div>
                        <strong>Processing Info:</strong><br/>
                        â€¢ File reading status<br/>
                        â€¢ Filtering progress<br/>
                        â€¢ Pivot table creation<br/>
                        â€¢ Chart generation<br/>
                        â€¢ Email sending status
                      </div>
                      <div>
                        <strong>Integration:</strong><br/>
                        â€¢ Calls processor.py<br/>
                        â€¢ Subprocess execution<br/>
                        â€¢ CLI arguments passing<br/>
                        â€¢ Error handling
                      </div>
                      <div>
                        <strong>Output Display:</strong><br/>
                        â€¢ 2 sheets Excel generated<br/>
                        â€¢ 1 email sent<br/>
                        â€¢ Combined report (GaranÈ›ii + Imobile)<br/>
                        â€¢ File paths display
                      </div>
                    </div>
                  </div>
                </foreignObject>
              </g>

              <!-- ARROWS: External to Workstation -->
              <path d="M 200 190 L 200 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p12)"/>
              
              <!-- ARROWS: Workstation Internal -->
              <path d="M 350 410 L 370 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p12)"/>
              <path d="M 690 410 L 710 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p12)"/>
              <path d="M 990 410 L 1010 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p12)"/>
              <path d="M 1290 410 L 1310 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p12)"/>
              <path d="M 1590 410 L 1610 410" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p12)"/>
              
              <!-- ARROWS: Workstation to File Storage -->
              <path d="M 230 540 L 230 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p12)"/>
              <path d="M 610 540 L 610 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p12)"/>
              <path d="M 990 540 L 990 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p12)"/>
              <path d="M 1370 540 L 1370 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p12)"/>
              <path d="M 1660 540 L 1660 620" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p12)"/>
              
              <!-- ARROWS: Workstation to GUI -->
              <path d="M 900 540 L 900 970" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p12)"/>
              
              <!-- ARROWS: File Storage to Workstation (feedback) -->
              <path d="M 230 620 L 230 540" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p12)" opacity="0.7"/>
              <path d="M 900 970 L 900 540" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p12)" opacity="0.7"/>
              <path d="M 200 270 L 200 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p12)" opacity="0.7"/>
            </svg>
          </div>
        </div>

        <!-- DiagramÄƒ FizicÄƒ Raport 13: Dosare Active -->
        <div class="physical-diagram" id="physical-diagram-13">
          <div class="diagram-container">
            <svg width="1800" height="1400" viewBox="0 0 1800 1400" min-width="1800" style="display:block; margin: 0 auto;" role="img" aria-label="DiagramÄƒ fizicÄƒ - Raportare LunarÄƒ Dosare Active Per Client">
              <defs>
                <linearGradient id="gradientCloud-p13" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientServer-p13" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientDB-p13" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e1bee7;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="gradientClient-p13" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
                </linearGradient>
                <marker id="arrowhead-phys-p13" markerWidth="12" markerHeight="12" refX="10" refY="4" orient="auto">
                  <polygon points="0 0, 12 4, 0 8" fill="#3576b0" />
                </marker>
              </defs>

              <!-- Background -->
              <rect width="1800" height="1400" fill="rgba(255,255,255,0.3)" rx="20"/>
              
              <!-- Title -->
              <text x="900" y="40" text-anchor="middle" style="font-size: 22px; font-weight: bold; fill: #22507a;">ğŸ—ï¸ DIAGRAMÄ‚ FIZICÄ‚ - RAPORTARE LUNARÄ‚ DOSARE ACTIVE PER CLIENT</text>
              
              <!-- Layer separators -->
              <line x1="50" y1="200" x2="1750" y2="200" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="600" x2="1750" y2="600" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1000" x2="1750" y2="1000" stroke="#22507a" stroke-width="2" opacity="0.3"/>
              <line x1="50" y1="1330" x2="1750" y2="1330" stroke="#22507a" stroke-width="2" opacity="0.3"/>

              <!-- LAYER 1: EXTERNAL SERVICES -->
              <text x="50" y="90" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸŒ SERVICII EXTERNE</text>
              
              <!-- Outlook Email Service -->
              <g class="node-phys">
                <rect x="50" y="110" width="300" height="80" rx="15" fill="url(#gradientCloud-p13)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="110" width="300" height="80">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 10px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“§ Microsoft Outlook</strong><br/>
                    <strong>Protocol:</strong> COM Interface (win32com)<br/>
                    <strong>Location:</strong> Local Installation<br/>
                    <strong>Function:</strong> Email Sending (6 emails)<br/>
                    <strong>Recipients:</strong> rpa@iccollect.ro, juridic@iccollect.ro
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 2: WINDOWS WORKSTATION -->
              <text x="50" y="250" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’» WINDOWS WORKSTATION - DEPLOYMENT FIZIC</text>
              
              <!-- Main Workstation Container -->
              <g class="node-phys">
                <rect x="50" y="270" width="1700" height="320" rx="20" fill="url(#gradientServer-p13)" stroke="#22507a" stroke-width="3" filter="drop-shadow(0 12px 24px rgba(0, 0, 0, 0.2))"/>
                
                <!-- Python Runtime Section -->
                <g class="node-phys">
                  <rect x="70" y="290" width="280" height="300" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="70" y="290" width="280" height="300">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ Python Runtime</div>
                      <div style="line-height: 1.6;">
                        <strong>Python 3.8+</strong><br/>
                        <strong>pandas</strong> - Data Processing<br/>
                        <strong>openpyxl</strong> - Excel I/O (.xlsx)<br/>
                        <strong>xlsxwriter</strong> - Excel Write<br/>
                        <strong>win32com</strong> - Outlook COM<br/>
                        <strong>schedule</strong> - Task Scheduling<br/>
                        <strong>threading</strong> - Background Tasks<br/>
                        <strong>glob</strong> - File Search<br/>
                        <strong>datetime</strong> - Date Handling
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Raport Creditori Module -->
                <g class="node-phys">
                  <rect x="370" y="290" width="320" height="300" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="370" y="290" width="320" height="300">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“Š Raport Creditori Module</div>
                      <div style="line-height: 1.6;">
                        <strong>processor.py</strong> - Main Logic<br/>
                        <strong>screen.py</strong> - GUI Interface<br/>
                        <strong>scheduler.py</strong> - Auto Scheduling<br/>
                        <strong>config.json</strong> - Configuration<br/>
                        <strong>Input:</strong> Raport_Master_*.xlsx<br/>
                        <strong>Processing:</strong> 2 sheets (skiprows=1 sheet 1)<br/>
                        <strong>Output:</strong> 6 Excel files + 1 Master<br/>
                        <strong>Creditors:</strong> EOS, BTD CREDITE,<br/>
                        BTD CARDURI, SALT, BT MIC, BT LEASING
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Excel Processing Engine -->
                <g class="node-phys">
                  <rect x="710" y="290" width="280" height="300" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="710" y="290" width="280" height="300">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">âš¡ Excel Processing</div>
                      <div style="line-height: 1.6;">
                        <strong>openpyxl</strong> - Read/Write<br/>
                        <strong>xlsxwriter</strong> - Protected Write<br/>
                        <strong>2 Sheets:</strong> Read & Concatenate<br/>
                        <strong>Sheet 1:</strong> skiprows=1<br/>
                        <strong>Sheet 2:</strong> Normal read<br/>
                        <strong>Formatting:</strong> Georgia 11pt<br/>
                        <strong>Protection:</strong> Password per creditor<br/>
                        <strong>Sheets per file:</strong> "ds active", "ds inchise"
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Data Analysis Engine -->
                <g class="node-phys">
                  <rect x="1010" y="290" width="280" height="300" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1010" y="290" width="280" height="300">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“Š Data Analysis</div>
                      <div style="line-height: 1.6;">
                        <strong>Column Mapping:</strong> PORTFOLIO (index 21),<br/>
                        NUME_TITULAR (auto-detect)<br/>
                        <strong>Filters:</strong> BANCPOST, GB01, AXIOMA,<br/>
                        CdF, Idea Leasing, GDPR, blank<br/>
                        <strong>Complete:</strong> DATA_PREDARE_BEJ<br/>
                        <strong>Split:</strong> split_active_closed()<br/>
                        <strong>Separate:</strong> 6 creditors<br/>
                        <strong>PORTFOLIO Clean:</strong> Remove "|", mapping
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Email Service -->
                <g class="node-phys">
                  <rect x="1310" y="290" width="200" height="300" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1310" y="290" width="200" height="300">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">ğŸ“§ Email Service</div>
                      <div style="line-height: 1.6;">
                        <strong>win32com</strong> - Outlook<br/>
                        <strong>6 Emails</strong> - Per creditor<br/>
                        <strong>HTML Body</strong> - Georgia 11pt<br/>
                        <strong>Subjects:</strong> Personalized<br/>
                        <strong>Attachments:</strong> Excel per creditor<br/>
                        <strong>TO:</strong> rpa@iccollect.ro,<br/>
                        juridic@iccollect.ro<br/>
                        <strong>Format:</strong> HTML signature
                      </div>
                    </div>
                  </foreignObject>
                </g>

                <!-- Scheduler Service -->
                <g class="node-phys">
                  <rect x="1530" y="290" width="200" height="300" rx="10" fill="rgba(255,255,255,0.4)" stroke="#22507a" stroke-width="2"/>
                  <foreignObject x="1530" y="290" width="200" height="300">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 10px;">
                      <div style="font-weight: bold; font-size: 13px; margin-bottom: 8px;">â° Scheduler Service</div>
                      <div style="line-height: 1.6;">
                        <strong>schedule</strong> - Task Library<br/>
                        <strong>threading</strong> - Background<br/>
                        <strong>Frequency:</strong> Monthly<br/>
                        <strong>Day:</strong> 2nd working day<br/>
                        <strong>Time:</strong> 08:30<br/>
                        <strong>Config:</strong> config.json<br/>
                        <strong>Auto-start:</strong> scheduler.py<br/>
                        <strong>Status:</strong> GUI display
                      </div>
                    </div>
                  </foreignObject>
                </g>
              </g>

              <!-- LAYER 3: FILE STORAGE -->
              <text x="50" y="650" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ’¾ STOCARE DATE LOCALE</text>
              
              <!-- Master Files -->
              <g class="node-phys">
                <rect x="50" y="670" width="360" height="140" rx="15" fill="url(#gradientDB-p13)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="670" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¥ Master Files (Input)</strong><br/>
                    <strong>Folder:</strong> raport_creditori/Master/<br/>
                    <strong>File:</strong> *Raport_Master*.xlsx<br/>
                    <strong>Sheets:</strong> 2 sheets<br/>
                    <strong>Sheet 1:</strong> skiprows=1<br/>
                    <strong>Sheet 2:</strong> Normal read<br/>
                    <strong>Auto-detection:</strong> glob.glob()<br/>
                    <strong>Selection:</strong> Most recent
                  </div>
                </foreignObject>
              </g>

              <!-- Result Files -->
              <g class="node-phys">
                <rect x="430" y="670" width="360" height="140" rx="15" fill="url(#gradientDB-p13)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="430" y="670" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“¤ Result Files (Output)</strong><br/>
                    <strong>Folder:</strong> rapoarte_generate/Rapoarte_Creditori/<br/>
                    <strong>Master:</strong> Raport_Master_Concatenat_Filtrat.xlsx<br/>
                    <strong>6 Excel-uri:</strong> Raport_EOS.xlsx,<br/>
                    Raport_BTD_CREDITE.xlsx,<br/>
                    Raport_BTD_CARDURI.xlsx,<br/>
                    Raport_SALT.xlsx,<br/>
                    Raport_BT_MIC.xlsx,<br/>
                    Raport_BT_LEASING.xlsx<br/>
                    <strong>Sheets:</strong> "ds active", "ds inchise"<br/>
                    <strong>Protection:</strong> Password per creditor
                  </div>
                </foreignObject>
              </g>

              <!-- Configuration -->
              <g class="node-phys">
                <rect x="810" y="670" width="360" height="140" rx="15" fill="url(#gradientDB-p13)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="810" y="670" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">âš™ï¸ Configuration Files</strong><br/>
                    <strong>config.json</strong> - Module Config<br/>
                    â€¢ Master folder path<br/>
                    â€¢ Output folder path<br/>
                    â€¢ scheduled_time: "08:30"<br/>
                    â€¢ scheduled_day: "Fiecare zi"<br/>
                    <strong>Email Recipients:</strong> Hardcoded<br/>
                    â€¢ TO: rpa@iccollect.ro, juridic@iccollect.ro<br/>
                    <strong>Passwords:</strong> ProtecÈ›ie parolÄƒ activÄƒ pentru toate Excel-urile
                  </div>
                </foreignObject>
              </g>

              <!-- Logs -->
              <g class="node-phys">
                <rect x="1190" y="670" width="360" height="140" rx="15" fill="url(#gradientDB-p13)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1190" y="670" width="360" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ“ Logging System</strong><br/>
                    <strong>Output:</strong> Console (print statements)<br/>
                    <strong>Format:</strong> [MASTER], [CREDITORI] prefixes<br/>
                    <strong>Tracking:</strong> File reading, concatenation,<br/>
                    filtering, column mapping,<br/>
                    DATA_PREDARE_BEJ completion,<br/>
                    creditor separation, active/closed split,<br/>
                    Excel generation, email sending<br/>
                    <strong>Progress:</strong> [PROGRES] markers
                  </div>
                </foreignObject>
              </g>

              <!-- Creditor Storage -->
              <g class="node-phys">
                <rect x="1570" y="670" width="180" height="140" rx="15" fill="url(#gradientDB-p13)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="1570" y="670" width="180" height="140">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 12px; font-size: 11px;">
                    <strong style="font-size: 13px;">ğŸ‘¥ Creditor Config</strong><br/>
                    <strong>6 Creditors:</strong><br/>
                    â€¢ EOS<br/>
                    â€¢ BTD CREDITE<br/>
                    â€¢ BTD CARDURI<br/>
                    â€¢ SALT<br/>
                    â€¢ BT MIC<br/>
                    â€¢ BT LEASING<br/>
                    <strong>Email Subjects:</strong> Personalized<br/>
                    <strong>Passwords:</strong> Per creditor
                  </div>
                </foreignObject>
              </g>

              <!-- LAYER 4: USER INTERFACE -->
              <text x="50" y="1050" style="font-size: 16px; font-weight: bold; fill: #22507a;">ğŸ‘¤ INTERFAÈšÄ‚ UTILIZATOR</text>
              
              <!-- GUI Application -->
              <g class="node-phys">
                <rect x="50" y="1070" width="1700" height="260" rx="15" fill="url(#gradientClient-p13)" stroke="#22507a" stroke-width="2" filter="drop-shadow(0 8px 16px rgba(0, 0, 0, 0.15))"/>
                <foreignObject x="50" y="1070" width="1700" height="260">
                  <div xmlns="http://www.w3.org/1999/xhtml" style="padding: 15px; font-size: 10px;">
                    <div style="font-weight: bold; font-size: 14px; margin-bottom: 10px;">ğŸ–¥ï¸ CustomTkinter GUI - Raport Creditori Screen</div>
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px;">
                      <div>
                        <strong>screen.py:</strong><br/>
                        â€¢ Folder selection (Master/Output)<br/>
                        â€¢ Email checkbox<br/>
                        â€¢ Process button<br/>
                        â€¢ Real-time logging display<br/>
                        â€¢ Scheduler controls
                      </div>
                      <div>
                        <strong>Features:</strong><br/>
                        â€¢ Dark theme<br/>
                        â€¢ Progress indicators<br/>
                        â€¢ Error messages<br/>
                        â€¢ Status updates<br/>
                        â€¢ Scheduler status
                      </div>
                      <div>
                        <strong>Scheduler UI:</strong><br/>
                        â€¢ Time selection (08:30)<br/>
                        â€¢ Day selection (2nd working day)<br/>
                        â€¢ Repeat mode (Lunar)<br/>
                        â€¢ Start/Stop buttons<br/>
                        â€¢ Status display
                      </div>
                      <div>
                        <strong>Processing Info:</strong><br/>
                        â€¢ File reading status<br/>
                        â€¢ Filtering progress<br/>
                        â€¢ Creditor separation<br/>
                        â€¢ Active/Closed split<br/>
                        â€¢ Excel generation<br/>
                        â€¢ Email sending status
                      </div>
                      <div>
                        <strong>Output Display:</strong><br/>
                        â€¢ 1 Master Excel generated<br/>
                        â€¢ 6 Creditor Excel files<br/>
                        â€¢ 6 Emails sent<br/>
                        â€¢ File paths display<br/>
                        â€¢ Scheduler next run time
                      </div>
                    </div>
                  </div>
                </foreignObject>
              </g>

              <!-- ARROWS: External to Workstation -->
              <path d="M 200 190 L 200 270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p13)"/>
              
              <!-- ARROWS: Workstation Internal -->
              <path d="M 350 440 L 370 440" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p13)"/>
              <path d="M 690 440 L 710 440" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p13)"/>
              <path d="M 990 440 L 1010 440" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p13)"/>
              <path d="M 1290 440 L 1310 440" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p13)"/>
              <path d="M 1510 440 L 1530 440" stroke="#3576b0" stroke-width="2" fill="none" marker-end="url(#arrowhead-phys-p13)"/>
              
              <!-- ARROWS: Workstation to File Storage -->
              <path d="M 230 590 L 230 670" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p13)"/>
              <path d="M 610 590 L 610 670" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p13)"/>
              <path d="M 990 590 L 990 670" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p13)"/>
              <path d="M 1370 590 L 1370 670" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p13)"/>
              <path d="M 1660 590 L 1660 670" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p13)"/>
              
              <!-- ARROWS: Workstation to GUI -->
              <path d="M 900 590 L 900 1070" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowhead-phys-p13)"/>
              
              <!-- ARROWS: File Storage to Workstation (feedback) -->
              <path d="M 230 670 L 230 590" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p13)" opacity="0.7"/>
              <path d="M 900 1070 L 900 590" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p13)" opacity="0.7"/>
              <path d="M 200 270 L 200 190" stroke="#ff6b6b" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead-phys-p13)" opacity="0.7"/>
            </svg>
          </div>
        </div>

        <div class="legend">
          <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);"></div>
            <span class="legend-text"><i class="fas fa-cloud icon"></i>Servicii Externe (Web/API)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);"></div>
            <span class="legend-text"><i class="fas fa-laptop icon"></i>Windows Workstation (Deployment)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);"></div>
            <span class="legend-text"><i class="fas fa-database icon"></i>Stocare Date Locale</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);"></div>
            <span class="legend-text"><i class="fas fa-desktop icon"></i>InterfaÈ›Äƒ Utilizator (GUI)</span>
          </div>
        </div>
      </div>
    </section>

    <section class="content-section hidden" id="secRegistru">
      <div class="section-head">
        <div class="title">ğŸ“‹ Registrul Activelor Informatice</div>
        <div style="opacity:.75; font-weight:700; color:#22507a;">Inventar complet active IT</div>
      </div>
      <div class="section-body">
        <section class="doc-section">
          <h2>1. Software - AplicaÈ›ii È™i Framework-uri</h2>
          <table>
            <thead>
              <tr>
                <th>Denumire</th>
                <th>Tip</th>
                <th>Versiune</th>
                <th>Descriere</th>
                <th>LicenÈ›Äƒ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Python</strong></td>
                <td>Limbaj de Programare</td>
                <td>3.8+</td>
                <td>Limbaj principal pentru toate modulele de raportare</td>
                <td>PSF License</td>
              </tr>
              <tr>
                <td><strong>CustomTkinter</strong></td>
                <td>GUI Framework</td>
                <td>â‰¥5.0.0</td>
                <td>InterfaÈ›Äƒ graficÄƒ modernÄƒ cu dark theme pentru toate modulele</td>
                <td>MIT</td>
              </tr>
              <tr>
                <td><strong>Microsoft Outlook</strong></td>
                <td>Email Client</td>
                <td>Desktop</td>
                <td>Integrare COM pentru trimitere automatÄƒ email-uri cu rapoarte</td>
                <td>Proprietar (Microsoft)</td>
              </tr>
              <tr>
                <td><strong>Tesseract OCR</strong></td>
                <td>OCR Engine</td>
                <td>Latest</td>
                <td>RecunoaÈ™tere text pentru rezolvare CAPTCHA (Raport SIUI/CASAN)</td>
                <td>Apache 2.0</td>
              </tr>
              <tr>
                <td><strong>Playwright Chromium</strong></td>
                <td>Browser Automation</td>
                <td>â‰¥1.30.0</td>
                <td>Browser automation pentru interogÄƒri web automate (CASAN)</td>
                <td>Apache 2.0</td>
              </tr>
            </tbody>
          </table>

          <h2>2. LibrÄƒrii Python - DependenÈ›e Principale</h2>
          <table>
            <thead>
              <tr>
                <th>Denumire</th>
                <th>Versiune</th>
                <th>Scop</th>
                <th>Utilizare Ã®n Module</th>
                <th>LicenÈ›Äƒ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>customtkinter</code></td>
                <td>â‰¥5.0.0</td>
                <td>GUI modern cu dark theme</td>
                <td>Toate modulele (screen.py)</td>
                <td>MIT</td>
              </tr>
              <tr>
                <td><code>Pillow</code></td>
                <td>â‰¥9.0.0</td>
                <td>Procesare imagini</td>
                <td>GUI, CASAN (preprocesare CAPTCHA)</td>
                <td>PIL License</td>
              </tr>
              <tr>
                <td><code>openpyxl</code></td>
                <td>â‰¥3.0.0</td>
                <td>Citire/scriere Excel (.xlsx)</td>
                <td>Toate modulele (procesare Excel)</td>
                <td>MIT</td>
              </tr>
              <tr>
                <td><code>pandas</code></td>
                <td>â‰¥1.5.0</td>
                <td>Manipulare date, DataFrame</td>
                <td>Toate modulele (procesare date)</td>
                <td>BSD 3-Clause</td>
              </tr>
              <tr>
                <td><code>playwright</code></td>
                <td>â‰¥1.30.0</td>
                <td>Browser automation</td>
                <td>Raport SIUI (CASAN interogÄƒri)</td>
                <td>Apache 2.0</td>
              </tr>
              <tr>
                <td><code>pytesseract</code></td>
                <td>â‰¥0.3.10</td>
                <td>Wrapper Python pentru Tesseract OCR</td>
                <td>Raport SIUI (rezolvare CAPTCHA)</td>
                <td>Apache 2.0</td>
              </tr>
              <tr>
                <td><code>opencv-python</code></td>
                <td>â‰¥4.7.0</td>
                <td>Preprocesare imagini CAPTCHA</td>
                <td>Raport SIUI (4 metode OCR)</td>
                <td>Apache 2.0</td>
              </tr>
              <tr>
                <td><code>numpy</code></td>
                <td>â‰¥1.24.0</td>
                <td>Procesare numericÄƒ È™i imagini</td>
                <td>Raport SIUI (procesare CAPTCHA)</td>
                <td>BSD 3-Clause</td>
              </tr>
              <tr>
                <td><code>pywin32</code></td>
                <td>â‰¥305</td>
                <td>Integrare COM Windows (Outlook)</td>
                <td>Toate modulele (trimitere email)</td>
                <td>PSF License</td>
              </tr>
              <tr>
                <td><code>schedule</code></td>
                <td>â‰¥1.2.0</td>
                <td>Scheduler pentru rulÄƒri automate</td>
                <td>Raport Creditori, Termene LicitaÈ›ie, Productivitate</td>
                <td>MIT</td>
              </tr>
              <tr>
                <td><code>plotly</code></td>
                <td>â‰¥5.14.0</td>
                <td>Grafice interactive HTML</td>
                <td>Raport Portal JustiÈ›ie, AnalizÄƒ Perimare BT</td>
                <td>MIT</td>
              </tr>
              <tr>
                <td><code>kaleido</code></td>
                <td>â‰¥0.2.1</td>
                <td>Export imagini PNG din Plotly</td>
                <td>Raport Portal JustiÈ›ie (PDF charts)</td>
                <td>MIT</td>
              </tr>
              <tr>
                <td><code>zeep</code></td>
                <td>â‰¥4.2.0</td>
                <td>Client SOAP pentru API portal.just.ro</td>
                <td>Raport Portal JustiÈ›ie</td>
                <td>MIT</td>
              </tr>
              <tr>
                <td><code>requests</code></td>
                <td>â‰¥2.28.0</td>
                <td>HTTP client pentru transport SOAP</td>
                <td>Raport Portal JustiÈ›ie</td>
                <td>Apache 2.0</td>
              </tr>
              <tr>
                <td><code>xlrd</code></td>
                <td>Latest</td>
                <td>Citire Excel .xls (legacy)</td>
                <td>Raport Termene LicitaÈ›ie (auto-detection)</td>
                <td>BSD 3-Clause</td>
              </tr>
              <tr>
                <td><code>pyxlsb</code></td>
                <td>Latest</td>
                <td>Citire Excel .xlsb (binary)</td>
                <td>Raport Termene LicitaÈ›ie (auto-detection)</td>
                <td>MIT</td>
              </tr>
              <tr>
                <td><code>xlsxwriter</code></td>
                <td>Latest</td>
                <td>Scriere Excel cu formatare avansatÄƒ</td>
                <td>Raport Creditori, Termene LicitaÈ›ie (protecÈ›ie parolÄƒ)</td>
                <td>BSD 3-Clause</td>
              </tr>
              <tr>
                <td><code>matplotlib</code></td>
                <td>Latest</td>
                <td>Grafice statice pentru email-uri</td>
                <td>Raport Expunere Executare, Termene LicitaÈ›ie</td>
                <td>PSF License</td>
              </tr>
            </tbody>
          </table>

          <h2>3. Utilitare Python Standard (Built-in)</h2>
          <table>
            <thead>
              <tr>
                <th>Modul</th>
                <th>Scop</th>
                <th>Utilizare Ã®n Proiect</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>json</code></td>
                <td>Serializare date JSON</td>
                <td>Configurare persistentÄƒ (config.json), checkpoint-uri, istoric procesÄƒri</td>
              </tr>
              <tr>
                <td><code>logging</code></td>
                <td>Sistem de logare</td>
                <td>Logging detaliat Ã®n toate modulele (console + fiÈ™iere)</td>
              </tr>
              <tr>
                <td><code>datetime</code></td>
                <td>Gestionare date È™i timp</td>
                <td>Validare date, formatare, scheduling, timestamp-uri</td>
              </tr>
              <tr>
                <td><code>glob</code></td>
                <td>CÄƒutare fiÈ™iere pattern</td>
                <td>Auto-detection fiÈ™iere Master, cÄƒutare rapoarte</td>
              </tr>
              <tr>
                <td><code>os</code></td>
                <td>OperaÈ›ii sistem de fiÈ™iere</td>
                <td>Gestionare directoare, cÄƒi fiÈ™iere, validare existenÈ›Äƒ</td>
              </tr>
              <tr>
                <td><code>subprocess</code></td>
                <td>ExecuÈ›ie procese externe</td>
                <td>Rulare processor.py din GUI, execuÈ›ie script-uri</td>
              </tr>
              <tr>
                <td><code>re</code></td>
                <td>Regular expressions</td>
                <td>Validare CNP, format dosare, pattern matching Ã®n text</td>
              </tr>
              <tr>
                <td><code>argparse</code></td>
                <td>Parsing argumente CLI</td>
                <td>Toate processor.py (--output, --no-email, etc.)</td>
              </tr>
              <tr>
                <td><code>io</code></td>
                <td>I/O operations</td>
                <td>Fix encoding UTF-8 pe Windows (stdout/stderr)</td>
              </tr>
              <tr>
                <td><code>base64</code></td>
                <td>Encoding binar</td>
                <td>Embedding imagini Ã®n HTML email-uri (matplotlib charts)</td>
              </tr>
              <tr>
                <td><code>BytesIO</code></td>
                <td>Buffer pentru imagini</td>
                <td>Procesare imagini Ã®n memorie (CAPTCHA, charts)</td>
              </tr>
              <tr>
                <td><code>threading</code></td>
                <td>ExecuÈ›ie asincronÄƒ</td>
                <td>Scheduler background tasks, GUI non-blocking</td>
              </tr>
              <tr>
                <td><code>time</code></td>
                <td>Gestionare timp</td>
                <td>Delays, timeouts, scheduling</td>
              </tr>
              <tr>
                <td><code>sys</code></td>
                <td>Sistem È™i runtime</td>
                <td>Platform detection, encoding fixes, path management</td>
              </tr>
              <tr>
                <td><code>traceback</code></td>
                <td>Error tracing</td>
                <td>Debugging, error logging detaliat</td>
              </tr>
            </tbody>
          </table>

          <h2>4. Servicii Externe È™i API-uri</h2>
          <table>
            <thead>
              <tr>
                <th>Denumire</th>
                <th>Tip</th>
                <th>URL/Endpoint</th>
                <th>Protocol</th>
                <th>Descriere</th>
                <th>Utilizare Ã®n Module</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>portal.just.ro</strong></td>
                <td>SOAP API</td>
                <td>portalquery.just.ro</td>
                <td>SOAP (Zeep)</td>
                <td>API pentru interogare dosare judiciare</td>
                <td>Raport Portal JustiÈ›ie</td>
              </tr>
              <tr>
                <td><strong>CASAN SIUI</strong></td>
                <td>Web Portal</td>
                <td>https://siui.casan.ro/asigurati/</td>
                <td>HTTP/HTTPS</td>
                <td>Portal pentru verificare calitate asigurat (CAPTCHA protejat)</td>
                <td>Raport SIUI (CASAN)</td>
              </tr>
              <tr>
                <td><strong>Microsoft Outlook</strong></td>
                <td>Email Service</td>
                <td>Local (COM Interface)</td>
                <td>COM (win32com)</td>
                <td>Trimitere email-uri automate cu rapoarte Excel/HTML</td>
                <td>Toate modulele (8+1 email-uri)</td>
              </tr>
            </tbody>
          </table>

          <h2>5. StructurÄƒ Proiect - FiÈ™iere È™i Directoare</h2>
          <table>
            <thead>
              <tr>
                <th>Cale</th>
                <th>Tip</th>
                <th>Descriere</th>
                <th>Module Utilizate</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>main.py</code></td>
                <td>Python</td>
                <td>AplicaÈ›ia principalÄƒ - orchestrator pentru toate modulele</td>
                <td>Toate</td>
              </tr>
              <tr>
                <td><code>config.py</code></td>
                <td>Python</td>
                <td>Configurare globalÄƒ (clasÄƒ Config)</td>
                <td>Toate</td>
              </tr>
              <tr>
                <td><code>config.json</code></td>
                <td>JSON</td>
                <td>SetÄƒri persistente globale</td>
                <td>Toate</td>
              </tr>
              <tr>
                <td><code>requirements.txt</code></td>
                <td>Text</td>
                <td>ListÄƒ completÄƒ dependenÈ›e Python</td>
                <td>Toate</td>
              </tr>
              <tr>
                <td><code>rapoarte_status.json</code></td>
                <td>JSON</td>
                <td>Status rapoarte (activ/mentenanÈ›Äƒ/dezactivat)</td>
                <td>main.py</td>
              </tr>
              <tr>
                <td><code>raport_creditori/processor.py</code></td>
                <td>Python</td>
                <td>Procesare Raport Creditori (dosare active per client)</td>
                <td>Raport Creditori</td>
              </tr>
              <tr>
                <td><code>raport_creditori/screen.py</code></td>
                <td>Python</td>
                <td>GUI CustomTkinter pentru Raport Creditori</td>
                <td>Raport Creditori</td>
              </tr>
              <tr>
                <td><code>raport_creditori/scheduler.py</code></td>
                <td>Python</td>
                <td>Scheduler lunar (a 2-a zi lucrÄƒtoare, 08:30)</td>
                <td>Raport Creditori</td>
              </tr>
              <tr>
                <td><code>raport_creante_500/processor.py</code></td>
                <td>Python</td>
                <td>Procesare Raport CreanÈ›e &lt; 500 RON</td>
                <td>Raport CreanÈ›e 500</td>
              </tr>
              <tr>
                <td><code>raport_expunere_executare/processor.py</code></td>
                <td>Python</td>
                <td>Procesare Raport Expunere Executare</td>
                <td>Raport Expunere</td>
              </tr>
              <tr>
                <td><code>raport_termene_licitatie_garantii/processor.py</code></td>
                <td>Python</td>
                <td>Procesare Raport Termene LicitaÈ›ie GaranÈ›ii + Imobile</td>
                <td>Raport Termene</td>
              </tr>
              <tr>
                <td><code>raport_incidente_riscuri/processor.py</code></td>
                <td>Python</td>
                <td>Procesare Raport Incidente È™i Riscuri</td>
                <td>Raport Incidente</td>
              </tr>
              <tr>
                <td><code>raport_productivitate/process_bt_productivitate.py</code></td>
                <td>Python</td>
                <td>Procesare Raport Productivitate BT</td>
                <td>Raport Productivitate</td>
              </tr>
              <tr>
                <td><code>raport_productivitate/process_cesionate_productivitate.py</code></td>
                <td>Python</td>
                <td>Procesare Raport Productivitate Cesionate</td>
                <td>Raport Productivitate</td>
              </tr>
              <tr>
                <td><code>raport_creante_perimate_bt/processor.py</code></td>
                <td>Python</td>
                <td>Procesare Raport CreanÈ›e Perimate BT</td>
                <td>Raport Perimate BT</td>
              </tr>
              <tr>
                <td><code>raport_portal_just/actualizare_portal_just.py</code></td>
                <td>Python</td>
                <td>Procesare Raport Portal JustiÈ›ie (API SOAP)</td>
                <td>Raport Portal JustiÈ›ie</td>
              </tr>
              <tr>
                <td><code>raport_portal_just/instanta_normalizer.py</code></td>
                <td>Python</td>
                <td>Normalizare nume instanÈ›e (248 instanÈ›e)</td>
                <td>Raport Portal JustiÈ›ie</td>
              </tr>
              <tr>
                <td><code>raport_portal_just/chart_generator.py</code></td>
                <td>Python</td>
                <td>Generare grafice Plotly (PDF + HTML)</td>
                <td>Raport Portal JustiÈ›ie</td>
              </tr>
              <tr>
                <td><code>raport_portal_just/HTML Sumar litigii/generate_html_from_excel.py</code></td>
                <td>Python</td>
                <td>Generare HTML Sumar Executiv cu date hardcodate</td>
                <td>Raport Portal JustiÈ›ie</td>
              </tr>
              <tr>
                <td><code>raport_interogare_siui/processor.py</code></td>
                <td>Python</td>
                <td>Procesare Raport SIUI (CASAN interogÄƒri automate)</td>
                <td>Raport SIUI</td>
              </tr>
              <tr>
                <td><code>raport_interogare_siui/check_dependencies.py</code></td>
                <td>Python</td>
                <td>Verificare dependenÈ›e CASAN (Playwright, Tesseract, etc.)</td>
                <td>Raport SIUI</td>
              </tr>
              <tr>
                <td><code>raport_interogare_siui/install_dependencies.py</code></td>
                <td>Python</td>
                <td>Instalare automatÄƒ dependenÈ›e CASAN</td>
                <td>Raport SIUI</td>
              </tr>
              <tr>
                <td><code>raport_analiza_perimare_bt/processor.py</code></td>
                <td>Python</td>
                <td>Procesare AnalizÄƒ Perimare BT (9 categorii, 9+1 email-uri)</td>
                <td>Raport AnalizÄƒ Perimare</td>
              </tr>
              <tr>
                <td><code>raport_perimate_fara_actiuni/processor.py</code></td>
                <td>Python</td>
                <td>Procesare Raport Perimate È™i FÄƒrÄƒ AcÈ›iuni (4+1 email-uri)</td>
                <td>Raport Perimate</td>
              </tr>
              <tr>
                <td><code>utils/email_sender.py</code></td>
                <td>Python</td>
                <td>Utilitar comun trimitere email-uri Outlook</td>
                <td>Multiple</td>
              </tr>
              <tr>
                <td><code>utils/scheduler.py</code></td>
                <td>Python</td>
                <td>Utilitar comun scheduling automat</td>
                <td>Multiple</td>
              </tr>
              <tr>
                <td><code>DocumentaÈ›ia - Roboescu.html</code></td>
                <td>HTML</td>
                <td>DocumentaÈ›ie tehnicÄƒ completÄƒ cu diagrame SVG</td>
                <td>DocumentaÈ›ie</td>
              </tr>
            </tbody>
          </table>

          <h2>6. FiÈ™iere de Configurare</h2>
          <table>
            <thead>
              <tr>
                <th>FiÈ™ier</th>
                <th>LocaÈ›ie</th>
                <th>ConÈ›inut</th>
                <th>Utilizare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>config.json</code></td>
                <td>Root</td>
                <td>ConfiguraÈ›ie globalÄƒ aplicaÈ›ie</td>
                <td>main.py, toate modulele</td>
              </tr>
              <tr>
                <td><code>rapoarte_status.json</code></td>
                <td>Root</td>
                <td>Status fiecare raport (activ/mentenanÈ›Äƒ)</td>
                <td>main.py</td>
              </tr>
              <tr>
                <td><code>raport_*/config.json</code></td>
                <td>Fiecare modul</td>
                <td>ConfiguraÈ›ie specificÄƒ modul (foldere, email, scheduler)</td>
                <td>Fiecare modul</td>
              </tr>
              <tr>
                <td><code>raport_portal_just/portal_just_config.json</code></td>
                <td>raport_portal_just/</td>
                <td>ConfiguraÈ›ie API portal.just.ro (timeout, retry)</td>
                <td>Raport Portal JustiÈ›ie</td>
              </tr>
              <tr>
                <td><code>raport_portal_just/email_config.json</code></td>
                <td>raport_portal_just/</td>
                <td>ConfiguraÈ›ie email-uri BRLI (8 BRLI + 1 general)</td>
                <td>Raport Portal JustiÈ›ie</td>
              </tr>
              <tr>
                <td><code>raport_productivitate/email_config.json</code></td>
                <td>raport_productivitate/</td>
                <td>ConfiguraÈ›ie email-uri productivitate (BT + Cesionate)</td>
                <td>Raport Productivitate</td>
              </tr>
              <tr>
                <td><code>raport_productivitate/users_config.json</code></td>
                <td>raport_productivitate/</td>
                <td>Mapping utilizatori pentru productivitate</td>
                <td>Raport Productivitate</td>
              </tr>
              <tr>
                <td><code>raport_creante_500/istoric_procesari.json</code></td>
                <td>raport_creante_500/</td>
                <td>Istoric procesÄƒri cu timestamp È™i statistici</td>
                <td>Raport CreanÈ›e 500</td>
              </tr>
            </tbody>
          </table>

          <h2>7. Directoare de Date</h2>
          <table>
            <thead>
              <tr>
                <th>Director</th>
                <th>LocaÈ›ie</th>
                <th>ConÈ›inut</th>
                <th>Utilizare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>Master/</code></td>
                <td>Root</td>
                <td>FiÈ™iere Excel Master globale</td>
                <td>Multiple module</td>
              </tr>
              <tr>
                <td><code>rapoarte_generate/</code></td>
                <td>Root</td>
                <td>Rapoarte Excel generate (output)</td>
                <td>Toate modulele</td>
              </tr>
              <tr>
                <td><code>raport_*/Master/</code></td>
                <td>Fiecare modul</td>
                <td>FiÈ™iere Excel Master specifice modul</td>
                <td>Fiecare modul</td>
              </tr>
              <tr>
                <td><code>raport_*/Rezultate/</code></td>
                <td>Fiecare modul</td>
                <td>Rapoarte Excel generate specifice modul</td>
                <td>Fiecare modul</td>
              </tr>
              <tr>
                <td><code>raport_*/rapoarte_generate/</code></td>
                <td>Unele module</td>
                <td>Rapoarte Excel generate alternative</td>
                <td>Unele module</td>
              </tr>
              <tr>
                <td><code>raport_portal_just/HTML Sumar litigii/</code></td>
                <td>raport_portal_just/</td>
                <td>Template-uri HTML È™i generator Python</td>
                <td>Raport Portal JustiÈ›ie</td>
              </tr>
            </tbody>
          </table>

          <h2>8. Module de Rapoarte (13 Implementate)</h2>
          <table>
            <thead>
              <tr>
                <th>Modul</th>
                <th>Folder</th>
                <th>FiÈ™iere Principale</th>
                <th>FuncÈ›ionalitÄƒÈ›i</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Raport Creditori</strong></td>
                <td><code>raport_creditori/</code></td>
                <td>processor.py, screen.py, scheduler.py</td>
                <td>6 Excel-uri parolate, 6 email-uri, scheduler lunar</td>
              </tr>
              <tr>
                <td><strong>Raport CreanÈ›e &lt; 500 RON</strong></td>
                <td><code>raport_creante_500/</code></td>
                <td>processor.py, screen.py</td>
                <td>Filtrare, analizÄƒ, JSON istoric</td>
              </tr>
              <tr>
                <td><strong>Raport Expunere Executare</strong></td>
                <td><code>raport_expunere_executare/</code></td>
                <td>processor.py, screen.py</td>
                <td>Charts matplotlib, email cu grafice</td>
              </tr>
              <tr>
                <td><strong>Raport Termene LicitaÈ›ie GaranÈ›ii</strong></td>
                <td><code>raport_termene_licitatie_garantii/</code></td>
                <td>processor.py, screen.py, scheduler.py</td>
                <td>2 Excel-uri, pivot tables, scheduler</td>
              </tr>
              <tr>
                <td><strong>Raport Incidente È™i Riscuri</strong></td>
                <td><code>raport_incidente_riscuri/</code></td>
                <td>processor.py, screen.py</td>
                <td>N+1 email-uri per creditor</td>
              </tr>
              <tr>
                <td><strong>Raport Productivitate</strong></td>
                <td><code>raport_productivitate/</code></td>
                <td>process_bt_productivitate.py, process_cesionate_productivitate.py, screen.py</td>
                <td>2 procesÄƒri paralele, 2 email-uri</td>
              </tr>
              <tr>
                <td><strong>Raport CreanÈ›e Perimate BT</strong></td>
                <td><code>raport_creante_perimate_bt/</code></td>
                <td>processor.py, screen.py, scheduler.py</td>
                <td>3 sheet-uri Excel, email condiÈ›ional</td>
              </tr>
              <tr>
                <td><strong>Raport Portal JustiÈ›ie</strong></td>
                <td><code>raport_portal_just/</code></td>
                <td>actualizare_portal_just.py, instanta_normalizer.py, chart_generator.py</td>
                <td>API SOAP, HTML Sumar, Plotly charts, 9 email-uri</td>
              </tr>
              <tr>
                <td><strong>Raport SIUI (CASAN)</strong></td>
                <td><code>raport_interogare_siui/</code></td>
                <td>processor.py, check_dependencies.py, install_dependencies.py</td>
                <td>Playwright automation, OCR CAPTCHA, 4 metode</td>
              </tr>
              <tr>
                <td><strong>Raport AnalizÄƒ Perimare BT</strong></td>
                <td><code>raport_analiza_perimare_bt/</code></td>
                <td>processor.py, screen.py</td>
                <td>9 categorii, 9+1 email-uri, charts Plotly</td>
              </tr>
              <tr>
                <td><strong>Raport Perimate È™i FÄƒrÄƒ AcÈ›iuni</strong></td>
                <td><code>raport_perimate_fara_actiuni/</code></td>
                <td>processor.py, screen.py</td>
                <td>3 sheet-uri, pivot table, 4+1 email-uri</td>
              </tr>
            </tbody>
          </table>

          <h2>9. Securitate È™i ProtecÈ›ie</h2>
          <table>
            <thead>
              <tr>
                <th>ComponentÄƒ</th>
                <th>Tehnologie</th>
                <th>Configurare</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>ProtecÈ›ie Excel</strong></td>
                <td>xlsxwriter + msoffcrypto</td>
                <td>Parole per creditor</td>
                <td>Excel-uri parolate Ã®nainte de salvare È™i trimitere</td>
              </tr>
              <tr>
                <td><strong>Validare CNP</strong></td>
                <td>Regular expressions</td>
                <td>13 cifre, cifrÄƒ control</td>
                <td>Validare strictÄƒ CNP romÃ¢nesc</td>
              </tr>
              <tr>
                <td><strong>Validare Dosare</strong></td>
                <td>Regular expressions</td>
                <td>Format XXX/YYYY/ZZZZ</td>
                <td>Validare format dosare judiciare</td>
              </tr>
              <tr>
                <td><strong>Error Handling</strong></td>
                <td>try-except blocks</td>
                <td>Comprehensive logging</td>
                <td>Gestionare erori cu logging detaliat</td>
              </tr>
              <tr>
                <td><strong>Encoding UTF-8</strong></td>
                <td>io.TextIOWrapper</td>
                <td>Windows fix</td>
                <td>Fix encoding pentru caractere romÃ¢neÈ™ti</td>
              </tr>
              <tr>
                <td><strong>Checkpoint System</strong></td>
                <td>JSON serialization</td>
                <td>checkpoint.json</td>
                <td>Suspend/Resume pentru procesÄƒri lungi</td>
              </tr>
            </tbody>
          </table>

          <h2>10. Scripts È™i Comenzi</h2>
          <table>
            <thead>
              <tr>
                <th>ComandÄƒ</th>
                <th>Descriere</th>
                <th>Utilizare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>python main.py</code></td>
                <td>PorneÈ™te aplicaÈ›ia principalÄƒ</td>
                <td>Orchestrator toate modulele</td>
              </tr>
              <tr>
                <td><code>python raport_*/processor.py [--output FOLDER] [--no-email]</code></td>
                <td>RuleazÄƒ procesorul unui modul</td>
                <td>Fiecare modul</td>
              </tr>
              <tr>
                <td><code>python raport_*/screen.py</code></td>
                <td>PorneÈ™te GUI pentru un modul</td>
                <td>Fiecare modul</td>
              </tr>
              <tr>
                <td><code>python raport_*/scheduler.py</code></td>
                <td>PorneÈ™te scheduler automat</td>
                <td>Module cu scheduling</td>
              </tr>
              <tr>
                <td><code>python raport_interogare_siui/check_dependencies.py</code></td>
                <td>VerificÄƒ dependenÈ›e CASAN</td>
                <td>Raport SIUI</td>
              </tr>
              <tr>
                <td><code>python raport_interogare_siui/install_dependencies.py</code></td>
                <td>InstaleazÄƒ dependenÈ›e CASAN</td>
                <td>Raport SIUI</td>
              </tr>
              <tr>
                <td><code>pip install -r requirements.txt</code></td>
                <td>InstaleazÄƒ toate dependenÈ›ele Python</td>
                <td>Setup iniÈ›ial</td>
              </tr>
              <tr>
                <td><code>playwright install chromium</code></td>
                <td>InstaleazÄƒ browser Playwright</td>
                <td>Raport SIUI (CASAN)</td>
              </tr>
            </tbody>
          </table>

          <h2>11. InformaÈ›ii Proiect</h2>
          <table>
            <thead>
              <tr>
                <th>Proprietate</th>
                <th>Valoare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Nume Proiect</strong></td>
                <td>Roboescu</td>
              </tr>
              <tr>
                <td><strong>Versiune</strong></td>
                <td>1.0</td>
              </tr>
              <tr>
                <td><strong>Dezvoltator</strong></td>
                <td>Constantin BÄƒdescu</td>
              </tr>
              <tr>
                <td><strong>Limbaj Principal</strong></td>
                <td>Python 3.8+</td>
              </tr>
              <tr>
                <td><strong>PlatformÄƒ Deployment</strong></td>
                <td>Windows Workstation (Local)</td>
              </tr>
              <tr>
                <td><strong>Rapoarte Implementate</strong></td>
                <td>13 din 24 planificate (54% - È›intÄƒ: iunie 2026)</td>
              </tr>
              <tr>
                <td><strong>LicenÈ›Äƒ</strong></td>
                <td>MIT</td>
              </tr>
              <tr>
                <td><strong>Data DocumentaÈ›ie</strong></td>
                <td>2026-01-01</td>
              </tr>
            </tbody>
          </table>

          <h2>12. Hardware È™i Sistem de Operare</h2>
          <table>
            <thead>
              <tr>
                <th>ComponentÄƒ</th>
                <th>Recomandare</th>
                <th>Minim</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Sistem de Operare</strong></td>
                <td>Windows 11</td>
                <td>Windows 10</td>
                <td>PlatformÄƒ principalÄƒ de deployment</td>
              </tr>
              <tr>
                <td><strong>Procesor</strong></td>
                <td>Intel i5 / AMD Ryzen 5 (4+ core)</td>
                <td>Intel i3 / AMD Ryzen 3 (2+ core)</td>
                <td>Procesare Excel È™i browser automation</td>
              </tr>
              <tr>
                <td><strong>RAM</strong></td>
                <td>16 GB</td>
                <td>8 GB</td>
                <td>Procesare fiÈ™iere Excel mari, Playwright browser</td>
              </tr>
              <tr>
                <td><strong>Stocare</strong></td>
                <td>500 GB SSD</td>
                <td>250 GB HDD</td>
                <td>FiÈ™iere Master, rapoarte generate, logs</td>
              </tr>
              <tr>
                <td><strong>ReÈ›ea</strong></td>
                <td>Internet stabil</td>
                <td>Internet</td>
                <td>API portal.just.ro, CASAN website, email</td>
              </tr>
            </tbody>
          </table>

          <h2>13. Formate FiÈ™iere</h2>
          <table>
            <thead>
              <tr>
                <th>Format</th>
                <th>Extensie</th>
                <th>BibliotecÄƒ</th>
                <th>Utilizare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Excel</strong></td>
                <td>.xlsx</td>
                <td>openpyxl</td>
                <td>Format principal (citire/scriere)</td>
              </tr>
              <tr>
                <td><strong>Excel Legacy</strong></td>
                <td>.xls</td>
                <td>xlrd</td>
                <td>Suport legacy (auto-detection)</td>
              </tr>
              <tr>
                <td><strong>Excel Binary</strong></td>
                <td>.xlsb</td>
                <td>pyxlsb</td>
                <td>Suport binary (auto-detection)</td>
              </tr>
              <tr>
                <td><strong>JSON</strong></td>
                <td>.json</td>
                <td>json (built-in)</td>
                <td>ConfiguraÈ›ii, checkpoint-uri, istoric</td>
              </tr>
              <tr>
                <td><strong>HTML</strong></td>
                <td>.html</td>
                <td>String manipulation</td>
                <td>Email-uri HTML, dashboard-uri, documentaÈ›ie</td>
              </tr>
              <tr>
                <td><strong>PNG</strong></td>
                <td>.png</td>
                <td>PIL/Pillow, matplotlib</td>
                <td>Charts embedded Ã®n email-uri</td>
              </tr>
              <tr>
                <td><strong>PDF</strong></td>
                <td>.pdf</td>
                <td>kaleido (Plotly)</td>
                <td>Export grafice Plotly</td>
              </tr>
              <tr>
                <td><strong>Text Log</strong></td>
                <td>.log</td>
                <td>logging (built-in)</td>
                <td>Logging detaliat (ex: siui_casan.log)</td>
              </tr>
            </tbody>
          </table>

          <h2>14. ConfiguraÈ›ii Email</h2>
          <table>
            <thead>
              <tr>
                <th>Modul</th>
                <th>NumÄƒr Email-uri</th>
                <th>Destinatari</th>
                <th>Format</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Raport Creditori</strong></td>
                <td>6</td>
                <td>rpa@iccollect.ro, juridic@iccollect.ro</td>
                <td>HTML (Georgia 11pt)</td>
              </tr>
              <tr>
                <td><strong>Raport CreanÈ›e &lt; 500</strong></td>
                <td>1</td>
                <td>actualizari@iccollect.ro (CC: rpa, juridic)</td>
                <td>HTML (Georgia 11pt)</td>
              </tr>
              <tr>
                <td><strong>Raport Expunere Executare</strong></td>
                <td>1</td>
                <td>Configurabil</td>
                <td>HTML + Charts matplotlib (base64)</td>
              </tr>
              <tr>
                <td><strong>Raport Termene LicitaÈ›ie</strong></td>
                <td>1</td>
                <td>rpa@iccollect.ro, juridic@iccollect.ro</td>
                <td>HTML + Charts matplotlib</td>
              </tr>
              <tr>
                <td><strong>Raport Incidente Riscuri</strong></td>
                <td>N+1</td>
                <td>Per creditor (din Excel/config) + rpa, juridic</td>
                <td>HTML (Georgia 11pt)</td>
              </tr>
              <tr>
                <td><strong>Raport Productivitate</strong></td>
                <td>2</td>
                <td>Configurabil (email_config.json)</td>
                <td>HTML (Georgia 11pt)</td>
              </tr>
              <tr>
                <td><strong>Raport CreanÈ›e Perimate BT</strong></td>
                <td>1 (condiÈ›ional)</td>
                <td>Hardcoded</td>
                <td>HTML (Georgia 11pt)</td>
              </tr>
              <tr>
                <td><strong>Raport Portal JustiÈ›ie</strong></td>
                <td>9</td>
                <td>8 BRLI + juridic@iccollect.ro</td>
                <td>HTML + Excel + HTML Sumar</td>
              </tr>
              <tr>
                <td><strong>Raport AnalizÄƒ Perimare BT</strong></td>
                <td>10</td>
                <td>9 categorii + 1 statistici</td>
                <td>HTML + Charts Plotly embedded</td>
              </tr>
              <tr>
                <td><strong>Raport Perimate FÄƒrÄƒ AcÈ›iuni</strong></td>
                <td>5</td>
                <td>4 portofolii + juridic@iccollect.ro</td>
                <td>HTML + Pivot table embedded</td>
              </tr>
            </tbody>
          </table>

          <h2>15. Scheduler È™i AutomatizÄƒri</h2>
          <table>
            <thead>
              <tr>
                <th>Modul</th>
                <th>FrecvenÈ›Äƒ</th>
                <th>Zi/Ora</th>
                <th>FiÈ™ier</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Raport Creditori</strong></td>
                <td>Lunar</td>
                <td>A 2-a zi lucrÄƒtoare, 08:30</td>
                <td>scheduler.py</td>
              </tr>
              <tr>
                <td><strong>Raport Termene LicitaÈ›ie</strong></td>
                <td>Zilnic</td>
                <td>UrmÄƒtoarea zi, 08:30</td>
                <td>scheduler.py</td>
              </tr>
              <tr>
                <td><strong>Raport Productivitate</strong></td>
                <td>Lunar</td>
                <td>Configurabil</td>
                <td>scheduler.py</td>
              </tr>
              <tr>
                <td><strong>Raport CreanÈ›e Perimate BT</strong></td>
                <td>Lunar</td>
                <td>Configurabil</td>
                <td>scheduler.py</td>
              </tr>
            </tbody>
          </table>

          <h2>16. External Tools È™i DependenÈ›e</h2>
          <table>
            <thead>
              <tr>
                <th>Tool</th>
                <th>Versiune</th>
                <th>Instalare</th>
                <th>Utilizare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Tesseract OCR</strong></td>
                <td>Latest</td>
                <td>Windows Installer</td>
                <td>Raport SIUI (rezolvare CAPTCHA)</td>
              </tr>
              <tr>
                <td><strong>Playwright Chromium</strong></td>
                <td>Latest</td>
                <td><code>playwright install chromium</code></td>
                <td>Raport SIUI (browser automation)</td>
              </tr>
              <tr>
                <td><strong>Microsoft Outlook</strong></td>
                <td>Desktop</td>
                <td>Windows Installation</td>
                <td>Toate modulele (trimitere email)</td>
              </tr>
            </tbody>
          </table>

          <h2>17. Fonturi È™i Formatare</h2>
          <table>
            <thead>
              <tr>
                <th>Element</th>
                <th>Font</th>
                <th>Dimensiune</th>
                <th>Utilizare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Excel Cells</strong></td>
                <td>Georgia</td>
                <td>11pt</td>
                <td>Toate rapoartele Excel</td>
              </tr>
              <tr>
                <td><strong>Email Body</strong></td>
                <td>Georgia</td>
                <td>11pt</td>
                <td>Toate email-urile HTML</td>
              </tr>
              <tr>
                <td><strong>Charts matplotlib</strong></td>
                <td>Georgia</td>
                <td>11pt</td>
                <td>Grafice embedded Ã®n email-uri</td>
              </tr>
              <tr>
                <td><strong>GUI Interface</strong></td>
                <td>Times New Roman / CustomTkinter default</td>
                <td>Variabil</td>
                <td>InterfaÈ›Äƒ graficÄƒ module</td>
              </tr>
            </tbody>
          </table>

          <h2>18. Parole Excel (ProtecÈ›ie)</h2>
          <table>
            <thead>
              <tr>
                <th>Modul</th>
                <th>ParolÄƒ</th>
                <th>FiÈ™iere</th>
                <th>NotÄƒ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Raport Creditori</strong></td>
                <td>ProtecÈ›ie parolÄƒ activÄƒ</td>
                <td>EOS, BTD CREDITE, SALT, BT MIC, BT LEASING</td>
                <td>5 din 6 creditori</td>
              </tr>
              <tr>
                <td><strong>Raport Creditori</strong></td>
                <td>ProtecÈ›ie parolÄƒ activÄƒ</td>
                <td>BTD CARDURI</td>
                <td>1 creditor special</td>
              </tr>
              <tr>
                <td><strong>Raport Termene LicitaÈ›ie</strong></td>
                <td>ProtecÈ›ie parolÄƒ activÄƒ</td>
                <td>Toate Excel-urile</td>
                <td>Standard</td>
              </tr>
              <tr>
                <td><strong>Raport Perimate FÄƒrÄƒ AcÈ›iuni</strong></td>
                <td>N/A</td>
                <td>FÄƒrÄƒ protecÈ›ie</td>
                <td>Excel standard</td>
              </tr>
            </tbody>
          </table>

          <h2>19. Logging È™i Monitoring</h2>
          <table>
            <thead>
              <tr>
                <th>Modul</th>
                <th>FiÈ™ier Log</th>
                <th>Format</th>
                <th>ConÈ›inut</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Raport SIUI</strong></td>
                <td>siui_casan.log</td>
                <td>Text</td>
                <td>Progres CASAN, erori CAPTCHA, statistici</td>
              </tr>
              <tr>
                <td><strong>Raport Creditori</strong></td>
                <td>raport_creditori.log</td>
                <td>Text</td>
                <td>Progres procesare, erori</td>
              </tr>
              <tr>
                <td><strong>Toate Modulele</strong></td>
                <td>Console output</td>
                <td>Print statements</td>
                <td>Progres real-time, erori, statistici</td>
              </tr>
            </tbody>
          </table>

          <h2>20. Versiuni È™i Compatibilitate</h2>
          <table>
            <thead>
              <tr>
                <th>ComponentÄƒ</th>
                <th>Versiune MinimÄƒ</th>
                <th>Versiune RecomandatÄƒ</th>
                <th>NotÄƒ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Python</strong></td>
                <td>3.8</td>
                <td>3.10+</td>
                <td>Type hints, f-strings</td>
              </tr>
              <tr>
                <td><strong>Windows</strong></td>
                <td>Windows 10</td>
                <td>Windows 11</td>
                <td>COM Interface (Outlook)</td>
              </tr>
              <tr>
                <td><strong>Microsoft Office</strong></td>
                <td>Office 2016</td>
                <td>Office 365</td>
                <td>Outlook pentru email</td>
              </tr>
              <tr>
                <td><strong>Excel Format</strong></td>
                <td>.xlsx (2007+)</td>
                <td>.xlsx (2016+)</td>
                <td>Suport È™i .xls, .xlsb</td>
              </tr>
            </tbody>
          </table>
        </section>
      </div>
    </section>

    <section class="content-section hidden" id="secFirewall">
      <div class="section-head">
        <div class="title">ğŸ›¡ï¸ Reguli Firewall &amp; Separare LogicÄƒ</div>
        <div style="opacity:.75; font-weight:700; color:#22507a;">MÄƒsuri de securitate È™i separare</div>
      </div>
      <div class="section-body">
        <section class="doc-section">
          <h2>Reguli Firewall È™i MÄƒsuri de Separare LogicÄƒ</h2>
          <p><strong>Deployment:</strong> AplicaÈ›ia Roboescu este instalatÄƒ local pe staÈ›ia de lucru Windows pusÄƒ la dispoziÈ›ie de companie, utilizatÄƒ exclusiv de utilizatorul desemnat ICC. Accesul la aplicaÈ›ie È™i la toate fiÈ™ierele asociate este limitat strict la utilizatorul Windows autorizat, conform politicilor interne de securitate IT ale GFBT.</p>
          <p><strong>Stocare Date:</strong> Toate fiÈ™ierele de prelucrare È™i rezultatele generate sunt stocate integral local pe staÈ›ia de lucru, nu sunt accesibile de pe alte echipamente È™i nu sunt partajate prin reÈ›ea sau servicii cloud.</p>

          <h3>1. Separare LogicÄƒ È™i Controlul Accesului</h3>
          
          <h4>1.1. Separare la Nivel de Utilizator</h4>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Tip</th>
                <th>Configurare ConcretÄƒ</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Parole SecÈ›iuni Sensibile</strong></td>
                <td>Control acces aplicaÈ›ie</td>
                <td>â€¢ SecÈ›iunea "Juridic ICC": ParolÄƒ dedicatÄƒ<br>
                  â€¢ SecÈ›iunea "InsolvenÈ›Äƒ ICC": ParolÄƒ dedicatÄƒ<br>
                  â€¢ SecÈ›iunea "Executare silitÄƒ ICC": ParolÄƒ dedicatÄƒ<br>
                  â€¢ SecÈ›iunea "Conformitate": ParolÄƒ dedicatÄƒ<br>
                  â€¢ SecÈ›iunea "Amiabil ICC": ParolÄƒ dedicatÄƒ<br>
                  â€¢ SecÈ›iunea "Raportare CRC BNR": ParolÄƒ dedicatÄƒ<br>
                  â€¢ SecÈ›iunea "Audit/Administrativ": ParolÄƒ dedicatÄƒ<br>
                  â€¢ Fiecare secÈ›iune are parolÄƒ unicÄƒ pentru control acces
                </td>
                <td>Implementare Ã®n <code>main.py</code> (linia 163-206):<br>
                  â€¢ FuncÈ›ie <code>show_password_dialog()</code><br>
                  â€¢ Verificare parolÄƒ la accesare secÈ›iuni sensibile<br>
                  â€¢ Dialog modal pentru introducere parolÄƒ<br>
                  â€¢ Blocare acces dacÄƒ parolÄƒ incorectÄƒ<br>
                  â€¢ Parolele sunt configurate Ã®n cod pentru securitate
                </td>
              </tr>
            </tbody>
          </table>

          <h4>1.2. Separare la Nivel de Date</h4>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Tip</th>
                <th>Configurare ConcretÄƒ</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Stocare LocalÄƒ ExclusivÄƒ</strong></td>
                <td>Separare logicÄƒ stocare</td>
                <td>â€¢ Toate fiÈ™ierele de prelucrare: Stocate integral local pe staÈ›ia de lucru<br>
                  â€¢ Rezultatele generate: Stocate local, nu accesibile de pe alte echipamente<br>
                  â€¢ Nu existÄƒ partajare prin reÈ›ea sau servicii cloud<br>
                  â€¢ Nu existÄƒ baze de date sau directoare partajate
                </td>
                <td>StructurÄƒ proiect local:<br>
                  â€¢ <code>raport_*/Master/</code> - fiÈ™iere de intrare locale<br>
                  â€¢ <code>raport_*/Rezultate/</code> - rezultate generate locale<br>
                  â€¢ <code>rapoarte_generate/</code> - output local<br>
                  â€¢ FÄƒrÄƒ conexiuni cloud, fÄƒrÄƒ partajare reÈ›ea<br>
                  â€¢ Stocare complet localÄƒ pe staÈ›ia de lucru
                </td>
              </tr>
              <tr>
                <td><strong>Separare Module</strong></td>
                <td>Separare logicÄƒ procese</td>
                <td>â€¢ Fiecare modul: Folder separat cu propriile date<br>
                  â€¢ ConfiguraÈ›ie: config.json per modul<br>
                  â€¢ Procesare: IndependentÄƒ, fÄƒrÄƒ dependenÈ›e cross-module<br>
                  â€¢ Erori: Izolate, nu afecteazÄƒ alte module
                </td>
                <td>StructurÄƒ proiect:<br>
                  â€¢ <code>raport_creditori/</code> - complet independent<br>
                  â€¢ <code>raport_portal_just/</code> - complet independent<br>
                  â€¢ <code>raport_interogare_siui/</code> - complet independent<br>
                  â€¢ Fiecare modul ruleazÄƒ Ã®n proces separat via <code>subprocess.run()</code>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>2. Reguli de Firewall â€“ Controlul ComunicaÈ›iilor</h3>
          <p>Firewall-ul local È™i politicile de reÈ›ea ale GFBT sunt configurate astfel Ã®ncÃ¢t sÄƒ permitÄƒ doar comunicaÈ›iile strict necesare funcÈ›ionÄƒrii aplicaÈ›iei.</p>
          
          <h4>2.1. Trafic Permis</h4>
          <table>
            <thead>
              <tr>
                <th>ComunicaÈ›ie</th>
                <th>Tip</th>
                <th>DestinaÈ›ie</th>
                <th>Protocol/Port</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Email Outbound</strong></td>
                <td>SMTP/Exchange</td>
                <td>â€¢ Servere de e-mail interne prin clientul Outlook<br>
                  â€¢ Destinatari interni ICC:<br>
                  &nbsp;&nbsp;- ICC juridic (juridic@iccollect.ro)<br>
                  &nbsp;&nbsp;- ICC cesionate<br>
                  &nbsp;&nbsp;- ICC actualizÄƒri (actualizari@iccollect.ro)<br>
                  &nbsp;&nbsp;- ICC RPA (rpa@iccollect.ro)<br>
                  &nbsp;&nbsp;- ICC dosare(dosare@iccollect.ro)<br>
                  â€¢ Creditori din grupul GFBT:<br>
                  &nbsp;&nbsp;- BT Mic<br>
                  &nbsp;&nbsp;- BT Direct s.a.m.d.
                </td>
                <td>SMTP/Exchange (port 25/587/443)<br>
                  Outlook COM Interface (local)
                </td>
                <td>Implementare Ã®n <code>utils/email_sender.py</code>:<br>
                  â€¢ <code>win32com.client</code> (COM Interface local)<br>
                  â€¢ Outlook trimite prin server Exchange ICC<br>
                  â€¢ Destinatari hardcodate Ã®n fiecare modul<br>
                  â€¢ Integrare localÄƒ prin COM Interface
                </td>
              </tr>
              <tr>
                <td><strong>API Portal JustiÈ›ie</strong></td>
                <td>SOAP HTTPS</td>
                <td>â€¢ portalquery.just.ro<br>
                  â€¢ Interogare dosare judiciare
                </td>
                <td>HTTPS (port 443)<br>
                  Protocol: SOAP
                </td>
                <td>Implementare Ã®n <code>raport_portal_just/actualizare_portal_just.py</code>:<br>
                  â€¢ Client SOAP: <code>zeep.Client()</code><br>
                  â€¢ Timeout: 10 secunde<br>
                  â€¢ Conexiune outbound HTTPS cÄƒtre portal.just.ro
                </td>
              </tr>
              <tr>
                <td><strong>CASAN SIUI</strong></td>
                <td>HTTPS Web</td>
                <td>â€¢ siui.casan.ro/asigurati/<br>
                  â€¢ Verificare calitate asigurat
                </td>
                <td>HTTPS (port 443)<br>
                  Browser: Playwright Chromium
                </td>
                <td>Implementare Ã®n <code>raport_interogare_siui/processor.py</code>:<br>
                  â€¢ Browser: <code>playwright.chromium.launch(headless=True)</code><br>
                  â€¢ User-agent rotation, random delays<br>
                  â€¢ CAPTCHA OCR: Tesseract<br>
                  â€¢ Conexiune outbound HTTPS cÄƒtre siui.casan.ro
                </td>
              </tr>
            </tbody>
          </table>


          <h3>3. Securitate Date</h3>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Tip</th>
                <th>Configurare ConcretÄƒ</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>ProtecÈ›ie Excel cu ParolÄƒ</strong></td>
                <td>Criptare fiÈ™iere</td>
                <td>â€¢ Excel-uri generate: ProtecÈ›ie parolÄƒ obligatorie<br>
                  â€¢ Raport Creditori: 6 Excel-uri parolate<br>
                  â€¢ Raport Termene LicitaÈ›ie: Excel-uri parolate<br>
                  â€¢ FiÈ™ierele sunt parolate Ã®nainte de salvare
                </td>
                <td>Implementare Ã®n <code>raport_creditori/processor.py</code> (linia 403-490):<br>
                  â€¢ FuncÈ›ie <code>save_protected_excel()</code><br>
                  â€¢ BibliotecÄƒ: <code>xlsxwriter</code> + <code>msoffcrypto-tool</code><br>
                  â€¢ Parole configurate Ã®n cod pentru securitate<br>
                  â€¢ Criptare realÄƒ Excel cu <code>msoffcrypto.OfficeFile()</code><br>
                  â€¢ Excel-urile nu pot fi deschise fÄƒrÄƒ parolÄƒ
                </td>
              </tr>
              <tr>
                <td><strong>Validare Date Sensibile</strong></td>
                <td>ProtecÈ›ie integritate</td>
                <td>â€¢ Validare CNP: Format strict (13 cifre, cifrÄƒ control)<br>
                  â€¢ Validare algoritm: CifrÄƒ de control CNP<br>
                  â€¢ Reject CNP invalid: Marcaj "CNP INVALID" Ã®n Excel<br>
                  â€¢ Logging: Toate validÄƒrile È™i erorile
                </td>
                <td>Implementare Ã®n <code>raport_interogare_siui/processor.py</code> (linia 50-90):<br>
                  â€¢ FuncÈ›ie <code>valid_cnp(cnp: str) -> bool</code><br>
                  â€¢ Verificare: 13 cifre, algoritm cifrÄƒ control<br>
                  â€¢ Reject: CNP invalid â†’ "CNP INVALID" Ã®n coloanÄƒ<br>
                  â€¢ Logging: <code>logger.warning()</code> pentru CNP-uri invalide
                </td>
              </tr>
              <tr>
                <td><strong>Email Security</strong></td>
                <td>ProtecÈ›ie transmisie</td>
                <td>â€¢ Destinatari: Hardcodate Ã®n cod sau config.json<br>
                  â€¢ AtaÈ™amente: Excel-uri parolate<br>
                  â€¢ Outlook COM: Integrare localÄƒ (nu SMTP extern)<br>
                  â€¢ Logging: Print statements pentru email-uri trimise
                </td>
                <td>Implementare Ã®n <code>utils/email_sender.py</code> (linia 1-98):<br>
                  â€¢ FuncÈ›ie <code>send_email_with_attachment()</code><br>
                  â€¢ Integrare: <code>win32com.client</code> (Outlook local)<br>
                  â€¢ Destinatari: Hardcodate Ã®n fiecare modul sau config.json<br>
                  â€¢ Trimitere directÄƒ cÄƒtre destinatari configuraÈ›i<br>
                  â€¢ Logging: <code>print()</code> pentru succes/eroare
                </td>
              </tr>
            </tbody>
          </table>

          <h3>4. Transmiterea Rezultatelor</h3>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Tip</th>
                <th>Configurare ConcretÄƒ</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Stocare LocalÄƒ MajoritarÄƒ</strong></td>
                <td>Stocare rezultate</td>
                <td>â€¢ Majoritatea rezultatelor sunt pÄƒstrate local<br>
                  â€¢ Folder-uri: <code>raport_*/Rezultate/</code>, <code>rapoarte_generate/</code><br>
                  â€¢ Nu sunt transmise automat<br>
                  â€¢ Accesibile doar local pe staÈ›ia de lucru
                </td>
                <td>Implementare Ã®n <code>processor.py</code> (fiecare modul):<br>
                  â€¢ Salvare localÄƒ: <code>df.to_excel(output_path)</code><br>
                  â€¢ LocaÈ›ie: Folder-uri locale definite Ã®n config<br>
                  â€¢ Format: Excel parolat (pentru rapoarte sensibile)<br>
                  â€¢ Stocare complet localÄƒ pe staÈ›ia de lucru
                </td>
              </tr>
              <tr>
                <td><strong>Transmitere AutomatÄƒ Subset</strong></td>
                <td>Email automat</td>
                <td>â€¢ Doar un subset strict definit de rezultate este transmis automat prin Outlook<br>
                  â€¢ Destinatari interni ICC:<br>
                  &nbsp;&nbsp;- juridic@iccollect.ro<br>
                  &nbsp;&nbsp;- actualizari@iccollect.ro<br>
                  &nbsp;&nbsp;- rpa@iccollect.ro<br>
                  â€¢ Creditori din grupul GFBT (BT Mic, BT Direct, etc.)<br>
                  â€¢ Nu se transmit date cÄƒtre terÈ›i din afara grupului GFBT
                </td>
                <td>Implementare Ã®n <code>utils/email_sender.py</code> È™i module:<br>
                  â€¢ FuncÈ›ie <code>send_email_with_attachment()</code><br>
                  â€¢ Destinatari: Hardcodate Ã®n fiecare modul<br>
                  â€¢ AtaÈ™amente: Excel-uri parolate<br>
                  â€¢ Outlook COM: Trimite prin server Exchange ICC<br>
                  â€¢ Destinatarii sunt hardcodate Ã®n cod pentru securitate
                </td>
              </tr>
              <tr>
                <td><strong>ProtecÈ›ie Excel Ã®n Transmitere</strong></td>
                <td>Securitate date</td>
                <td>â€¢ Toate Excel-urile transmise prin email sunt parolate Ã®nainte de trimitere<br>
                  â€¢ ProtecÈ›ie: Excel-urile nu pot fi deschise fÄƒrÄƒ parolÄƒ<br>
                  â€¢ Securitate: Date protejate Ã®n tranzit<br>
                  â€¢ FiÈ™ierele pleacÄƒ parolate de la aplicaÈ›ie
                </td>
                <td>Implementare Ã®n <code>raport_creditori/processor.py</code> (linia 403-490):<br>
                  â€¢ FuncÈ›ie <code>save_protected_excel()</code><br>
                  â€¢ Criptare: <code>msoffcrypto.OfficeFile()</code><br>
                  â€¢ Parole configurate Ã®n cod pentru securitate<br>
                  â€¢ Excel-urile sunt parolate Ã®nainte de trimitere email
                </td>
              </tr>
            </tbody>
          </table>

          <h3>5. Separare LogicÄƒ - Module Independente</h3>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Tip</th>
                <th>Configurare ConcretÄƒ</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Izolare Module</strong></td>
                <td>Separare logicÄƒ procese</td>
                <td>â€¢ Fiecare modul: Folder separat cu propriile date<br>
                  â€¢ ConfiguraÈ›ie: config.json per modul<br>
                  â€¢ Procesare: IndependentÄƒ, fÄƒrÄƒ dependenÈ›e cross-module<br>
                  â€¢ Erori: Izolate, nu afecteazÄƒ alte module
                </td>
                <td>StructurÄƒ proiect:<br>
                  â€¢ <code>raport_creditori/</code> - complet independent<br>
                  â€¢ <code>raport_portal_just/</code> - complet independent<br>
                  â€¢ <code>raport_interogare_siui/</code> - complet independent<br>
                  â€¢ Fiecare modul ruleazÄƒ Ã®n proces separat
                </td>
              </tr>
              <tr>
                <td><strong>Separare Date Master</strong></td>
                <td>Separare logicÄƒ stocare</td>
                <td>â€¢ Fiecare modul: Folder Master/ propriu<br>
                  â€¢ Nu existÄƒ share-are date Ã®ntre module<br>
                  â€¢ Output: Folder Rezultate/ separat per modul<br>
                  â€¢ Nu existÄƒ baze de date partajate
                </td>
                <td>Organizare directoare locale:<br>
                  â€¢ <code>raport_creditori/Master/</code> - local<br>
                  â€¢ <code>raport_portal_just/Master/</code> - local<br>
                  â€¢ <code>raport_interogare_siui/Master/</code> - local<br>
                  â€¢ FÄƒrÄƒ acces cross-module, fÄƒrÄƒ partajare reÈ›ea
                </td>
              </tr>
              <tr>
                <td><strong>Procese Independente</strong></td>
                <td>Separare logicÄƒ execuÈ›ie</td>
                <td>â€¢ Fiecare modul: Proces Python separat<br>
                  â€¢ Subprocess execution: Din GUI (screen.py)<br>
                  â€¢ Erori: Nu propagÄƒ cÄƒtre alte procese<br>
                  â€¢ Resource isolation: Memorie È™i CPU separate
                </td>
                <td>Implementare Ã®n <code>screen.py</code> (fiecare modul):<br>
                  â€¢ <code>subprocess.run(['python', 'processor.py', '--output', folder])</code><br>
                  â€¢ Fiecare proces ruleazÄƒ independent<br>
                  â€¢ Error handling: <code>try-except</code> Ã®n GUI<br>
                  â€¢ Nu existÄƒ shared state Ã®ntre procese
                </td>
              </tr>
            </tbody>
          </table>

          <h3>6. Logging È™i Monitorizare</h3>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Tip</th>
                <th>Configurare ConcretÄƒ</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Logging Procesare</strong></td>
                <td>Monitorizare procesare</td>
                <td>â€¢ Log files: <code>siui_casan.log</code>, <code>raport_creditori.log</code><br>
                  â€¢ Format: Timestamp, nivel (DEBUG/INFO/WARNING/ERROR), mesaj<br>
                  â€¢ Encoding: UTF-8 pentru caractere romÃ¢neÈ™ti<br>
                  â€¢ Stocare: Local pe staÈ›ia de lucru
                </td>
                <td>Implementare Ã®n <code>processor.py</code> (fiecare modul):<br>
                  â€¢ <code>logging.basicConfig()</code> cu FileHandler È™i StreamHandler<br>
                  â€¢ Encoding: <code>encoding='utf-8'</code> Ã®n FileHandler<br>
                  â€¢ Format: <code>%(asctime)s - %(levelname)s - %(message)s</code><br>
                  â€¢ Logging: <code>logger.info()</code>, <code>logger.error()</code>, <code>logger.warning()</code><br>
                  â€¢ Log-urile sunt stocate local, nu sunt transmise extern
                </td>
              </tr>
              <tr>
                <td><strong>Logging Email</strong></td>
                <td>Monitorizare comunicaÈ›ii</td>
                <td>â€¢ Print statements: Succes/eroare pentru fiecare email trimis<br>
                  â€¢ Format: <code>âœ… Email trimis cu succes cÄƒtre: {to_email}</code><br>
                  â€¢ Erori: <code>âŒ Eroare la trimiterea email-ului: {error}</code><br>
                  â€¢ Stocare: Console output local
                </td>
                <td>Implementare Ã®n <code>utils/email_sender.py</code> (linia 42-47):<br>
                  â€¢ <code>print()</code> pentru succes/eroare<br>
                  â€¢ Status: Return <code>True</code>/<code>False</code> pentru succes/eroare<br>
                  â€¢ Logging local - nu este transmis extern
                </td>
              </tr>
            </tbody>
          </table>

          <h3>7. Rezumat MÄƒsuri de Securitate Implementate</h3>
          <p>AplicaÈ›ia Roboescu implementeazÄƒ urmÄƒtoarele mÄƒsuri de securitate:</p>
          <ul>
            <li><strong>Parole SecÈ›iuni Sensibile</strong> - Control acces la nivel aplicaÈ›ie pentru secÈ›iuni sensibile (Juridic, InsolvenÈ›Äƒ, Executare, Conformitate, Amiabil, Raportare CRC BNR, Audit/Administrativ)</li>
            <li><strong>ProtecÈ›ie Excel cu ParolÄƒ</strong> - Excel-uri generate cu criptare realÄƒ folosind <code>msoffcrypto-tool</code>, fiÈ™ierele sunt parolate Ã®nainte de salvare È™i trimitere</li>
            <li><strong>Validare Date Sensibile</strong> - Validare CNP cu algoritm cifrÄƒ control, reject CNP-uri invalide</li>
            <li><strong>Stocare LocalÄƒ ExclusivÄƒ</strong> - Toate fiÈ™ierele stocate integral local pe staÈ›ia de lucru, fÄƒrÄƒ partajare reÈ›ea sau cloud</li>
            <li><strong>Separare Module</strong> - Fiecare modul Ã®n folder separat, procesare independentÄƒ, erori izolate</li>
            <li><strong>Procese Independente</strong> - Fiecare modul ruleazÄƒ Ã®n proces Python separat via <code>subprocess.run()</code></li>
            <li><strong>Email Security</strong> - Integrare Outlook local (COM Interface), destinatari hardcodate, ataÈ™amente Excel parolate</li>
            <li><strong>Logging Local</strong> - Logging detaliat Ã®n fiÈ™iere locale cu encoding UTF-8, stocare localÄƒ</li>
            <li><strong>Transmitere LimitatÄƒ</strong> - Doar subset strict definit de rezultate transmis automat prin Outlook cÄƒtre interni ICC È™i creditori GFBT</li>
            <li><strong>ProtecÈ›ie Ã®n Transmitere</strong> - Toate Excel-urile transmise prin email sunt parolate Ã®nainte de trimitere</li>
          </ul>
        </section>
      </div>
    </section>

    <section class="content-section hidden" id="secSoftware">
      <div class="section-head">
        <div class="title">ğŸ’» Software &amp; StaÈ›ii de Lucru</div>
        <div style="opacity:.75; font-weight:700; color:#22507a;">Necesar software, setÄƒri È™i protocoale</div>
      </div>
      <div class="section-body">
        <section class="doc-section">
          <h2>Necesar Software StaÈ›ii de Lucru</h2>
          <p>Acest document enumerÄƒ software-ul necesar, setÄƒrile dedicate funcÈ›ionÄƒrii, tehnologiile È™i protocoalele utilizate Ã®n proiectul Roboescu. AplicaÈ›ia ruleazÄƒ local pe staÈ›ia de lucru Windows a utilizatorului ICC desemnat.</p>

          <h3>1. Sistem de Operare</h3>
          <table>
            <thead>
              <tr>
                <th>Software</th>
                <th>Versiune</th>
                <th>Scop</th>
                <th>NotÄƒ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Windows</strong></td>
                <td>10 / 11</td>
                <td>Sistem de operare</td>
                <td>Recomandat Windows 10 sau superior</td>
              </tr>
              <tr>
                <td><strong>Python</strong></td>
                <td>3.8+</td>
                <td>Runtime environment pentru aplicaÈ›ie</td>
                <td>Necesar pentru rularea aplicaÈ›iei Roboescu</td>
              </tr>
              <tr>
                <td><strong>pip (Python Package Manager)</strong></td>
                <td>Inclus cu Python</td>
                <td>Gestionare dependenÈ›e Python</td>
                <td>Necesar pentru instalare pachete Python</td>
              </tr>
            </tbody>
          </table>

          <h3>2. Software Extern Necesar</h3>
          <table>
            <thead>
              <tr>
                <th>Software</th>
                <th>Versiune</th>
                <th>Scop</th>
                <th>NotÄƒ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Microsoft Outlook</strong></td>
                <td>2016 sau superior</td>
                <td>Client email pentru trimitere rapoarte</td>
                <td>Necesar pentru funcÈ›ionalitatea de email. Trebuie instalat È™i configurat cu cont Exchange ICC</td>
              </tr>
              <tr>
                <td><strong>Tesseract OCR</strong></td>
                <td>5.3.3+</td>
                <td>RecunoaÈ™tere text pentru rezolvare CAPTCHA</td>
                <td>OpÈ›ional, necesar doar pentru interogarea CASAN SIUI. DescÄƒrcare: https://github.com/UB-Mannheim/tesseract/wiki</td>
              </tr>
              <tr>
                <td><strong>Microsoft Excel</strong></td>
                <td>2016 sau superior</td>
                <td>Vizualizare È™i editare fiÈ™iere Excel generate</td>
                <td>OpÈ›ional, pentru verificare manualÄƒ a rapoartelor generate</td>
              </tr>
            </tbody>
          </table>

          <h3>3. DependenÈ›e Python</h3>
          <p>Toate dependenÈ›ele Python sunt listate Ã®n <code>requirements.txt</code> È™i pot fi instalate cu comanda: <code>pip install -r requirements.txt</code></p>
          
          <h4>3.1. InterfaÈ›Äƒ GraficÄƒ</h4>

          <table>
            <thead>
              <tr>
                <th>BibliotecÄƒ</th>
                <th>Versiune</th>
                <th>Scop</th>
                <th>Utilizare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>customtkinter</strong></td>
                <td>â‰¥5.0.0</td>
                <td>GUI modern cu dark theme</td>
                <td>InterfaÈ›Äƒ graficÄƒ principalÄƒ a aplicaÈ›iei</td>
              </tr>
              <tr>
                <td><strong>Pillow</strong></td>
                <td>â‰¥9.0.0</td>
                <td>Procesare imagini</td>
                <td>Procesare imagini pentru interfaÈ›Äƒ È™i CAPTCHA</td>
              </tr>
            </tbody>
          </table>

          <h4>3.2. Prelucrare Excel</h4>
          <table>
            <thead>
              <tr>
                <th>BibliotecÄƒ</th>
                <th>Versiune</th>
                <th>Scop</th>
                <th>Utilizare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>openpyxl</strong></td>
                <td>â‰¥3.0.0</td>
                <td>Citire/scriere fiÈ™iere Excel</td>
                <td>Prelucrare Excel-uri, formatare, protecÈ›ie parolÄƒ</td>
              </tr>
              <tr>
                <td><strong>pandas</strong></td>
                <td>â‰¥1.5.0</td>
                <td>Manipulare date</td>
                <td>DataFrame operations, filtrare, concatenare, analizÄƒ date</td>
              </tr>
              <tr>
                <td><strong>xlsxwriter</strong></td>
                <td>Inclus implicit</td>
                <td>Scriere Excel avansatÄƒ</td>
                <td>Generare Excel-uri cu formatare complexÄƒ</td>
              </tr>
              <tr>
                <td><strong>msoffcrypto-tool</strong></td>
                <td>Inclus implicit</td>
                <td>Criptare Excel</td>
                <td>ProtecÈ›ie parolÄƒ realÄƒ pentru Excel-uri</td>
              </tr>
            </tbody>
          </table>

          <h4>3.3. Automatizare Web</h4>
          <table>
            <thead>
              <tr>
                <th>BibliotecÄƒ</th>
                <th>Versiune</th>
                <th>Scop</th>
                <th>Utilizare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>playwright</strong></td>
                <td>â‰¥1.30.0</td>
                <td>Browser automation</td>
                <td>Automatizare interogÄƒri CASAN SIUI, headless browsing</td>
              </tr>
              <tr>
                <td><strong>pytesseract</strong></td>
                <td>â‰¥0.3.10</td>
                <td>Wrapper Python pentru Tesseract OCR</td>
                <td>RecunoaÈ™tere text CAPTCHA</td>
              </tr>
              <tr>
                <td><strong>opencv-python</strong></td>
                <td>â‰¥4.7.0</td>
                <td>Procesare imagini</td>
                <td>Preprocesare imagini CAPTCHA pentru OCR</td>
              </tr>
              <tr>
                <td><strong>numpy</strong></td>
                <td>â‰¥1.24.0</td>
                <td>Procesare numericÄƒ</td>
                <td>OperaÈ›ii matematice pe imagini È™i date</td>
              </tr>
              <tr>
                <td><strong>zeep</strong></td>
                <td>â‰¥4.2.0</td>
                <td>Client SOAP</td>
                <td>InterogÄƒri API portal.just.ro</td>
              </tr>
              <tr>
                <td><strong>requests</strong></td>
                <td>â‰¥2.28.0</td>
                <td>HTTP client</td>
                <td>HTTP requests pentru API-uri externe</td>
              </tr>
            </tbody>
          </table>

          <h4>3.4. Comunicare Email</h4>
          <table>
            <thead>
              <tr>
                <th>BibliotecÄƒ</th>
                <th>Versiune</th>
                <th>Scop</th>
                <th>Utilizare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>pywin32</strong></td>
                <td>â‰¥305</td>
                <td>Windows COM Interface</td>
                <td>Integrare Outlook pentru trimitere email-uri automate</td>
              </tr>
            </tbody>
          </table>

          <h4>3.5. Programare È™i Scheduling</h4>
          <table>
            <thead>
              <tr>
                <th>BibliotecÄƒ</th>
                <th>Versiune</th>
                <th>Scop</th>
                <th>Utilizare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>schedule</strong></td>
                <td>â‰¥1.2.0</td>
                <td>Scheduler pentru rulÄƒri automate</td>
                <td>Programare rapoarte automate (lunar, zilnic, etc.)</td>
              </tr>
              <tr>
                <td><strong>threading</strong></td>
                <td>Built-in</td>
                <td>ExecuÈ›ie asincronÄƒ</td>
                <td>Rulare scheduler Ã®n background fÄƒrÄƒ blocare GUI</td>
              </tr>
            </tbody>
          </table>

          <h4>3.6. Vizualizare Date</h4>
          <table>
            <thead>
              <tr>
                <th>BibliotecÄƒ</th>
                <th>Versiune</th>
                <th>Scop</th>
                <th>Utilizare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>plotly</strong></td>
                <td>â‰¥5.14.0</td>
                <td>Grafice interactive</td>
                <td>Generare grafice HTML interactive pentru rapoarte</td>
              </tr>
              <tr>
                <td><strong>kaleido</strong></td>
                <td>â‰¥0.2.1</td>
                <td>Export imagini</td>
                <td>Export grafice Plotly Ã®n format PNG (opÈ›ional)</td>
              </tr>
              <tr>
                <td><strong>matplotlib</strong></td>
                <td>Inclus implicit</td>
                <td>Grafice statice</td>
                <td>Generare grafice pentru embed Ã®n Excel È™i email</td>
              </tr>
            </tbody>
          </table>

          <h4>3.7. Utilitare Built-in</h4>
          <p>UrmÄƒtoarele module sunt incluse Ã®n Python standard È™i nu necesitÄƒ instalare:</p>
          <ul>
            <li><strong>json</strong> - Configurare persistentÄƒ</li>
            <li><strong>logging</strong> - Sistem de logare detaliat</li>
            <li><strong>datetime</strong> - Gestionare date È™i timp</li>
            <li><strong>glob</strong> - CÄƒutare fiÈ™iere</li>
            <li><strong>os</strong> - OperaÈ›ii sistem de fiÈ™iere</li>
            <li><strong>subprocess</strong> - ExecuÈ›ie procese externe</li>
            <li><strong>re</strong> - Expresii regulate</li>
            <li><strong>argparse</strong> - Parsing argumente linie de comandÄƒ</li>
            <li><strong>io</strong> - OperaÈ›ii I/O</li>
            <li><strong>base64</strong> - Encoding/decoding base64</li>
            <li><strong>BytesIO</strong> - Buffer Ã®n memorie</li>
          </ul>

          <h3>4. SetÄƒri Dedicate FuncÈ›ionÄƒrii</h3>
          <table>
            <thead>
              <tr>
                <th>Setare</th>
                <th>Valoare</th>
                <th>LocaÈ›ie</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>ConfiguraÈ›ie GlobalÄƒ</strong></td>
                <td>JSON</td>
                <td><code>config.json</code> (root)</td>
                <td>SetÄƒri globale aplicaÈ›ie (email, paths, etc.)</td>
              </tr>
              <tr>
                <td><strong>ConfiguraÈ›ie per Modul</strong></td>
                <td>JSON</td>
                <td><code>raport_*/config.json</code></td>
                <td>SetÄƒri specifice fiecÄƒrui modul de raport</td>
              </tr>
              <tr>
                <td><strong>Tesseract Path</strong></td>
                <td>Calea instalare Tesseract</td>
                <td><code>raport_interogare_siui/processor.py</code></td>
                <td>Configurare cale Tesseract OCR (dacÄƒ instalat)</td>
              </tr>
              <tr>
                <td><strong>Playwright Browser</strong></td>
                <td>Chromium</td>
                <td>Instalat via <code>playwright install chromium</code></td>
                <td>Browser headless pentru automatizare web</td>
              </tr>
              <tr>
                <td><strong>Outlook COM</strong></td>
                <td>Auto-detect</td>
                <td><code>utils/email_sender.py</code></td>
                <td>Integrare automatÄƒ cu Outlook instalat</td>
              </tr>
              <tr>
                <td><strong>Encoding UTF-8</strong></td>
                <td>UTF-8</td>
                <td>Toate fiÈ™ierele Python</td>
                <td>Encoding standard pentru caractere romÃ¢neÈ™ti</td>
              </tr>
            </tbody>
          </table>

          <h3>5. Protocoale Utilizate</h3>
          <table>
            <thead>
              <tr>
                <th>Protocol</th>
                <th>Versiune</th>
                <th>Utilizare</th>
                <th>Port</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>HTTPS</strong></td>
                <td>1.1 / 2</td>
                <td>Comunicare cu API-uri externe (portal.just.ro, siui.casan.ro)</td>
                <td>443</td>
              </tr>
              <tr>
                <td><strong>SOAP</strong></td>
                <td>1.1 / 1.2</td>
                <td>InterogÄƒri API portal.just.ro</td>
                <td>Peste HTTPS (443)</td>
              </tr>
              <tr>
                <td><strong>SMTP/Exchange</strong></td>
                <td>-</td>
                <td>Trimitere email prin Outlook</td>
                <td>25/587/443 (gestionat de Outlook)</td>
              </tr>
              <tr>
                <td><strong>COM Interface</strong></td>
                <td>-</td>
                <td>Integrare Outlook local</td>
                <td>Local (nu necesitÄƒ port)</td>
              </tr>
            </tbody>
          </table>

          <h3>6. Instalare DependenÈ›e</h3>
          
          <h4>6.1. Instalare Python Packages</h4>
          <pre><code># Instalare toate dependenÈ›ele
pip install -r requirements.txt

# Sau instalare manualÄƒ
pip install customtkinter>=5.0.0 Pillow>=9.0.0 openpyxl>=3.0.0 pandas>=1.5.0
pip install playwright>=1.30.0 pytesseract>=0.3.10 opencv-python>=4.7.0 numpy>=1.24.0
pip install pywin32>=305 schedule>=1.2.0 plotly>=5.14.0 kaleido>=0.2.1
pip install zeep>=4.2.0 requests>=2.28.0</code></pre>

          <h4>6.2. Instalare Playwright Browser</h4>
          <pre><code># Instalare browser Chromium pentru Playwright
playwright install chromium</code></pre>

          <h4>6.3. Instalare Tesseract OCR (OpÈ›ional - doar pentru CASAN)</h4>
          <p><strong>Windows:</strong></p>
          <ol>
            <li>DescÄƒrcare: <a href="https://github.com/UB-Mannheim/tesseract/wiki" target="_blank">https://github.com/UB-Mannheim/tesseract/wiki</a></li>
            <li>Sau direct: <a href="https://digi.bib.uni-mannheim.de/tesseract/tesseract-ocr-w64-setup-5.3.3.20231005.exe" target="_blank">Installer direct</a></li>
            <li><strong>IMPORTANT:</strong> BifeazÄƒ "Add to PATH" la instalare</li>
            <li>Verificare: <code>tesseract --version</code></li>
          </ol>

          <h4>6.4. Scripturi de Instalare AutomatÄƒ</h4>
          <pre><code># Instalare automatÄƒ dependenÈ›e CASAN (Python packages + Playwright)
python raport_interogare_siui/install_dependencies.py

# Verificare dependenÈ›e CASAN
python raport_interogare_siui/check_dependencies.py</code></pre>

          <h3>7. CerinÈ›e Minime StaÈ›ii de Lucru</h3>
          <table>
            <thead>
              <tr>
                <th>ComponentÄƒ</th>
                <th>CerinÈ›Äƒ</th>
                <th>NotÄƒ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Procesor</strong></td>
                <td>Dual-core 2.0 GHz sau superior</td>
                <td>Recomandat pentru procesare Excel È™i automatizare web</td>
              </tr>
              <tr>
                <td><strong>Memorie RAM</strong></td>
                <td>4 GB minim, 8 GB recomandat</td>
                <td>NecesarÄƒ pentru procesare Excel mari È™i browser automation</td>
              </tr>
              <tr>
                <td><strong>SpaÈ›iu Stocare</strong></td>
                <td>500 MB minim</td>
                <td>Pentru aplicaÈ›ie, dependenÈ›e Python È™i fiÈ™iere temporare</td>
              </tr>
              <tr>
                <td><strong>Sistem de Operare</strong></td>
                <td>Windows 10 / 11</td>
                <td>Necesar pentru pywin32 È™i Outlook COM</td>
              </tr>
              <tr>
                <td><strong>Python</strong></td>
                <td>3.8 sau superior</td>
                <td>Runtime environment pentru aplicaÈ›ie</td>
              </tr>
              <tr>
                <td><strong>Microsoft Outlook</strong></td>
                <td>2016 sau superior</td>
                <td>Necesar pentru funcÈ›ionalitatea de email</td>
              </tr>
              <tr>
                <td><strong>Conexiune Internet</strong></td>
                <td>HTTPS</td>
                <td>NecesarÄƒ pentru interogÄƒri API externe (portal.just.ro, CASAN)</td>
              </tr>
              <tr>
                <td><strong>Permisiuni FiÈ™iere</strong></td>
                <td>Read/Write</td>
                <td>Acces la folder-uri Master/ È™i Rezultate/ pentru fiecare modul</td>
              </tr>
            </tbody>
          </table>
        </section>
      </div>
    </section>

    <section class="content-section hidden" id="secDFD">
      <div class="section-head">
        <div class="title">ğŸ”„ Fluxuri de Date (DFD)</div>
        <div style="opacity:.75; font-weight:700; color:#22507a;">Data Flow Diagram - Diagrame fluxuri de date</div>
      </div>
      <div class="section-body">
        <section class="doc-section">
          <h2>Descrierea Fluxurilor de Date (DFD â€“ Data Flow Diagram)</h2>
          <p>Diagramele de flux de date (DFD) descriu fluxul informaÈ›iilor prin aplicaÈ›ia Roboescu, identificÃ¢nd procesele, stocÄƒrile de date, entitÄƒÈ›ile externe È™i fluxurile de date Ã®ntre acestea pentru fiecare raport implementat.</p>

          <!-- Tab Navigation pentru Rapoarte DFD -->
          <div style="margin-bottom: 25px; border-bottom: 3px solid rgba(34, 80, 122, 0.2); padding-bottom: 10px;">
            <nav style="display: flex; flex-wrap: wrap; gap: 10px; padding: 15px; background: rgba(255, 255, 255, 0.3); border-radius: 15px; backdrop-filter: blur(10px);">
              <button class="dfd-tab-btn active" data-dfd="1">ğŸ“Š 1. Creditori</button>
              <button class="dfd-tab-btn" data-dfd="2">ğŸ’° 2. CreanÈ›e &lt;500</button>
              <button class="dfd-tab-btn" data-dfd="3">ğŸ“Š 3. Expunere Exec</button>
              <button class="dfd-tab-btn" data-dfd="4">ğŸ“… 4. Termene Lic</button>
              <button class="dfd-tab-btn" data-dfd="5">âš ï¸ 5. Incidente</button>
              <button class="dfd-tab-btn" data-dfd="6">ğŸ“ˆ 6. Productivitate</button>
              <button class="dfd-tab-btn" data-dfd="7">ğŸ“‹ 7. CreanÈ›e Perimate</button>
              <button class="dfd-tab-btn" data-dfd="8">âš–ï¸ 8. Portal Just</button>
              <button class="dfd-tab-btn" data-dfd="9">ğŸ†” 9. SIUI</button>
              <button class="dfd-tab-btn" data-dfd="10">ğŸ“Š 10. AnalizÄƒ Perimare</button>
              <button class="dfd-tab-btn" data-dfd="11">ğŸ“‹ 11. Perimate FÄƒrÄƒ AcÈ›iuni</button>
              <button class="dfd-tab-btn" data-dfd="12">ğŸ  12. Termene Lic Identif</button>
              <button class="dfd-tab-btn" data-dfd="13">ğŸ“Š 13. Dosare Active</button>
            </nav>
          </div>

          <h3>Simboluri DFD Utilizate</h3>
          <table>
            <thead>
              <tr>
                <th>Simbol</th>
                <th>Denumire</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Proces</strong></td>
                <td>Proces (Process)</td>
                <td>ReprezintÄƒ o transformare sau procesare a datelor (cerc cu numÄƒr)</td>
              </tr>
              <tr>
                <td><strong>Stoc de Date</strong></td>
                <td>Data Store</td>
                <td>ReprezintÄƒ un depozit de date persistent (douÄƒ linii paralele)</td>
              </tr>
              <tr>
                <td><strong>Entitate ExternÄƒ</strong></td>
                <td>External Entity</td>
                <td>ReprezintÄƒ o entitate externÄƒ sistemului (dreptunghi)</td>
              </tr>
              <tr>
                <td><strong>Flux de Date</strong></td>
                <td>Data Flow</td>
                <td>SÄƒgeÈ›i care aratÄƒ direcÈ›ia È™i numele datelor care circulÄƒ</td>
              </tr>
            </tbody>
          </table>

          <!-- DFD Raport 1: Creditori -->
          <div class="dfd-report active" id="dfd-report-1">
            <h3>ğŸ“Š 1. Raport Creditori - Fluxuri de Date</h3>
            
            <h4>1.1. DFD Nivel 0 - DiagramÄƒ Context</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1200" height="700" viewBox="0 0 1200 700" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD-Creditori" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Proces central -->
                <circle cx="600" cy="350" r="90" fill="#fff3e0" stroke="#ff9800" stroke-width="3"/>
                <text x="600" y="330" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Raport</text>
                <text x="600" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Creditori</text>
                <text x="600" y="380" text-anchor="middle" font-family="Georgia, serif" font-size="14">Sistem Procesare</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="300" width="140" height="70" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="120" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">Utilizator</text>
                <text x="120" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">ICC</text>
                <text x="120" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Selectare fiÈ™ier)</text>
                
                <rect x="1010" y="100" width="140" height="70" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1080" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Creditori</text>
                <text x="1080" y="145" text-anchor="middle" font-family="Georgia, serif" font-size="12">EOS, BTD, SALT</text>
                <text x="1080" y="160" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Destinatari email)</text>
                
                <rect x="1010" y="530" width="140" height="70" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1080" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Output</text>
                <text x="1080" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Stocare localÄƒ)</text>
                
                <rect x="50" y="530" width="140" height="70" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="120" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="120" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Master</text>
                <text x="120" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(FiÈ™ier Excel input)</text>
                
                <rect x="1010" y="300" width="140" height="70" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1080" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">Local</text>
                <text x="1080" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Trimitere email)</text>
                
                <!-- Fluxuri de date -->
                <path d="M 190 335 L 510 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Creditori)"/>
                <text x="350" y="330" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">SelecÈ›ie fiÈ™ier Master</text>
                
                <path d="M 190 565 L 510 410" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Creditori)"/>
                <text x="300" y="500" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Date Excel Master</text>
                <text x="300" y="515" font-family="Georgia, serif" font-size="10" fill="#666">(Sheet 1 + Sheet 2)</text>
                
                <path d="M 690 350 L 1010 135" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Creditori)"/>
                <text x="850" y="220" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Rapoarte Excel parolate</text>
                <text x="850" y="235" font-family="Georgia, serif" font-size="10" fill="#666">(EOS, BTD CREDITE, etc.)</text>
                
                <path d="M 690 380 L 1010 565" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Creditori)"/>
                <text x="850" y="480" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Rapoarte Excel parolate</text>
                <text x="850" y="495" font-family="Georgia, serif" font-size="10" fill="#666">(Salvare localÄƒ)</text>
                
                <path d="M 690 320 L 1010 335" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Creditori)"/>
                <text x="850" y="315" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email cu ataÈ™amente</text>
                <text x="850" y="330" font-family="Georgia, serif" font-size="10" fill="#666">(Rapoarte parolate)</text>
              </svg>
            </div>
            
            <h4>1.2. DFD Nivel 1 - Flux Detaliat de Procesare</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1400" height="1000" viewBox="0 0 1400 1000" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD1-Creditori" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                  <marker id="arrowDFD1-Error" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#f44336" />
                  </marker>
                </defs>
                
                <!-- Titlu -->
                <text x="700" y="40" text-anchor="middle" font-family="Georgia, serif" font-size="22" font-weight="bold" fill="#22507a">ğŸ“Š RAPORT CREDITORI - FLUXURI DE DATE DETALIATE</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="80" width="120" height="60" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="110" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Utilizator</text>
                <text x="110" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">ICC</text>
                
                <rect x="1230" y="80" width="120" height="60" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1290" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Creditori</text>
                <text x="1290" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">(Email)</text>
                
                <rect x="1230" y="850" width="120" height="60" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1290" y="875" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1290" y="895" text-anchor="middle" font-family="Georgia, serif" font-size="11">Output</text>
                
                <rect x="50" y="850" width="120" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="110" y="875" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="110" y="895" text-anchor="middle" font-family="Georgia, serif" font-size="11">Master</text>
                
                <rect x="1230" y="450" width="120" height="60" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1290" y="475" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1290" y="495" text-anchor="middle" font-family="Georgia, serif" font-size="11">Local</text>
                
                <!-- Procese -->
                <circle cx="200" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">1.0</text>
                <text x="200" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire &amp;</text>
                <text x="200" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Concatenare</text>
                
                <circle cx="400" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">2.0</text>
                <text x="400" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Mapare &amp;</text>
                <text x="400" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Validare</text>
                
                <circle cx="600" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">3.0</text>
                <text x="600" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Filtrare</text>
                <text x="600" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Date</text>
                
                <circle cx="800" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">4.0</text>
                <text x="800" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Completare</text>
                <text x="800" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Date LipsÄƒ</text>
                
                <circle cx="200" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">5.0</text>
                <text x="200" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Formatare &amp;</text>
                <text x="200" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">CurÄƒÈ›are</text>
                
                <circle cx="500" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="500" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">6.0</text>
                <text x="500" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="500" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Rapoarte</text>
                
                <circle cx="800" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">7.0</text>
                <text x="800" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Criptare</text>
                <text x="800" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Excel</text>
                
                <circle cx="1000" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="1000" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">8.0</text>
                <text x="1000" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Trimitere</text>
                <text x="1000" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <!-- Stocuri de date -->
                <rect x="50" y="650" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="50" y1="675" x2="250" y2="675" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="150" y="695" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D1</text>
                <text x="150" y="715" text-anchor="middle" font-family="Georgia, serif" font-size="12">FiÈ™ier Master</text>
                <text x="150" y="730" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Excel input)</text>
                
                <rect x="550" y="650" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="550" y1="675" x2="750" y2="675" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="650" y="695" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D2</text>
                <text x="650" y="715" text-anchor="middle" font-family="Georgia, serif" font-size="12">Date Procesate</text>
                <text x="650" y="730" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Temporar)</text>
                
                <rect x="1050" y="650" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1050" y1="675" x2="1250" y2="675" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1150" y="695" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D3</text>
                <text x="1150" y="715" text-anchor="middle" font-family="Georgia, serif" font-size="12">Rapoarte Generate</text>
                <text x="1150" y="730" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Excel parolate)</text>
                
                <!-- Fluxuri principale -->
                <!-- Utilizator -> 1.0 -->
                <path d="M 170 110 L 150 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="140" y="170" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">selecÈ›ie fiÈ™ier</text>
                
                <!-- D1 -> 1.0 -->
                <path d="M 150 650 L 150 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="130" y="470" font-family="Georgia, serif" font-size="10" fill="#3576b0">fiÈ™ier Excel Master</text>
                
                <!-- 1.0 -> 2.0 -->
                <path d="M 250 250 L 350 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="300" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date concatenate</text>
                
                <!-- 2.0 -> 3.0 -->
                <path d="M 450 250 L 550 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="500" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date mapate</text>
                
                <!-- 3.0 -> 4.0 -->
                <path d="M 650 250 L 750 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="700" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date filtrate</text>
                
                <!-- 4.0 -> 5.0 -->
                <path d="M 800 300 L 200 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="500" y="370" font-family="Georgia, serif" font-size="10" fill="#3576b0">date completate</text>
                
                <!-- 5.0 -> D2 -->
                <path d="M 200 500 L 650 650" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="400" y="570" font-family="Georgia, serif" font-size="10" fill="#3576b0">date procesate</text>
                
                <!-- D2 -> 6.0 -->
                <path d="M 650 650 L 500 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="570" y="570" font-family="Georgia, serif" font-size="10" fill="#3576b0">date procesate</text>
                
                <!-- 6.0 -> 7.0 -->
                <path d="M 550 450 L 750 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="650" y="440" font-family="Georgia, serif" font-size="10" fill="#3576b0">rapoarte generate</text>
                
                <!-- 7.0 -> D3 -->
                <path d="M 800 500 L 1150 650" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="950" y="570" font-family="Georgia, serif" font-size="10" fill="#3576b0">Excel parolate</text>
                
                <!-- 7.0 -> 8.0 -->
                <path d="M 850 450 L 950 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="900" y="440" font-family="Georgia, serif" font-size="10" fill="#3576b0">Excel parolate</text>
                
                <!-- 8.0 -> Creditori -->
                <path d="M 1050 450 L 1230 110" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="1140" y="260" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">email cu rapoarte</text>
                
                <!-- 8.0 -> Outlook -->
                <path d="M 1050 480 L 1230 480" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="1140" y="490" font-family="Georgia, serif" font-size="10" fill="#3576b0">comandÄƒ trimitere</text>
                
                <!-- D3 -> Folder Output -->
                <path d="M 1250 690 L 1290 850" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="1270" y="770" font-family="Georgia, serif" font-size="10" fill="#3576b0">salvare localÄƒ</text>
                
                <!-- Fluxuri de eroare -->
                <path d="M 200 300 L 110 200 L 50 150" stroke="#f44336" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Error)" stroke-dasharray="5,5"/>
                <text x="100" y="160" font-family="Georgia, serif" font-size="10" fill="#f44336" font-weight="bold">eroare: fiÈ™ier invalid</text>
                
                <path d="M 400 300 L 110 200 L 50 150" stroke="#f44336" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Error)" stroke-dasharray="5,5"/>
                <text x="200" y="160" font-family="Georgia, serif" font-size="10" fill="#f44336" font-weight="bold">eroare: coloane lipsÄƒ</text>
                
                <!-- Legenda -->
                <rect x="50" y="950" width="1300" height="40" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="5"/>
                <path d="M 100 970 L 200 970" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creditori)"/>
                <text x="220" y="975" font-family="Georgia, serif" font-size="11">Flux de date normal</text>
                
                <path d="M 100 985 L 200 985" stroke="#f44336" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Error)" stroke-dasharray="5,5"/>
                <text x="220" y="990" font-family="Georgia, serif" font-size="11">Flux de eroare</text>
                
                <text x="700" y="975" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Procese:</tspan> 1.0-Citire | 2.0-Mapare | 3.0-Filtrare | 4.0-Completare | 5.0-Formatare | 6.0-Generare | 7.0-Criptare | 8.0-Email</text>
                <text x="700" y="990" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Stocuri:</tspan> D1-FiÈ™ier Master | D2-Date Procesate | D3-Rapoarte Generate</text>
              </svg>
            </div>
            
            <h4>1.3. Tabel de Fluxuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Flux</th>
                  <th>Nume Flux</th>
                  <th>SursÄƒ</th>
                  <th>DestinaÈ›ie</th>
                  <th>ConÈ›inut</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>F1</td>
                  <td>SelecÈ›ie FiÈ™ier</td>
                  <td>Utilizator ICC</td>
                  <td>Proces 1.0</td>
                  <td>SelecÈ›ie fiÈ™ier Excel Master din folder</td>
                </tr>
                <tr>
                  <td>F2</td>
                  <td>Date Excel Master</td>
                  <td>D1 (FiÈ™ier Master)</td>
                  <td>Proces 1.0</td>
                  <td>Sheet 1 È™i Sheet 2 cu date dosare</td>
                </tr>
                <tr>
                  <td>F3</td>
                  <td>Date Concatenate</td>
                  <td>Proces 1.0</td>
                  <td>Proces 2.0</td>
                  <td>DataFrame pandas cu date concatenate</td>
                </tr>
                <tr>
                  <td>F4</td>
                  <td>Date Mapate</td>
                  <td>Proces 2.0</td>
                  <td>Proces 3.0</td>
                  <td>DataFrame cu coloane mapate (PORTFOLIO, NUME_TITULAR)</td>
                </tr>
                <tr>
                  <td>F5</td>
                  <td>Date Filtrate</td>
                  <td>Proces 3.0</td>
                  <td>Proces 4.0</td>
                  <td>DataFrame fÄƒrÄƒ BANCPOST, GB01, AXIOMA, CdF, Idea Leasing, GDPR, blank</td>
                </tr>
                <tr>
                  <td>F6</td>
                  <td>Date Completate</td>
                  <td>Proces 4.0</td>
                  <td>Proces 5.0</td>
                  <td>DataFrame cu DATA_PREDARE_BEJ completat</td>
                </tr>
                <tr>
                  <td>F7</td>
                  <td>Date Procesate</td>
                  <td>Proces 5.0</td>
                  <td>D2 (Date Procesate)</td>
                  <td>DataFrame formatat (font Georgia 11, date formatate, PORTFOLIO curÄƒÈ›at)</td>
                </tr>
                <tr>
                  <td>F8</td>
                  <td>Date Procesate</td>
                  <td>D2 (Date Procesate)</td>
                  <td>Proces 6.0</td>
                  <td>DataFrame pentru generare rapoarte</td>
                </tr>
                <tr>
                  <td>F9</td>
                  <td>Rapoarte Generate</td>
                  <td>Proces 6.0</td>
                  <td>Proces 7.0</td>
                  <td>DicÈ›ionar DataFrame-uri per creditor (EOS, BTD CREDITE, BTD CARDURI, SALT, BT MIC, BT LEASING)</td>
                </tr>
                <tr>
                  <td>F10</td>
                  <td>Excel Parolate</td>
                  <td>Proces 7.0</td>
                  <td>D3 (Rapoarte Generate)</td>
                  <td>FiÈ™iere Excel criptate cu parolÄƒ (msoffcrypto)</td>
                </tr>
                <tr>
                  <td>F11</td>
                  <td>Excel Parolate</td>
                  <td>Proces 7.0</td>
                  <td>Proces 8.0</td>
                  <td>FiÈ™iere Excel criptate pentru trimitere email</td>
                </tr>
                <tr>
                  <td>F12</td>
                  <td>Email cu Rapoarte</td>
                  <td>Proces 8.0</td>
                  <td>Creditori</td>
                  <td>Email HTML cu font Georgia 11, subiect, body, ataÈ™amente Excel parolate</td>
                </tr>
                <tr>
                  <td>F13</td>
                  <td>ComandÄƒ Trimitere</td>
                  <td>Proces 8.0</td>
                  <td>Outlook</td>
                  <td>ComandÄƒ COM pentru trimitere email prin Outlook local</td>
                </tr>
                <tr>
                  <td>F14</td>
                  <td>Salvare LocalÄƒ</td>
                  <td>D3 (Rapoarte Generate)</td>
                  <td>Folder Output</td>
                  <td>FiÈ™iere Excel parolate salvate Ã®n Rapoarte_Creditori/</td>
                </tr>
              </tbody>
            </table>
            
            <h4>1.4. Tabel de Stocuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Stoc</th>
                  <th>Nume Stoc</th>
                  <th>Descriere</th>
                  <th>StructurÄƒ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>D1</td>
                  <td>FiÈ™ier Master</td>
                  <td>FiÈ™ier Excel Master din folderul Master/</td>
                  <td>Excel cu 2 sheet-uri: Sheet 1 (skiprows=1), Sheet 2 (date dosare)</td>
                </tr>
                <tr>
                  <td>D2</td>
                  <td>Date Procesate</td>
                  <td>FiÈ™ier Excel temporar cu date procesate</td>
                  <td>Raport_Master_Concatenat_Filtrat.xlsx - Sheet "Date_Concatenate" (formatat cu font Georgia 11, date formatate)</td>
                </tr>
                <tr>
                  <td>D3</td>
                  <td>Rapoarte Generate</td>
                  <td>Folder Rapoarte_Creditori/ cu rapoarte Excel parolate</td>
                  <td>6 fiÈ™iere Excel parolate: Raport_EOS.xlsx, Raport_BTD_CREDITE.xlsx, Raport_BTD_CARDURI.xlsx, Raport_SALT.xlsx, Raport_BT_MIC.xlsx, Raport_BT_LEASING.xlsx</td>
                </tr>
              </tbody>
            </table>
            
            <h4>1.5. Descriere DetaliatÄƒ a Proceselor</h4>
            <table>
              <thead>
                <tr>
                  <th>Proces</th>
                  <th>Descriere</th>
                  <th>Input</th>
                  <th>Output</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>1.0 - Citire È™i Concatenare</strong></td>
                  <td>CiteÈ™te Sheet 1 (skiprows=1) È™i Sheet 2 din fiÈ™ierul Excel Master, apoi concateneazÄƒ datele Ã®ntr-un singur DataFrame</td>
                  <td>FiÈ™ier Excel Master (D1)</td>
                  <td>DataFrame pandas cu date concatenate</td>
                </tr>
                <tr>
                  <td><strong>2.0 - Mapare È™i Validare</strong></td>
                  <td>MapeazÄƒ coloanele generice la nume specifice (PORTFOLIO la index 21, NUME_TITULAR prin detectare), creeazÄƒ coloane placeholder pentru cÃ¢mpuri lipsÄƒ</td>
                  <td>DataFrame concatenat</td>
                  <td>DataFrame cu coloane mapate È™i validate</td>
                </tr>
                <tr>
                  <td><strong>3.0 - Filtrare Date</strong></td>
                  <td>EliminÄƒ rÃ¢nduri cu PORTFOLIO = BANCPOST, GB01, AXIOMA, CdF, Idea Leasing, blank, È™i rÃ¢nduri cu NUME_TITULAR conÈ›inÃ¢nd "GDPR"</td>
                  <td>DataFrame mapat</td>
                  <td>DataFrame filtrat</td>
                </tr>
                <tr>
                  <td><strong>4.0 - Completare Date LipsÄƒ</strong></td>
                  <td>CompleteazÄƒ DATA_PREDARE_BEJ cu data din DATA_RAPORT pentru rÃ¢ndurile unde ambele cÃ¢mpuri (DATA_PREDARE_BEJ È™i DATA_INCHEIERE_DOSAR) sunt goale</td>
                  <td>DataFrame filtrat</td>
                  <td>DataFrame cu date completate</td>
                </tr>
                <tr>
                  <td><strong>5.0 - Formatare È™i CurÄƒÈ›are</strong></td>
                  <td>AplicÄƒ font Georgia 11 pe toate celulele, formateazÄƒ coloanele de datÄƒ (MM/DD/YYYY), curÄƒÈ›Äƒ È™i redenumeÈ™te valorile PORTFOLIO (ex: ABSOLUT â†’ SALT, BTD â†’ BTD CREDITE)</td>
                  <td>DataFrame completat</td>
                  <td>DataFrame formatat salvat Ã®n D2</td>
                </tr>
                <tr>
                  <td><strong>6.0 - Generare Rapoarte</strong></td>
                  <td>FiltreazÄƒ datele per creditor (EOS, BTD CREDITE, BTD CARDURI, SALT, BT MIC, BT LEASING) È™i separÄƒ dosare active (fÄƒrÄƒ DATA_INCHEIERE_DOSAR) de dosare Ã®nchise (cu DATA_INCHEIERE_DOSAR)</td>
                  <td>Date procesate (D2)</td>
                  <td>DicÈ›ionar cu 6 perechi creditor â†’ {ds active, ds inchise}</td>
                </tr>
                <tr>
                  <td><strong>7.0 - Criptare Excel</strong></td>
                  <td>CreeazÄƒ fiÈ™iere Excel temporare cu xlsxwriter, apoi le cripteazÄƒ cu msoffcrypto-tool folosind parola "administrare", È™terge fiÈ™ierele temporare</td>
                  <td>DicÈ›ionar rapoarte per creditor</td>
                  <td>6 fiÈ™iere Excel parolate salvate Ã®n D3</td>
                </tr>
                <tr>
                  <td><strong>8.0 - Trimitere Email</strong></td>
                  <td>Trimite email-uri prin Outlook local (COM Interface) cÄƒtre creditori cu subiect, body HTML (font Georgia 11), È™i ataÈ™amente Excel parolate</td>
                  <td>Excel-uri parolate</td>
                  <td>Email-uri trimise cÄƒtre creditori prin Outlook</td>
                </tr>
              </tbody>
            </table>
            
            <h4>1.6. Note Importante</h4>
            <ul>
              <li><strong>Procesare LocalÄƒ:</strong> Toate procesele se desfÄƒÈ™oarÄƒ local pe staÈ›ia de lucru a utilizatorului ICC, fÄƒrÄƒ transmitere cÄƒtre servere externe.</li>
              <li><strong>FÄƒrÄƒ Stocare PersistentÄƒ:</strong> Datele sunt procesate exclusiv Ã®n memorie temporarÄƒ (RAM). FiÈ™ierul temporar D2 este creat doar pentru verificare intermediarÄƒ È™i poate fi È™ters dupÄƒ procesare.</li>
              <li><strong>Criptare Excel:</strong> Toate rapoartele generate sunt criptate cu parolÄƒ realÄƒ folosind msoffcrypto-tool, asigurÃ¢nd protecÈ›ie la nivel de fiÈ™ier.</li>
              <li><strong>Email Local:</strong> Email-urile sunt trimise prin Outlook local (COM Interface), fÄƒrÄƒ utilizarea de servicii externe de email sau cloud.</li>
              <li><strong>Separare per Creditor:</strong> Fiecare creditor primeÈ™te un raport separat cu dosare active È™i Ã®nchise, filtrat conform criteriilor stabilite.</li>
              <li><strong>Eliminare AutomatÄƒ:</strong> DupÄƒ finalizarea procesÄƒrii È™i trimiterii email-urilor, datele din memorie sunt eliminate automat, aplicaÈ›ia revenind la starea iniÈ›ialÄƒ.</li>
            </ul>
          </div>

          <!-- DFD Raport 2: CreanÈ›e <500 -->
          <div class="dfd-report" id="dfd-report-2">
            <h3>ğŸ’° 2. Raport CreanÈ›e <500 - Fluxuri de Date</h3>
            
            <h4>2.1. DFD Nivel 0 - DiagramÄƒ Context</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1200" height="700" viewBox="0 0 1200 700" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD-Creante500" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Proces central -->
                <circle cx="600" cy="350" r="90" fill="#fff3e0" stroke="#ff9800" stroke-width="3"/>
                <text x="600" y="330" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Raport</text>
                <text x="600" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">CreanÈ›e</text>
                <text x="600" y="380" text-anchor="middle" font-family="Georgia, serif" font-size="14">&lt; 500 RON</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="300" width="140" height="70" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="120" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">Utilizator</text>
                <text x="120" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">ICC</text>
                <text x="120" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Selectare fiÈ™ier)</text>
                
                <rect x="1010" y="100" width="140" height="70" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1080" y="145" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Output</text>
                <text x="1080" y="160" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Raport Excel)</text>
                
                <rect x="50" y="530" width="140" height="70" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="120" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="120" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Master</text>
                <text x="120" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(FiÈ™ier Excel input)</text>
                
                <!-- Fluxuri de date -->
                <path d="M 190 335 L 510 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Creante500)"/>
                <text x="350" y="330" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">SelecÈ›ie fiÈ™ier Master</text>
                
                <path d="M 190 565 L 510 410" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Creante500)"/>
                <text x="300" y="500" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Date Excel Master</text>
                <text x="300" y="515" font-family="Georgia, serif" font-size="10" fill="#666">(3 sheet-uri)</text>
                
                <path d="M 690 350 L 1010 135" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Creante500)"/>
                <text x="850" y="220" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Raport Excel procesat</text>
                <text x="850" y="235" font-family="Georgia, serif" font-size="10" fill="#666">(Master_unificat.xlsx)</text>
              </svg>
            </div>
            
            <h4>2.2. DFD Nivel 1 - Flux Detaliat de Procesare</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1400" height="900" viewBox="0 0 1400 900" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD1-Creante500" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Titlu -->
                <text x="700" y="40" text-anchor="middle" font-family="Georgia, serif" font-size="22" font-weight="bold" fill="#22507a">ğŸ’° RAPORT CREANÈšE &lt; 500 RON - FLUXURI DE DATE</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="80" width="120" height="60" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="110" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Utilizator</text>
                <text x="110" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">ICC</text>
                
                <rect x="1230" y="80" width="120" height="60" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1290" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1290" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">Output</text>
                
                <rect x="50" y="750" width="120" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="110" y="775" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="110" y="795" text-anchor="middle" font-family="Georgia, serif" font-size="11">Master</text>
                
                <!-- Procese -->
                <circle cx="200" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">1.0</text>
                <text x="200" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="200" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Sheet-uri</text>
                
                <circle cx="400" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">2.0</text>
                <text x="400" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Concatenare</text>
                <text x="400" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">&amp; Aliniere</text>
                
                <circle cx="600" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">3.0</text>
                <text x="600" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Filtrare</text>
                <text x="600" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Date</text>
                
                <circle cx="800" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">4.0</text>
                <text x="800" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">AnalizÄƒ</text>
                <text x="800" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">COMMENTS</text>
                
                <circle cx="200" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">5.0</text>
                <text x="200" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">AnalizÄƒ</text>
                <text x="200" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">ÃncasÄƒri 6M</text>
                
                <circle cx="500" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="500" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">6.0</text>
                <text x="500" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Normalizare</text>
                <text x="500" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">&amp; Explodare</text>
                
                <circle cx="800" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">7.0</text>
                <text x="800" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Formatare</text>
                <text x="800" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Excel</text>
                
                <!-- Stocuri de date -->
                <rect x="50" y="600" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="50" y1="625" x2="250" y2="625" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="150" y="645" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D1</text>
                <text x="150" y="665" text-anchor="middle" font-family="Georgia, serif" font-size="12">FiÈ™ier Master</text>
                <text x="150" y="680" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(3 sheet-uri)</text>
                
                <rect x="1150" y="600" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1150" y1="625" x2="1350" y2="625" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1250" y="645" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D2</text>
                <text x="1250" y="665" text-anchor="middle" font-family="Georgia, serif" font-size="12">Raport Final</text>
                <text x="1250" y="680" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Master_unificat.xlsx)</text>
                
                <!-- Fluxuri principale -->
                <path d="M 170 110 L 150 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creante500)"/>
                <text x="140" y="170" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">selecÈ›ie fiÈ™ier</text>
                
                <path d="M 150 750 L 150 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creante500)"/>
                <text x="130" y="520" font-family="Georgia, serif" font-size="10" fill="#3576b0">fiÈ™ier Excel Master</text>
                
                <path d="M 250 250 L 350 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creante500)"/>
                <text x="300" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date citite</text>
                
                <path d="M 450 250 L 550 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creante500)"/>
                <text x="500" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date concatenate</text>
                
                <path d="M 650 250 L 750 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creante500)"/>
                <text x="700" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date filtrate</text>
                
                <path d="M 800 300 L 200 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creante500)"/>
                <text x="500" y="370" font-family="Georgia, serif" font-size="10" fill="#3576b0">date procesate</text>
                
                <path d="M 200 500 L 500 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creante500)"/>
                <text x="350" y="480" font-family="Georgia, serif" font-size="10" fill="#3576b0">date analizate</text>
                
                <path d="M 550 450 L 750 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creante500)"/>
                <text x="650" y="440" font-family="Georgia, serif" font-size="10" fill="#3576b0">date normalizate</text>
                
                <path d="M 850 450 L 1250 600" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creante500)"/>
                <text x="1050" y="520" font-family="Georgia, serif" font-size="10" fill="#3576b0">raport Excel</text>
                
                <path d="M 1350 640 L 1290 80" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Creante500)"/>
                <text x="1320" y="350" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">salvare localÄƒ</text>
              </svg>
            </div>
            
            <h4>2.3. Tabel de Fluxuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Flux</th>
                  <th>Nume Flux</th>
                  <th>SursÄƒ</th>
                  <th>DestinaÈ›ie</th>
                  <th>ConÈ›inut</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>F1</td>
                  <td>SelecÈ›ie FiÈ™ier</td>
                  <td>Utilizator ICC</td>
                  <td>Proces 1.0</td>
                  <td>SelecÈ›ie fiÈ™ier Excel Master din folder</td>
                </tr>
                <tr>
                  <td>F2</td>
                  <td>Date Excel Master</td>
                  <td>D1 (FiÈ™ier Master)</td>
                  <td>Proces 1.0</td>
                  <td>3 sheet-uri Excel (Sheet 1, Sheet 2, Sheet 3)</td>
                </tr>
                <tr>
                  <td>F3</td>
                  <td>Date Citite</td>
                  <td>Proces 1.0</td>
                  <td>Proces 2.0</td>
                  <td>DataFrame-uri pandas cu date din fiecare sheet</td>
                </tr>
                <tr>
                  <td>F4</td>
                  <td>Date Concatenate</td>
                  <td>Proces 2.0</td>
                  <td>Proces 3.0</td>
                  <td>DataFrame unificat cu date concatenate È™i aliniate</td>
                </tr>
                <tr>
                  <td>F5</td>
                  <td>Date Filtrate</td>
                  <td>Proces 3.0</td>
                  <td>Proces 4.0</td>
                  <td>DataFrame fÄƒrÄƒ rezoluÈ›ii de Ã®nchidere È™i cu EXP_TOT_CLIENT_RON â‰¤ 500</td>
                </tr>
                <tr>
                  <td>F6</td>
                  <td>Date Procesate</td>
                  <td>Proces 4.0</td>
                  <td>Proces 5.0</td>
                  <td>DataFrame cu analizÄƒ COMMENTS (prioritÄƒÈ›i, informaÈ›ii financiare)</td>
                </tr>
                <tr>
                  <td>F7</td>
                  <td>Date Analizate</td>
                  <td>Proces 5.0</td>
                  <td>Proces 6.0</td>
                  <td>DataFrame cu analizÄƒ Ã®ncasÄƒri ultimele 6 luni</td>
                </tr>
                <tr>
                  <td>F8</td>
                  <td>Date Normalizate</td>
                  <td>Proces 6.0</td>
                  <td>Proces 7.0</td>
                  <td>DataFrame cu coloane normalizate È™i explodate (NR_DATA_CTR, CONT_CREDIT)</td>
                </tr>
                <tr>
                  <td>F9</td>
                  <td>Raport Excel</td>
                  <td>Proces 7.0</td>
                  <td>D2 (Raport Final)</td>
                  <td>FiÈ™ier Excel formatat cu borduri È™i colorare (galben, verde, albastru)</td>
                </tr>
                <tr>
                  <td>F10</td>
                  <td>Salvare LocalÄƒ</td>
                  <td>D2 (Raport Final)</td>
                  <td>Folder Output</td>
                  <td>FiÈ™ier Master_unificat.xlsx salvat Ã®n folderul de output</td>
                </tr>
              </tbody>
            </table>
            
            <h4>2.4. Tabel de Stocuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Stoc</th>
                  <th>Nume Stoc</th>
                  <th>Descriere</th>
                  <th>StructurÄƒ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>D1</td>
                  <td>FiÈ™ier Master</td>
                  <td>FiÈ™ier Excel Master din folderul Master/</td>
                  <td>Excel cu 3 sheet-uri: Sheet 1 (skiprows=1), Sheet 2 (skiprows=1, header=None), Sheet 3 (skiprows=1, header=None)</td>
                </tr>
                <tr>
                  <td>D2</td>
                  <td>Raport Final</td>
                  <td>FiÈ™ier Excel final procesat</td>
                  <td>Master_unificat.xlsx - Sheet "Sheet1" (formatat cu borduri, colorare galben/verde/albastru, sortat dupÄƒ prioritate)</td>
                </tr>
              </tbody>
            </table>
            
            <h4>2.5. Descriere DetaliatÄƒ a Proceselor</h4>
            <table>
              <thead>
                <tr>
                  <th>Proces</th>
                  <th>Descriere</th>
                  <th>Input</th>
                  <th>Output</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>1.0 - Citire Sheet-uri</strong></td>
                  <td>CiteÈ™te cele 3 sheet-uri din fiÈ™ierul Excel Master (Sheet 1 cu skiprows=1, Sheet 2 È™i Sheet 3 cu skiprows=1 È™i header=None)</td>
                  <td>FiÈ™ier Excel Master (D1)</td>
                  <td>3 DataFrame-uri pandas</td>
                </tr>
                <tr>
                  <td><strong>2.0 - Concatenare È™i Aliniere</strong></td>
                  <td>AliniazÄƒ coloanele Sheet 2 È™i Sheet 3 cu Sheet 1, apoi concateneazÄƒ toate datele Ã®ntr-un singur DataFrame. RedenumeÈ™te ID_CONT_FLEX â†’ CONT_CREDIT</td>
                  <td>3 DataFrame-uri</td>
                  <td>DataFrame unificat</td>
                </tr>
                <tr>
                  <td><strong>3.0 - Filtrare Date</strong></td>
                  <td>EliminÄƒ rÃ¢nduri cu REZOLUTIE_INCHIDERE Ã®n lista de rezoluÈ›ii de È™ters È™i rÃ¢nduri cu EXP_TOT_CLIENT_RON > 500. ReordoneazÄƒ coloanele specifice la Ã®nceput</td>
                  <td>DataFrame concatenat</td>
                  <td>DataFrame filtrat</td>
                </tr>
                <tr>
                  <td><strong>4.0 - AnalizÄƒ COMMENTS</strong></td>
                  <td>AnalizeazÄƒ coloana COMMENTS pentru expresii specifice (info bej sold/debit), menÈ›iuni lunÄƒ curentÄƒ/trecutÄƒ/acum 2 luni. CreeazÄƒ coloane de prioritate È™i sortare</td>
                  <td>DataFrame filtrat</td>
                  <td>DataFrame cu analizÄƒ COMMENTS</td>
                </tr>
                <tr>
                  <td><strong>5.0 - AnalizÄƒ ÃncasÄƒri 6M</strong></td>
                  <td>VerificÄƒ DATA_ULTIMA_TRANZ pentru Ã®ncasÄƒri Ã®n ultimele 6 luni. CreeazÄƒ coloana "incasari 6M" cu valorile "Incasari in ultimele 6 luni" sau "Fara incasari in ultimele 6 luni"</td>
                  <td>DataFrame cu analizÄƒ COMMENTS</td>
                  <td>DataFrame cu analizÄƒ Ã®ncasÄƒri</td>
                </tr>
                <tr>
                  <td><strong>6.0 - Normalizare È™i Explodare</strong></td>
                  <td>NormalizeazÄƒ coloanele NR_DATA_CTR È™i CONT_CREDIT (eliminÄƒ pipe, split pe "|"). ExplodeazÄƒ sincronizat cele douÄƒ coloane pentru a crea rÃ¢nduri separate</td>
                  <td>DataFrame cu analizÄƒ Ã®ncasÄƒri</td>
                  <td>DataFrame normalizat È™i explodat</td>
                </tr>
                <tr>
                  <td><strong>7.0 - Formatare Excel</strong></td>
                  <td>SalveazÄƒ DataFrame-ul Ã®n Excel, adaugÄƒ borduri È™i colorare (galben pentru creanÈ›a lunii curente, verde pentru luna trecutÄƒ, albastru pentru acum 2 luni). SorteazÄƒ dupÄƒ prioritate</td>
                  <td>DataFrame normalizat</td>
                  <td>FiÈ™ier Excel formatat salvat Ã®n D2</td>
                </tr>
              </tbody>
            </table>
            
            <h4>2.6. Note Importante</h4>
            <ul>
              <li><strong>Procesare LocalÄƒ:</strong> Toate procesele se desfÄƒÈ™oarÄƒ local pe staÈ›ia de lucru a utilizatorului ICC, fÄƒrÄƒ transmitere cÄƒtre servere externe.</li>
              <li><strong>FÄƒrÄƒ Stocare PersistentÄƒ:</strong> Datele sunt procesate exclusiv Ã®n memorie temporarÄƒ (RAM). FiÈ™ierul final este salvat doar pentru utilizare ulterioarÄƒ.</li>
              <li><strong>Filtrare AutomatÄƒ:</strong> Raportul filtreazÄƒ automat dosarele cu creanÈ›e mai mari de 500 RON È™i rezoluÈ›ii de Ã®nchidere specifice.</li>
              <li><strong>Prioritizare:</strong> Dosarele sunt sortate automat dupÄƒ prioritate (creanÈ›a lunii curente â†’ luna trecutÄƒ â†’ acum 2 luni â†’ informaÈ›ie financiarÄƒ â†’ fÄƒrÄƒ informaÈ›ie).</li>
              <li><strong>Colorare VizualÄƒ:</strong> Excel-ul final include colorare pentru identificare rapidÄƒ a prioritÄƒÈ›ilor (galben, verde, albastru).</li>
              <li><strong>Eliminare AutomatÄƒ:</strong> DupÄƒ finalizarea procesÄƒrii, datele din memorie sunt eliminate automat, aplicaÈ›ia revenind la starea iniÈ›ialÄƒ.</li>
            </ul>
          </div>

          <!-- DFD Raport 3: Expunere Executare -->
          <div class="dfd-report" id="dfd-report-3">
            <h3>ğŸ“Š 3. Raport Expunere Executare - Fluxuri de Date</h3>
            
            <h4>3.1. DFD Nivel 0 - DiagramÄƒ Context</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1200" height="700" viewBox="0 0 1200 700" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD-Expunere" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Proces central -->
                <circle cx="600" cy="350" r="90" fill="#fff3e0" stroke="#ff9800" stroke-width="3"/>
                <text x="600" y="330" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Raport</text>
                <text x="600" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Expunere</text>
                <text x="600" y="380" text-anchor="middle" font-family="Georgia, serif" font-size="14">Executare</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="300" width="140" height="70" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="120" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">Utilizator</text>
                <text x="120" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">ICC</text>
                <text x="120" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Selectare fiÈ™iere)</text>
                
                <rect x="1010" y="100" width="140" height="70" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1080" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1080" y="145" text-anchor="middle" font-family="Georgia, serif" font-size="12">Email</text>
                <text x="1080" y="160" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(ICC, Creditori)</text>
                
                <rect x="1010" y="530" width="140" height="70" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1080" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Output</text>
                <text x="1080" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Rapoarte Excel)</text>
                
                <rect x="50" y="530" width="140" height="70" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="120" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="120" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Master</text>
                <text x="120" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Restantieri + Lista)</text>
                
                <rect x="1010" y="300" width="140" height="70" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1080" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">Local</text>
                <text x="1080" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Trimitere email)</text>
                
                <!-- Fluxuri de date -->
                <path d="M 190 335 L 510 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Expunere)"/>
                <text x="350" y="330" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">SelecÈ›ie fiÈ™iere</text>
                
                <path d="M 190 565 L 510 410" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Expunere)"/>
                <text x="300" y="500" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">FiÈ™iere Restantieri</text>
                <text x="300" y="515" font-family="Georgia, serif" font-size="10" fill="#666">+ Lista Derulanta.xlsx</text>
                
                <path d="M 690 350 L 1010 135" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Expunere)"/>
                <text x="850" y="220" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email cu rapoarte</text>
                <text x="850" y="235" font-family="Georgia, serif" font-size="10" fill="#666">(Excel + grafice)</text>
                
                <path d="M 690 380 L 1010 565" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Expunere)"/>
                <text x="850" y="480" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Rapoarte Excel</text>
                <text x="850" y="495" font-family="Georgia, serif" font-size="10" fill="#666">(Salvare localÄƒ)</text>
                
                <path d="M 690 320 L 1010 335" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Expunere)"/>
                <text x="850" y="315" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email cu ataÈ™amente</text>
                <text x="850" y="330" font-family="Georgia, serif" font-size="10" fill="#666">(Rapoarte + grafice)</text>
              </svg>
            </div>
            
            <h4>3.2. DFD Nivel 1 - Flux Detaliat de Procesare</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1600" height="1100" viewBox="0 0 1600 1100" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD1-Expunere" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Titlu -->
                <text x="800" y="40" text-anchor="middle" font-family="Georgia, serif" font-size="22" font-weight="bold" fill="#22507a">ğŸ“Š RAPORT EXPUNERE EXECUTARE - FLUXURI DE DATE DETALIATE</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="80" width="120" height="60" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="110" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Utilizator</text>
                <text x="110" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">ICC</text>
                
                <rect x="1430" y="80" width="120" height="60" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1490" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1490" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <rect x="1430" y="950" width="120" height="60" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="975" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1490" y="995" text-anchor="middle" font-family="Georgia, serif" font-size="11">Output</text>
                
                <rect x="50" y="950" width="120" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="110" y="975" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="110" y="995" text-anchor="middle" font-family="Georgia, serif" font-size="11">Master</text>
                
                <rect x="1430" y="500" width="120" height="60" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="525" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1490" y="545" text-anchor="middle" font-family="Georgia, serif" font-size="11">Local</text>
                
                <!-- Procese -->
                <circle cx="200" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">1.0</text>
                <text x="200" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="200" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Lista Derulanta</text>
                
                <circle cx="400" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">2.0</text>
                <text x="400" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="400" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Restantieri</text>
                
                <circle cx="600" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">3.0</text>
                <text x="600" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Concatenare</text>
                <text x="600" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Sheet-uri</text>
                
                <circle cx="800" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">4.0</text>
                <text x="800" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Filtrare</text>
                <text x="800" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Date</text>
                
                <circle cx="200" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">5.0</text>
                <text x="200" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Aplicare</text>
                <text x="200" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Mapping</text>
                
                <circle cx="500" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="500" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">6.0</text>
                <text x="500" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Formatare</text>
                <text x="500" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Excel</text>
                
                <circle cx="800" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">7.0</text>
                <text x="800" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="800" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Rapoarte</text>
                
                <circle cx="1100" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="1100" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">8.0</text>
                <text x="1100" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="1100" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Grafice</text>
                
                <circle cx="200" cy="700" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="690" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">9.0</text>
                <text x="200" y="705" text-anchor="middle" font-family="Georgia, serif" font-size="11">Eliminare</text>
                <text x="200" y="720" text-anchor="middle" font-family="Georgia, serif" font-size="11">Lichidate</text>
                
                <circle cx="500" cy="700" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="500" y="690" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">10.0</text>
                <text x="500" y="705" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="500" y="720" text-anchor="middle" font-family="Georgia, serif" font-size="11">Neconcordante</text>
                
                <circle cx="800" cy="700" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="690" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">11.0</text>
                <text x="800" y="705" text-anchor="middle" font-family="Georgia, serif" font-size="11">Trimitere</text>
                <text x="800" y="720" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <!-- Stocuri de date -->
                <rect x="50" y="800" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="50" y1="825" x2="250" y2="825" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="150" y="845" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D1</text>
                <text x="150" y="865" text-anchor="middle" font-family="Georgia, serif" font-size="12">FiÈ™iere Input</text>
                <text x="150" y="880" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Restantieri + Lista)</text>
                
                <rect x="600" y="800" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="600" y1="825" x2="800" y2="825" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="700" y="845" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D2</text>
                <text x="700" y="865" text-anchor="middle" font-family="Georgia, serif" font-size="12">Mapping</text>
                <text x="700" y="880" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Portofoliu â†’ Creditor)</text>
                
                <rect x="1150" y="800" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1150" y1="825" x2="1350" y2="825" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1250" y="845" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D3</text>
                <text x="1250" y="865" text-anchor="middle" font-family="Georgia, serif" font-size="12">Rapoarte Procesate</text>
                <text x="1250" y="880" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Prelucrare)</text>
                
                <rect x="1150" y="600" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1150" y1="625" x2="1350" y2="625" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1250" y="645" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D4</text>
                <text x="1250" y="665" text-anchor="middle" font-family="Georgia, serif" font-size="12">Rapoarte Finale</text>
                <text x="1250" y="680" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Consolidate)</text>
                
                <!-- Fluxuri principale -->
                <path d="M 170 110 L 150 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="140" y="170" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">selecÈ›ie fiÈ™iere</text>
                
                <path d="M 150 950 L 150 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="130" y="620" font-family="Georgia, serif" font-size="10" fill="#3576b0">fiÈ™iere Restantieri</text>
                
                <path d="M 150 950 L 200 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="160" y="620" font-family="Georgia, serif" font-size="10" fill="#3576b0">Lista Derulanta.xlsx</text>
                
                <path d="M 250 250 L 350 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="300" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">mapping portofoliu</text>
                
                <path d="M 250 250 L 700 800" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="450" y="520" font-family="Georgia, serif" font-size="10" fill="#3576b0">mapping creat</text>
                
                <path d="M 700 800 L 200 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="400" y="620" font-family="Georgia, serif" font-size="10" fill="#3576b0">mapping</text>
                
                <path d="M 450 250 L 550 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="500" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date Restantieri</text>
                
                <path d="M 650 250 L 750 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="700" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date concatenate</text>
                
                <path d="M 850 250 L 750 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="800" y="350" font-family="Georgia, serif" font-size="10" fill="#3576b0">date filtrate</text>
                
                <path d="M 250 450 L 450 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="350" y="440" font-family="Georgia, serif" font-size="10" fill="#3576b0">date cu mapping</text>
                
                <path d="M 550 450 L 750 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="650" y="440" font-family="Georgia, serif" font-size="10" fill="#3576b0">date formatate</text>
                
                <path d="M 850 450 L 1250 600" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="1050" y="520" font-family="Georgia, serif" font-size="10" fill="#3576b0">rapoarte consolidate</text>
                
                <path d="M 1150 450 L 1050 700" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="1100" y="570" font-family="Georgia, serif" font-size="10" fill="#3576b0">grafice generate</text>
                
                <path d="M 250 700 L 450 700" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="350" y="690" font-family="Georgia, serif" font-size="10" fill="#3576b0">raport neconcordante</text>
                
                <path d="M 850 700 L 1430 110" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="1140" y="380" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">email cu rapoarte</text>
                
                <path d="M 850 750 L 1430 530" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="1140" y="640" font-family="Georgia, serif" font-size="10" fill="#3576b0">comandÄƒ trimitere</text>
                
                <path d="M 1350 640 L 1490 950" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="1420" y="800" font-family="Georgia, serif" font-size="10" fill="#3576b0">salvare localÄƒ</text>
                
                <!-- Legenda -->
                <rect x="50" y="1050" width="1500" height="40" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="5"/>
                <path d="M 100 1070 L 200 1070" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Expunere)"/>
                <text x="220" y="1075" font-family="Georgia, serif" font-size="11">Flux de date normal</text>
                <text x="800" y="1075" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Procese:</tspan> 1.0-Citire Lista | 2.0-Citire Restantieri | 3.0-Concatenare | 4.0-Filtrare | 5.0-Mapping | 6.0-Formatare | 7.0-Generare Rapoarte | 8.0-Generare Grafice | 9.0-Eliminare Lichidate | 10.0-Neconcordante | 11.0-Email</text>
                <text x="800" y="1090" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Stocuri:</tspan> D1-FiÈ™iere Input | D2-Mapping | D3-Rapoarte Procesate | D4-Rapoarte Finale</text>
              </svg>
            </div>
            
            <h4>3.3. Tabel de Fluxuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Flux</th>
                  <th>Nume Flux</th>
                  <th>SursÄƒ</th>
                  <th>DestinaÈ›ie</th>
                  <th>ConÈ›inut</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>F1</td>
                  <td>SelecÈ›ie FiÈ™iere</td>
                  <td>Utilizator ICC</td>
                  <td>Proces 1.0, 2.0</td>
                  <td>SelecÈ›ie fiÈ™iere Raport-Restantieri_* È™i Lista Derulanta.xlsx</td>
                </tr>
                <tr>
                  <td>F2</td>
                  <td>FiÈ™iere Restantieri</td>
                  <td>D1 (FiÈ™iere Input)</td>
                  <td>Proces 2.0</td>
                  <td>FiÈ™iere Excel Raport-Restantieri_* cu multiple sheet-uri</td>
                </tr>
                <tr>
                  <td>F3</td>
                  <td>Lista Derulanta</td>
                  <td>D1 (FiÈ™iere Input)</td>
                  <td>Proces 1.0</td>
                  <td>FiÈ™ier Excel Lista Derulanta.xlsx cu mapping portofoliu â†’ denumire creditor</td>
                </tr>
                <tr>
                  <td>F4</td>
                  <td>Mapping Portofoliu</td>
                  <td>Proces 1.0</td>
                  <td>D2 (Mapping)</td>
                  <td>DicÈ›ionar mapping Ã®ntre Portofoliu È™i Denumire creditor corect</td>
                </tr>
                <tr>
                  <td>F5</td>
                  <td>Mapping</td>
                  <td>D2 (Mapping)</td>
                  <td>Proces 5.0</td>
                  <td>DicÈ›ionar mapping pentru aplicare pe date</td>
                </tr>
                <tr>
                  <td>F6</td>
                  <td>Date Restantieri</td>
                  <td>Proces 2.0</td>
                  <td>Proces 3.0</td>
                  <td>DataFrame-uri pandas cu date din fiecare sheet</td>
                </tr>
                <tr>
                  <td>F7</td>
                  <td>Date Concatenate</td>
                  <td>Proces 3.0</td>
                  <td>Proces 4.0</td>
                  <td>DataFrame unificat cu date concatenate din toate sheet-urile</td>
                </tr>
                <tr>
                  <td>F8</td>
                  <td>Date Filtrate</td>
                  <td>Proces 4.0</td>
                  <td>Proces 5.0</td>
                  <td>DataFrame fÄƒrÄƒ EXECUTARE="NU", fÄƒrÄƒ DATA_PREDARE_BEJ cu luna curentÄƒ sau blank, fÄƒrÄƒ EXT_ACCOUNT_ID="-1"</td>
                </tr>
                <tr>
                  <td>F9</td>
                  <td>Date cu Mapping</td>
                  <td>Proces 5.0</td>
                  <td>Proces 6.0</td>
                  <td>DataFrame cu denumiri portofolii corectate conform mapping-ului</td>
                </tr>
                <tr>
                  <td>F10</td>
                  <td>Date Formate</td>
                  <td>Proces 6.0</td>
                  <td>D3 (Rapoarte Procesate)</td>
                  <td>FiÈ™iere Excel formatate (font Georgia 11, borduri, colorare header, valori 0 roÈ™ii)</td>
                </tr>
                <tr>
                  <td>F11</td>
                  <td>Rapoarte Consolidate</td>
                  <td>Proces 7.0</td>
                  <td>D4 (Rapoarte Finale)</td>
                  <td>Rapoarte Excel consolidate (Total Conturi Executare, Total Expunere Executare)</td>
                </tr>
                <tr>
                  <td>F12</td>
                  <td>Grafice Generate</td>
                  <td>Proces 8.0</td>
                  <td>Proces 11.0</td>
                  <td>Grafice matplotlib (bar charts pentru expunere È™i conturi) codificate base64</td>
                </tr>
                <tr>
                  <td>F13</td>
                  <td>Raport Neconcordante</td>
                  <td>Proces 10.0</td>
                  <td>D4 (Rapoarte Finale)</td>
                  <td>Raport Excel cu cazuri neconcordante (portofolii neidentificate)</td>
                </tr>
                <tr>
                  <td>F14</td>
                  <td>Email cu Rapoarte</td>
                  <td>Proces 11.0</td>
                  <td>Destinatari Email</td>
                  <td>Email HTML cu tabel consolidat, grafice embedded, ataÈ™amente Excel</td>
                </tr>
                <tr>
                  <td>F15</td>
                  <td>ComandÄƒ Trimitere</td>
                  <td>Proces 11.0</td>
                  <td>Outlook</td>
                  <td>ComandÄƒ COM pentru trimitere email prin Outlook local</td>
                </tr>
                <tr>
                  <td>F16</td>
                  <td>Salvare LocalÄƒ</td>
                  <td>D4 (Rapoarte Finale)</td>
                  <td>Folder Output</td>
                  <td>FiÈ™iere Excel salvate Ã®n folderul Rezultate expunere/</td>
                </tr>
              </tbody>
            </table>
            
            <h4>3.4. Tabel de Stocuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Stoc</th>
                  <th>Nume Stoc</th>
                  <th>Descriere</th>
                  <th>StructurÄƒ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>D1</td>
                  <td>FiÈ™iere Input</td>
                  <td>FiÈ™iere Excel din folderul Master expunere executare/</td>
                  <td>FiÈ™iere Raport-Restantieri_*.xlsx (multiple sheet-uri) È™i Lista Derulanta.xlsx</td>
                </tr>
                <tr>
                  <td>D2</td>
                  <td>Mapping</td>
                  <td>DicÈ›ionar mapping portofoliu â†’ denumire creditor</td>
                  <td>DicÈ›ionar Python {portofoliu: denumire_corecta} creat din Lista Derulanta.xlsx</td>
                </tr>
                <tr>
                  <td>D3</td>
                  <td>Rapoarte Procesate</td>
                  <td>Folder Prelucrare - [luna curentÄƒ] cu rapoarte procesate per creditor</td>
                  <td>FiÈ™iere Excel Raport-Restantieri_[Denumire_Creditor].xlsx formatate, fÄƒrÄƒ cazuri lichidate</td>
                </tr>
                <tr>
                  <td>D4</td>
                  <td>Rapoarte Finale</td>
                  <td>Folder Rezultate expunere/ cu rapoarte consolidate</td>
                  <td>Rapoarte Excel: Total Conturi Executare, Total Expunere Executare, Neconcordante, Tabel Consolidat</td>
                </tr>
              </tbody>
            </table>
            
            <h4>3.5. Descriere DetaliatÄƒ a Proceselor</h4>
            <table>
              <thead>
                <tr>
                  <th>Proces</th>
                  <th>Descriere</th>
                  <th>Input</th>
                  <th>Output</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>1.0 - Citire Lista Derulanta</strong></td>
                  <td>CiteÈ™te fiÈ™ierul Lista Derulanta.xlsx È™i creeazÄƒ dicÈ›ionarul de mapping Ã®ntre Portofoliu È™i Denumire creditor corect</td>
                  <td>Lista Derulanta.xlsx (D1)</td>
                  <td>DicÈ›ionar mapping salvat Ã®n D2</td>
                </tr>
                <tr>
                  <td><strong>2.0 - Citire Restantieri</strong></td>
                  <td>CiteÈ™te toate fiÈ™ierele Raport-Restantieri_*.xlsx din folderul Master, identificÄƒ toate sheet-urile</td>
                  <td>FiÈ™iere Raport-Restantieri_*.xlsx (D1)</td>
                  <td>ListÄƒ de DataFrame-uri pandas (unul per sheet)</td>
                </tr>
                <tr>
                  <td><strong>3.0 - Concatenare Sheet-uri</strong></td>
                  <td>Pentru fiecare fiÈ™ier Restantieri: proceseazÄƒ sheet-ul 1 (rÃ¢ndul 2 ca header), copiazÄƒ datele din sheet-urile suplimentare Ã®n sheet-ul 1, concateneazÄƒ toate datele</td>
                  <td>DataFrame-uri din fiecare sheet</td>
                  <td>DataFrame unificat per fiÈ™ier</td>
                </tr>
                <tr>
                  <td><strong>4.0 - Filtrare Date</strong></td>
                  <td>EliminÄƒ rÃ¢ndurile unde: EXECUTARE="NU", DATA_PREDARE_BEJ conÈ›ine luna curentÄƒ sau este blank, EXT_ACCOUNT_ID="-1"</td>
                  <td>DataFrame concatenat</td>
                  <td>DataFrame filtrat</td>
                </tr>
                <tr>
                  <td><strong>5.0 - Aplicare Mapping</strong></td>
                  <td>AplicÄƒ mapping-ul din D2 pentru a corecta denumirile portofoliilor Ã®n datele procesate</td>
                  <td>DataFrame filtrat + Mapping (D2)</td>
                  <td>DataFrame cu denumiri corectate</td>
                </tr>
                <tr>
                  <td><strong>6.0 - Formatare Excel</strong></td>
                  <td>FormateazÄƒ Excel-ul cu stil modern: font Georgia 11, header albastru, borduri, valori 0 roÈ™ii boldate. SalveazÄƒ Ã®n folderul Prelucrare</td>
                  <td>DataFrame cu mapping aplicat</td>
                  <td>FiÈ™ier Excel formatat salvat Ã®n D3</td>
                </tr>
                <tr>
                  <td><strong>7.0 - Generare Rapoarte</strong></td>
                  <td>GenereazÄƒ rapoarte consolidate: Total Conturi Executare (agregare pe creditor), Total Expunere Executare (agregare pe creditor), Tabel Consolidat</td>
                  <td>Rapoarte procesate (D3)</td>
                  <td>Rapoarte Excel consolidate salvate Ã®n D4</td>
                </tr>
                <tr>
                  <td><strong>8.0 - Generare Grafice</strong></td>
                  <td>GenereazÄƒ grafice matplotlib (bar charts) pentru expunere totalÄƒ executare È™i numÄƒr total conturi, codificate base64 pentru includere Ã®n email</td>
                  <td>Date consolidate</td>
                  <td>Grafice codificate base64</td>
                </tr>
                <tr>
                  <td><strong>9.0 - Eliminare Lichidate</strong></td>
                  <td>EliminÄƒ cazurile lichidate din toate fiÈ™ierele procesate (identificÄƒ dupÄƒ coloane STADIU_DOSAR, REZOLUTIE_INCHIDERE, DATA_INCHEIERE_DOSAR)</td>
                  <td>Rapoarte procesate (D3)</td>
                  <td>Rapoarte actualizate fÄƒrÄƒ cazuri lichidate</td>
                </tr>
                <tr>
                  <td><strong>10.0 - Generare Neconcordante</strong></td>
                  <td>GenereazÄƒ raport Excel cu cazurile neconcordante (portofolii care nu au fost identificate Ã®n mapping-ul din Lista Derulanta)</td>
                  <td>Date procesate cu portofolii neidentificate</td>
                  <td>Raport Excel Neconcordante salvat Ã®n D4</td>
                </tr>
                <tr>
                  <td><strong>11.0 - Trimitere Email</strong></td>
                  <td>Trimite email prin Outlook local cu tabel HTML consolidat, grafice embedded (base64), È™i ataÈ™amente Excel (rapoarte consolidate)</td>
                  <td>Rapoarte finale (D4) + Grafice</td>
                  <td>Email trimis cÄƒtre destinatari prin Outlook</td>
                </tr>
              </tbody>
            </table>
            
            <h4>3.6. Note Importante</h4>
            <ul>
              <li><strong>Procesare LocalÄƒ:</strong> Toate procesele se desfÄƒÈ™oarÄƒ local pe staÈ›ia de lucru a utilizatorului ICC, fÄƒrÄƒ transmitere cÄƒtre servere externe.</li>
              <li><strong>FÄƒrÄƒ Stocare PersistentÄƒ:</strong> Datele sunt procesate exclusiv Ã®n memorie temporarÄƒ (RAM). FiÈ™ierele intermediare È™i finale sunt salvate doar pentru utilizare ulterioarÄƒ.</li>
              <li><strong>Mapping Portofoliu:</strong> Mapping-ul Ã®ntre portofolii È™i denumiri creditori este creat din Lista Derulanta.xlsx È™i aplicat automat pe toate datele procesate.</li>
              <li><strong>Filtrare Multi-Criteriu:</strong> Raportul aplicÄƒ multiple filtre (EXECUTARE, DATA_PREDARE_BEJ, EXT_ACCOUNT_ID) pentru a elimina datele irelevante.</li>
              <li><strong>Eliminare AutomatÄƒ Lichidate:</strong> Cazurile lichidate sunt eliminate automat din rapoarte dupÄƒ procesare iniÈ›ialÄƒ.</li>
              <li><strong>Grafice Embedded:</strong> Graficele sunt generate cu matplotlib È™i codificate base64 pentru includere directÄƒ Ã®n email HTML.</li>
              <li><strong>Email Consolidat:</strong> Email-ul final conÈ›ine tabel HTML consolidat cu toate creditori, grafice embedded, È™i ataÈ™amente Excel.</li>
              <li><strong>Eliminare AutomatÄƒ:</strong> DupÄƒ finalizarea procesÄƒrii È™i trimiterii email-urilor, datele din memorie sunt eliminate automat, aplicaÈ›ia revenind la starea iniÈ›ialÄƒ.</li>
            </ul>
          </div>

          <!-- DFD Raport 4: Termene LicitaÈ›ie -->
          <div class="dfd-report" id="dfd-report-4">
            <h3>ğŸ“… 4. Raport Termene LicitaÈ›ie - Fluxuri de Date</h3>
            
            <h4>4.1. DFD Nivel 0 - DiagramÄƒ Context</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1200" height="700" viewBox="0 0 1200 700" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD-Termene" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Proces central -->
                <circle cx="600" cy="350" r="90" fill="#fff3e0" stroke="#ff9800" stroke-width="3"/>
                <text x="600" y="330" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Raport</text>
                <text x="600" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Termene</text>
                <text x="600" y="380" text-anchor="middle" font-family="Georgia, serif" font-size="14">LicitaÈ›ie</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="300" width="140" height="70" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="120" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">Utilizator</text>
                <text x="120" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">ICC</text>
                <text x="120" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Selectare fiÈ™iere)</text>
                
                <rect x="1010" y="100" width="140" height="70" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1080" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1080" y="145" text-anchor="middle" font-family="Georgia, serif" font-size="12">Email</text>
                <text x="1080" y="160" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(ICC)</text>
                
                <rect x="1010" y="530" width="140" height="70" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1080" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Output</text>
                <text x="1080" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Raport Excel)</text>
                
                <rect x="50" y="530" width="140" height="70" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="120" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="120" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Master</text>
                <text x="120" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Rap 7 + Garantii)</text>
                
                <rect x="1010" y="300" width="140" height="70" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1080" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">Local</text>
                <text x="1080" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Trimitere email)</text>
                
                <!-- Fluxuri de date -->
                <path d="M 190 335 L 510 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Termene)"/>
                <text x="350" y="330" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">SelecÈ›ie fiÈ™iere</text>
                
                <path d="M 190 565 L 510 410" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Termene)"/>
                <text x="300" y="500" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">FiÈ™iere Rap 7</text>
                <text x="300" y="515" font-family="Georgia, serif" font-size="10" fill="#666">+ raportGarantiiExecutareICC</text>
                
                <path d="M 690 350 L 1010 135" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Termene)"/>
                <text x="850" y="220" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email cu raport</text>
                <text x="850" y="235" font-family="Georgia, serif" font-size="10" fill="#666">(Excel + diagramÄƒ)</text>
                
                <path d="M 690 380 L 1010 565" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Termene)"/>
                <text x="850" y="480" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Raport Excel</text>
                <text x="850" y="495" font-family="Georgia, serif" font-size="10" fill="#666">(Salvare localÄƒ)</text>
                
                <path d="M 690 320 L 1010 335" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Termene)"/>
                <text x="850" y="315" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email cu ataÈ™amente</text>
                <text x="850" y="330" font-family="Georgia, serif" font-size="10" fill="#666">(Raport + diagramÄƒ)</text>
              </svg>
            </div>
            
            <h4>4.2. DFD Nivel 1 - Flux Detaliat de Procesare</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1500" height="1000" viewBox="0 0 1500 1000" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD1-Termene" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Titlu -->
                <text x="750" y="40" text-anchor="middle" font-family="Georgia, serif" font-size="22" font-weight="bold" fill="#22507a">ğŸ“… RAPORT TERMENE LICITAÈšIE - FLUXURI DE DATE DETALIATE</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="80" width="120" height="60" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="110" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Utilizator</text>
                <text x="110" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">ICC</text>
                
                <rect x="1330" y="80" width="120" height="60" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1390" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1390" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <rect x="1330" y="850" width="120" height="60" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1390" y="875" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1390" y="895" text-anchor="middle" font-family="Georgia, serif" font-size="11">Output</text>
                
                <rect x="50" y="850" width="120" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="110" y="875" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="110" y="895" text-anchor="middle" font-family="Georgia, serif" font-size="11">Master</text>
                
                <rect x="1330" y="450" width="120" height="60" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1390" y="475" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1390" y="495" text-anchor="middle" font-family="Georgia, serif" font-size="11">Local</text>
                
                <!-- Procese -->
                <circle cx="200" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">1.0</text>
                <text x="200" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="200" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Rap 7</text>
                
                <circle cx="400" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">2.0</text>
                <text x="400" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="400" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Garantii</text>
                
                <circle cx="600" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">3.0</text>
                <text x="600" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Concatenare</text>
                <text x="600" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Sheet-uri</text>
                
                <circle cx="800" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">4.0</text>
                <text x="800" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">CurÄƒÈ›are</text>
                <text x="800" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">AUCTION_NO</text>
                
                <circle cx="1000" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="1000" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">5.0</text>
                <text x="1000" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Conectare</text>
                <text x="1000" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">&amp; Filtrare</text>
                
                <circle cx="200" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">6.0</text>
                <text x="200" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Formatare</text>
                <text x="200" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Georgia 11</text>
                
                <circle cx="500" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="500" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">7.0</text>
                <text x="500" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="500" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Pivot Table</text>
                
                <circle cx="800" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">8.0</text>
                <text x="800" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="800" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">DiagramÄƒ</text>
                
                <circle cx="1100" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="1100" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">9.0</text>
                <text x="1100" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Trimitere</text>
                <text x="1100" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <!-- Stocuri de date -->
                <rect x="50" y="650" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="50" y1="675" x2="250" y2="675" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="150" y="695" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D1</text>
                <text x="150" y="715" text-anchor="middle" font-family="Georgia, serif" font-size="12">FiÈ™iere Input</text>
                <text x="150" y="730" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Rap 7 + Garantii)</text>
                
                <rect x="600" y="650" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="600" y1="675" x2="800" y2="675" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="700" y="695" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D2</text>
                <text x="700" y="715" text-anchor="middle" font-family="Georgia, serif" font-size="12">Date Procesate</text>
                <text x="700" y="730" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Temporar)</text>
                
                <rect x="1150" y="650" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1150" y1="675" x2="1350" y2="675" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1250" y="695" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D3</text>
                <text x="1250" y="715" text-anchor="middle" font-family="Georgia, serif" font-size="12">Raport Final</text>
                <text x="1250" y="730" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Excel)</text>
                
                <!-- Fluxuri principale -->
                <path d="M 170 110 L 150 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="140" y="170" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">selecÈ›ie fiÈ™iere</text>
                
                <path d="M 150 850 L 150 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="130" y="570" font-family="Georgia, serif" font-size="10" fill="#3576b0">fiÈ™ier Rap 7</text>
                
                <path d="M 150 850 L 400 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="250" y="570" font-family="Georgia, serif" font-size="10" fill="#3576b0">fiÈ™ier Garantii</text>
                
                <path d="M 250 250 L 350 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="300" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date Rap 7</text>
                
                <path d="M 450 250 L 550 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="500" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date Garantii</text>
                
                <path d="M 650 250 L 750 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="700" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date concatenate</text>
                
                <path d="M 850 250 L 950 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="900" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">AUCTION_NO curÄƒÈ›at</text>
                
                <path d="M 1050 250 L 700 650" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="850" y="450" font-family="Georgia, serif" font-size="10" fill="#3576b0">date conectate</text>
                
                <path d="M 700 650 L 200 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="400" y="550" font-family="Georgia, serif" font-size="10" fill="#3576b0">date procesate</text>
                
                <path d="M 250 450 L 450 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="350" y="440" font-family="Georgia, serif" font-size="10" fill="#3576b0">date formatate</text>
                
                <path d="M 550 450 L 750 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="650" y="440" font-family="Georgia, serif" font-size="10" fill="#3576b0">pivot table</text>
                
                <path d="M 850 450 L 1050 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="950" y="440" font-family="Georgia, serif" font-size="10" fill="#3576b0">diagramÄƒ</text>
                
                <path d="M 1150 450 L 1330 110" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="1240" y="260" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">email cu raport</text>
                
                <path d="M 1150 500 L 1330 480" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="1240" y="490" font-family="Georgia, serif" font-size="10" fill="#3576b0">comandÄƒ trimitere</text>
                
                <path d="M 1350 690 L 1390 850" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="1370" y="770" font-family="Georgia, serif" font-size="10" fill="#3576b0">salvare localÄƒ</text>
                
                <!-- Legenda -->
                <rect x="50" y="950" width="1400" height="40" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="5"/>
                <path d="M 100 970 L 200 970" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Termene)"/>
                <text x="220" y="975" font-family="Georgia, serif" font-size="11">Flux de date normal</text>
                <text x="750" y="975" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Procese:</tspan> 1.0-Citire Rap 7 | 2.0-Citire Garantii | 3.0-Concatenare | 4.0-CurÄƒÈ›are | 5.0-Conectare | 6.0-Formatare | 7.0-Pivot | 8.0-DiagramÄƒ | 9.0-Email</text>
                <text x="750" y="990" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Stocuri:</tspan> D1-FiÈ™iere Input | D2-Date Procesate | D3-Raport Final</text>
              </svg>
            </div>
            
            <h4>4.3. Tabel de Fluxuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Flux</th>
                  <th>Nume Flux</th>
                  <th>SursÄƒ</th>
                  <th>DestinaÈ›ie</th>
                  <th>ConÈ›inut</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>F1</td>
                  <td>SelecÈ›ie FiÈ™iere</td>
                  <td>Utilizator ICC</td>
                  <td>Proces 1.0, 2.0</td>
                  <td>SelecÈ›ie fiÈ™ier Rap 7 È™i raportGarantiiExecutareICC</td>
                </tr>
                <tr>
                  <td>F2</td>
                  <td>FiÈ™ier Rap 7</td>
                  <td>D1 (FiÈ™iere Input)</td>
                  <td>Proces 1.0</td>
                  <td>FiÈ™ier Excel Rap 7 cu sheet "baza finala rap.3-sursa2"</td>
                </tr>
                <tr>
                  <td>F3</td>
                  <td>FiÈ™ier Garantii</td>
                  <td>D1 (FiÈ™iere Input)</td>
                  <td>Proces 2.0</td>
                  <td>FiÈ™ier Excel raportGarantiiExecutareICC cu 2 sheet-uri</td>
                </tr>
                <tr>
                  <td>F4</td>
                  <td>Date Rap 7</td>
                  <td>Proces 1.0</td>
                  <td>Proces 5.0</td>
                  <td>DataFrame pandas cu date din Rap 7 (ID garantie Capone)</td>
                </tr>
                <tr>
                  <td>F5</td>
                  <td>Date Garantii</td>
                  <td>Proces 2.0</td>
                  <td>Proces 3.0</td>
                  <td>DataFrame-uri pandas cu date din fiecare sheet Garantii</td>
                </tr>
                <tr>
                  <td>F6</td>
                  <td>Date Concatenate</td>
                  <td>Proces 3.0</td>
                  <td>Proces 4.0</td>
                  <td>DataFrame unificat cu date concatenate din ambele sheet-uri Garantii</td>
                </tr>
                <tr>
                  <td>F7</td>
                  <td>AUCTION_NO CurÄƒÈ›at</td>
                  <td>Proces 4.0</td>
                  <td>Proces 5.0</td>
                  <td>DataFrame cu coloana AUCTION_NO_CLEANED (valori 1-1000)</td>
                </tr>
                <tr>
                  <td>F8</td>
                  <td>Date Conectate</td>
                  <td>Proces 5.0</td>
                  <td>D2 (Date Procesate)</td>
                  <td>DataFrame cu date conectate pe ID garantie Capone, filtrate</td>
                </tr>
                <tr>
                  <td>F9</td>
                  <td>Date Procesate</td>
                  <td>D2 (Date Procesate)</td>
                  <td>Proces 6.0</td>
                  <td>DataFrame pentru formatare</td>
                </tr>
                <tr>
                  <td>F10</td>
                  <td>Date Formate</td>
                  <td>Proces 6.0</td>
                  <td>Proces 7.0</td>
                  <td>DataFrame formatat cu font Georgia 11</td>
                </tr>
                <tr>
                  <td>F11</td>
                  <td>Pivot Table</td>
                  <td>Proces 7.0</td>
                  <td>Proces 8.0, D3</td>
                  <td>Pivot table cu intervale de 10 pentru AUCTION_NO (1-10, 11-20, etc.)</td>
                </tr>
                <tr>
                  <td>F12</td>
                  <td>DiagramÄƒ</td>
                  <td>Proces 8.0</td>
                  <td>Proces 9.0</td>
                  <td>DiagramÄƒ matplotlib (grouped bar chart) codificatÄƒ base64</td>
                </tr>
                <tr>
                  <td>F13</td>
                  <td>Email cu Raport</td>
                  <td>Proces 9.0</td>
                  <td>Destinatari Email</td>
                  <td>Email HTML cu tabel pivot, diagramÄƒ embedded, ataÈ™ament Excel</td>
                </tr>
                <tr>
                  <td>F14</td>
                  <td>ComandÄƒ Trimitere</td>
                  <td>Proces 9.0</td>
                  <td>Outlook</td>
                  <td>ComandÄƒ COM pentru trimitere email prin Outlook local</td>
                </tr>
                <tr>
                  <td>F15</td>
                  <td>Salvare LocalÄƒ</td>
                  <td>D3 (Raport Final)</td>
                  <td>Folder Output</td>
                  <td>FiÈ™ier Excel salvat Ã®n Rapoarte_Termene_Licitatie/</td>
                </tr>
              </tbody>
            </table>
            
            <h4>4.4. Tabel de Stocuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Stoc</th>
                  <th>Nume Stoc</th>
                  <th>Descriere</th>
                  <th>StructurÄƒ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>D1</td>
                  <td>FiÈ™iere Input</td>
                  <td>FiÈ™iere Excel din folderul Master/</td>
                  <td>FiÈ™ier Rap 7 (sheet "baza finala rap.3-sursa2") È™i raportGarantiiExecutareICC (2 sheet-uri)</td>
                </tr>
                <tr>
                  <td>D2</td>
                  <td>Date Procesate</td>
                  <td>FiÈ™iere Excel temporare pentru analizÄƒ</td>
                  <td>Rap7_Analiza.xlsx È™i RaportGarantiiExecutareICC_Analiza.xlsx (formatate cu font Georgia 11)</td>
                </tr>
                <tr>
                  <td>D3</td>
                  <td>Raport Final</td>
                  <td>FiÈ™ier Excel final cu raport complet</td>
                  <td>Raport_Termene_Licitatie_Garantii.xlsx cu 3 sheet-uri: Rap7_Data, Garantii_Data, Pivot_Intervale</td>
                </tr>
              </tbody>
            </table>
            
            <h4>4.5. Descriere DetaliatÄƒ a Proceselor</h4>
            <table>
              <thead>
                <tr>
                  <th>Proces</th>
                  <th>Descriere</th>
                  <th>Input</th>
                  <th>Output</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>1.0 - Citire Rap 7</strong></td>
                  <td>CiteÈ™te fiÈ™ierul Rap 7 È™i extrage sheet-ul "baza finala rap.3-sursa2" cu datele despre garanÈ›ii</td>
                  <td>FiÈ™ier Rap 7 (D1)</td>
                  <td>DataFrame pandas cu date Rap 7</td>
                </tr>
                <tr>
                  <td><strong>2.0 - Citire Garantii</strong></td>
                  <td>CiteÈ™te fiÈ™ierul raportGarantiiExecutareICC, sheet-ul 1 (skiprows=1) È™i sheet-ul 2</td>
                  <td>FiÈ™ier raportGarantiiExecutareICC (D1)</td>
                  <td>2 DataFrame-uri pandas (unul per sheet)</td>
                </tr>
                <tr>
                  <td><strong>3.0 - Concatenare Sheet-uri</strong></td>
                  <td>ConcateneazÄƒ datele din ambele sheet-uri Garantii Ã®ntr-un singur DataFrame</td>
                  <td>2 DataFrame-uri Garantii</td>
                  <td>DataFrame unificat</td>
                </tr>
                <tr>
                  <td><strong>4.0 - CurÄƒÈ›are AUCTION_NO</strong></td>
                  <td>CurÄƒÈ›Äƒ coloana AUCTION_NO: extrage doar cifrele, filtreazÄƒ valorile Ã®n intervalul 1-1000, eliminÄƒ valori invalide ("?", "reevaluare", "tert", "-")</td>
                  <td>DataFrame concatenat</td>
                  <td>DataFrame cu coloana AUCTION_NO_CLEANED</td>
                </tr>
                <tr>
                  <td><strong>5.0 - Conectare È™i Filtrare</strong></td>
                  <td>ConecteazÄƒ datele Rap 7 cu Garantii pe coloana "ID garantie Capone", filtreazÄƒ doar cazurile regÄƒsite Ã®n Rap 7, pÄƒstreazÄƒ doar cazurile cu AUCTION_NO valid (1-1000)</td>
                  <td>Date Rap 7 + Date Garantii cu AUCTION_NO curÄƒÈ›at</td>
                  <td>DataFrame conectat È™i filtrat</td>
                </tr>
                <tr>
                  <td><strong>6.0 - Formatare Georgia 11</strong></td>
                  <td>AplicÄƒ font Georgia 11 pe toate celulele din fiÈ™ierele temporare de analizÄƒ</td>
                  <td>Date procesate (D2)</td>
                  <td>FiÈ™iere Excel formatate salvate Ã®n D2</td>
                </tr>
                <tr>
                  <td><strong>7.0 - Generare Pivot Table</strong></td>
                  <td>GenereazÄƒ pivot table cu intervale de 10 pentru AUCTION_NO_CLEANED (1-10, 11-20, ..., 101-110), calculeazÄƒ numÄƒr active È™i procentaje, include toate intervalele chiar dacÄƒ sunt goale</td>
                  <td>Date formatate</td>
                  <td>Pivot table cu coloane: Numar termene licitatii, Nr active, Procent (%)</td>
                </tr>
                <tr>
                  <td><strong>8.0 - Generare DiagramÄƒ</strong></td>
                  <td>GenereazÄƒ diagramÄƒ matplotlib (grouped bar chart) pentru distribuÈ›ia procentualÄƒ a termenelor de licitaÈ›ie, codificÄƒ base64 pentru includere Ã®n email</td>
                  <td>Pivot table</td>
                  <td>DiagramÄƒ codificatÄƒ base64</td>
                </tr>
                <tr>
                  <td><strong>9.0 - Trimitere Email</strong></td>
                  <td>Trimite email prin Outlook local cu tabel HTML pivot, diagramÄƒ embedded (base64), È™i ataÈ™ament Excel (raport final). Subiectul include luna È™i anul rulÄƒrii</td>
                  <td>Raport final (D3) + DiagramÄƒ</td>
                  <td>Email trimis cÄƒtre destinatari prin Outlook</td>
                </tr>
              </tbody>
            </table>
            
            <h4>4.6. Note Importante</h4>
            <ul>
              <li><strong>Procesare LocalÄƒ:</strong> Toate procesele se desfÄƒÈ™oarÄƒ local pe staÈ›ia de lucru a utilizatorului ICC, fÄƒrÄƒ transmitere cÄƒtre servere externe.</li>
              <li><strong>FÄƒrÄƒ Stocare PersistentÄƒ:</strong> Datele sunt procesate exclusiv Ã®n memorie temporarÄƒ (RAM). FiÈ™ierele intermediare È™i finale sunt salvate doar pentru utilizare ulterioarÄƒ.</li>
              <li><strong>CurÄƒÈ›are AUCTION_NO:</strong> Coloana AUCTION_NO este curÄƒÈ›atÄƒ automat pentru a pÄƒstra doar valorile numerice valide Ã®n intervalul 1-1000, eliminÃ¢nd valori invalide sau ambigue.</li>
              <li><strong>Conectare pe ID GaranÈ›ie:</strong> Datele sunt conectate pe coloana "ID garantie Capone" Ã®ntre Rap 7 È™i raportGarantiiExecutareICC pentru a identifica cazurile relevante.</li>
              <li><strong>Pivot Table cu Intervale:</strong> Pivot table-ul este generat cu intervale fixe de 10 (1-10, 11-20, etc.) pÃ¢nÄƒ la 110, incluzÃ¢nd toate intervalele chiar dacÄƒ sunt goale pentru claritate.</li>
              <li><strong>DiagramÄƒ Embedded:</strong> Diagrama este generatÄƒ cu matplotlib È™i codificatÄƒ base64 pentru includere directÄƒ Ã®n email HTML, fÄƒrÄƒ fiÈ™iere separate.</li>
              <li><strong>Email cu Tabel HTML:</strong> Email-ul final conÈ›ine tabel HTML formatat cu stiluri albastre, pivot table-ul complet, È™i diagramÄƒ embedded.</li>
              <li><strong>Eliminare AutomatÄƒ:</strong> DupÄƒ finalizarea procesÄƒrii È™i trimiterii email-ului, datele din memorie sunt eliminate automat, aplicaÈ›ia revenind la starea iniÈ›ialÄƒ.</li>
            </ul>
          </div>

          <!-- DFD Raport 5: Incidente Riscuri -->
          <div class="dfd-report" id="dfd-report-5">
            <h3>âš ï¸ 5. Raport Incidente Riscuri - Fluxuri de Date</h3>
            
            <h4>5.1. DFD Nivel 0 - DiagramÄƒ Context</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1200" height="700" viewBox="0 0 1200 700" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD-Incidente" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Proces central -->
                <circle cx="600" cy="350" r="90" fill="#fff3e0" stroke="#ff9800" stroke-width="3"/>
                <text x="600" y="330" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Raport</text>
                <text x="600" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Incidente</text>
                <text x="600" y="380" text-anchor="middle" font-family="Georgia, serif" font-size="14">Riscuri</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="300" width="140" height="70" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="120" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">Utilizator</text>
                <text x="120" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">ICC</text>
                <text x="120" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Selectare folder)</text>
                
                <rect x="1010" y="100" width="140" height="70" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1080" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Creditori</text>
                <text x="1080" y="145" text-anchor="middle" font-family="Georgia, serif" font-size="12">(Email)</text>
                <text x="1080" y="160" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Destinatari)</text>
                
                <rect x="1010" y="530" width="140" height="70" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1080" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Output</text>
                <text x="1080" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Rapoarte Excel)</text>
                
                <rect x="50" y="530" width="140" height="70" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="120" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="120" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Master</text>
                <text x="120" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Lista + Rapoarte)</text>
                
                <rect x="1010" y="300" width="140" height="70" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1080" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">Local</text>
                <text x="1080" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Trimitere email)</text>
                
                <!-- Fluxuri de date -->
                <path d="M 190 335 L 510 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Incidente)"/>
                <text x="350" y="330" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">SelecÈ›ie folder Master</text>
                
                <path d="M 190 565 L 510 410" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Incidente)"/>
                <text x="300" y="500" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Lista derulanta.xlsx</text>
                <text x="300" y="515" font-family="Georgia, serif" font-size="10" fill="#666">+ Rapoarte per creditor</text>
                
                <path d="M 690 350 L 1010 135" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Incidente)"/>
                <text x="850" y="220" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email-uri cu rapoarte</text>
                <text x="850" y="235" font-family="Georgia, serif" font-size="10" fill="#666">(Excel parolate + parole)</text>
                
                <path d="M 690 380 L 1010 565" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Incidente)"/>
                <text x="850" y="480" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Rapoarte Excel parolate</text>
                <text x="850" y="495" font-family="Georgia, serif" font-size="10" fill="#666">(Salvare localÄƒ)</text>
                
                <path d="M 690 320 L 1010 335" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Incidente)"/>
                <text x="850" y="315" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email-uri cu ataÈ™amente</text>
                <text x="850" y="330" font-family="Georgia, serif" font-size="10" fill="#666">(Rapoarte parolate)</text>
              </svg>
            </div>
            
            <h4>5.2. DFD Nivel 1 - Flux Detaliat de Procesare</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1600" height="1100" viewBox="0 0 1600 1100" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD1-Incidente" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Titlu -->
                <text x="800" y="40" text-anchor="middle" font-family="Georgia, serif" font-size="22" font-weight="bold" fill="#22507a">âš ï¸ RAPORT INCIDENTE RISCURI - FLUXURI DE DATE DETALIATE</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="80" width="120" height="60" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="110" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Utilizator</text>
                <text x="110" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">ICC</text>
                
                <rect x="1430" y="80" width="120" height="60" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1490" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Creditori</text>
                <text x="1490" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">(Email)</text>
                
                <rect x="1430" y="950" width="120" height="60" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="975" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1490" y="995" text-anchor="middle" font-family="Georgia, serif" font-size="11">Output</text>
                
                <rect x="50" y="950" width="120" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="110" y="975" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="110" y="995" text-anchor="middle" font-family="Georgia, serif" font-size="11">Master</text>
                
                <rect x="1430" y="500" width="120" height="60" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="525" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1490" y="545" text-anchor="middle" font-family="Georgia, serif" font-size="11">Local</text>
                
                <!-- Procese -->
                <circle cx="200" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">1.0</text>
                <text x="200" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="200" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Lista Derulanta</text>
                
                <circle cx="400" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">2.0</text>
                <text x="400" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Identificare</text>
                <text x="400" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Creditori</text>
                
                <circle cx="600" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">3.0</text>
                <text x="600" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">CÄƒutare</text>
                <text x="600" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Rapoarte</text>
                
                <circle cx="800" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">4.0</text>
                <text x="800" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Procesare</text>
                <text x="800" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Excel</text>
                
                <circle cx="200" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">5.0</text>
                <text x="200" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="200" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">ParolÄƒ</text>
                
                <circle cx="500" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="500" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">6.0</text>
                <text x="500" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Criptare</text>
                <text x="500" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Excel</text>
                
                <circle cx="800" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">7.0</text>
                <text x="800" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Trimitere</text>
                <text x="800" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email ParolÄƒ</text>
                
                <circle cx="1100" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="1100" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">8.0</text>
                <text x="1100" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Trimitere</text>
                <text x="1100" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email Raport</text>
                
                <circle cx="200" cy="700" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="690" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">9.0</text>
                <text x="200" y="705" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="200" y="720" text-anchor="middle" font-family="Georgia, serif" font-size="11">Rezumat</text>
                
                <circle cx="500" cy="700" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="500" y="690" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">10.0</text>
                <text x="500" y="705" text-anchor="middle" font-family="Georgia, serif" font-size="11">Trimitere</text>
                <text x="500" y="720" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email Rezumat</text>
                
                <!-- Stocuri de date -->
                <rect x="50" y="800" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="50" y1="825" x2="250" y2="825" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="150" y="845" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D1</text>
                <text x="150" y="865" text-anchor="middle" font-family="Georgia, serif" font-size="12">FiÈ™iere Input</text>
                <text x="150" y="880" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Lista + Rapoarte)</text>
                
                <rect x="600" y="800" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="600" y1="825" x2="800" y2="825" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="700" y="845" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D2</text>
                <text x="700" y="865" text-anchor="middle" font-family="Georgia, serif" font-size="12">Lista Creditori</text>
                <text x="700" y="880" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Creditori + Emailuri)</text>
                
                <rect x="1150" y="800" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1150" y1="825" x2="1350" y2="825" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1250" y="845" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D3</text>
                <text x="1250" y="865" text-anchor="middle" font-family="Georgia, serif" font-size="12">Rapoarte Procesate</text>
                <text x="1250" y="880" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Excel parolate)</text>
                
                <rect x="1150" y="600" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1150" y1="625" x2="1350" y2="625" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1250" y="645" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D4</text>
                <text x="1250" y="665" text-anchor="middle" font-family="Georgia, serif" font-size="12">Rezumat Excel</text>
                <text x="1250" y="680" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Creditori + Parole)</text>
                
                <!-- Fluxuri principale -->
                <path d="M 170 110 L 150 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="140" y="170" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">selecÈ›ie folder</text>
                
                <path d="M 150 950 L 150 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="130" y="620" font-family="Georgia, serif" font-size="10" fill="#3576b0">Lista derulanta.xlsx</text>
                
                <path d="M 150 950 L 600 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="350" y="620" font-family="Georgia, serif" font-size="10" fill="#3576b0">rapoarte Excel</text>
                
                <path d="M 250 250 L 350 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="300" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date Lista</text>
                
                <path d="M 250 250 L 700 800" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="450" y="520" font-family="Georgia, serif" font-size="10" fill="#3576b0">lista creditori</text>
                
                <path d="M 700 800 L 400 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="550" y="520" font-family="Georgia, serif" font-size="10" fill="#3576b0">creditori</text>
                
                <path d="M 450 250 L 550 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="500" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">creditori identificaÈ›i</text>
                
                <path d="M 650 250 L 750 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="700" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">rapoarte gÄƒsite</text>
                
                <path d="M 850 250 L 750 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="800" y="350" font-family="Georgia, serif" font-size="10" fill="#3576b0">rapoarte Excel</text>
                
                <path d="M 250 450 L 450 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="350" y="440" font-family="Georgia, serif" font-size="10" fill="#3576b0">parolÄƒ generatÄƒ</text>
                
                <path d="M 550 450 L 1250 600" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="900" y="520" font-family="Georgia, serif" font-size="10" fill="#3576b0">raport criptat</text>
                
                <path d="M 850 450 L 1430 110" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="1140" y="260" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">email cu parolÄƒ</text>
                
                <path d="M 1150 450 L 1430 110" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="1290" y="260" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">email cu raport</text>
                
                <path d="M 250 700 L 450 700" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="350" y="690" font-family="Georgia, serif" font-size="10" fill="#3576b0">rezumat Excel</text>
                
                <path d="M 550 700 L 1430 110" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="990" y="380" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">email rezumat</text>
                
                <path d="M 1150 480 L 1430 530" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="1290" y="510" font-family="Georgia, serif" font-size="10" fill="#3576b0">comandÄƒ trimitere</text>
                
                <path d="M 1350 640 L 1490 950" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="1420" y="800" font-family="Georgia, serif" font-size="10" fill="#3576b0">salvare localÄƒ</text>
                
                <!-- Legenda -->
                <rect x="50" y="1050" width="1500" height="40" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="5"/>
                <path d="M 100 1070 L 200 1070" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Incidente)"/>
                <text x="220" y="1075" font-family="Georgia, serif" font-size="11">Flux de date normal</text>
                <text x="800" y="1075" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Procese:</tspan> 1.0-Citire Lista | 2.0-Identificare | 3.0-CÄƒutare | 4.0-Procesare | 5.0-Generare ParolÄƒ | 6.0-Criptare | 7.0-Email ParolÄƒ | 8.0-Email Raport | 9.0-Generare Rezumat | 10.0-Email Rezumat</text>
                <text x="800" y="1090" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Stocuri:</tspan> D1-FiÈ™iere Input | D2-Lista Creditori | D3-Rapoarte Procesate | D4-Rezumat Excel</text>
              </svg>
            </div>
            
            <h4>5.3. Tabel de Fluxuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Flux</th>
                  <th>Nume Flux</th>
                  <th>SursÄƒ</th>
                  <th>DestinaÈ›ie</th>
                  <th>ConÈ›inut</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>F1</td>
                  <td>SelecÈ›ie Folder</td>
                  <td>Utilizator ICC</td>
                  <td>Proces 1.0, 3.0</td>
                  <td>SelecÈ›ie folder Master cu Lista derulanta.xlsx È™i rapoarte Excel</td>
                </tr>
                <tr>
                  <td>F2</td>
                  <td>Lista derulanta.xlsx</td>
                  <td>D1 (FiÈ™iere Input)</td>
                  <td>Proces 1.0</td>
                  <td>FiÈ™ier Excel cu lista creditori È™i emailurile lor (TO È™i CC)</td>
                </tr>
                <tr>
                  <td>F3</td>
                  <td>Rapoarte Excel</td>
                  <td>D1 (FiÈ™iere Input)</td>
                  <td>Proces 3.0</td>
                  <td>FiÈ™iere Excel Raportari periodice per creditor</td>
                </tr>
                <tr>
                  <td>F4</td>
                  <td>Date Lista</td>
                  <td>Proces 1.0</td>
                  <td>D2 (Lista Creditori)</td>
                  <td>ListÄƒ de dicÈ›ionare cu creditor, email_to, email_cc</td>
                </tr>
                <tr>
                  <td>F5</td>
                  <td>Creditori</td>
                  <td>D2 (Lista Creditori)</td>
                  <td>Proces 2.0</td>
                  <td>ListÄƒ creditori pentru identificare È™i mapping</td>
                </tr>
                <tr>
                  <td>F6</td>
                  <td>Creditori IdentificaÈ›i</td>
                  <td>Proces 2.0</td>
                  <td>Proces 3.0</td>
                  <td>ListÄƒ creditori cu emailuri identificate (din Excel sau mapping)</td>
                </tr>
                <tr>
                  <td>F7</td>
                  <td>Rapoarte GÄƒsite</td>
                  <td>Proces 3.0</td>
                  <td>Proces 4.0</td>
                  <td>ListÄƒ cÄƒi cÄƒtre fiÈ™iere Excel rapoarte per creditor</td>
                </tr>
                <tr>
                  <td>F8</td>
                  <td>Rapoarte Excel</td>
                  <td>Proces 4.0</td>
                  <td>Proces 5.0, 6.0</td>
                  <td>FiÈ™iere Excel procesate (coloanÄƒ lunÄƒ curentÄƒ adÄƒugatÄƒ, completatÄƒ cu 0)</td>
                </tr>
                <tr>
                  <td>F9</td>
                  <td>ParolÄƒ GeneratÄƒ</td>
                  <td>Proces 5.0</td>
                  <td>Proces 6.0, 7.0, 9.0</td>
                  <td>ParolÄƒ aleatoare generatÄƒ pentru fiecare creditor (12 caractere)</td>
                </tr>
                <tr>
                  <td>F10</td>
                  <td>Raport Criptat</td>
                  <td>Proces 6.0</td>
                  <td>D3 (Rapoarte Procesate)</td>
                  <td>FiÈ™ier Excel criptat cu parolÄƒ folosind msoffcrypto-tool</td>
                </tr>
                <tr>
                  <td>F11</td>
                  <td>Email cu ParolÄƒ</td>
                  <td>Proces 7.0</td>
                  <td>Creditori</td>
                  <td>Email HTML cu font Georgia 11pt conÈ›inÃ¢nd parola pentru raport</td>
                </tr>
                <tr>
                  <td>F12</td>
                  <td>Email cu Raport</td>
                  <td>Proces 8.0</td>
                  <td>Creditori</td>
                  <td>Email HTML cu font Georgia 11pt, corp mesaj, ataÈ™ament Excel parolat</td>
                </tr>
                <tr>
                  <td>F13</td>
                  <td>Rezumat Excel</td>
                  <td>Proces 9.0</td>
                  <td>D4 (Rezumat Excel)</td>
                  <td>FiÈ™ier Excel cu lista creditori, emailuri, È™i parolele generate</td>
                </tr>
                <tr>
                  <td>F14</td>
                  <td>Email Rezumat</td>
                  <td>Proces 10.0</td>
                  <td>ICC</td>
                  <td>Email HTML cu font Georgia 11pt, ataÈ™ament Excel rezumat cu toate parolele</td>
                </tr>
                <tr>
                  <td>F15</td>
                  <td>ComandÄƒ Trimitere</td>
                  <td>Proces 7.0, 8.0, 10.0</td>
                  <td>Outlook</td>
                  <td>ComandÄƒ COM pentru trimitere email prin Outlook local</td>
                </tr>
                <tr>
                  <td>F16</td>
                  <td>Salvare LocalÄƒ</td>
                  <td>D3, D4</td>
                  <td>Folder Output</td>
                  <td>FiÈ™iere Excel salvate Ã®n folderul Rezultate/</td>
                </tr>
              </tbody>
            </table>
            
            <h4>5.4. Tabel de Stocuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Stoc</th>
                  <th>Nume Stoc</th>
                  <th>Descriere</th>
                  <th>StructurÄƒ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>D1</td>
                  <td>FiÈ™iere Input</td>
                  <td>FiÈ™iere Excel din folderul Master/</td>
                  <td>Lista derulanta.xlsx (creditori + emailuri) È™i fiÈ™iere Raportari periodice per creditor</td>
                </tr>
                <tr>
                  <td>D2</td>
                  <td>Lista Creditori</td>
                  <td>ListÄƒ creditori cu emailuri</td>
                  <td>ListÄƒ de dicÈ›ionare Python [{creditor: nume, email_to: email, email_cc: email}]</td>
                </tr>
                <tr>
                  <td>D3</td>
                  <td>Rapoarte Procesate</td>
                  <td>Folder Rezultate/ cu rapoarte Excel parolate</td>
                  <td>FiÈ™iere Excel criptate cu parolÄƒ per creditor (Raportari periodice_[Creditor]_updated.xlsx)</td>
                </tr>
                <tr>
                  <td>D4</td>
                  <td>Rezumat Excel</td>
                  <td>FiÈ™ier Excel cu rezumat creditori È™i parole</td>
                  <td>Rezumat_Incidente_Riscuri_[Luna_An].xlsx cu coloane: Creditor, Email TO, Email CC, ParolÄƒ</td>
                </tr>
              </tbody>
            </table>
            
            <h4>5.5. Descriere DetaliatÄƒ a Proceselor</h4>
            <table>
              <thead>
                <tr>
                  <th>Proces</th>
                  <th>Descriere</th>
                  <th>Input</th>
                  <th>Output</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>1.0 - Citire Lista Derulanta</strong></td>
                  <td>CiteÈ™te fiÈ™ierul Lista derulanta.xlsx È™i extrage lista creditori cu emailurile lor (TO È™i CC)</td>
                  <td>Lista derulanta.xlsx (D1)</td>
                  <td>ListÄƒ creditori salvatÄƒ Ã®n D2</td>
                </tr>
                <tr>
                  <td><strong>2.0 - Identificare Creditori</strong></td>
                  <td>IdentificÄƒ creditorii È™i emailurile lor: verificÄƒ dacÄƒ au emailuri Ã®n Excel, cautÄƒ Ã®n mapping hardcodat, sau foloseÈ™te configuraÈ›ia default</td>
                  <td>ListÄƒ creditori (D2)</td>
                  <td>ListÄƒ creditori cu emailuri identificate</td>
                </tr>
                <tr>
                  <td><strong>3.0 - CÄƒutare Rapoarte</strong></td>
                  <td>Pentru fiecare creditor, cautÄƒ fiÈ™ierul raportului Ã®n folderul Master folosind pattern-uri multiple (nume exact, parÈ›ial, cuvinte cheie)</td>
                  <td>Creditori identificaÈ›i + Rapoarte Excel (D1)</td>
                  <td>ListÄƒ cÄƒi cÄƒtre fiÈ™iere rapoarte per creditor</td>
                </tr>
                <tr>
                  <td><strong>4.0 - Procesare Excel</strong></td>
                  <td>Pentru fiecare raport Excel: identificÄƒ rÃ¢ndul de header, adaugÄƒ coloanÄƒ pentru luna curentÄƒ (format "Mon-YY"), completeazÄƒ toate rÃ¢ndurile cu date cu valoarea 0, aplicÄƒ formatare modernÄƒ (font Georgia 11, borduri, colorare header albastru)</td>
                  <td>FiÈ™iere rapoarte Excel</td>
                  <td>FiÈ™iere Excel procesate cu coloanÄƒ nouÄƒ adÄƒugatÄƒ</td>
                </tr>
                <tr>
                  <td><strong>5.0 - Generare ParolÄƒ</strong></td>
                  <td>GenereazÄƒ parolÄƒ aleatoare unicÄƒ pentru fiecare creditor (12 caractere: litere, cifre, caractere speciale) folosind secrets</td>
                  <td>Creditori identificaÈ›i</td>
                  <td>DicÈ›ionar {creditor: parolÄƒ}</td>
                </tr>
                <tr>
                  <td><strong>6.0 - Criptare Excel</strong></td>
                  <td>CripteazÄƒ fiecare raport Excel procesat cu parola generatÄƒ folosind msoffcrypto-tool, salveazÄƒ Ã®n folderul Rezultate/</td>
                  <td>Rapoarte Excel procesate + Parole</td>
                  <td>FiÈ™iere Excel criptate salvate Ã®n D3</td>
                </tr>
                <tr>
                  <td><strong>7.0 - Trimitere Email ParolÄƒ</strong></td>
                  <td>Trimite email prin Outlook local cÄƒtre fiecare creditor cu parola pentru raport (HTML cu font Georgia 11pt)</td>
                  <td>Parole + Emailuri creditori</td>
                  <td>Email-uri trimise cÄƒtre creditori prin Outlook</td>
                </tr>
                <tr>
                  <td><strong>8.0 - Trimitere Email Raport</strong></td>
                  <td>Trimite email prin Outlook local cÄƒtre fiecare creditor cu raportul Excel parolat ca ataÈ™ament (HTML cu font Georgia 11pt, corp mesaj personalizat)</td>
                  <td>Rapoarte criptate (D3) + Emailuri creditori</td>
                  <td>Email-uri trimise cÄƒtre creditori prin Outlook</td>
                </tr>
                <tr>
                  <td><strong>9.0 - Generare Rezumat</strong></td>
                  <td>GenereazÄƒ fiÈ™ier Excel rezumat cu toÈ›i creditori, emailurile lor (TO È™i CC), È™i parolele generate, formatat cu font Georgia 11</td>
                  <td>ListÄƒ creditori + Parole</td>
                  <td>FiÈ™ier Excel rezumat salvat Ã®n D4</td>
                </tr>
                <tr>
                  <td><strong>10.0 - Trimitere Email Rezumat</strong></td>
                  <td>Trimite email prin Outlook local cÄƒtre ICC cu rezumatul Excel ca ataÈ™ament (HTML cu font Georgia 11pt, conÈ›ine toate parolele)</td>
                  <td>Rezumat Excel (D4)</td>
                  <td>Email trimis cÄƒtre ICC prin Outlook</td>
                </tr>
              </tbody>
            </table>
            
            <h4>5.6. Note Importante</h4>
            <ul>
              <li><strong>Procesare LocalÄƒ:</strong> Toate procesele se desfÄƒÈ™oarÄƒ local pe staÈ›ia de lucru a utilizatorului ICC, fÄƒrÄƒ transmitere cÄƒtre servere externe.</li>
              <li><strong>FÄƒrÄƒ Stocare PersistentÄƒ:</strong> Datele sunt procesate exclusiv Ã®n memorie temporarÄƒ (RAM). FiÈ™ierele intermediare È™i finale sunt salvate doar pentru utilizare ulterioarÄƒ.</li>
              <li><strong>Identificare DinamicÄƒ Creditori:</strong> Creditorii sunt identificaÈ›i din Lista derulanta.xlsx, cu suport pentru creditori noi prin cÄƒutare agresivÄƒ dupÄƒ pattern-uri multiple.</li>
              <li><strong>Mapping Emailuri:</strong> Emailurile sunt identificate din Excel, din mapping hardcodat (BT Microfinantare, BTD CARDURI, BTD CREDITE, SALT BANK), sau din configuraÈ›ia default.</li>
              <li><strong>Procesare per Creditor:</strong> Fiecare creditor primeÈ™te un raport separat, parolÄƒ unicÄƒ, È™i douÄƒ email-uri separate (unul cu parola, altul cu raportul).</li>
              <li><strong>Criptare RealÄƒ:</strong> Rapoartele sunt criptate cu parolÄƒ realÄƒ folosind msoffcrypto-tool, asigurÃ¢nd protecÈ›ie la nivel de fiÈ™ier.</li>
              <li><strong>AdÄƒugare ColoanÄƒ LunÄƒ:</strong> Fiecare raport Excel primeÈ™te o coloanÄƒ nouÄƒ pentru luna curentÄƒ (format "Mon-YY"), completatÄƒ automat cu 0 pentru toate rÃ¢ndurile cu date.</li>
              <li><strong>Rezumat Centralizat:</strong> Un rezumat Excel cu toÈ›i creditori È™i parolele lor este generat È™i trimis cÄƒtre ICC pentru referinÈ›Äƒ centralizatÄƒ.</li>
              <li><strong>Eliminare AutomatÄƒ:</strong> DupÄƒ finalizarea procesÄƒrii È™i trimiterii email-urilor, datele din memorie sunt eliminate automat, aplicaÈ›ia revenind la starea iniÈ›ialÄƒ.</li>
            </ul>
          </div>

          <!-- DFD Raport 6: Productivitate -->
          <div class="dfd-report" id="dfd-report-6">
            <h3>ğŸ“ˆ 6. Raport Productivitate - Fluxuri de Date</h3>
            
            <h4>6.1. DFD Nivel 0 - DiagramÄƒ Context</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1200" height="700" viewBox="0 0 1200 700" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD-Productivitate" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Proces central -->
                <circle cx="600" cy="350" r="90" fill="#fff3e0" stroke="#ff9800" stroke-width="3"/>
                <text x="600" y="330" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Raport</text>
                <text x="600" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Productivitate</text>
                <text x="600" y="380" text-anchor="middle" font-family="Georgia, serif" font-size="14">BT + Cesionate</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="300" width="140" height="70" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="120" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">Utilizator</text>
                <text x="120" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">ICC</text>
                <text x="120" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Selectare fiÈ™iere)</text>
                
                <rect x="1010" y="100" width="140" height="70" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1080" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1080" y="145" text-anchor="middle" font-family="Georgia, serif" font-size="12">Email</text>
                <text x="1080" y="160" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(ICC, Admin)</text>
                
                <rect x="1010" y="530" width="140" height="70" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1080" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Output</text>
                <text x="1080" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Rapoarte Excel)</text>
                
                <rect x="50" y="530" width="140" height="70" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="120" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="120" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Master BT</text>
                <text x="120" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">+ Master Cesionate</text>
                
                <rect x="1010" y="300" width="140" height="70" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1080" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">Local</text>
                <text x="1080" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Trimitere email)</text>
                
                <!-- Fluxuri de date -->
                <path d="M 190 335 L 510 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Productivitate)"/>
                <text x="350" y="330" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">SelecÈ›ie fiÈ™iere</text>
                
                <path d="M 190 565 L 510 410" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Productivitate)"/>
                <text x="300" y="500" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">FiÈ™iere Owner</text>
                <text x="300" y="515" font-family="Georgia, serif" font-size="10" fill="#666">+ Rapoarte Tasks</text>
                
                <path d="M 690 350 L 1010 135" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Productivitate)"/>
                <text x="850" y="220" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email-uri cu rapoarte</text>
                <text x="850" y="235" font-family="Georgia, serif" font-size="10" fill="#666">(HTML + Excel)</text>
                
                <path d="M 690 380 L 1010 565" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Productivitate)"/>
                <text x="850" y="480" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Rapoarte Excel</text>
                <text x="850" y="495" font-family="Georgia, serif" font-size="10" fill="#666">(Salvare localÄƒ)</text>
                
                <path d="M 690 320 L 1010 335" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Productivitate)"/>
                <text x="850" y="315" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email-uri cu ataÈ™amente</text>
                <text x="850" y="330" font-family="Georgia, serif" font-size="10" fill="#666">(Rapoarte Excel)</text>
              </svg>
            </div>
            
            <h4>6.2. DFD Nivel 1 - Flux Detaliat de Procesare</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1600" height="1100" viewBox="0 0 1600 1100" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD1-Productivitate" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Titlu -->
                <text x="800" y="40" text-anchor="middle" font-family="Georgia, serif" font-size="22" font-weight="bold" fill="#22507a">ğŸ“ˆ RAPORT PRODUCTIVITATE - FLUXURI DE DATE DETALIATE</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="80" width="120" height="60" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="110" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Utilizator</text>
                <text x="110" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">ICC</text>
                
                <rect x="1430" y="80" width="120" height="60" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1490" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1490" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <rect x="1430" y="950" width="120" height="60" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="975" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1490" y="995" text-anchor="middle" font-family="Georgia, serif" font-size="11">Output</text>
                
                <rect x="50" y="950" width="120" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="110" y="975" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="110" y="995" text-anchor="middle" font-family="Georgia, serif" font-size="11">Master BT</text>
                
                <rect x="50" y="800" width="120" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="110" y="825" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="110" y="845" text-anchor="middle" font-family="Georgia, serif" font-size="11">Master Cesionate</text>
                
                <rect x="1430" y="500" width="120" height="60" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="525" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1490" y="545" text-anchor="middle" font-family="Georgia, serif" font-size="11">Local</text>
                
                <!-- Procese -->
                <circle cx="200" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">1.0</text>
                <text x="200" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="200" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">BT Owner</text>
                
                <circle cx="400" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">2.0</text>
                <text x="400" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="400" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">BT Tasks</text>
                
                <circle cx="600" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">3.0</text>
                <text x="600" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Mapping</text>
                <text x="600" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Owner-Dept</text>
                
                <circle cx="800" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">4.0</text>
                <text x="800" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Agregare</text>
                <text x="800" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Taskuri</text>
                
                <circle cx="200" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">5.0</text>
                <text x="200" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="200" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Cesionate Owner</text>
                
                <circle cx="400" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">6.0</text>
                <text x="400" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="400" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Cesionate Tasks</text>
                
                <circle cx="600" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">7.0</text>
                <text x="600" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Mapping</text>
                <text x="600" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Cesionate</text>
                
                <circle cx="800" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">8.0</text>
                <text x="800" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Agregare</text>
                <text x="800" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Cesionate</text>
                
                <circle cx="200" cy="700" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="690" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">9.0</text>
                <text x="200" y="705" text-anchor="middle" font-family="Georgia, serif" font-size="11">Determinare</text>
                <text x="200" y="720" text-anchor="middle" font-family="Georgia, serif" font-size="11">LunÄƒ</text>
                
                <circle cx="500" cy="700" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="500" y="690" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">10.0</text>
                <text x="500" y="705" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="500" y="720" text-anchor="middle" font-family="Georgia, serif" font-size="11">Rapoarte Excel</text>
                
                <circle cx="800" cy="700" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="690" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">11.0</text>
                <text x="800" y="705" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="800" y="720" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email HTML</text>
                
                <circle cx="1100" cy="700" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="1100" y="690" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">12.0</text>
                <text x="1100" y="705" text-anchor="middle" font-family="Georgia, serif" font-size="11">Trimitere</text>
                <text x="1100" y="720" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <!-- Stocuri de date -->
                <rect x="50" y="600" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="50" y1="625" x2="250" y2="625" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="150" y="645" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D1</text>
                <text x="150" y="665" text-anchor="middle" font-family="Georgia, serif" font-size="12">FiÈ™iere BT</text>
                <text x="150" y="680" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Owner + Tasks)</text>
                
                <rect x="50" y="750" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="50" y1="775" x2="250" y2="775" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="150" y="795" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D2</text>
                <text x="150" y="815" text-anchor="middle" font-family="Georgia, serif" font-size="12">FiÈ™iere Cesionate</text>
                <text x="150" y="830" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Owner + Tasks)</text>
                
                <rect x="600" y="600" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="600" y1="625" x2="800" y2="625" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="700" y="645" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D3</text>
                <text x="700" y="665" text-anchor="middle" font-family="Georgia, serif" font-size="12">Mapping Owner</text>
                <text x="700" y="680" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Owner â†’ Departament)</text>
                
                <rect x="1150" y="600" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1150" y1="625" x2="1350" y2="625" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1250" y="645" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D4</text>
                <text x="1250" y="665" text-anchor="middle" font-family="Georgia, serif" font-size="12">Rapoarte Finale</text>
                <text x="1250" y="680" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Excel)</text>
                
                <!-- Fluxuri principale -->
                <path d="M 170 110 L 150 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="140" y="170" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">selecÈ›ie fiÈ™iere</text>
                
                <path d="M 150 950 L 150 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="130" y="620" font-family="Georgia, serif" font-size="10" fill="#3576b0">owner.xlsx</text>
                
                <path d="M 150 950 L 400 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="250" y="620" font-family="Georgia, serif" font-size="10" fill="#3576b0">Raport Tasks BT</text>
                
                <path d="M 150 800 L 200 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="160" y="620" font-family="Georgia, serif" font-size="10" fill="#3576b0">owner_cesionat.xlsx</text>
                
                <path d="M 150 800 L 400 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="250" y="620" font-family="Georgia, serif" font-size="10" fill="#3576b0">Raport Tasks Cesionate</text>
                
                <path d="M 250 250 L 350 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="300" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date Owner BT</text>
                
                <path d="M 450 250 L 550 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="500" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date Tasks BT</text>
                
                <path d="M 250 250 L 700 600" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="450" y="420" font-family="Georgia, serif" font-size="10" fill="#3576b0">mapping creat</text>
                
                <path d="M 700 600 L 600 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="650" y="420" font-family="Georgia, serif" font-size="10" fill="#3576b0">mapping</text>
                
                <path d="M 650 250 L 750 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="700" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date cu mapping</text>
                
                <path d="M 850 250 L 750 700" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="800" y="470" font-family="Georgia, serif" font-size="10" fill="#3576b0">date agregate BT</text>
                
                <path d="M 250 450 L 350 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="300" y="440" font-family="Georgia, serif" font-size="10" fill="#3576b0">date Owner Cesionate</text>
                
                <path d="M 450 450 L 550 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="500" y="440" font-family="Georgia, serif" font-size="10" fill="#3576b0">date Tasks Cesionate</text>
                
                <path d="M 650 450 L 750 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="700" y="440" font-family="Georgia, serif" font-size="10" fill="#3576b0">date cu mapping</text>
                
                <path d="M 850 450 L 750 700" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="800" y="570" font-family="Georgia, serif" font-size="10" fill="#3576b0">date agregate Cesionate</text>
                
                <path d="M 250 700 L 450 700" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="350" y="690" font-family="Georgia, serif" font-size="10" fill="#3576b0">lunÄƒ determinatÄƒ</text>
                
                <path d="M 550 700 L 1250 600" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="900" y="650" font-family="Georgia, serif" font-size="10" fill="#3576b0">rapoarte Excel</text>
                
                <path d="M 850 700 L 1050 700" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="950" y="690" font-family="Georgia, serif" font-size="10" fill="#3576b0">email HTML</text>
                
                <path d="M 1150 700 L 1430 110" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="1290" y="380" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">email cu rapoarte</text>
                
                <path d="M 1150 750 L 1430 530" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="1290" y="640" font-family="Georgia, serif" font-size="10" fill="#3576b0">comandÄƒ trimitere</text>
                
                <path d="M 1350 640 L 1490 950" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="1420" y="800" font-family="Georgia, serif" font-size="10" fill="#3576b0">salvare localÄƒ</text>
                
                <!-- Legenda -->
                <rect x="50" y="1050" width="1500" height="40" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="5"/>
                <path d="M 100 1070 L 200 1070" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Productivitate)"/>
                <text x="220" y="1075" font-family="Georgia, serif" font-size="11">Flux de date normal</text>
                <text x="800" y="1075" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Procese:</tspan> 1.0-Citire BT Owner | 2.0-Citire BT Tasks | 3.0-Mapping BT | 4.0-Agregare BT | 5.0-Citire Cesionate Owner | 6.0-Citire Cesionate Tasks | 7.0-Mapping Cesionate | 8.0-Agregare Cesionate | 9.0-Determinare LunÄƒ | 10.0-Generare Rapoarte | 11.0-Generare Email | 12.0-Trimitere</text>
                <text x="800" y="1090" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Stocuri:</tspan> D1-FiÈ™iere BT | D2-FiÈ™iere Cesionate | D3-Mapping Owner | D4-Rapoarte Finale</text>
              </svg>
            </div>
            
            <h4>6.3. Tabel de Fluxuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Flux</th>
                  <th>Nume Flux</th>
                  <th>SursÄƒ</th>
                  <th>DestinaÈ›ie</th>
                  <th>ConÈ›inut</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>F1</td>
                  <td>SelecÈ›ie FiÈ™iere</td>
                  <td>Utilizator ICC</td>
                  <td>Proces 1.0, 2.0, 5.0, 6.0</td>
                  <td>SelecÈ›ie folder Master BT È™i Master Cesionate cu fiÈ™iere Owner È™i Rapoarte Tasks</td>
                </tr>
                <tr>
                  <td>F2</td>
                  <td>Owner.xlsx</td>
                  <td>D1 (FiÈ™iere BT)</td>
                  <td>Proces 1.0</td>
                  <td>FiÈ™ier Excel owner.xlsx cu 2 sheet-uri: Owner (utilizatori) È™i Mapping (Ã®ncadrare task)</td>
                </tr>
                <tr>
                  <td>F3</td>
                  <td>Raport Tasks BT</td>
                  <td>D1 (FiÈ™iere BT)</td>
                  <td>Proces 2.0</td>
                  <td>FiÈ™ier Excel Raport-Productivitate-Tasks_BT.xlsx cu taskuri È™i owneri</td>
                </tr>
                <tr>
                  <td>F4</td>
                  <td>Owner_cesionat.xlsx</td>
                  <td>D2 (FiÈ™iere Cesionate)</td>
                  <td>Proces 5.0</td>
                  <td>FiÈ™ier Excel owner_cesionat.xlsx cu sheet-uri: Owneri È™i Ãncadrare task</td>
                </tr>
                <tr>
                  <td>F5</td>
                  <td>Raport Tasks Cesionate</td>
                  <td>D2 (FiÈ™iere Cesionate)</td>
                  <td>Proces 6.0</td>
                  <td>FiÈ™ier Excel Raport-Productivitate-Tasks-Owner_CESIONATE.xlsx cu taskuri È™i owneri</td>
                </tr>
                <tr>
                  <td>F6</td>
                  <td>Date Owner BT</td>
                  <td>Proces 1.0</td>
                  <td>Proces 3.0</td>
                  <td>DataFrame pandas cu date owneri (utilizatori È™i departamente)</td>
                </tr>
                <tr>
                  <td>F7</td>
                  <td>Date Tasks BT</td>
                  <td>Proces 2.0</td>
                  <td>Proces 3.0</td>
                  <td>DataFrame pandas cu date taskuri BT (owner, taskuri, date)</td>
                </tr>
                <tr>
                  <td>F8</td>
                  <td>Mapping Creat</td>
                  <td>Proces 3.0</td>
                  <td>D3 (Mapping Owner)</td>
                  <td>DicÈ›ionar mapping Ã®ntre Owner È™i Departament (din sheet Mapping)</td>
                </tr>
                <tr>
                  <td>F9</td>
                  <td>Mapping</td>
                  <td>D3 (Mapping Owner)</td>
                  <td>Proces 3.0, 7.0</td>
                  <td>DicÈ›ionar mapping pentru aplicare pe date</td>
                </tr>
                <tr>
                  <td>F10</td>
                  <td>Date cu Mapping</td>
                  <td>Proces 3.0</td>
                  <td>Proces 4.0</td>
                  <td>DataFrame cu taskuri BT È™i departamente asignate</td>
                </tr>
                <tr>
                  <td>F11</td>
                  <td>Date Agregate BT</td>
                  <td>Proces 4.0</td>
                  <td>Proces 9.0</td>
                  <td>DataFrame cu taskuri agregate pe departament È™i utilizator (Executare, Suport Monitorizare, Verificare dosare)</td>
                </tr>
                <tr>
                  <td>F12</td>
                  <td>Date Owner Cesionate</td>
                  <td>Proces 5.0</td>
                  <td>Proces 7.0</td>
                  <td>DataFrame pandas cu date owneri Cesionate</td>
                </tr>
                <tr>
                  <td>F13</td>
                  <td>Date Tasks Cesionate</td>
                  <td>Proces 6.0</td>
                  <td>Proces 7.0</td>
                  <td>DataFrame pandas cu date taskuri Cesionate</td>
                </tr>
                <tr>
                  <td>F14</td>
                  <td>Date cu Mapping Cesionate</td>
                  <td>Proces 7.0</td>
                  <td>Proces 8.0</td>
                  <td>DataFrame cu taskuri Cesionate È™i departamente asignate</td>
                </tr>
                <tr>
                  <td>F15</td>
                  <td>Date Agregate Cesionate</td>
                  <td>Proces 8.0</td>
                  <td>Proces 9.0</td>
                  <td>DataFrame cu taskuri Cesionate agregate pe departament È™i utilizator</td>
                </tr>
                <tr>
                  <td>F16</td>
                  <td>LunÄƒ DeterminatÄƒ</td>
                  <td>Proces 9.0</td>
                  <td>Proces 10.0, 11.0</td>
                  <td>String cu luna È™i anul raportului (ex: "Ianuarie 2025") determinat din DATA_REZOLUTIE sau coloane de datÄƒ</td>
                </tr>
                <tr>
                  <td>F17</td>
                  <td>Rapoarte Excel</td>
                  <td>Proces 10.0</td>
                  <td>D4 (Rapoarte Finale)</td>
                  <td>FiÈ™iere Excel formatate cu font Georgia 11: Productivitate_BT_[Luna_An].xlsx È™i Productivitate_Cesionate_[Luna_An].xlsx</td>
                </tr>
                <tr>
                  <td>F18</td>
                  <td>Email HTML</td>
                  <td>Proces 11.0</td>
                  <td>Proces 12.0</td>
                  <td>Corp email HTML cu font Georgia 11pt, tabele pe departamente, totaluri</td>
                </tr>
                <tr>
                  <td>F19</td>
                  <td>Email cu Rapoarte</td>
                  <td>Proces 12.0</td>
                  <td>Destinatari Email</td>
                  <td>Email HTML cu tabele productivitate, ataÈ™amente Excel (BT È™i Cesionate)</td>
                </tr>
                <tr>
                  <td>F20</td>
                  <td>ComandÄƒ Trimitere</td>
                  <td>Proces 12.0</td>
                  <td>Outlook</td>
                  <td>ComandÄƒ COM pentru trimitere email prin Outlook local</td>
                </tr>
                <tr>
                  <td>F21</td>
                  <td>Salvare LocalÄƒ</td>
                  <td>D4 (Rapoarte Finale)</td>
                  <td>Folder Output</td>
                  <td>FiÈ™iere Excel salvate Ã®n rapoarte_generate/</td>
                </tr>
              </tbody>
            </table>
            
            <h4>6.4. Tabel de Stocuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Stoc</th>
                  <th>Nume Stoc</th>
                  <th>Descriere</th>
                  <th>StructurÄƒ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>D1</td>
                  <td>FiÈ™iere BT</td>
                  <td>FiÈ™iere Excel din folderul Master BT/</td>
                  <td>owner.xlsx (2 sheet-uri: Owner, Mapping) È™i Raport-Productivitate-Tasks_BT.xlsx</td>
                </tr>
                <tr>
                  <td>D2</td>
                  <td>FiÈ™iere Cesionate</td>
                  <td>FiÈ™iere Excel din folderul Master Cesionate/</td>
                  <td>owner_cesionat.xlsx (2 sheet-uri: Owneri, Ãncadrare task) È™i Raport-Productivitate-Tasks-Owner_CESIONATE.xlsx</td>
                </tr>
                <tr>
                  <td>D3</td>
                  <td>Mapping Owner</td>
                  <td>DicÈ›ionar mapping owner â†’ departament</td>
                  <td>DicÈ›ionar Python {owner: departament} creat din sheet-urile Mapping/Ãncadrare task</td>
                </tr>
                <tr>
                  <td>D4</td>
                  <td>Rapoarte Finale</td>
                  <td>Folder rapoarte_generate/ cu rapoarte Excel</td>
                  <td>2 fiÈ™iere Excel: Productivitate_BT_[Luna_An].xlsx È™i Productivitate_Cesionate_[Luna_An].xlsx (formatate cu font Georgia 11)</td>
                </tr>
              </tbody>
            </table>
            
            <h4>6.5. Descriere DetaliatÄƒ a Proceselor</h4>
            <table>
              <thead>
                <tr>
                  <th>Proces</th>
                  <th>Descriere</th>
                  <th>Input</th>
                  <th>Output</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>1.0 - Citire BT Owner</strong></td>
                  <td>CiteÈ™te fiÈ™ierul owner.xlsx, sheet-ul 1 (Owner) cu lista utilizatorilor È™i departamentele lor</td>
                  <td>owner.xlsx (D1)</td>
                  <td>DataFrame pandas cu date owneri BT</td>
                </tr>
                <tr>
                  <td><strong>2.0 - Citire BT Tasks</strong></td>
                  <td>CiteÈ™te fiÈ™ierul Raport-Productivitate-Tasks_BT.xlsx (header=1) cu taskuri È™i owneri</td>
                  <td>Raport-Productivitate-Tasks_BT.xlsx (D1)</td>
                  <td>DataFrame pandas cu date taskuri BT</td>
                </tr>
                <tr>
                  <td><strong>3.0 - Mapping Owner-Dept BT</strong></td>
                  <td>CiteÈ™te sheet-ul 2 (Mapping) din owner.xlsx, creeazÄƒ dicÈ›ionar mapping Ã®ntre Owner È™i Departament, aplicÄƒ mapping pe datele Tasks</td>
                  <td>Date Owner BT + Date Tasks BT + owner.xlsx sheet Mapping</td>
                  <td>DataFrame cu taskuri BT È™i departamente asignate</td>
                </tr>
                <tr>
                  <td><strong>4.0 - Agregare Taskuri BT</strong></td>
                  <td>AgregÄƒ taskurile pe departament È™i utilizator, calculeazÄƒ totaluri pe departament (Executare, Suport Monitorizare, Verificare dosare) È™i total general</td>
                  <td>DataFrame cu mapping aplicat</td>
                  <td>DataFrame cu situaÈ›ie completÄƒ BT (departamente, utilizatori, numÄƒr taskuri, totaluri)</td>
                </tr>
                <tr>
                  <td><strong>5.0 - Citire Cesionate Owner</strong></td>
                  <td>CiteÈ™te fiÈ™ierul owner_cesionat.xlsx, sheet-ul "Owneri" cu lista utilizatorilor</td>
                  <td>owner_cesionat.xlsx (D2)</td>
                  <td>DataFrame pandas cu date owneri Cesionate</td>
                </tr>
                <tr>
                  <td><strong>6.0 - Citire Cesionate Tasks</strong></td>
                  <td>CiteÈ™te fiÈ™ierul Raport-Productivitate-Tasks-Owner_CESIONATE.xlsx cu taskuri È™i owneri</td>
                  <td>Raport-Productivitate-Tasks-Owner_CESIONATE.xlsx (D2)</td>
                  <td>DataFrame pandas cu date taskuri Cesionate</td>
                </tr>
                <tr>
                  <td><strong>7.0 - Mapping Cesionate</strong></td>
                  <td>CiteÈ™te sheet-ul "Ãncadrare task" din owner_cesionat.xlsx, creeazÄƒ dicÈ›ionar mapping Ã®ntre Owner È™i Departament, aplicÄƒ mapping pe datele Tasks Cesionate</td>
                  <td>Date Owner Cesionate + Date Tasks Cesionate + owner_cesionat.xlsx sheet Ãncadrare task</td>
                  <td>DataFrame cu taskuri Cesionate È™i departamente asignate</td>
                </tr>
                <tr>
                  <td><strong>8.0 - Agregare Cesionate</strong></td>
                  <td>AgregÄƒ taskurile Cesionate pe departament È™i utilizator, calculeazÄƒ totaluri pe departament È™i total general</td>
                  <td>DataFrame cu mapping Cesionate aplicat</td>
                  <td>DataFrame cu situaÈ›ie completÄƒ Cesionate (departamente, utilizatori, numÄƒr taskuri, totaluri)</td>
                </tr>
                <tr>
                  <td><strong>9.0 - Determinare LunÄƒ</strong></td>
                  <td>DeterminÄƒ luna raportului din datele procesate: prioritizeazÄƒ coloana DATA_REZOLUTIE, cautÄƒ Ã®n alte coloane de datÄƒ, fallback la luna curentÄƒ</td>
                  <td>Date agregate BT + Cesionate</td>
                  <td>String cu luna È™i anul (ex: "Ianuarie 2025")</td>
                </tr>
                <tr>
                  <td><strong>10.0 - Generare Rapoarte Excel</strong></td>
                  <td>GenereazÄƒ 2 fiÈ™iere Excel formatate cu font Georgia 11: Productivitate_BT_[Luna_An].xlsx È™i Productivitate_Cesionate_[Luna_An].xlsx cu situaÈ›ii complete pe departamente</td>
                  <td>Date agregate BT + Cesionate + LunÄƒ determinatÄƒ</td>
                  <td>2 fiÈ™iere Excel formatate salvate Ã®n D4</td>
                </tr>
                <tr>
                  <td><strong>11.0 - Generare Email HTML</strong></td>
                  <td>GenereazÄƒ corp email HTML cu font Georgia 11pt, tabele HTML pe departamente (Executare, Suport Monitorizare, Verificare dosare) cu numÄƒr taskuri, totaluri pe departament È™i total general</td>
                  <td>Date agregate BT + Cesionate + LunÄƒ determinatÄƒ</td>
                  <td>String HTML formatat pentru email</td>
                </tr>
                <tr>
                  <td><strong>12.0 - Trimitere Email</strong></td>
                  <td>Trimite email prin Outlook local cÄƒtre destinatari (ICC, admin) cu corp HTML, ataÈ™amente Excel (BT È™i Cesionate)</td>
                  <td>Email HTML + Rapoarte Excel (D4)</td>
                  <td>Email trimis cÄƒtre destinatari prin Outlook</td>
                </tr>
              </tbody>
            </table>
            
            <h4>6.6. Note Importante</h4>
            <ul>
              <li><strong>Procesare LocalÄƒ:</strong> Toate procesele se desfÄƒÈ™oarÄƒ local pe staÈ›ia de lucru a utilizatorului ICC, fÄƒrÄƒ transmitere cÄƒtre servere externe.</li>
              <li><strong>FÄƒrÄƒ Stocare PersistentÄƒ:</strong> Datele sunt procesate exclusiv Ã®n memorie temporarÄƒ (RAM). FiÈ™ierele intermediare È™i finale sunt salvate doar pentru utilizare ulterioarÄƒ.</li>
              <li><strong>Procesare DualÄƒ:</strong> Raportul proceseazÄƒ douÄƒ tipuri de date separate: BT Productivitate È™i Cesionate Productivitate, fiecare cu propriile fiÈ™iere Owner È™i Tasks.</li>
              <li><strong>Mapping Dinamic:</strong> Mapping-ul Ã®ntre Owner È™i Departament este creat din sheet-urile Mapping/Ãncadrare task din fiÈ™ierele Owner, permiÈ›Ã¢nd flexibilitate Ã®n organizarea departamentelor.</li>
              <li><strong>Agregare pe Departamente:</strong> Taskurile sunt agregate pe departamente (Executare, Suport Monitorizare, Verificare dosare) È™i utilizatori, cu calculare automatÄƒ de totaluri.</li>
              <li><strong>Determinare AutomatÄƒ LunÄƒ:</strong> Luna raportului este determinatÄƒ automat din datele procesate (prioritizeazÄƒ DATA_REZOLUTIE), asigurÃ¢nd acurateÈ›e temporalÄƒ.</li>
              <li><strong>Email cu Tabele HTML:</strong> Email-ul final conÈ›ine tabele HTML formatate cu font Georgia 11pt, organizate pe departamente, cu evidenÈ›ierea totalurilor.</li>
              <li><strong>Rapoarte Separate:</strong> Se genereazÄƒ rapoarte Excel separate pentru BT È™i Cesionate, permiÈ›Ã¢nd analizÄƒ independentÄƒ a fiecÄƒrui tip de productivitate.</li>
              <li><strong>Eliminare AutomatÄƒ:</strong> DupÄƒ finalizarea procesÄƒrii È™i trimiterii email-urilor, datele din memorie sunt eliminate automat, aplicaÈ›ia revenind la starea iniÈ›ialÄƒ.</li>
            </ul>
          </div>

          <!-- DFD Raport 7: CreanÈ›e Perimate -->
          <div class="dfd-report" id="dfd-report-7">
            <h3>ğŸ“‹ 7. Raport CreanÈ›e Perimate - Fluxuri de Date</h3>
            
            <h4>7.1. DFD Nivel 0 - DiagramÄƒ Context</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1200" height="700" viewBox="0 0 1200 700" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD-Perimate" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Proces central -->
                <circle cx="600" cy="350" r="90" fill="#fff3e0" stroke="#ff9800" stroke-width="3"/>
                <text x="600" y="330" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Raport</text>
                <text x="600" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">CreanÈ›e</text>
                <text x="600" y="380" text-anchor="middle" font-family="Georgia, serif" font-size="14">Perimate</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="300" width="140" height="70" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="120" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">Utilizator</text>
                <text x="120" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">ICC</text>
                <text x="120" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Selectare folder)</text>
                
                <rect x="1010" y="100" width="140" height="70" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1080" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1080" y="145" text-anchor="middle" font-family="Georgia, serif" font-size="12">Email</text>
                <text x="1080" y="160" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Alexandru Cristescu)</text>
                
                <rect x="1010" y="530" width="140" height="70" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1080" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Output</text>
                <text x="1080" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Raport Excel)</text>
                
                <rect x="50" y="530" width="140" height="70" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="120" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="120" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Master</text>
                <text x="120" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(FiÈ™ier Excel)</text>
                
                <rect x="1010" y="300" width="140" height="70" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1080" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">Local</text>
                <text x="1080" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Trimitere email)</text>
                
                <!-- Fluxuri de date -->
                <path d="M 190 335 L 510 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Perimate)"/>
                <text x="350" y="330" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">SelecÈ›ie folder Master</text>
                
                <path d="M 190 565 L 510 410" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Perimate)"/>
                <text x="300" y="500" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">FiÈ™ier Excel Master</text>
                <text x="300" y="515" font-family="Georgia, serif" font-size="10" fill="#666">(3 sheet-uri)</text>
                
                <path d="M 690 350 L 1010 135" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Perimate)"/>
                <text x="850" y="220" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email cu raport</text>
                <text x="850" y="235" font-family="Georgia, serif" font-size="10" fill="#666">(condiÈ›ionat de perimare)</text>
                
                <path d="M 690 380 L 1010 565" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Perimate)"/>
                <text x="850" y="480" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Raport Excel</text>
                <text x="850" y="495" font-family="Georgia, serif" font-size="10" fill="#666">(Salvare localÄƒ)</text>
                
                <path d="M 690 320 L 1010 335" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-Perimate)"/>
                <text x="850" y="315" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email cu ataÈ™ament</text>
                <text x="850" y="330" font-family="Georgia, serif" font-size="10" fill="#666">(dacÄƒ existÄƒ perimare)</text>
              </svg>
            </div>
            
            <h4>7.2. DFD Nivel 1 - Flux Detaliat de Procesare</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1400" height="900" viewBox="0 0 1400 900" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD1-Perimate" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Titlu -->
                <text x="700" y="40" text-anchor="middle" font-family="Georgia, serif" font-size="22" font-weight="bold" fill="#22507a">ğŸ“‹ RAPORT CREANÈšE PERIMATE - FLUXURI DE DATE DETALIATE</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="80" width="120" height="60" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="110" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Utilizator</text>
                <text x="110" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">ICC</text>
                
                <rect x="1230" y="80" width="120" height="60" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1290" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1290" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <rect x="1230" y="750" width="120" height="60" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1290" y="775" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1290" y="795" text-anchor="middle" font-family="Georgia, serif" font-size="11">Output</text>
                
                <rect x="50" y="750" width="120" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="110" y="775" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="110" y="795" text-anchor="middle" font-family="Georgia, serif" font-size="11">Master</text>
                
                <rect x="1230" y="400" width="120" height="60" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1290" y="425" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1290" y="445" text-anchor="middle" font-family="Georgia, serif" font-size="11">Local</text>
                
                <!-- Procese -->
                <circle cx="200" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">1.0</text>
                <text x="200" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="200" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">Sheet-uri</text>
                
                <circle cx="400" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">2.0</text>
                <text x="400" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Concatenare</text>
                <text x="400" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">&amp; Aliniere</text>
                
                <circle cx="600" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">3.0</text>
                <text x="600" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Calculare</text>
                <text x="600" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">LunÄƒ PrecedentÄƒ</text>
                
                <circle cx="800" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">4.0</text>
                <text x="800" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Filtrare</text>
                <text x="800" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">LunÄƒ PrecedentÄƒ</text>
                
                <circle cx="200" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">5.0</text>
                <text x="200" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Identificare</text>
                <text x="200" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Perimare</text>
                
                <circle cx="500" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="500" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">6.0</text>
                <text x="500" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="500" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Raport Excel</text>
                
                <circle cx="800" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">7.0</text>
                <text x="800" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Trimitere</text>
                <text x="800" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <!-- Stocuri de date -->
                <rect x="50" y="600" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="50" y1="625" x2="250" y2="625" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="150" y="645" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D1</text>
                <text x="150" y="665" text-anchor="middle" font-family="Georgia, serif" font-size="12">FiÈ™ier Master</text>
                <text x="150" y="680" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(3 sheet-uri)</text>
                
                <rect x="1150" y="600" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1150" y1="625" x2="1350" y2="625" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1250" y="645" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D2</text>
                <text x="1250" y="665" text-anchor="middle" font-family="Georgia, serif" font-size="12">Raport Final</text>
                <text x="1250" y="680" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Excel)</text>
                
                <!-- Fluxuri principale -->
                <path d="M 170 110 L 150 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Perimate)"/>
                <text x="140" y="170" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">selecÈ›ie folder</text>
                
                <path d="M 150 750 L 150 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Perimate)"/>
                <text x="130" y="520" font-family="Georgia, serif" font-size="10" fill="#3576b0">fiÈ™ier Excel Master</text>
                
                <path d="M 250 250 L 350 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Perimate)"/>
                <text x="300" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date citite</text>
                
                <path d="M 450 250 L 550 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Perimate)"/>
                <text x="500" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">date concatenate</text>
                
                <path d="M 650 250 L 750 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Perimate)"/>
                <text x="700" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">lunÄƒ precedentÄƒ</text>
                
                <path d="M 850 250 L 750 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Perimate)"/>
                <text x="800" y="350" font-family="Georgia, serif" font-size="10" fill="#3576b0">dosare lunÄƒ precedentÄƒ</text>
                
                <path d="M 250 450 L 450 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Perimate)"/>
                <text x="350" y="440" font-family="Georgia, serif" font-size="10" fill="#3576b0">dosare perimate</text>
                
                <path d="M 550 450 L 1250 600" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Perimate)"/>
                <text x="900" y="520" font-family="Georgia, serif" font-size="10" fill="#3576b0">raport Excel</text>
                
                <path d="M 850 450 L 1230 110" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Perimate)"/>
                <text x="1040" y="260" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">email cu raport</text>
                
                <path d="M 850 500 L 1230 430" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Perimate)"/>
                <text x="1040" y="470" font-family="Georgia, serif" font-size="10" fill="#3576b0">comandÄƒ trimitere</text>
                
                <path d="M 1350 640 L 1290 750" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Perimate)"/>
                <text x="1320" y="700" font-family="Georgia, serif" font-size="10" fill="#3576b0">salvare localÄƒ</text>
                
                <!-- Legenda -->
                <rect x="50" y="850" width="1300" height="40" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="5"/>
                <path d="M 100 870 L 200 870" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-Perimate)"/>
                <text x="220" y="875" font-family="Georgia, serif" font-size="11">Flux de date normal</text>
                <text x="700" y="875" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Procese:</tspan> 1.0-Citire | 2.0-Concatenare | 3.0-Calculare LunÄƒ | 4.0-Filtrare | 5.0-Identificare Perimare | 6.0-Generare Raport | 7.0-Trimitere Email</text>
                <text x="700" y="890" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Stocuri:</tspan> D1-FiÈ™ier Master | D2-Raport Final</text>
              </svg>
            </div>
            
            <h4>7.3. Tabel de Fluxuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Flux</th>
                  <th>Nume Flux</th>
                  <th>SursÄƒ</th>
                  <th>DestinaÈ›ie</th>
                  <th>ConÈ›inut</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>F1</td>
                  <td>SelecÈ›ie Folder</td>
                  <td>Utilizator ICC</td>
                  <td>Proces 1.0</td>
                  <td>SelecÈ›ie folder Master cu fiÈ™ier Excel</td>
                </tr>
                <tr>
                  <td>F2</td>
                  <td>FiÈ™ier Excel Master</td>
                  <td>D1 (FiÈ™ier Master)</td>
                  <td>Proces 1.0</td>
                  <td>FiÈ™ier Excel cu 3 sheet-uri (Sheet 1 cu skiprows=1, Sheet 2 È™i Sheet 3 cu skiprows=1 È™i header=None)</td>
                </tr>
                <tr>
                  <td>F3</td>
                  <td>Date Citite</td>
                  <td>Proces 1.0</td>
                  <td>Proces 2.0</td>
                  <td>3 DataFrame-uri pandas cu date din fiecare sheet</td>
                </tr>
                <tr>
                  <td>F4</td>
                  <td>Date Concatenate</td>
                  <td>Proces 2.0</td>
                  <td>Proces 3.0</td>
                  <td>DataFrame unificat cu date concatenate È™i aliniate</td>
                </tr>
                <tr>
                  <td>F5</td>
                  <td>LunÄƒ PrecedentÄƒ</td>
                  <td>Proces 3.0</td>
                  <td>Proces 4.0</td>
                  <td>String cu luna precedentÄƒ (format "MM.YYYY" È™i nume romÃ¢nÄƒ)</td>
                </tr>
                <tr>
                  <td>F6</td>
                  <td>Dosare LunÄƒ PrecedentÄƒ</td>
                  <td>Proces 4.0</td>
                  <td>Proces 5.0</td>
                  <td>DataFrame cu dosare Ã®nchise Ã®n luna precedentÄƒ (filtrare pe DATA_INCHIDERE_DOSAR)</td>
                </tr>
                <tr>
                  <td>F7</td>
                  <td>Dosare Perimate</td>
                  <td>Proces 5.0</td>
                  <td>Proces 6.0</td>
                  <td>DataFrame cu dosare care conÈ›in "perimare" Ã®n STADIU_DOSAR sau REZOLUTIE_INCHIDERE</td>
                </tr>
                <tr>
                  <td>F8</td>
                  <td>Raport Excel</td>
                  <td>Proces 6.0</td>
                  <td>D2 (Raport Final)</td>
                  <td>FiÈ™ier Excel cu 3 sheet-uri: Toate_Dosarele_Luna, Dosare_Perimate, Sumar</td>
                </tr>
                <tr>
                  <td>F9</td>
                  <td>Email cu Raport</td>
                  <td>Proces 7.0</td>
                  <td>Destinatari Email</td>
                  <td>Email HTML cu font Georgia 11pt, conÈ›inut condiÈ›ionat (existÄƒ/nu existÄƒ perimare), ataÈ™ament Excel doar dacÄƒ existÄƒ perimare</td>
                </tr>
                <tr>
                  <td>F10</td>
                  <td>ComandÄƒ Trimitere</td>
                  <td>Proces 7.0</td>
                  <td>Outlook</td>
                  <td>ComandÄƒ COM pentru trimitere email prin Outlook local</td>
                </tr>
                <tr>
                  <td>F11</td>
                  <td>Salvare LocalÄƒ</td>
                  <td>D2 (Raport Final)</td>
                  <td>Folder Output</td>
                  <td>FiÈ™ier Excel salvat Ã®n rapoarte_generate/</td>
                </tr>
              </tbody>
            </table>
            
            <h4>7.4. Tabel de Stocuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Stoc</th>
                  <th>Nume Stoc</th>
                  <th>Descriere</th>
                  <th>StructurÄƒ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>D1</td>
                  <td>FiÈ™ier Master</td>
                  <td>FiÈ™ier Excel Master din folderul Master/</td>
                  <td>Excel cu 3 sheet-uri: Sheet 1 (skiprows=1), Sheet 2 (skiprows=1, header=None), Sheet 3 (skiprows=1, header=None)</td>
                </tr>
                <tr>
                  <td>D2</td>
                  <td>Raport Final</td>
                  <td>FiÈ™ier Excel final cu raport perimate</td>
                  <td>Raport_Perimate_BT_[MM.YYYY]_[timestamp].xlsx cu 3 sheet-uri: Toate_Dosarele_Luna, Dosare_Perimate, Sumar</td>
                </tr>
              </tbody>
            </table>
            
            <h4>7.5. Descriere DetaliatÄƒ a Proceselor</h4>
            <table>
              <thead>
                <tr>
                  <th>Proces</th>
                  <th>Descriere</th>
                  <th>Input</th>
                  <th>Output</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>1.0 - Citire Sheet-uri</strong></td>
                  <td>CiteÈ™te cele 3 sheet-uri din fiÈ™ierul Excel Master (Sheet 1 cu skiprows=1, Sheet 2 È™i Sheet 3 cu skiprows=1 È™i header=None). SelecteazÄƒ automat cel mai recent fiÈ™ier din folder</td>
                  <td>FiÈ™ier Excel Master (D1)</td>
                  <td>3 DataFrame-uri pandas</td>
                </tr>
                <tr>
                  <td><strong>2.0 - Concatenare È™i Aliniere</strong></td>
                  <td>AliniazÄƒ coloanele Sheet 2 È™i Sheet 3 cu Sheet 1, apoi concateneazÄƒ toate datele Ã®ntr-un singur DataFrame. VerificÄƒ existenÈ›a coloanelor necesare (DATA_INCHIDERE_DOSAR, STADIU_DOSAR, REZOLUTIE_INCHIDERE)</td>
                  <td>3 DataFrame-uri</td>
                  <td>DataFrame unificat</td>
                </tr>
                <tr>
                  <td><strong>3.0 - Calculare LunÄƒ PrecedentÄƒ</strong></td>
                  <td>CalculeazÄƒ luna precedentÄƒ faÈ›Äƒ de luna curentÄƒ (format "MM.YYYY" È™i nume romÃ¢nÄƒ, ex: "Ianuarie 2025")</td>
                  <td>Data curentÄƒ</td>
                  <td>String cu luna precedentÄƒ</td>
                </tr>
                <tr>
                  <td><strong>4.0 - Filtrare LunÄƒ PrecedentÄƒ</strong></td>
                  <td>ConverteÈ™te coloana DATA_INCHIDERE_DOSAR la datetime È™i filtreazÄƒ dosarele Ã®nchise Ã®n luna precedentÄƒ (format "MM.YYYY")</td>
                  <td>DataFrame concatenat + LunÄƒ precedentÄƒ</td>
                  <td>DataFrame cu dosare Ã®nchise Ã®n luna precedentÄƒ</td>
                </tr>
                <tr>
                  <td><strong>5.0 - Identificare Perimare</strong></td>
                  <td>CautÄƒ cuvintele cheie "perimare" (case-insensitive) Ã®n coloanele STADIU_DOSAR È™i REZOLUTIE_INCHIDERE pentru a identifica dosarele cu perimare</td>
                  <td>DataFrame cu dosare lunÄƒ precedentÄƒ</td>
                  <td>DataFrame cu dosare perimate (poate fi gol)</td>
                </tr>
                <tr>
                  <td><strong>6.0 - Generare Raport Excel</strong></td>
                  <td>GenereazÄƒ fiÈ™ier Excel cu 3 sheet-uri: Toate_Dosarele_Luna (toate dosarele din luna precedentÄƒ), Dosare_Perimate (doar dosarele cu perimare, dacÄƒ existÄƒ), Sumar (statistici: lunÄƒ analizatÄƒ, numÄƒr total dosare, numÄƒr dosare perimate, data generÄƒrii)</td>
                  <td>Dosare lunÄƒ precedentÄƒ + Dosare perimate</td>
                  <td>FiÈ™ier Excel salvat Ã®n D2</td>
                </tr>
                <tr>
                  <td><strong>7.0 - Trimitere Email</strong></td>
                  <td>Trimite email prin Outlook local cÄƒtre Alexandru Cristescu (CC: rpa@iccollect.ro, juridic@iccollect.ro) cu conÈ›inut condiÈ›ionat: dacÄƒ existÄƒ perimare (subiect "Atentie: Dosare cu rezolutie de perimare", mesaj de alertÄƒ, ataÈ™ament Excel), dacÄƒ nu existÄƒ perimare (subiect "Raport numar dosare perimate", mesaj de confirmare cÄƒ numÄƒrul este 0, fÄƒrÄƒ ataÈ™ament)</td>
                  <td>Raport Excel (D2) + Status perimare</td>
                  <td>Email trimis cÄƒtre destinatari prin Outlook</td>
                </tr>
              </tbody>
            </table>
            
            <h4>7.6. Note Importante</h4>
            <ul>
              <li><strong>Procesare LocalÄƒ:</strong> Toate procesele se desfÄƒÈ™oarÄƒ local pe staÈ›ia de lucru a utilizatorului ICC, fÄƒrÄƒ transmitere cÄƒtre servere externe.</li>
              <li><strong>FÄƒrÄƒ Stocare PersistentÄƒ:</strong> Datele sunt procesate exclusiv Ã®n memorie temporarÄƒ (RAM). FiÈ™ierul final este salvat doar pentru utilizare ulterioarÄƒ.</li>
              <li><strong>Selectare AutomatÄƒ FiÈ™ier:</strong> Raportul selecteazÄƒ automat cel mai recent fiÈ™ier Excel din folderul Master, permiÈ›Ã¢nd procesare automatÄƒ fÄƒrÄƒ intervenÈ›ie manualÄƒ.</li>
              <li><strong>AnalizÄƒ LunÄƒ PrecedentÄƒ:</strong> Raportul analizeazÄƒ automat dosarele Ã®nchise Ã®n luna precedentÄƒ faÈ›Äƒ de luna curentÄƒ, asigurÃ¢nd raportare la timp.</li>
              <li><strong>CÄƒutare Perimare:</strong> Identificarea perimÄƒrii se face prin cÄƒutare case-insensitive a cuvÃ¢ntului "perimare" Ã®n coloanele STADIU_DOSAR È™i REZOLUTIE_INCHIDERE.</li>
              <li><strong>Email CondiÈ›ionat:</strong> Email-ul este trimis cu conÈ›inut diferit Ã®n funcÈ›ie de existenÈ›a cazurilor de perimare: alertÄƒ cu ataÈ™ament dacÄƒ existÄƒ, confirmare fÄƒrÄƒ ataÈ™ament dacÄƒ nu existÄƒ.</li>
              <li><strong>Raport Multi-Sheet:</strong> Raportul Excel conÈ›ine 3 sheet-uri pentru analizÄƒ completÄƒ: toate dosarele, dosarele perimate (dacÄƒ existÄƒ), È™i sumar cu statistici.</li>
              <li><strong>Eliminare AutomatÄƒ:</strong> DupÄƒ finalizarea procesÄƒrii È™i trimiterii email-ului, datele din memorie sunt eliminate automat, aplicaÈ›ia revenind la starea iniÈ›ialÄƒ.</li>
            </ul>
          </div>

          <!-- DFD Raport 8: Portal Just -->
          <div class="dfd-report" id="dfd-report-8">
            <h3>âš–ï¸ 8. Raport Portal Just - Fluxuri de Date</h3>
            
            <h4>8.1. DFD Nivel 0 - DiagramÄƒ Context</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1200" height="700" viewBox="0 0 1200 700" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD-PortalJust" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Proces central -->
                <circle cx="600" cy="350" r="90" fill="#fff3e0" stroke="#ff9800" stroke-width="3"/>
                <text x="600" y="330" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Raport</text>
                <text x="600" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Portal Just</text>
                <text x="600" y="380" text-anchor="middle" font-family="Georgia, serif" font-size="14">Actualizare Dosare</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="300" width="140" height="70" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="120" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">Utilizator</text>
                <text x="120" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">ICC</text>
                <text x="120" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Selectare fiÈ™ier)</text>
                
                <rect x="1010" y="100" width="140" height="70" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1080" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1080" y="145" text-anchor="middle" font-family="Georgia, serif" font-size="12">Email</text>
                <text x="1080" y="160" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(BRLI + Juridic)</text>
                
                <rect x="1010" y="530" width="140" height="70" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1080" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Output</text>
                <text x="1080" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Rapoarte Excel + HTML)</text>
                
                <rect x="50" y="530" width="140" height="70" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="120" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="120" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Master</text>
                <text x="120" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Litigii.xlsx)</text>
                
                <rect x="1010" y="300" width="140" height="70" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1080" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">Local</text>
                <text x="1080" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Trimitere email)</text>
                
                <rect x="50" y="100" width="140" height="70" fill="#fff9c4" stroke="#fbc02d" stroke-width="2" rx="5"/>
                <text x="120" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">API</text>
                <text x="120" y="145" text-anchor="middle" font-family="Georgia, serif" font-size="12">portal.just.ro</text>
                <text x="120" y="160" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(SOAP)</text>
                
                <!-- Fluxuri de date -->
                <path d="M 190 335 L 510 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-PortalJust)"/>
                <text x="350" y="330" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">SelecÈ›ie fiÈ™ier Master</text>
                
                <path d="M 190 565 L 510 410" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-PortalJust)"/>
                <text x="300" y="500" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">FiÈ™ier Litigii.xlsx</text>
                <text x="300" y="515" font-family="Georgia, serif" font-size="10" fill="#666">(Dosare)</text>
                
                <path d="M 190 135 L 510 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-PortalJust)"/>
                <text x="300" y="200" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Cereri API</text>
                <text x="300" y="215" font-family="Georgia, serif" font-size="10" fill="#666">(NumÄƒr dosar)</text>
                
                <path d="M 510 290 L 190 135" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-PortalJust)"/>
                <text x="300" y="180" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">RÄƒspuns API</text>
                <text x="300" y="195" font-family="Georgia, serif" font-size="10" fill="#666">(Date dosare)</text>
                
                <path d="M 690 350 L 1010 135" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-PortalJust)"/>
                <text x="850" y="220" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email-uri cu rapoarte</text>
                <text x="850" y="235" font-family="Georgia, serif" font-size="10" fill="#666">(Excel + HTML)</text>
                
                <path d="M 690 380 L 1010 565" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-PortalJust)"/>
                <text x="850" y="480" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Rapoarte Excel + HTML</text>
                <text x="850" y="495" font-family="Georgia, serif" font-size="10" fill="#666">(Salvare localÄƒ)</text>
                
                <path d="M 690 320 L 1010 335" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-PortalJust)"/>
                <text x="850" y="315" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email-uri cu ataÈ™amente</text>
                <text x="850" y="330" font-family="Georgia, serif" font-size="10" fill="#666">(Excel + HTML)</text>
              </svg>
            </div>
            
            <h4>8.2. DFD Nivel 1 - Flux Detaliat de Procesare</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1600" height="1200" viewBox="0 0 1600 1200" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD1-PortalJust" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Titlu -->
                <text x="800" y="40" text-anchor="middle" font-family="Georgia, serif" font-size="22" font-weight="bold" fill="#22507a">âš–ï¸ RAPORT PORTAL JUST - FLUXURI DE DATE DETALIATE</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="80" width="120" height="60" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="110" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Utilizator</text>
                <text x="110" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">ICC</text>
                
                <rect x="1430" y="80" width="120" height="60" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1490" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1490" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <rect x="1430" y="1050" width="120" height="60" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="1075" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1490" y="1095" text-anchor="middle" font-family="Georgia, serif" font-size="11">Output</text>
                
                <rect x="50" y="1050" width="120" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="110" y="1075" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="110" y="1095" text-anchor="middle" font-family="Georgia, serif" font-size="11">Master</text>
                
                <rect x="50" y="200" width="120" height="60" fill="#fff9c4" stroke="#fbc02d" stroke-width="2" rx="5"/>
                <text x="110" y="225" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">API</text>
                <text x="110" y="245" text-anchor="middle" font-family="Georgia, serif" font-size="11">portal.just.ro</text>
                
                <rect x="1430" y="500" width="120" height="60" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="525" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1490" y="545" text-anchor="middle" font-family="Georgia, serif" font-size="11">Local</text>
                
                <!-- Procese -->
                <circle cx="200" cy="350" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="340" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">1.0</text>
                <text x="200" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="200" y="370" text-anchor="middle" font-family="Georgia, serif" font-size="11">Excel Master</text>
                
                <circle cx="400" cy="350" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="340" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">2.0</text>
                <text x="400" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="11">Extragere</text>
                <text x="400" y="370" text-anchor="middle" font-family="Georgia, serif" font-size="11">NumÄƒr Dosar</text>
                
                <circle cx="200" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">3.0</text>
                <text x="200" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Apel</text>
                <text x="200" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">API SOAP</text>
                
                <circle cx="400" cy="250" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">4.0</text>
                <text x="400" y="255" text-anchor="middle" font-family="Georgia, serif" font-size="11">Procesare</text>
                <text x="400" y="270" text-anchor="middle" font-family="Georgia, serif" font-size="11">RÄƒspuns API</text>
                
                <circle cx="600" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">5.0</text>
                <text x="600" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Normalizare</text>
                <text x="600" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">InstanÈ›e</text>
                
                <circle cx="800" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">6.0</text>
                <text x="800" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">AdÄƒugare</text>
                <text x="800" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">Coloane Auxiliare</text>
                
                <circle cx="200" cy="550" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="540" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">7.0</text>
                <text x="200" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="11">Filtrare</text>
                <text x="200" y="570" text-anchor="middle" font-family="Georgia, serif" font-size="11">pe BRLI</text>
                
                <circle cx="500" cy="550" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="500" y="540" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">8.0</text>
                <text x="500" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="500" y="570" text-anchor="middle" font-family="Georgia, serif" font-size="11">Excel BRLI</text>
                
                <circle cx="800" cy="550" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="540" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">9.0</text>
                <text x="800" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="800" y="570" text-anchor="middle" font-family="Georgia, serif" font-size="11">HTML Sumar</text>
                
                <circle cx="1100" cy="550" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="1100" y="540" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">10.0</text>
                <text x="1100" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="11">Trimitere</text>
                <text x="1100" y="570" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <!-- Stocuri de date -->
                <rect x="50" y="700" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="50" y1="725" x2="250" y2="725" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="150" y="745" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D1</text>
                <text x="150" y="765" text-anchor="middle" font-family="Georgia, serif" font-size="12">FiÈ™ier Master</text>
                <text x="150" y="780" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Litigii.xlsx)</text>
                
                <rect x="600" y="700" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="600" y1="725" x2="800" y2="725" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="700" y="745" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D2</text>
                <text x="700" y="765" text-anchor="middle" font-family="Georgia, serif" font-size="12">Date Actualizate</text>
                <text x="700" y="780" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(DataFrame)</text>
                
                <rect x="1150" y="700" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1150" y1="725" x2="1350" y2="725" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1250" y="745" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D3</text>
                <text x="1250" y="765" text-anchor="middle" font-family="Georgia, serif" font-size="12">Rapoarte Finale</text>
                <text x="1250" y="780" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Excel + HTML)</text>
                
                <!-- Fluxuri principale -->
                <path d="M 170 110 L 150 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="140" y="220" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">selecÈ›ie fiÈ™ier</text>
                
                <path d="M 150 1050 L 150 400" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="130" y="720" font-family="Georgia, serif" font-size="10" fill="#3576b0">Litigii.xlsx</text>
                
                <path d="M 250 350 L 350 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="300" y="340" font-family="Georgia, serif" font-size="10" fill="#3576b0">date dosare</text>
                
                <path d="M 450 350 L 350 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="400" y="300" font-family="Georgia, serif" font-size="10" fill="#3576b0">numÄƒr dosar</text>
                
                <path d="M 250 250 L 150 230" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="180" y="230" font-family="Georgia, serif" font-size="10" fill="#3576b0">cerere API</text>
                
                <path d="M 150 230 L 350 250" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="240" y="240" font-family="Georgia, serif" font-size="10" fill="#3576b0">rÄƒspuns API</text>
                
                <path d="M 450 250 L 550 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="500" y="270" font-family="Georgia, serif" font-size="10" fill="#3576b0">date dosar</text>
                
                <path d="M 650 300 L 700 700" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="675" y="500" font-family="Georgia, serif" font-size="10" fill="#3576b0">date actualizate</text>
                
                <path d="M 700 700 L 650 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="675" y="500" font-family="Georgia, serif" font-size="10" fill="#3576b0">date pentru normalizare</text>
                
                <path d="M 850 300 L 750 550" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="800" y="420" font-family="Georgia, serif" font-size="10" fill="#3576b0">date normalizate</text>
                
                <path d="M 250 550 L 450 550" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="350" y="540" font-family="Georgia, serif" font-size="10" fill="#3576b0">date filtrate BRLI</text>
                
                <path d="M 550 550 L 1250 700" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="900" y="620" font-family="Georgia, serif" font-size="10" fill="#3576b0">Excel BRLI</text>
                
                <path d="M 850 550 L 1250 700" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="1050" y="620" font-family="Georgia, serif" font-size="10" fill="#3576b0">HTML sumar</text>
                
                <path d="M 1150 550 L 1430 110" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="1290" y="320" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">email cu rapoarte</text>
                
                <path d="M 1150 600 L 1430 530" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="1290" y="570" font-family="Georgia, serif" font-size="10" fill="#3576b0">comandÄƒ trimitere</text>
                
                <path d="M 1350 740 L 1490 1050" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="1420" y="900" font-family="Georgia, serif" font-size="10" fill="#3576b0">salvare localÄƒ</text>
                
                <!-- Legenda -->
                <rect x="50" y="1150" width="1500" height="40" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="5"/>
                <path d="M 100 1170 L 200 1170" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PortalJust)"/>
                <text x="220" y="1175" font-family="Georgia, serif" font-size="11">Flux de date normal</text>
                <text x="800" y="1175" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Procese:</tspan> 1.0-Citire | 2.0-Extragere | 3.0-Apel API | 4.0-Procesare | 5.0-Normalizare | 6.0-AdÄƒugare Coloane | 7.0-Filtrare | 8.0-Generare Excel | 9.0-Generare HTML | 10.0-Trimitere</text>
                <text x="800" y="1190" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Stocuri:</tspan> D1-FiÈ™ier Master | D2-Date Actualizate | D3-Rapoarte Finale</text>
              </svg>
            </div>
            
            <h4>8.3. Tabel de Fluxuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Flux</th>
                  <th>Nume Flux</th>
                  <th>SursÄƒ</th>
                  <th>DestinaÈ›ie</th>
                  <th>ConÈ›inut</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>F1</td>
                  <td>SelecÈ›ie FiÈ™ier Master</td>
                  <td>Utilizator ICC</td>
                  <td>Proces 1.0</td>
                  <td>SelecÈ›ie fiÈ™ier Litigii.xlsx din folderul Master/</td>
                </tr>
                <tr>
                  <td>F2</td>
                  <td>FiÈ™ier Litigii.xlsx</td>
                  <td>D1 (FiÈ™ier Master)</td>
                  <td>Proces 1.0</td>
                  <td>FiÈ™ier Excel cu dosare judiciare (coloana "Dosar instanta" sau "Dosar")</td>
                </tr>
                <tr>
                  <td>F3</td>
                  <td>Date Dosare</td>
                  <td>Proces 1.0</td>
                  <td>Proces 2.0</td>
                  <td>DataFrame pandas cu date dosare din Excel</td>
                </tr>
                <tr>
                  <td>F4</td>
                  <td>NumÄƒr Dosar</td>
                  <td>Proces 2.0</td>
                  <td>Proces 3.0</td>
                  <td>String cu numÄƒrul dosarului (format: "1234/2024/ABC")</td>
                </tr>
                <tr>
                  <td>F5</td>
                  <td>Cerere API</td>
                  <td>Proces 3.0</td>
                  <td>API portal.just.ro</td>
                  <td>Cerere SOAP CautareDosare cu numarDosar</td>
                </tr>
                <tr>
                  <td>F6</td>
                  <td>RÄƒspuns API</td>
                  <td>API portal.just.ro</td>
                  <td>Proces 4.0</td>
                  <td>RÄƒspuns SOAP cu informaÈ›ii dosar: Instanta, Obiect dosar, Data initierii, Termen, Solutie, Complet, Camera, Tip sedinta, Parti, Statistici</td>
                </tr>
                <tr>
                  <td>F7</td>
                  <td>Date Dosar</td>
                  <td>Proces 4.0</td>
                  <td>D2 (Date Actualizate)</td>
                  <td>DicÈ›ionar cu informaÈ›ii dosar actualizate</td>
                </tr>
                <tr>
                  <td>F8</td>
                  <td>Date Actualizate</td>
                  <td>D2 (Date Actualizate)</td>
                  <td>Proces 5.0</td>
                  <td>DataFrame pandas cu date dosare actualizate prin API</td>
                </tr>
                <tr>
                  <td>F9</td>
                  <td>Date Normalizate</td>
                  <td>Proces 5.0</td>
                  <td>Proces 6.0</td>
                  <td>DataFrame cu coloana "Instanta" normalizatÄƒ (248 corecÈ›ii manuale)</td>
                </tr>
                <tr>
                  <td>F10</td>
                  <td>Date cu Coloane Auxiliare</td>
                  <td>Proces 6.0</td>
                  <td>Proces 7.0</td>
                  <td>DataFrame cu coloane adÄƒugate: Stadiu, BRLI, Rezolutie solutie</td>
                </tr>
                <tr>
                  <td>F11</td>
                  <td>Date Filtrate BRLI</td>
                  <td>Proces 7.0</td>
                  <td>Proces 8.0</td>
                  <td>DataFrame filtrat pe un anumit BRLI</td>
                </tr>
                <tr>
                  <td>F12</td>
                  <td>Excel BRLI</td>
                  <td>Proces 8.0</td>
                  <td>D3 (Rapoarte Finale)</td>
                  <td>FiÈ™ier Excel formatat ca tabel pentru un anumit BRLI (Litigii_actualizat_api_[BRLI].xlsx)</td>
                </tr>
                <tr>
                  <td>F13</td>
                  <td>HTML Sumar</td>
                  <td>Proces 9.0</td>
                  <td>D3 (Rapoarte Finale)</td>
                  <td>FiÈ™ier HTML interactiv cu grafice È™i statistici (Sumar Executiv â€“ Analiza Litigii NaÈ›ionale.html)</td>
                </tr>
                <tr>
                  <td>F14</td>
                  <td>Email cu Rapoarte</td>
                  <td>Proces 10.0</td>
                  <td>Destinatari Email</td>
                  <td>Email HTML cu font Georgia 11pt, tabel detaliat fiÈ™iere, ataÈ™amente Excel È™i HTML</td>
                </tr>
                <tr>
                  <td>F15</td>
                  <td>ComandÄƒ Trimitere</td>
                  <td>Proces 10.0</td>
                  <td>Outlook</td>
                  <td>ComandÄƒ COM pentru trimitere email prin Outlook local</td>
                </tr>
                <tr>
                  <td>F16</td>
                  <td>Salvare LocalÄƒ</td>
                  <td>D3 (Rapoarte Finale)</td>
                  <td>Folder Output</td>
                  <td>FiÈ™iere Excel È™i HTML salvate Ã®n Rezultate/</td>
                </tr>
              </tbody>
            </table>
            
            <h4>8.4. Tabel de Stocuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Stoc</th>
                  <th>Nume Stoc</th>
                  <th>Descriere</th>
                  <th>StructurÄƒ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>D1</td>
                  <td>FiÈ™ier Master</td>
                  <td>FiÈ™ier Excel Master cu dosare judiciare</td>
                  <td>Litigii.xlsx cu coloana "Dosar instanta" sau "Dosar" (format: "1234/2024/ABC")</td>
                </tr>
                <tr>
                  <td>D2</td>
                  <td>Date Actualizate</td>
                  <td>DataFrame pandas cu date dosare actualizate prin API</td>
                  <td>DataFrame cu coloane: Instanta, Obiect dosar, Data initierii litigiului, Termen, Solutie, Complet, Camera, Tip sedinta, Tert poprit, Reclamant, Parat, Toate partile, Numar sedinte, Ultima modificare</td>
                </tr>
                <tr>
                  <td>D3</td>
                  <td>Rapoarte Finale</td>
                  <td>Folder Rezultate/ cu rapoarte Excel È™i HTML</td>
                  <td>FiÈ™iere Excel per BRLI (Litigii_actualizat_api_[BRLI].xlsx), fiÈ™ier Excel general (Litigii_actualizat_api.xlsx), fiÈ™ier HTML sumar (Sumar Executiv â€“ Analiza Litigii NaÈ›ionale.html), fiÈ™ier JSON (litigii_data.json)</td>
                </tr>
              </tbody>
            </table>
            
            <h4>8.5. Descriere DetaliatÄƒ a Proceselor</h4>
            <table>
              <thead>
                <tr>
                  <th>Proces</th>
                  <th>Descriere</th>
                  <th>Input</th>
                  <th>Output</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>1.0 - Citire Excel Master</strong></td>
                  <td>CiteÈ™te fiÈ™ierul Litigii.xlsx din folderul Master/, identificÄƒ coloana cu numÄƒrul dosarului ("Dosar instanta", "Dosar", "NumÄƒr Dosar", "Dosar instanÈ›Äƒ")</td>
                  <td>Litigii.xlsx (D1)</td>
                  <td>DataFrame pandas cu date dosare</td>
                </tr>
                <tr>
                  <td><strong>2.0 - Extragere NumÄƒr Dosar</strong></td>
                  <td>Extrage numÄƒrul dosarului din fiecare rÃ¢nd, valideazÄƒ formatul (trebuie sÄƒ conÈ›inÄƒ "/" È™i cel puÈ›in 3 componente), ignorÄƒ dosarele cu format invalid</td>
                  <td>DataFrame cu date dosare</td>
                  <td>String cu numÄƒrul dosarului validat</td>
                </tr>
                <tr>
                  <td><strong>3.0 - Apel API SOAP</strong></td>
                  <td>IniÈ›ializeazÄƒ client SOAP pentru API-ul portal.just.ro (WSDL: http://portalquery.just.ro/Query.asmx?WSDL), apeleazÄƒ metoda CautareDosare cu numarDosar, gestioneazÄƒ erorile API È™i timeout-uri</td>
                  <td>NumÄƒr dosar</td>
                  <td>RÄƒspuns SOAP cu lista dosare</td>
                </tr>
                <tr>
                  <td><strong>4.0 - Procesare RÄƒspuns API</strong></td>
                  <td>ProceseazÄƒ rÄƒspunsul SOAP: selecteazÄƒ cel mai nou dosar (sortare descrescÄƒtoare dupÄƒ data), extrage informaÈ›ii complete: Instanta, Obiect dosar, Data initierii litigiului, Categorie dosar, Termen (ultima È™edinÈ›Äƒ), Solutie (ultima soluÈ›ie), Complet, Camera, Tip sedinta, Parti (Tert poprit, Reclamant, Parat, Toate partile), Statistici (Numar sedinte, Ultima modificare)</td>
                  <td>RÄƒspuns SOAP</td>
                  <td>DicÈ›ionar cu informaÈ›ii dosar actualizate</td>
                </tr>
                <tr>
                  <td><strong>5.0 - Normalizare InstanÈ›e</strong></td>
                  <td>AplicÄƒ normalizarea instanÈ›elor folosind instanta_normalizer (248 corecÈ›ii manuale), creeazÄƒ coloana "Instanta RO" cu instanÈ›e normalizate, È™terge coloana "Instanta" originalÄƒ, redenumeÈ™te "Instanta RO" Ã®n "Instanta"</td>
                  <td>DataFrame cu date actualizate</td>
                  <td>DataFrame cu coloana "Instanta" normalizatÄƒ</td>
                </tr>
                <tr>
                  <td><strong>6.0 - AdÄƒugare Coloane Auxiliare</strong></td>
                  <td>AdaugÄƒ coloane auxiliare folosind normalizatorul: Stadiu (determinare din Instanta: Fond, Apel, Recurs), BRLI (determinare din Instanta: numele BRLI-ului responsabil), Rezolutie solutie (determinare din Solutie: Respinge, Admite, etc.)</td>
                  <td>DataFrame cu instanÈ›e normalizate</td>
                  <td>DataFrame cu coloane auxiliare adÄƒugate</td>
                </tr>
                <tr>
                  <td><strong>7.0 - Filtrare pe BRLI</strong></td>
                  <td>FiltreazÄƒ datele pentru fiecare BRLI unic din DataFrame, creeazÄƒ DataFrame separat pentru fiecare BRLI</td>
                  <td>DataFrame cu coloane auxiliare</td>
                  <td>DataFrame filtrat pe un anumit BRLI</td>
                </tr>
                <tr>
                  <td><strong>8.0 - Generare Excel BRLI</strong></td>
                  <td>GenereazÄƒ fiÈ™ier Excel formatat ca tabel pentru fiecare BRLI: salveazÄƒ DataFrame-ul filtrat, formateazÄƒ ca tabel Excel cu stiluri, filtre È™i sortare, nume fiÈ™ier: Litigii_actualizat_api_[BRLI].xlsx</td>
                  <td>DataFrame filtrat pe BRLI</td>
                  <td>FiÈ™ier Excel formatat salvat Ã®n D3</td>
                </tr>
                <tr>
                  <td><strong>9.0 - Generare HTML Sumar</strong></td>
                  <td>GenereazÄƒ fiÈ™ier HTML interactiv cu grafice È™i statistici: analizeazÄƒ datele (analyze_data), genereazÄƒ HTML cu template premium È™i date hardcodate (generate_html_with_data), salveazÄƒ ca "Sumar Executiv â€“ Analiza Litigii NaÈ›ionale.html", salveazÄƒ È™i JSON pentru referinÈ›Äƒ (litigii_data.json)</td>
                  <td>DataFrame complet (toate datele)</td>
                  <td>FiÈ™ier HTML interactiv salvat Ã®n D3</td>
                </tr>
                <tr>
                  <td><strong>10.0 - Trimitere Email</strong></td>
                  <td>Trimite email prin Outlook local cÄƒtre fiecare BRLI È™i cÄƒtre juridic ICC: pentru fiecare BRLI: email cu Excel filtrat È™i HTML sumar, email general cÄƒtre juridic: Excel complet È™i HTML sumar, corp email HTML cu font Georgia 11pt, tabel detaliat fiÈ™iere anexate, semnÄƒturÄƒ text automatÄƒ</td>
                  <td>Rapoarte Excel + HTML (D3)</td>
                  <td>Email-uri trimise cÄƒtre destinatari prin Outlook</td>
                </tr>
              </tbody>
            </table>
            
            <h4>8.6. Note Importante</h4>
            <ul>
              <li><strong>Procesare LocalÄƒ:</strong> Toate procesele se desfÄƒÈ™oarÄƒ local pe staÈ›ia de lucru a utilizatorului ICC, fÄƒrÄƒ transmitere cÄƒtre servere externe (exceptÃ¢nd API-ul portal.just.ro).</li>
              <li><strong>FÄƒrÄƒ Stocare PersistentÄƒ:</strong> Datele sunt procesate exclusiv Ã®n memorie temporarÄƒ (RAM). FiÈ™ierele intermediare È™i finale sunt salvate doar pentru utilizare ulterioarÄƒ.</li>
              <li><strong>Integrare API SOAP:</strong> Raportul foloseÈ™te API-ul SOAP oficial al portal.just.ro pentru extragerea datelor, asigurÃ¢nd acurateÈ›e È™i actualitate.</li>
              <li><strong>Normalizare InstanÈ›e:</strong> Normalizarea instanÈ›elor foloseÈ™te 248 corecÈ›ii manuale implementate, asigurÃ¢nd consistenÈ›Äƒ Ã®n denumiri.</li>
              <li><strong>Coloane Auxiliare:</strong> Raportul adaugÄƒ automat coloane auxiliare (Stadiu, BRLI, Rezolutie solutie) pentru analizÄƒ È™i filtrare uÈ™oarÄƒ.</li>
              <li><strong>Rapoarte Separate per BRLI:</strong> Se genereazÄƒ rapoarte Excel separate pentru fiecare BRLI, permiÈ›Ã¢nd analizÄƒ independentÄƒ È™i trimitere personalizatÄƒ.</li>
              <li><strong>HTML Interactiv:</strong> HTML-ul sumar conÈ›ine grafice interactive, statistici detaliate È™i tabele cu filtrare, oferind o prezentare executivÄƒ completÄƒ.</li>
              <li><strong>Email-uri Personalizate:</strong> Email-urile sunt personalizate pentru fiecare BRLI cu datele relevante, iar email-ul general cÄƒtre juridic ICC conÈ›ine toate datele.</li>
              <li><strong>Suport Suspend/Resume:</strong> Raportul suportÄƒ suspendarea È™i reluarea procesÄƒrii prin checkpoint-uri, permiÈ›Ã¢nd procesarea dosarelor mari Ã®n etape.</li>
              <li><strong>Eliminare AutomatÄƒ:</strong> DupÄƒ finalizarea procesÄƒrii È™i trimiterii email-urilor, datele din memorie sunt eliminate automat, aplicaÈ›ia revenind la starea iniÈ›ialÄƒ.</li>
            </ul>
          </div>

          <!-- DFD Raport 9: SIUI -->
          <div class="dfd-report" id="dfd-report-9">
            <h3>ğŸ†” 9. Raport SIUI - Fluxuri de Date</h3>
            
            <h4>9.1. DFD Nivel 0 - DiagramÄƒ Context</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1200" height="700" viewBox="0 0 1200 700" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD-SIUI" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Proces central -->
                <circle cx="600" cy="350" r="90" fill="#fff3e0" stroke="#ff9800" stroke-width="3"/>
                <text x="600" y="330" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Raport</text>
                <text x="600" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">SIUI</text>
                <text x="600" y="380" text-anchor="middle" font-family="Georgia, serif" font-size="14">Interogare CNP</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="300" width="140" height="70" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="120" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">Utilizator</text>
                <text x="120" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">ICC</text>
                <text x="120" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Selectare fiÈ™ier)</text>
                
                <rect x="1010" y="530" width="140" height="70" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1080" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Output</text>
                <text x="1080" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Raport Excel)</text>
                
                <rect x="50" y="530" width="140" height="70" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="120" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="120" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Master</text>
                <text x="120" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(FiÈ™ier Excel)</text>
                
                <rect x="50" y="100" width="140" height="70" fill="#fff9c4" stroke="#fbc02d" stroke-width="2" rx="5"/>
                <text x="120" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Site Web</text>
                <text x="120" y="145" text-anchor="middle" font-family="Georgia, serif" font-size="12">CASAN</text>
                <text x="120" y="160" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(siui.casan.ro)</text>
                
                <!-- Fluxuri de date -->
                <path d="M 190 335 L 510 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-SIUI)"/>
                <text x="350" y="330" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">SelecÈ›ie fiÈ™ier Master</text>
                
                <path d="M 190 565 L 510 410" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-SIUI)"/>
                <text x="300" y="500" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">FiÈ™ier Excel Master</text>
                <text x="300" y="515" font-family="Georgia, serif" font-size="10" fill="#666">(CNP-uri)</text>
                
                <path d="M 190 135 L 510 290" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-SIUI)"/>
                <text x="300" y="200" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Cerere interogare</text>
                <text x="300" y="215" font-family="Georgia, serif" font-size="10" fill="#666">(CNP + CAPTCHA)</text>
                
                <path d="M 510 290 L 190 135" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-SIUI)"/>
                <text x="300" y="180" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">RÄƒspuns interogare</text>
                <text x="300" y="195" font-family="Georgia, serif" font-size="10" fill="#666">(Status asigurare)</text>
                
                <path d="M 690 380 L 1010 565" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-SIUI)"/>
                <text x="850" y="480" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Raport Excel</text>
                <text x="850" y="495" font-family="Georgia, serif" font-size="10" fill="#666">(Salvare localÄƒ)</text>
              </svg>
            </div>
            
            <h4>9.2. DFD Nivel 1 - Flux Detaliat de Procesare</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1600" height="1100" viewBox="0 0 1600 1100" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD1-SIUI" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Titlu -->
                <text x="800" y="40" text-anchor="middle" font-family="Georgia, serif" font-size="22" font-weight="bold" fill="#22507a">ğŸ†” RAPORT SIUI - FLUXURI DE DATE DETALIATE</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="80" width="120" height="60" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="110" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Utilizator</text>
                <text x="110" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">ICC</text>
                
                <rect x="1430" y="950" width="120" height="60" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="975" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1490" y="995" text-anchor="middle" font-family="Georgia, serif" font-size="11">Output</text>
                
                <rect x="50" y="950" width="120" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="110" y="975" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="110" y="995" text-anchor="middle" font-family="Georgia, serif" font-size="11">Master</text>
                
                <rect x="50" y="200" width="120" height="60" fill="#fff9c4" stroke="#fbc02d" stroke-width="2" rx="5"/>
                <text x="110" y="225" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Site Web</text>
                <text x="110" y="245" text-anchor="middle" font-family="Georgia, serif" font-size="11">CASAN</text>
                
                <!-- Procese -->
                <circle cx="200" cy="350" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="340" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">1.0</text>
                <text x="200" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="200" y="370" text-anchor="middle" font-family="Georgia, serif" font-size="11">Excel Master</text>
                
                <circle cx="400" cy="350" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="340" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">2.0</text>
                <text x="400" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="11">Validare</text>
                <text x="400" y="370" text-anchor="middle" font-family="Georgia, serif" font-size="11">CNP</text>
                
                <circle cx="600" cy="350" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="340" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">3.0</text>
                <text x="600" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="11">Extragere</text>
                <text x="600" y="370" text-anchor="middle" font-family="Georgia, serif" font-size="11">Info CNP</text>
                
                <circle cx="200" cy="550" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="540" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">4.0</text>
                <text x="200" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="11">Navigare</text>
                <text x="200" y="570" text-anchor="middle" font-family="Georgia, serif" font-size="11">Site CASAN</text>
                
                <circle cx="400" cy="550" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="540" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">5.0</text>
                <text x="400" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="11">Rezolvare</text>
                <text x="400" y="570" text-anchor="middle" font-family="Georgia, serif" font-size="11">CAPTCHA</text>
                
                <circle cx="600" cy="550" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="540" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">6.0</text>
                <text x="600" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="11">Trimitere</text>
                <text x="600" y="570" text-anchor="middle" font-family="Georgia, serif" font-size="11">Formular</text>
                
                <circle cx="800" cy="550" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="540" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">7.0</text>
                <text x="800" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="11">Extragere</text>
                <text x="800" y="570" text-anchor="middle" font-family="Georgia, serif" font-size="11">Rezultat</text>
                
                <circle cx="1000" cy="550" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="1000" y="540" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">8.0</text>
                <text x="1000" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="11">Actualizare</text>
                <text x="1000" y="570" text-anchor="middle" font-family="Georgia, serif" font-size="11">Excel</text>
                
                <circle cx="800" cy="350" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="340" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">9.0</text>
                <text x="800" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="800" y="370" text-anchor="middle" font-family="Georgia, serif" font-size="11">Raport Final</text>
                
                <!-- Stocuri de date -->
                <rect x="50" y="700" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="50" y1="725" x2="250" y2="725" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="150" y="745" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D1</text>
                <text x="150" y="765" text-anchor="middle" font-family="Georgia, serif" font-size="12">FiÈ™ier Master</text>
                <text x="150" y="780" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(CNP-uri)</text>
                
                <rect x="1150" y="700" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1150" y1="725" x2="1350" y2="725" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1250" y="745" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D2</text>
                <text x="1250" y="765" text-anchor="middle" font-family="Georgia, serif" font-size="12">Raport Final</text>
                <text x="1250" y="780" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Excel)</text>
                
                <!-- Fluxuri principale -->
                <path d="M 170 110 L 150 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="140" y="220" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">selecÈ›ie fiÈ™ier</text>
                
                <path d="M 150 950 L 150 400" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="130" y="670" font-family="Georgia, serif" font-size="10" fill="#3576b0">fiÈ™ier Excel Master</text>
                
                <path d="M 250 350 L 350 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="300" y="340" font-family="Georgia, serif" font-size="10" fill="#3576b0">CNP-uri</text>
                
                <path d="M 450 350 L 550 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="500" y="340" font-family="Georgia, serif" font-size="10" fill="#3576b0">CNP-uri validate</text>
                
                <path d="M 650 350 L 750 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="700" y="340" font-family="Georgia, serif" font-size="10" fill="#3576b0">info CNP</text>
                
                <path d="M 250 550 L 150 230" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="180" y="380" font-family="Georgia, serif" font-size="10" fill="#3576b0">navigare site</text>
                
                <path d="M 350 550 L 450 550" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="400" y="540" font-family="Georgia, serif" font-size="10" fill="#3576b0">imagine CAPTCHA</text>
                
                <path d="M 450 550 L 550 550" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="500" y="540" font-family="Georgia, serif" font-size="10" fill="#3576b0">text CAPTCHA</text>
                
                <path d="M 650 550 L 750 550" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="700" y="540" font-family="Georgia, serif" font-size="10" fill="#3576b0">formular completat</text>
                
                <path d="M 850 550 L 150 230" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="500" y="380" font-family="Georgia, serif" font-size="10" fill="#3576b0">pagina rezultat</text>
                
                <path d="M 150 230 L 950 550" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="550" y="400" font-family="Georgia, serif" font-size="10" fill="#3576b0">status asigurare</text>
                
                <path d="M 1050 550 L 1250 700" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="1150" y="620" font-family="Georgia, serif" font-size="10" fill="#3576b0">date actualizate</text>
                
                <path d="M 850 350 L 1250 700" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="1050" y="520" font-family="Georgia, serif" font-size="10" fill="#3576b0">raport Excel</text>
                
                <path d="M 1350 740 L 1490 950" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="1420" y="850" font-family="Georgia, serif" font-size="10" fill="#3576b0">salvare localÄƒ</text>
                
                <!-- Legenda -->
                <rect x="50" y="1050" width="1500" height="40" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="5"/>
                <path d="M 100 1070 L 200 1070" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-SIUI)"/>
                <text x="220" y="1075" font-family="Georgia, serif" font-size="11">Flux de date normal</text>
                <text x="800" y="1075" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Procese:</tspan> 1.0-Citire | 2.0-Validare CNP | 3.0-Extragere Info | 4.0-Navigare | 5.0-Rezolvare CAPTCHA | 6.0-Trimitere | 7.0-Extragere Rezultat | 8.0-Actualizare | 9.0-Generare</text>
                <text x="800" y="1090" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Stocuri:</tspan> D1-FiÈ™ier Master | D2-Raport Final</text>
              </svg>
            </div>
            
            <h4>9.3. Tabel de Fluxuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Flux</th>
                  <th>Nume Flux</th>
                  <th>SursÄƒ</th>
                  <th>DestinaÈ›ie</th>
                  <th>ConÈ›inut</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>F1</td>
                  <td>SelecÈ›ie FiÈ™ier Master</td>
                  <td>Utilizator ICC</td>
                  <td>Proces 1.0</td>
                  <td>SelecÈ›ie fiÈ™ier Excel Master cu CNP-uri din folderul Master/</td>
                </tr>
                <tr>
                  <td>F2</td>
                  <td>FiÈ™ier Excel Master</td>
                  <td>D1 (FiÈ™ier Master)</td>
                  <td>Proces 1.0</td>
                  <td>FiÈ™ier Excel cu coloana B conÈ›inÃ¢nd CNP-uri</td>
                </tr>
                <tr>
                  <td>F3</td>
                  <td>CNP-uri</td>
                  <td>Proces 1.0</td>
                  <td>Proces 2.0</td>
                  <td>ListÄƒ de CNP-uri din Excel (coloana B)</td>
                </tr>
                <tr>
                  <td>F4</td>
                  <td>CNP-uri Validate</td>
                  <td>Proces 2.0</td>
                  <td>Proces 3.0</td>
                  <td>CNP-uri validate conform algoritmului de control (13 cifre, cifrÄƒ control validÄƒ)</td>
                </tr>
                <tr>
                  <td>F5</td>
                  <td>Info CNP</td>
                  <td>Proces 3.0</td>
                  <td>Proces 8.0</td>
                  <td>InformaÈ›ii extrase din CNP: Sex, Data naÈ™terii, VÃ¢rsta, JudeÈ›, CJP (Calitate de PersoanÄƒ Ã®n VÃ¢rstÄƒ)</td>
                </tr>
                <tr>
                  <td>F6</td>
                  <td>Navigare Site</td>
                  <td>Proces 4.0</td>
                  <td>Site Web CASAN</td>
                  <td>ComandÄƒ Playwright pentru navigare la https://siui.casan.ro/asigurati/</td>
                </tr>
                <tr>
                  <td>F7</td>
                  <td>Imagine CAPTCHA</td>
                  <td>Site Web CASAN</td>
                  <td>Proces 5.0</td>
                  <td>Imagine CAPTCHA extrasÄƒ din paginÄƒ (screenshot)</td>
                </tr>
                <tr>
                  <td>F8</td>
                  <td>Text CAPTCHA</td>
                  <td>Proces 5.0</td>
                  <td>Proces 6.0</td>
                  <td>Text CAPTCHA rezolvat prin OCR Tesseract (6 cifre)</td>
                </tr>
                <tr>
                  <td>F9</td>
                  <td>Formular Completat</td>
                  <td>Proces 6.0</td>
                  <td>Site Web CASAN</td>
                  <td>Formular completat cu CNP, checkbox CID bifat, È™i text CAPTCHA</td>
                </tr>
                <tr>
                  <td>F10</td>
                  <td>PaginÄƒ Rezultat</td>
                  <td>Site Web CASAN</td>
                  <td>Proces 7.0</td>
                  <td>HTML paginÄƒ cu rezultatul interogÄƒrii (conÈ›inut text)</td>
                </tr>
                <tr>
                  <td>F11</td>
                  <td>Status Asigurare</td>
                  <td>Proces 7.0</td>
                  <td>Proces 8.0</td>
                  <td>Status asigurare extras: ASIGURAT, NEASIGURAT, DECEDAT, sau EROARE</td>
                </tr>
                <tr>
                  <td>F12</td>
                  <td>Date Actualizate</td>
                  <td>Proces 8.0</td>
                  <td>Proces 9.0</td>
                  <td>DataFrame sau Excel cu coloane actualizate: Sex, Data naÈ™terii, VÃ¢rsta, JudeÈ›, CJP, Status CASAN</td>
                </tr>
                <tr>
                  <td>F13</td>
                  <td>Raport Excel</td>
                  <td>Proces 9.0</td>
                  <td>D2 (Raport Final)</td>
                  <td>FiÈ™ier Excel final: Master_SIUI_procesat_[timestamp].xlsx sau Master_SIUI_CASAN_AUTO_[timestamp].xlsx</td>
                </tr>
                <tr>
                  <td>F14</td>
                  <td>Salvare LocalÄƒ</td>
                  <td>D2 (Raport Final)</td>
                  <td>Folder Output</td>
                  <td>FiÈ™ier Excel salvat Ã®n rapoarte_generate/</td>
                </tr>
              </tbody>
            </table>
            
            <h4>9.4. Tabel de Stocuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Stoc</th>
                  <th>Nume Stoc</th>
                  <th>Descriere</th>
                  <th>StructurÄƒ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>D1</td>
                  <td>FiÈ™ier Master</td>
                  <td>FiÈ™ier Excel Master cu CNP-uri</td>
                  <td>Excel cu coloana B conÈ›inÃ¢nd CNP-uri (format: 13 cifre), coloane C-H pentru rezultate (Sex, Data naÈ™terii, VÃ¢rsta, JudeÈ›, CJP, Status CASAN)</td>
                </tr>
                <tr>
                  <td>D2</td>
                  <td>Raport Final</td>
                  <td>FiÈ™ier Excel final cu rezultate procesare</td>
                  <td>Master_SIUI_procesat_[timestamp].xlsx (doar CNP) sau Master_SIUI_CASAN_AUTO_[timestamp].xlsx (CNP + CASAN), cu toate coloanele completate</td>
                </tr>
              </tbody>
            </table>
            
            <h4>9.5. Descriere DetaliatÄƒ a Proceselor</h4>
            <table>
              <thead>
                <tr>
                  <th>Proces</th>
                  <th>Descriere</th>
                  <th>Input</th>
                  <th>Output</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>1.0 - Citire Excel Master</strong></td>
                  <td>CiteÈ™te fiÈ™ierul Excel Master din folderul Master/, identificÄƒ coloana B cu CNP-uri, verificÄƒ existenÈ›a coloanelor C-H (Sex, Data naÈ™terii, VÃ¢rsta, JudeÈ›, CJP, Status CASAN) È™i le creeazÄƒ dacÄƒ nu existÄƒ</td>
                  <td>FiÈ™ier Excel Master (D1)</td>
                  <td>ListÄƒ de CNP-uri din coloana B</td>
                </tr>
                <tr>
                  <td><strong>2.0 - Validare CNP</strong></td>
                  <td>ValideazÄƒ fiecare CNP conform algoritmului de control: verificÄƒ lungimea (13 cifre), verificÄƒ cÄƒ toate caracterele sunt cifre, calculeazÄƒ cifra de control folosind constanta "279146358279", comparÄƒ cu ultima cifrÄƒ a CNP-ului</td>
                  <td>ListÄƒ de CNP-uri</td>
                  <td>CNP-uri validate (CNP-urile invalide sunt marcate)</td>
                </tr>
                <tr>
                  <td><strong>3.0 - Extragere Info CNP</strong></td>
                  <td>ParseazÄƒ CNP-ul validat È™i extrage informaÈ›ii: Sex (din prima cifrÄƒ: 1,3,5,7,9 = Masculin; 2,4,6,8 = Feminin), Data naÈ™terii (din cifrele 2-7: AA/MM/DD, cu anul corectat Ã®n funcÈ›ie de prima cifrÄƒ), VÃ¢rsta (calculatÄƒ din data naÈ™terii), JudeÈ› (din cifrele 8-9, mapare la dicÈ›ionar JUDETE), CJP (Calitate de PersoanÄƒ Ã®n VÃ¢rstÄƒ: DA dacÄƒ vÃ¢rsta >= 65, NU altfel)</td>
                  <td>CNP-uri validate</td>
                  <td>InformaÈ›ii extrase: Sex, Data naÈ™terii, VÃ¢rsta, JudeÈ›, CJP</td>
                </tr>
                <tr>
                  <td><strong>4.0 - Navigare Site CASAN</strong></td>
                  <td>FoloseÈ™te Playwright pentru a deschide browser headless, navigheazÄƒ la https://siui.casan.ro/asigurati/, aÈ™teaptÄƒ Ã®ncÄƒrcarea paginii (domcontentloaded)</td>
                  <td>CNP pentru interogare</td>
                  <td>PaginÄƒ web Ã®ncÄƒrcatÄƒ</td>
                </tr>
                <tr>
                  <td><strong>5.0 - Rezolvare CAPTCHA</strong></td>
                  <td>Extrage imaginea CAPTCHA din paginÄƒ (selector: img[src*="Captcha.aspx"]), face screenshot, proceseazÄƒ imaginea cu OpenCV (mÄƒrire 3x, grayscale, denoising, threshold Otsu, morfologie), aplicÄƒ OCR Tesseract cu configuraÈ›ii multiple (PSM 7, 8, 13), extrage text CAPTCHA (6 cifre)</td>
                  <td>Imagine CAPTCHA</td>
                  <td>Text CAPTCHA rezolvat</td>
                </tr>
                <tr>
                  <td><strong>6.0 - Trimitere Formular</strong></td>
                  <td>CompleteazÄƒ formularul CASAN: introduce CNP Ã®n cÃ¢mp (selector: input#MainContent_tbCNP), bifeazÄƒ checkbox CID (input[name*="cbCIDFromCNP"]), introduce text CAPTCHA (input#MainContent_textCaptcha), trimite formularul (input[name*="btnSearch"]), aÈ™teaptÄƒ rÄƒspunsul (wait_for_result_message)</td>
                  <td>CNP + Text CAPTCHA</td>
                  <td>Formular trimis, paginÄƒ rezultat Ã®ncÄƒrcatÄƒ</td>
                </tr>
                <tr>
                  <td><strong>7.0 - Extragere Rezultat</strong></td>
                  <td>Extrage statusul asigurÄƒrii din paginÄƒ: cautÄƒ Ã®n span-uri, body text, validationSummary, list items pentru pattern-uri specifice ("este asiguratÄƒ" = ASIGURAT, "nu este asiguratÄƒ" = NEASIGURAT, "este decedatÄƒ/decedat" = DECEDAT), gestioneazÄƒ erorile CAPTCHA È™i reÃ®ncearcÄƒ dacÄƒ este necesar (max 3 Ã®ncercÄƒri)</td>
                  <td>PaginÄƒ rezultat</td>
                  <td>Status asigurare: ASIGURAT, NEASIGURAT, DECEDAT, sau EROARE</td>
                </tr>
                <tr>
                  <td><strong>8.0 - Actualizare Excel</strong></td>
                  <td>ActualizeazÄƒ fiÈ™ierul Excel cu informaÈ›iile extrase: coloana C (Sex), coloana D (Data naÈ™terii), coloana E (VÃ¢rsta), coloana F (JudeÈ›), coloana G (CJP), coloana H (Status CASAN), salveazÄƒ progresul la fiecare 5 CNP-uri procesate</td>
                  <td>Info CNP + Status Asigurare</td>
                  <td>Excel actualizat cu toate informaÈ›iile</td>
                </tr>
                <tr>
                  <td><strong>9.0 - Generare Raport Final</strong></td>
                  <td>GenereazÄƒ fiÈ™ierul Excel final: salveazÄƒ Excel-ul actualizat cu nume unic (timestamp), calculeazÄƒ statistici (procesate, succes, erori), returneazÄƒ calea cÄƒtre fiÈ™ierul generat</td>
                  <td>Excel actualizat</td>
                  <td>FiÈ™ier Excel final salvat Ã®n D2</td>
                </tr>
              </tbody>
            </table>
            
            <h4>9.6. Note Importante</h4>
            <ul>
              <li><strong>Procesare LocalÄƒ:</strong> Toate procesele se desfÄƒÈ™oarÄƒ local pe staÈ›ia de lucru a utilizatorului ICC, cu excepÈ›ia interogÄƒrii site-ului CASAN care necesitÄƒ conexiune la internet.</li>
              <li><strong>FÄƒrÄƒ Stocare PersistentÄƒ:</strong> Datele sunt procesate exclusiv Ã®n memorie temporarÄƒ (RAM). FiÈ™ierul final este salvat doar pentru utilizare ulterioarÄƒ.</li>
              <li><strong>Validare CNP:</strong> Validarea CNP-urilor foloseÈ™te algoritmul oficial de control cu constanta "279146358279", asigurÃ¢nd acurateÈ›e Ã®n extragerea informaÈ›iilor.</li>
              <li><strong>Extragere Info CNP:</strong> InformaÈ›iile sunt extrase direct din structura CNP-ului fÄƒrÄƒ necesitatea interogÄƒrilor externe, permiÈ›Ã¢nd procesare rapidÄƒ.</li>
              <li><strong>Interogare CASAN OpÈ›ionalÄƒ:</strong> Interogarea site-ului CASAN este opÈ›ionalÄƒ (activatÄƒ cu --casan sau --casan-auto), necesitÃ¢nd dependenÈ›e suplimentare (Playwright, OpenCV, Tesseract OCR).</li>
              <li><strong>Rezolvare CAPTCHA OCR:</strong> CAPTCHA-ul este rezolvat automat folosind OCR Tesseract cu procesare avansatÄƒ a imaginii (denoising, threshold, morfologie), permiÈ›Ã¢nd interogare complet automatÄƒ.</li>
              <li><strong>Gestionare Erori:</strong> Raportul gestioneazÄƒ erorile CAPTCHA, timeout-uri È™i erori de reÈ›ea prin reÃ®ncercÄƒri (max 3 Ã®ncercÄƒri per CNP) È™i pauze Ã®ntre interogÄƒri (5-10 secunde).</li>
              <li><strong>Salvare Progres:</strong> Progresul este salvat automat la fiecare 5 CNP-uri procesate, permiÈ›Ã¢nd reluarea procesÄƒrii Ã®n caz de Ã®ntrerupere.</li>
              <li><strong>Eliminare AutomatÄƒ:</strong> DupÄƒ finalizarea procesÄƒrii, datele din memorie sunt eliminate automat, aplicaÈ›ia revenind la starea iniÈ›ialÄƒ.</li>
            </ul>
          </div>

          <!-- DFD Raport 10: AnalizÄƒ Perimare -->
          <div class="dfd-report" id="dfd-report-10">
            <h3>ğŸ“Š 10. Raport AnalizÄƒ Perimare - Fluxuri de Date</h3>
            
            <h4>10.1. DFD Nivel 0 - DiagramÄƒ Context</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1200" height="700" viewBox="0 0 1200 700" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD-AnalizaPerimare" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Proces central -->
                <circle cx="600" cy="350" r="90" fill="#fff3e0" stroke="#ff9800" stroke-width="3"/>
                <text x="600" y="330" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Raport</text>
                <text x="600" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">AnalizÄƒ</text>
                <text x="600" y="380" text-anchor="middle" font-family="Georgia, serif" font-size="14">Perimare</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="300" width="140" height="70" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="120" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">Utilizator</text>
                <text x="120" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">ICC</text>
                <text x="120" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Selectare folder)</text>
                
                <rect x="1010" y="100" width="140" height="70" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1080" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1080" y="145" text-anchor="middle" font-family="Georgia, serif" font-size="12">Email</text>
                <text x="1080" y="160" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(OWNER_ICC)</text>
                
                <rect x="1010" y="530" width="140" height="70" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1080" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Output</text>
                <text x="1080" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Rapoarte Excel)</text>
                
                <rect x="50" y="530" width="140" height="70" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="120" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="120" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Master</text>
                <text x="120" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Raport-Master-ICC + Analiza perimare BT)</text>
                
                <rect x="1010" y="300" width="140" height="70" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1080" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">Local</text>
                <text x="1080" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Trimitere email)</text>
                
                <!-- Fluxuri de date -->
                <path d="M 190 335 L 510 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-AnalizaPerimare)"/>
                <text x="350" y="330" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">SelecÈ›ie folder Master</text>
                
                <path d="M 190 565 L 510 410" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-AnalizaPerimare)"/>
                <text x="300" y="500" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">FiÈ™iere Excel Master</text>
                <text x="300" y="515" font-family="Georgia, serif" font-size="10" fill="#666">(Raport-Master-ICC + Analiza perimare BT)</text>
                
                <path d="M 690 350 L 1010 135" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-AnalizaPerimare)"/>
                <text x="850" y="220" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email-uri cu rapoarte</text>
                <text x="850" y="235" font-family="Georgia, serif" font-size="10" fill="#666">(per OWNER_ICC)</text>
                
                <path d="M 690 380 L 1010 565" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-AnalizaPerimare)"/>
                <text x="850" y="480" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Rapoarte Excel</text>
                <text x="850" y="495" font-family="Georgia, serif" font-size="10" fill="#666">(Salvare localÄƒ)</text>
                
                <path d="M 690 320 L 1010 335" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-AnalizaPerimare)"/>
                <text x="850" y="315" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email-uri cu ataÈ™amente</text>
                <text x="850" y="330" font-family="Georgia, serif" font-size="10" fill="#666">(Rapoarte Excel)</text>
              </svg>
            </div>
            
            <h4>10.2. DFD Nivel 1 - Flux Detaliat de Procesare</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1600" height="1300" viewBox="0 0 1600 1300" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD1-AnalizaPerimare" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Titlu -->
                <text x="800" y="40" text-anchor="middle" font-family="Georgia, serif" font-size="22" font-weight="bold" fill="#22507a">ğŸ“Š RAPORT ANALIZÄ‚ PERIMARE - FLUXURI DE DATE DETALIATE</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="80" width="120" height="60" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="110" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Utilizator</text>
                <text x="110" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">ICC</text>
                
                <rect x="1430" y="80" width="120" height="60" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1490" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1490" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <rect x="1430" y="1150" width="120" height="60" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="1175" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1490" y="1195" text-anchor="middle" font-family="Georgia, serif" font-size="11">Output</text>
                
                <rect x="50" y="1150" width="120" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="110" y="1175" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="110" y="1195" text-anchor="middle" font-family="Georgia, serif" font-size="11">Master</text>
                
                <rect x="1430" y="500" width="120" height="60" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="525" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1490" y="545" text-anchor="middle" font-family="Georgia, serif" font-size="11">Local</text>
                
                <!-- Procese -->
                <circle cx="200" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">1.0</text>
                <text x="200" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="200" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">Raport-Master</text>
                
                <circle cx="400" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">2.0</text>
                <text x="400" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Concatenare</text>
                <text x="400" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">Sheet-uri</text>
                
                <circle cx="200" cy="450" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="440" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">3.0</text>
                <text x="200" y="455" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="200" y="470" text-anchor="middle" font-family="Georgia, serif" font-size="11">Analiza perimare</text>
                
                <circle cx="600" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">4.0</text>
                <text x="600" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">VLOOKUP</text>
                <text x="600" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">EXEC_FILE_NO</text>
                
                <circle cx="800" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">5.0</text>
                <text x="800" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Filtrare</text>
                <text x="800" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">Status-uri</text>
                
                <circle cx="200" cy="600" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">6.0</text>
                <text x="200" y="605" text-anchor="middle" font-family="Georgia, serif" font-size="11">Completare</text>
                <text x="200" y="620" text-anchor="middle" font-family="Georgia, serif" font-size="11">OWNER_ICC</text>
                
                <circle cx="400" cy="600" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">7.0</text>
                <text x="400" y="605" text-anchor="middle" font-family="Georgia, serif" font-size="11">Filtrare</text>
                <text x="400" y="620" text-anchor="middle" font-family="Georgia, serif" font-size="11">Categorii</text>
                
                <circle cx="600" cy="600" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">8.0</text>
                <text x="600" y="605" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="600" y="620" text-anchor="middle" font-family="Georgia, serif" font-size="11">Rapoarte Excel</text>
                
                <circle cx="800" cy="600" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">9.0</text>
                <text x="800" y="605" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="800" y="620" text-anchor="middle" font-family="Georgia, serif" font-size="11">Statistici</text>
                
                <circle cx="1000" cy="600" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="1000" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">10.0</text>
                <text x="1000" y="605" text-anchor="middle" font-family="Georgia, serif" font-size="11">Trimitere</text>
                <text x="1000" y="620" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <!-- Stocuri de date -->
                <rect x="50" y="800" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="50" y1="825" x2="250" y2="825" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="150" y="845" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D1</text>
                <text x="150" y="865" text-anchor="middle" font-family="Georgia, serif" font-size="12">FiÈ™iere Master</text>
                <text x="150" y="880" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Raport-Master-ICC + Analiza perimare BT)</text>
                
                <rect x="600" y="800" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="600" y1="825" x2="800" y2="825" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="700" y="845" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D2</text>
                <text x="700" y="865" text-anchor="middle" font-family="Georgia, serif" font-size="12">Date Consolidate</text>
                <text x="700" y="880" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(DataFrame)</text>
                
                <rect x="1150" y="800" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1150" y1="825" x2="1350" y2="825" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1250" y="845" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D3</text>
                <text x="1250" y="865" text-anchor="middle" font-family="Georgia, serif" font-size="12">Rapoarte Finale</text>
                <text x="1250" y="880" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Excel)</text>
                
                <!-- Fluxuri principale -->
                <path d="M 170 110 L 150 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="140" y="200" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">selecÈ›ie folder</text>
                
                <path d="M 150 1150 L 150 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="130" y="750" font-family="Georgia, serif" font-size="10" fill="#3576b0">Raport-Master-ICC.xlsx</text>
                
                <path d="M 150 1150 L 200 450" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="160" y="800" font-family="Georgia, serif" font-size="10" fill="#3576b0">Analiza perimare BT.xlsx</text>
                
                <path d="M 250 300 L 350 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="300" y="290" font-family="Georgia, serif" font-size="10" fill="#3576b0">date sheet-uri</text>
                
                <path d="M 450 300 L 550 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="500" y="290" font-family="Georgia, serif" font-size="10" fill="#3576b0">date concatenate</text>
                
                <path d="M 250 450 L 550 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="400" y="370" font-family="Georgia, serif" font-size="10" fill="#3576b0">lookup dict</text>
                
                <path d="M 650 300 L 750 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="700" y="290" font-family="Georgia, serif" font-size="10" fill="#3576b0">date cu VLOOKUP</text>
                
                <path d="M 850 300 L 700 800" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="775" y="550" font-family="Georgia, serif" font-size="10" fill="#3576b0">date filtrate</text>
                
                <path d="M 700 800 L 650 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="675" y="550" font-family="Georgia, serif" font-size="10" fill="#3576b0">date pentru filtrare</text>
                
                <path d="M 250 600 L 350 600" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="300" y="590" font-family="Georgia, serif" font-size="10" fill="#3576b0">OWNER_ICC completat</text>
                
                <path d="M 450 600 L 550 600" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="500" y="590" font-family="Georgia, serif" font-size="10" fill="#3576b0">categorii filtrate</text>
                
                <path d="M 650 600 L 1250 800" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="950" y="700" font-family="Georgia, serif" font-size="10" fill="#3576b0">rapoarte Excel</text>
                
                <path d="M 850 600 L 1250 800" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="1050" y="700" font-family="Georgia, serif" font-size="10" fill="#3576b0">statistici</text>
                
                <path d="M 1050 600 L 1430 110" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="1240" y="350" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">email-uri cu rapoarte</text>
                
                <path d="M 1050 650 L 1430 530" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="1240" y="600" font-family="Georgia, serif" font-size="10" fill="#3576b0">comandÄƒ trimitere</text>
                
                <path d="M 1350 840 L 1490 1150" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="1420" y="1000" font-family="Georgia, serif" font-size="10" fill="#3576b0">salvare localÄƒ</text>
                
                <!-- Legenda -->
                <rect x="50" y="1250" width="1500" height="40" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="5"/>
                <path d="M 100 1270 L 200 1270" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-AnalizaPerimare)"/>
                <text x="220" y="1275" font-family="Georgia, serif" font-size="11">Flux de date normal</text>
                <text x="800" y="1275" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Procese:</tspan> 1.0-Citire | 2.0-Concatenare | 3.0-Citire Analiza | 4.0-VLOOKUP | 5.0-Filtrare Status | 6.0-Completare | 7.0-Filtrare Categorii | 8.0-Generare | 9.0-Statistici | 10.0-Trimitere</text>
                <text x="800" y="1290" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Stocuri:</tspan> D1-FiÈ™iere Master | D2-Date Consolidate | D3-Rapoarte Finale</text>
              </svg>
            </div>
            
            <h4>10.3. Tabel de Fluxuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Flux</th>
                  <th>Nume Flux</th>
                  <th>SursÄƒ</th>
                  <th>DestinaÈ›ie</th>
                  <th>ConÈ›inut</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>F1</td>
                  <td>SelecÈ›ie Folder Master</td>
                  <td>Utilizator ICC</td>
                  <td>Proces 1.0, 3.0</td>
                  <td>SelecÈ›ie folder Master cu fiÈ™iere Excel</td>
                </tr>
                <tr>
                  <td>F2</td>
                  <td>Raport-Master-ICC.xlsx</td>
                  <td>D1 (FiÈ™iere Master)</td>
                  <td>Proces 1.0</td>
                  <td>FiÈ™ier Excel cu 3 sheet-uri (Sheet 1 cu header=1, Sheet 2 È™i Sheet 3 cu skiprows=1 È™i header=None)</td>
                </tr>
                <tr>
                  <td>F3</td>
                  <td>Analiza perimare BT.xlsx</td>
                  <td>D1 (FiÈ™iere Master)</td>
                  <td>Proces 3.0</td>
                  <td>FiÈ™ier Excel cu coloane File Number (B) È™i Analiza perimare (C)</td>
                </tr>
                <tr>
                  <td>F4</td>
                  <td>Date Sheet-uri</td>
                  <td>Proces 1.0</td>
                  <td>Proces 2.0</td>
                  <td>3 DataFrame-uri pandas cu date din fiecare sheet</td>
                </tr>
                <tr>
                  <td>F5</td>
                  <td>Date Concatenate</td>
                  <td>Proces 2.0</td>
                  <td>Proces 4.0</td>
                  <td>DataFrame unificat cu date concatenate È™i aliniate (coloana "Analiza perimare BT" adÄƒugatÄƒ)</td>
                </tr>
                <tr>
                  <td>F6</td>
                  <td>Lookup Dict</td>
                  <td>Proces 3.0</td>
                  <td>Proces 4.0</td>
                  <td>DicÈ›ionar File Number â†’ Analiza perimare (pentru VLOOKUP)</td>
                </tr>
                <tr>
                  <td>F7</td>
                  <td>Date cu VLOOKUP</td>
                  <td>Proces 4.0</td>
                  <td>Proces 5.0</td>
                  <td>DataFrame cu coloana "Analiza perimare BT" completatÄƒ prin VLOOKUP (EXEC_FILE_NO â†’ File Number)</td>
                </tr>
                <tr>
                  <td>F8</td>
                  <td>Date Filtrate</td>
                  <td>Proces 5.0</td>
                  <td>D2 (Date Consolidate)</td>
                  <td>DataFrame cu rÃ¢ndurile care nu au match Ã®n VLOOKUP È™terse, status-uri specifice È™terse (InsolvenÈ›a, Faliment, etc.)</td>
                </tr>
                <tr>
                  <td>F9</td>
                  <td>OWNER_ICC Completat</td>
                  <td>Proces 6.0</td>
                  <td>Proces 7.0</td>
                  <td>DataFrame cu coloana OWNER_ICC completatÄƒ cu @iccollect.ro (dacÄƒ nu conÈ›ine deja)</td>
                </tr>
                <tr>
                  <td>F10</td>
                  <td>Categorii Filtrate</td>
                  <td>Proces 7.0</td>
                  <td>Proces 8.0</td>
                  <td>DataFrame-uri separate pe categorii: La incuviintat, Dosare Ã®nchise, REZOLUTIE_INCHIDERE blank, Suspendate, Angajament, Licitatii, Dosar incuviintat, Netransmise</td>
                </tr>
                <tr>
                  <td>F11</td>
                  <td>Rapoarte Excel</td>
                  <td>Proces 8.0</td>
                  <td>D3 (Rapoarte Finale)</td>
                  <td>FiÈ™iere Excel formatate pentru fiecare categorie: Dosare_incuviintat_Capone_task_perimare_[timestamp].xlsx, Dosare_inchise_Capone_task_perimare_[timestamp].xlsx, etc.</td>
                </tr>
                <tr>
                  <td>F12</td>
                  <td>Statistici</td>
                  <td>Proces 9.0</td>
                  <td>Proces 10.0</td>
                  <td>DicÈ›ionar cu statistici pentru fiecare categorie (numÄƒr cazuri, OWNER_ICC, etc.)</td>
                </tr>
                <tr>
                  <td>F13</td>
                  <td>Email-uri cu Rapoarte</td>
                  <td>Proces 10.0</td>
                  <td>Destinatari Email</td>
                  <td>Email-uri HTML cu font Georgia 11pt, trimise per OWNER_ICC cu rapoarte Excel relevante ataÈ™ate</td>
                </tr>
                <tr>
                  <td>F14</td>
                  <td>ComandÄƒ Trimitere</td>
                  <td>Proces 10.0</td>
                  <td>Outlook</td>
                  <td>ComandÄƒ COM pentru trimitere email prin Outlook local</td>
                </tr>
                <tr>
                  <td>F15</td>
                  <td>Salvare LocalÄƒ</td>
                  <td>D3 (Rapoarte Finale)</td>
                  <td>Folder Output</td>
                  <td>FiÈ™iere Excel salvate Ã®n Rezultate/</td>
                </tr>
              </tbody>
            </table>
            
            <h4>10.4. Tabel de Stocuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Stoc</th>
                  <th>Nume Stoc</th>
                  <th>Descriere</th>
                  <th>StructurÄƒ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>D1</td>
                  <td>FiÈ™iere Master</td>
                  <td>FiÈ™iere Excel Master din folderul Master/</td>
                  <td>Raport-Master-ICC.xlsx (3 sheet-uri) È™i Analiza perimare BT.xlsx (coloane File Number, Analiza perimare)</td>
                </tr>
                <tr>
                  <td>D2</td>
                  <td>Date Consolidate</td>
                  <td>DataFrame pandas cu date consolidate È™i procesate</td>
                  <td>DataFrame cu coloane: EXEC_FILE_NO, Analiza perimare BT, STADIU_DOSAR, REZOLUTIE_INCHIDERE, OWNER_ICC, etc.</td>
                </tr>
                <tr>
                  <td>D3</td>
                  <td>Rapoarte Finale</td>
                  <td>Folder Rezultate/ cu rapoarte Excel</td>
                  <td>FiÈ™iere Excel per categorie: Dosare_incuviintat_Capone_task_perimare_[timestamp].xlsx, Dosare_inchise_Capone_task_perimare_[timestamp].xlsx, Dosare_inchidere_blank_Capone_task_perimare_[timestamp].xlsx, Dosare_suspendate_blank_Capone_task_perimare_[timestamp].xlsx, Dosare_angajament_blank_Capone_task_perimare_[timestamp].xlsx, Dosare_licitatii_blank_Capone_task_perimare_[timestamp].xlsx, Dosare_dosar_incuviintat_blank_Capone_task_perimare_[timestamp].xlsx, Dosare_netransmise_Capone_task_perimare_[timestamp].xlsx, Analiza_perimare_BT_consolidat_[timestamp].xlsx</td>
                </tr>
              </tbody>
            </table>
            
            <h4>10.5. Descriere DetaliatÄƒ a Proceselor</h4>
            <table>
              <thead>
                <tr>
                  <th>Proces</th>
                  <th>Descriere</th>
                  <th>Input</th>
                  <th>Output</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>1.0 - Citire Raport-Master-ICC</strong></td>
                  <td>CiteÈ™te fiÈ™ierul Raport-Master-ICC.xlsx din folderul Master/, identificÄƒ cele 3 sheet-uri, proceseazÄƒ Sheet 1 cu header=1 (È™terge rÃ¢ndul 1, rÃ¢ndul 2 devine cap de tabel), proceseazÄƒ Sheet 2 È™i Sheet 3 cu skiprows=1 È™i header=None</td>
                  <td>Raport-Master-ICC.xlsx (D1)</td>
                  <td>3 DataFrame-uri pandas</td>
                </tr>
                <tr>
                  <td><strong>2.0 - Concatenare Sheet-uri</strong></td>
                  <td>AliniazÄƒ coloanele Sheet 2 È™i Sheet 3 cu Sheet 1, concateneazÄƒ toate datele Ã®ntr-un singur DataFrame, adaugÄƒ coloana "Analiza perimare BT" Ã®ntre EXEC_FILE_NO È™i DOSAR_B</td>
                  <td>3 DataFrame-uri</td>
                  <td>DataFrame unificat</td>
                </tr>
                <tr>
                  <td><strong>3.0 - Citire Analiza perimare</strong></td>
                  <td>CiteÈ™te fiÈ™ierul "Analiza perimare BT.xlsx", identificÄƒ coloanele File Number (B) È™i Analiza perimare (C), creeazÄƒ dicÈ›ionar lookup File Number â†’ Analiza perimare</td>
                  <td>Analiza perimare BT.xlsx (D1)</td>
                  <td>DicÈ›ionar lookup File Number â†’ Analiza perimare</td>
                </tr>
                <tr>
                  <td><strong>4.0 - VLOOKUP EXEC_FILE_NO</strong></td>
                  <td>RealizeazÄƒ VLOOKUP Ã®ntre EXEC_FILE_NO din DataFrame consolidat È™i File Number din dicÈ›ionar lookup, completeazÄƒ coloana "Analiza perimare BT" cu valorile gÄƒsite, È™terge rÃ¢ndurile care nu au match Ã®n VLOOKUP</td>
                  <td>DataFrame consolidat + Lookup dict</td>
                  <td>DataFrame cu coloana "Analiza perimare BT" completatÄƒ</td>
                </tr>
                <tr>
                  <td><strong>5.0 - Filtrare Status-uri</strong></td>
                  <td>FiltreazÄƒ È™i È™terge cazurile cu status-uri specifice din STADIU_DOSAR: InsolvenÈ›a â€“ Ã®nchis, Faliment, InsolvenÈ›a - Suspendat, etc. (case-insensitive)</td>
                  <td>DataFrame cu VLOOKUP</td>
                  <td>DataFrame cu status-uri specifice È™terse</td>
                </tr>
                <tr>
                  <td><strong>6.0 - Completare OWNER_ICC</strong></td>
                  <td>CompleteazÄƒ coloana OWNER_ICC cu @iccollect.ro pentru valorile care nu conÈ›in deja domeniul (dacÄƒ valoarea este goalÄƒ, rÄƒmÃ¢ne goalÄƒ)</td>
                  <td>DataFrame filtrat</td>
                  <td>DataFrame cu OWNER_ICC completat</td>
                </tr>
                <tr>
                  <td><strong>7.0 - Filtrare Categorii</strong></td>
                  <td>FiltreazÄƒ datele Ã®n categorii separate: La incuviintat (STADIU_DOSAR = "La incuviintat"), Dosare Ã®nchise (status-uri specifice + REZOLUTIE_INCHIDERE blank), Suspendate (STADIU_DOSAR conÈ›ine "suspendat" + REZOLUTIE_INCHIDERE blank), Angajament (STADIU_DOSAR = "Angajament" + REZOLUTIE_INCHIDERE blank), Licitatii (STADIU_DOSAR = "Licitatii" + REZOLUTIE_INCHIDERE blank), Dosar incuviintat (STADIU_DOSAR = "Dosar incuviintat" + REZOLUTIE_INCHIDERE blank), Netransmise (OWNER_ICC blank sau netransmise)</td>
                  <td>DataFrame cu OWNER_ICC completat</td>
                  <td>DataFrame-uri separate pe categorii</td>
                </tr>
                <tr>
                  <td><strong>8.0 - Generare Rapoarte Excel</strong></td>
                  <td>GenereazÄƒ fiÈ™iere Excel formatate pentru fiecare categorie: salveazÄƒ DataFrame-ul filtrat, formateazÄƒ ca tabel Excel cu stiluri, filtre È™i sortare, nume fiÈ™ier: Dosare_[categorie]_Capone_task_perimare_[timestamp].xlsx, genereazÄƒ È™i fiÈ™ier consolidat: Analiza_perimare_BT_consolidat_[timestamp].xlsx</td>
                  <td>DataFrame-uri pe categorii</td>
                  <td>FiÈ™iere Excel formatate salvate Ã®n D3</td>
                </tr>
                <tr>
                  <td><strong>9.0 - Generare Statistici</strong></td>
                  <td>CalculeazÄƒ statistici pentru fiecare categorie: numÄƒr cazuri, distribuÈ›ie pe OWNER_ICC, etc., creeazÄƒ dicÈ›ionar cu statistici</td>
                  <td>DataFrame-uri pe categorii</td>
                  <td>DicÈ›ionar cu statistici</td>
                </tr>
                <tr>
                  <td><strong>10.0 - Trimitere Email</strong></td>
                  <td>Trimite email-uri prin Outlook local cÄƒtre fiecare OWNER_ICC: pentru fiecare OWNER_ICC, filtreazÄƒ rapoartele relevante, trimite email cu rapoarte Excel ataÈ™ate, corp email HTML cu font Georgia 11pt, trimite È™i email final cu statistici generale</td>
                  <td>Rapoarte Excel (D3) + Statistici</td>
                  <td>Email-uri trimise cÄƒtre destinatari prin Outlook</td>
                </tr>
              </tbody>
            </table>
            
            <h4>10.6. Note Importante</h4>
            <ul>
              <li><strong>Procesare LocalÄƒ:</strong> Toate procesele se desfÄƒÈ™oarÄƒ local pe staÈ›ia de lucru a utilizatorului ICC, fÄƒrÄƒ transmitere cÄƒtre servere externe.</li>
              <li><strong>FÄƒrÄƒ Stocare PersistentÄƒ:</strong> Datele sunt procesate exclusiv Ã®n memorie temporarÄƒ (RAM). FiÈ™ierele intermediare È™i finale sunt salvate doar pentru utilizare ulterioarÄƒ.</li>
              <li><strong>VLOOKUP EXEC_FILE_NO:</strong> VLOOKUP-ul se realizeazÄƒ Ã®ntre EXEC_FILE_NO din Raport-Master-ICC È™i File Number din Analiza perimare BT.xlsx, permiÈ›Ã¢nd asocierea informaÈ›iilor de analizÄƒ perimare cu dosarele din master.</li>
              <li><strong>Filtrare Multi-Criteriu:</strong> Raportul filtreazÄƒ datele dupÄƒ multiple criterii: status-uri specifice, REZOLUTIE_INCHIDERE blank, STADIU_DOSAR, permiÈ›Ã¢nd identificarea precisÄƒ a cazurilor relevante.</li>
              <li><strong>Categorii Separate:</strong> Raportul genereazÄƒ rapoarte Excel separate pentru fiecare categorie de cazuri, permiÈ›Ã¢nd analizÄƒ independentÄƒ È™i trimitere personalizatÄƒ.</li>
              <li><strong>Email-uri Personalizate per OWNER_ICC:</strong> Email-urile sunt trimise individual cÄƒtre fiecare OWNER_ICC cu doar rapoartele relevante pentru acel utilizator, asigurÃ¢nd confidenÈ›ialitate È™i relevanÈ›Äƒ.</li>
              <li><strong>Completare AutomatÄƒ OWNER_ICC:</strong> Coloana OWNER_ICC este completatÄƒ automat cu @iccollect.ro pentru valorile care nu conÈ›in deja domeniul, asigurÃ¢nd format consistent pentru email-uri.</li>
              <li><strong>Rapoarte Formatate:</strong> Rapoartele Excel sunt formatate ca tabele cu stiluri, filtre È™i sortare, permiÈ›Ã¢nd analizÄƒ rapidÄƒ È™i profesionalÄƒ.</li>
              <li><strong>Eliminare AutomatÄƒ:</strong> DupÄƒ finalizarea procesÄƒrii È™i trimiterii email-urilor, datele din memorie sunt eliminate automat, aplicaÈ›ia revenind la starea iniÈ›ialÄƒ.</li>
            </ul>
          </div>

          <!-- DFD Raport 11: Perimate FÄƒrÄƒ AcÈ›iuni -->
          <div class="dfd-report" id="dfd-report-11">
            <h3>ğŸ“‹ 11. Raport Perimate FÄƒrÄƒ AcÈ›iuni - Fluxuri de Date</h3>
            
            <h4>11.1. DFD Nivel 0 - DiagramÄƒ Context</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1200" height="700" viewBox="0 0 1200 700" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD-PerimateFaraActiuni" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Proces central -->
                <circle cx="600" cy="350" r="90" fill="#fff3e0" stroke="#ff9800" stroke-width="3"/>
                <text x="600" y="330" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Raport</text>
                <text x="600" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Perimate</text>
                <text x="600" y="380" text-anchor="middle" font-family="Georgia, serif" font-size="14">FÄƒrÄƒ AcÈ›iuni</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="300" width="140" height="70" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="120" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">Utilizator</text>
                <text x="120" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">ICC</text>
                <text x="120" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Selectare folder)</text>
                
                <rect x="1010" y="100" width="140" height="70" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1080" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1080" y="145" text-anchor="middle" font-family="Georgia, serif" font-size="12">Email</text>
                <text x="1080" y="160" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(per Portofolio)</text>
                
                <rect x="1010" y="530" width="140" height="70" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1080" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Output</text>
                <text x="1080" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Raport Excel)</text>
                
                <rect x="50" y="530" width="140" height="70" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="120" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="120" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Master</text>
                <text x="120" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Raport_Master)</text>
                
                <rect x="1010" y="300" width="140" height="70" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1080" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">Local</text>
                <text x="1080" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Trimitere email)</text>
                
                <!-- Fluxuri de date -->
                <path d="M 190 335 L 510 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-PerimateFaraActiuni)"/>
                <text x="350" y="330" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">SelecÈ›ie folder Master</text>
                
                <path d="M 190 565 L 510 410" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-PerimateFaraActiuni)"/>
                <text x="300" y="500" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">FiÈ™ier Raport_Master</text>
                <text x="300" y="515" font-family="Georgia, serif" font-size="10" fill="#666">(Excel, multiple sheet-uri)</text>
                
                <path d="M 690 350 L 1010 135" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-PerimateFaraActiuni)"/>
                <text x="850" y="220" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email-uri cu rapoarte</text>
                <text x="850" y="235" font-family="Georgia, serif" font-size="10" fill="#666">(per Portofolio)</text>
                
                <path d="M 690 380 L 1010 565" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-PerimateFaraActiuni)"/>
                <text x="850" y="480" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Raport Excel</text>
                <text x="850" y="495" font-family="Georgia, serif" font-size="10" fill="#666">(Salvare localÄƒ)</text>
                
                <path d="M 690 320 L 1010 335" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-PerimateFaraActiuni)"/>
                <text x="850" y="315" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email-uri cu ataÈ™amente</text>
                <text x="850" y="330" font-family="Georgia, serif" font-size="10" fill="#666">(Raport Excel)</text>
              </svg>
            </div>
            
            <h4>11.2. DFD Nivel 1 - Flux Detaliat de Procesare</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1600" height="1200" viewBox="0 0 1600 1200" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD1-PerimateFaraActiuni" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Titlu -->
                <text x="800" y="40" text-anchor="middle" font-family="Georgia, serif" font-size="22" font-weight="bold" fill="#22507a">ğŸ“‹ RAPORT PERIMATE FÄ‚RÄ‚ ACÈšIUNI - FLUXURI DE DATE DETALIATE</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="80" width="120" height="60" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="110" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Utilizator</text>
                <text x="110" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">ICC</text>
                
                <rect x="1430" y="80" width="120" height="60" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1490" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1490" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <rect x="1430" y="1100" width="120" height="60" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="1125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1490" y="1145" text-anchor="middle" font-family="Georgia, serif" font-size="11">Output</text>
                
                <rect x="50" y="1100" width="120" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="110" y="1125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="110" y="1145" text-anchor="middle" font-family="Georgia, serif" font-size="11">Master</text>
                
                <rect x="1430" y="500" width="120" height="60" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="525" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1490" y="545" text-anchor="middle" font-family="Georgia, serif" font-size="11">Local</text>
                
                <!-- Procese -->
                <circle cx="200" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">1.0</text>
                <text x="200" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="200" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">Raport_Master</text>
                
                <circle cx="400" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">2.0</text>
                <text x="400" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Concatenare</text>
                <text x="400" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">Sheet-uri</text>
                
                <circle cx="600" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">3.0</text>
                <text x="600" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Mapping</text>
                <text x="600" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">Portofolio</text>
                
                <circle cx="800" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">4.0</text>
                <text x="800" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Filtrare</text>
                <text x="800" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">Multi-Criteriu</text>
                
                <circle cx="200" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">5.0</text>
                <text x="200" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">Creare</text>
                <text x="200" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">Sheet 2</text>
                
                <circle cx="400" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">6.0</text>
                <text x="400" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">Creare</text>
                <text x="400" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">Pivot Table</text>
                
                <circle cx="600" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">7.0</text>
                <text x="600" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="600" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">Raport Excel</text>
                
                <circle cx="800" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">8.0</text>
                <text x="800" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">Filtrare</text>
                <text x="800" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">per Portofolio</text>
                
                <circle cx="1000" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="1000" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">9.0</text>
                <text x="1000" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">Trimitere</text>
                <text x="1000" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <!-- Stocuri de date -->
                <rect x="50" y="700" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="50" y1="725" x2="250" y2="725" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="150" y="745" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D1</text>
                <text x="150" y="765" text-anchor="middle" font-family="Georgia, serif" font-size="12">FiÈ™ier Master</text>
                <text x="150" y="780" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Raport_Master)</text>
                
                <rect x="600" y="700" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="600" y1="725" x2="800" y2="725" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="700" y="745" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D2</text>
                <text x="700" y="765" text-anchor="middle" font-family="Georgia, serif" font-size="12">Date Procesate</text>
                <text x="700" y="780" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(DataFrame)</text>
                
                <rect x="1150" y="700" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1150" y1="725" x2="1350" y2="725" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1250" y="745" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D3</text>
                <text x="1250" y="765" text-anchor="middle" font-family="Georgia, serif" font-size="12">Raport Final</text>
                <text x="1250" y="780" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Excel)</text>
                
                <!-- Fluxuri principale -->
                <path d="M 170 110 L 150 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="140" y="200" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">selecÈ›ie folder</text>
                
                <path d="M 150 1100 L 150 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="130" y="720" font-family="Georgia, serif" font-size="10" fill="#3576b0">Raport_Master.xlsx</text>
                
                <path d="M 250 300 L 350 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="300" y="290" font-family="Georgia, serif" font-size="10" fill="#3576b0">date sheet-uri</text>
                
                <path d="M 450 300 L 550 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="500" y="290" font-family="Georgia, serif" font-size="10" fill="#3576b0">date concatenate</text>
                
                <path d="M 650 300 L 750 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="700" y="290" font-family="Georgia, serif" font-size="10" fill="#3576b0">portofolio mapat</text>
                
                <path d="M 850 300 L 700 700" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="775" y="500" font-family="Georgia, serif" font-size="10" fill="#3576b0">date filtrate</text>
                
                <path d="M 700 700 L 650 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="675" y="500" font-family="Georgia, serif" font-size="10" fill="#3576b0">date pentru filtrare</text>
                
                <path d="M 250 500 L 350 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="300" y="490" font-family="Georgia, serif" font-size="10" fill="#3576b0">EXEC_FILE_NO + PORTFOLIO</text>
                
                <path d="M 450 500 L 550 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="500" y="490" font-family="Georgia, serif" font-size="10" fill="#3576b0">pivot table</text>
                
                <path d="M 650 500 L 1250 700" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="950" y="600" font-family="Georgia, serif" font-size="10" fill="#3576b0">raport Excel</text>
                
                <path d="M 850 500 L 1050 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="950" y="490" font-family="Georgia, serif" font-size="10" fill="#3576b0">date per portofolio</text>
                
                <path d="M 1050 500 L 1430 110" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="1240" y="300" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">email-uri cu rapoarte</text>
                
                <path d="M 1050 550 L 1430 530" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="1240" y="550" font-family="Georgia, serif" font-size="10" fill="#3576b0">comandÄƒ trimitere</text>
                
                <path d="M 1350 740 L 1490 1100" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="1420" y="920" font-family="Georgia, serif" font-size="10" fill="#3576b0">salvare localÄƒ</text>
                
                <!-- Legenda -->
                <rect x="50" y="1150" width="1500" height="40" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="5"/>
                <path d="M 100 1170 L 200 1170" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-PerimateFaraActiuni)"/>
                <text x="220" y="1175" font-family="Georgia, serif" font-size="11">Flux de date normal</text>
                <text x="800" y="1175" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Procese:</tspan> 1.0-Citire | 2.0-Concatenare | 3.0-Mapping | 4.0-Filtrare | 5.0-Creare Sheet 2 | 6.0-Pivot | 7.0-Generare | 8.0-Filtrare Portofolio | 9.0-Trimitere</text>
                <text x="800" y="1190" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Stocuri:</tspan> D1-FiÈ™ier Master | D2-Date Procesate | D3-Raport Final</text>
              </svg>
            </div>
            
            <h4>11.3. Tabel de Fluxuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Flux</th>
                  <th>Nume Flux</th>
                  <th>SursÄƒ</th>
                  <th>DestinaÈ›ie</th>
                  <th>ConÈ›inut</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>F1</td>
                  <td>SelecÈ›ie Folder Master</td>
                  <td>Utilizator ICC</td>
                  <td>Proces 1.0</td>
                  <td>SelecÈ›ie folder Master cu fiÈ™ier Excel Raport_Master</td>
                </tr>
                <tr>
                  <td>F2</td>
                  <td>FiÈ™ier Raport_Master</td>
                  <td>D1 (FiÈ™ier Master)</td>
                  <td>Proces 1.0</td>
                  <td>FiÈ™ier Excel cu multiple sheet-uri (skiprows=1, header=0 pentru fiecare sheet)</td>
                </tr>
                <tr>
                  <td>F3</td>
                  <td>Date Sheet-uri</td>
                  <td>Proces 1.0</td>
                  <td>Proces 2.0</td>
                  <td>ListÄƒ de DataFrame-uri pandas cu date din fiecare sheet (linia 1 È™tearsÄƒ, linia 2 = header)</td>
                </tr>
                <tr>
                  <td>F4</td>
                  <td>Date Concatenate</td>
                  <td>Proces 2.0</td>
                  <td>Proces 3.0</td>
                  <td>DataFrame unificat cu date concatenate È™i aliniate (toate sheet-urile combinate)</td>
                </tr>
                <tr>
                  <td>F5</td>
                  <td>Portofolio Mapat</td>
                  <td>Proces 3.0</td>
                  <td>Proces 4.0</td>
                  <td>DataFrame cu coloana portofolio redenumitÄƒ conform mapping-ului (ABSOLUT â†’ SALT BANK SA, BTD â†’ BTD CRED, etc.)</td>
                </tr>
                <tr>
                  <td>F6</td>
                  <td>Date Filtrate</td>
                  <td>Proces 4.0</td>
                  <td>D2 (Date Procesate)</td>
                  <td>DataFrame cu filtre aplicate: portofolio acceptate, rezolutie != "Sterge", REZOLUTIE_INCHIDERE blank, DATA_PREDARE_BEJ != luna curentÄƒ</td>
                </tr>
                <tr>
                  <td>F7</td>
                  <td>EXEC_FILE_NO + PORTFOLIO</td>
                  <td>D2 (Date Procesate)</td>
                  <td>Proces 5.0</td>
                  <td>DataFrame cu doar coloanele EXEC_FILE_NO È™i PORTFOLIO (fÄƒrÄƒ duplicate)</td>
                </tr>
                <tr>
                  <td>F8</td>
                  <td>Pivot Table</td>
                  <td>Proces 6.0</td>
                  <td>Proces 7.0</td>
                  <td>DataFrame pivot cu grupare dupÄƒ PORTFOLIO È™i numÄƒrare EXEC_FILE_NO (cu Grand Total)</td>
                </tr>
                <tr>
                  <td>F9</td>
                  <td>Raport Excel</td>
                  <td>Proces 7.0</td>
                  <td>D3 (Raport Final)</td>
                  <td>FiÈ™ier Excel cu 3 sheet-uri: Sheet1 (date complete), Sheet2 (EXEC_FILE_NO + PORTFOLIO), Sheet3 (Pivot Table)</td>
                </tr>
                <tr>
                  <td>F10</td>
                  <td>Date per Portofolio</td>
                  <td>D2 (Date Procesate)</td>
                  <td>Proces 8.0</td>
                  <td>DataFrame-uri separate filtrate pe fiecare portofolio (BTD CREDITE, BT Microfinantare IFN S.A, SALT BANK SA, BTD CARDURI)</td>
                </tr>
                <tr>
                  <td>F11</td>
                  <td>Email-uri cu Rapoarte</td>
                  <td>Proces 9.0</td>
                  <td>Destinatari Email</td>
                  <td>Email-uri HTML cu font Georgia 11pt, trimise per portofolio cu raport Excel filtrat ataÈ™at</td>
                </tr>
                <tr>
                  <td>F12</td>
                  <td>ComandÄƒ Trimitere</td>
                  <td>Proces 9.0</td>
                  <td>Outlook</td>
                  <td>ComandÄƒ COM pentru trimitere email prin Outlook local</td>
                </tr>
                <tr>
                  <td>F13</td>
                  <td>Salvare LocalÄƒ</td>
                  <td>D3 (Raport Final)</td>
                  <td>Folder Output</td>
                  <td>FiÈ™ier Excel salvat Ã®n Rezultate/</td>
                </tr>
              </tbody>
            </table>
            
            <h4>11.4. Tabel de Stocuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Stoc</th>
                  <th>Nume Stoc</th>
                  <th>Descriere</th>
                  <th>StructurÄƒ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>D1</td>
                  <td>FiÈ™ier Master</td>
                  <td>FiÈ™ier Excel Raport_Master din folderul Master/</td>
                  <td>Excel cu multiple sheet-uri (fiecare sheet cu skiprows=1, header=0)</td>
                </tr>
                <tr>
                  <td>D2</td>
                  <td>Date Procesate</td>
                  <td>DataFrame pandas cu date procesate È™i filtrate</td>
                  <td>DataFrame cu coloane: EXEC_FILE_NO, PORTFOLIO, REZOLUTIE, REZOLUTIE_INCHIDERE, DATA_PREDARE_BEJ, etc.</td>
                </tr>
                <tr>
                  <td>D3</td>
                  <td>Raport Final</td>
                  <td>FiÈ™ier Excel final cu raport perimate fÄƒrÄƒ acÈ›iuni</td>
                  <td>Raport_Perimate_Fara_Actiuni_[timestamp].xlsx cu 3 sheet-uri: Sheet1 (date complete), Sheet2 (EXEC_FILE_NO + PORTFOLIO fÄƒrÄƒ duplicate), Sheet3 (Pivot Table dupÄƒ PORTFOLIO)</td>
                </tr>
              </tbody>
            </table>
            
            <h4>11.5. Descriere DetaliatÄƒ a Proceselor</h4>
            <table>
              <thead>
                <tr>
                  <th>Proces</th>
                  <th>Descriere</th>
                  <th>Input</th>
                  <th>Output</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>1.0 - Citire Raport_Master</strong></td>
                  <td>CiteÈ™te fiÈ™ierul Excel Raport_Master din folderul Master/, identificÄƒ toate sheet-urile, proceseazÄƒ fiecare sheet cu skiprows=1 (È™terge linia 1) È™i header=0 (linia 2 devine cap de tabel), detecteazÄƒ engine-ul corespunzÄƒtor (.xls, .xlsx, .xlsb)</td>
                  <td>Raport_Master.xlsx (D1)</td>
                  <td>ListÄƒ de DataFrame-uri pandas (unul pentru fiecare sheet)</td>
                </tr>
                <tr>
                  <td><strong>2.0 - Concatenare Sheet-uri</strong></td>
                  <td>AliniazÄƒ coloanele tuturor sheet-urilor la coloanele primului sheet (referinÈ›Äƒ), concateneazÄƒ toate DataFrame-urile Ã®ntr-un singur DataFrame unificat</td>
                  <td>ListÄƒ de DataFrame-uri</td>
                  <td>DataFrame unificat cu toate datele concatenate</td>
                </tr>
                <tr>
                  <td><strong>3.0 - Mapping Portofolio</strong></td>
                  <td>AplicÄƒ mapping pentru coloana portofolio: È™terge liniile cu anumite menÈ›iuni (GB01, BT LEASING, AXIOMA, EOS, etc.), aplicÄƒ mapping (ABSOLUT â†’ SALT BANK SA, BTD â†’ BTD CREDITE (BTD), BT MICRO â†’ BT Microfinantare IFN S.A, etc.), pÄƒstreazÄƒ doar liniile cu denumirile acceptate (BTD CREDITE (BTD), BT Microfinantare IFN S.A, SALT BANK SA, BTD CARDURI (ERS))</td>
                  <td>DataFrame concatenat</td>
                  <td>DataFrame cu portofolio mapat È™i filtrat</td>
                </tr>
                <tr>
                  <td><strong>4.0 - Filtrare Multi-Criteriu</strong></td>
                  <td>AplicÄƒ filtre multiple: È™terge liniile cu rezolutie = "Sterge", pÄƒstreazÄƒ doar liniile cu REZOLUTIE_INCHIDERE blank (NaN, string gol, sau "NAN"), È™terge liniile cu DATA_PREDARE_BEJ din luna curentÄƒ (verificÄƒ multiple formate de datÄƒ: MM/YYYY, YYYY-MM, YYYY-MM-DD, MM.YYYY, nume lunÄƒ romÃ¢nÄƒ)</td>
                  <td>DataFrame cu portofolio mapat</td>
                  <td>DataFrame filtrat dupÄƒ toate criteriile</td>
                </tr>
                <tr>
                  <td><strong>5.0 - Creare Sheet 2</strong></td>
                  <td>CreeazÄƒ DataFrame cu doar coloanele EXEC_FILE_NO È™i PORTFOLIO, eliminÄƒ duplicatele, pregÄƒteÈ™te pentru Sheet 2</td>
                  <td>DataFrame filtrat (D2)</td>
                  <td>DataFrame cu EXEC_FILE_NO È™i PORTFOLIO (fÄƒrÄƒ duplicate)</td>
                </tr>
                <tr>
                  <td><strong>6.0 - Creare Pivot Table</strong></td>
                  <td>CreeazÄƒ pivot table: grupeazÄƒ dupÄƒ PORTFOLIO, numÄƒrÄƒ EXEC_FILE_NO, sorteazÄƒ descrescÄƒtor dupÄƒ count, adaugÄƒ rÃ¢ndul Grand Total</td>
                  <td>DataFrame Sheet 2</td>
                  <td>DataFrame pivot cu PORTFOLIO È™i Count of EXEC_FILE_NO</td>
                </tr>
                <tr>
                  <td><strong>7.0 - Generare Raport Excel</strong></td>
                  <td>GenereazÄƒ fiÈ™ier Excel cu 3 sheet-uri: Sheet1 (date complete procesate), Sheet2 (EXEC_FILE_NO + PORTFOLIO fÄƒrÄƒ duplicate), Sheet3 (Pivot Table), salveazÄƒ cu nume unic (timestamp)</td>
                  <td>DataFrame filtrat + Sheet 2 + Pivot Table</td>
                  <td>FiÈ™ier Excel salvat Ã®n D3</td>
                </tr>
                <tr>
                  <td><strong>8.0 - Filtrare per Portofolio</strong></td>
                  <td>FiltreazÄƒ datele pentru fiecare portofolio unic (BTD CREDITE (BTD), BT Microfinantare IFN S.A, SALT BANK SA, BTD CARDURI (ERS)), creeazÄƒ DataFrame separat pentru fiecare portofolio</td>
                  <td>DataFrame filtrat (D2)</td>
                  <td>DataFrame-uri separate pe portofolio</td>
                </tr>
                <tr>
                  <td><strong>9.0 - Trimitere Email</strong></td>
                  <td>Trimite email-uri prin Outlook local cÄƒtre fiecare portofolio: pentru fiecare portofolio, filtreazÄƒ raportul Excel, trimite email cu raport Excel filtrat ataÈ™at, corp email HTML cu font Georgia 11pt, mesaj personalizat per portofolio</td>
                  <td>Raport Excel (D3) + Date per portofolio</td>
                  <td>Email-uri trimise cÄƒtre destinatari prin Outlook</td>
                </tr>
              </tbody>
            </table>
            
            <h4>11.6. Note Importante</h4>
            <ul>
              <li><strong>Procesare LocalÄƒ:</strong> Toate procesele se desfÄƒÈ™oarÄƒ local pe staÈ›ia de lucru a utilizatorului ICC, fÄƒrÄƒ transmitere cÄƒtre servere externe.</li>
              <li><strong>FÄƒrÄƒ Stocare PersistentÄƒ:</strong> Datele sunt procesate exclusiv Ã®n memorie temporarÄƒ (RAM). FiÈ™ierul final este salvat doar pentru utilizare ulterioarÄƒ.</li>
              <li><strong>Procesare Multi-Sheet:</strong> Raportul proceseazÄƒ automat toate sheet-urile din fiÈ™ierul Raport_Master, combinÃ¢ndu-le Ã®ntr-un singur DataFrame pentru analizÄƒ unificatÄƒ.</li>
              <li><strong>Mapping Portofolio:</strong> Mapping-ul portofolio asigurÄƒ normalizarea denumirilor È™i filtrarea doar a portofoliilor relevante (BTD CREDITE, BT Microfinantare IFN S.A, SALT BANK SA, BTD CARDURI).</li>
              <li><strong>Filtrare Multi-Criteriu:</strong> Raportul aplicÄƒ filtre multiple pentru identificarea precisÄƒ a cazurilor perimate fÄƒrÄƒ acÈ›iuni: REZOLUTIE_INCHIDERE blank, DATA_PREDARE_BEJ != luna curentÄƒ, rezolutie != "Sterge".</li>
              <li><strong>Pivot Table:</strong> Pivot table-ul oferÄƒ o vedere agregatÄƒ a cazurilor per portofolio, permiÈ›Ã¢nd analizÄƒ rapidÄƒ a volumului de cazuri perimate fÄƒrÄƒ acÈ›iuni.</li>
              <li><strong>Email-uri Personalizate per Portofolio:</strong> Email-urile sunt trimise individual cÄƒtre fiecare portofolio cu doar rapoartele relevante pentru acel portofolio, asigurÃ¢nd confidenÈ›ialitate È™i relevanÈ›Äƒ.</li>
              <li><strong>Detectare AutomatÄƒ Engine:</strong> Raportul detecteazÄƒ automat engine-ul corespunzÄƒtor pentru citirea fiÈ™ierelor Excel (.xls â†’ xlrd, .xlsx â†’ openpyxl, .xlsb â†’ pyxlsb), permiÈ›Ã¢nd procesarea diferitelor formate.</li>
              <li><strong>Eliminare AutomatÄƒ:</strong> DupÄƒ finalizarea procesÄƒrii È™i trimiterii email-urilor, datele din memorie sunt eliminate automat, aplicaÈ›ia revenind la starea iniÈ›ialÄƒ.</li>
            </ul>
          </div>

          <!-- DFD Raport 12: Termene Lic Identif -->
          <div class="dfd-report" id="dfd-report-12">
            <h3>ğŸ  12. Raport Termene Lic Identif - Fluxuri de Date</h3>
            
            <h4>12.1. DFD Nivel 0 - DiagramÄƒ Context</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1200" height="700" viewBox="0 0 1200 700" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD-TermeneLicIdentif" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Proces central -->
                <circle cx="600" cy="350" r="90" fill="#fff3e0" stroke="#ff9800" stroke-width="3"/>
                <text x="600" y="330" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Raport</text>
                <text x="600" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Termene Lic</text>
                <text x="600" y="380" text-anchor="middle" font-family="Georgia, serif" font-size="14">Imobile Identificate</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="300" width="140" height="70" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="120" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">Utilizator</text>
                <text x="120" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">ICC</text>
                <text x="120" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Selectare folder)</text>
                
                <rect x="1010" y="100" width="140" height="70" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1080" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1080" y="145" text-anchor="middle" font-family="Georgia, serif" font-size="12">Email</text>
                <text x="1080" y="160" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(ICC, Juridic)</text>
                
                <rect x="1010" y="530" width="140" height="70" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1080" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Output</text>
                <text x="1080" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Raport Excel)</text>
                
                <rect x="50" y="530" width="140" height="70" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="120" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="120" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Master</text>
                <text x="120" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(raportGarantiiExecutareICC)</text>
                
                <rect x="1010" y="300" width="140" height="70" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1080" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">Local</text>
                <text x="1080" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Trimitere email)</text>
                
                <!-- Fluxuri de date -->
                <path d="M 190 335 L 510 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-TermeneLicIdentif)"/>
                <text x="350" y="330" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">SelecÈ›ie folder Master</text>
                
                <path d="M 190 565 L 510 410" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-TermeneLicIdentif)"/>
                <text x="300" y="500" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">FiÈ™ier raportGarantiiExecutareICC</text>
                <text x="300" y="515" font-family="Georgia, serif" font-size="10" fill="#666">(2 sheet-uri)</text>
                
                <path d="M 690 350 L 1010 135" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-TermeneLicIdentif)"/>
                <text x="850" y="220" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email cu raport</text>
                <text x="850" y="235" font-family="Georgia, serif" font-size="10" fill="#666">(Excel + grafice)</text>
                
                <path d="M 690 380 L 1010 565" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-TermeneLicIdentif)"/>
                <text x="850" y="480" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Raport Excel</text>
                <text x="850" y="495" font-family="Georgia, serif" font-size="10" fill="#666">(Salvare localÄƒ)</text>
                
                <path d="M 690 320 L 1010 335" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-TermeneLicIdentif)"/>
                <text x="850" y="315" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email cu ataÈ™amente</text>
                <text x="850" y="330" font-family="Georgia, serif" font-size="10" fill="#666">(Raport Excel)</text>
              </svg>
            </div>
            
            <h4>12.2. DFD Nivel 1 - Flux Detaliat de Procesare</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1600" height="1200" viewBox="0 0 1600 1200" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD1-TermeneLicIdentif" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Titlu -->
                <text x="800" y="40" text-anchor="middle" font-family="Georgia, serif" font-size="22" font-weight="bold" fill="#22507a">ğŸ  RAPORT TERMENE LICITAÈšIE IMOBILE IDENTIFICATE - FLUXURI DE DATE DETALIATE</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="80" width="120" height="60" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="110" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Utilizator</text>
                <text x="110" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">ICC</text>
                
                <rect x="1430" y="80" width="120" height="60" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1490" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1490" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <rect x="1430" y="1100" width="120" height="60" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="1125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1490" y="1145" text-anchor="middle" font-family="Georgia, serif" font-size="11">Output</text>
                
                <rect x="50" y="1100" width="120" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="110" y="1125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="110" y="1145" text-anchor="middle" font-family="Georgia, serif" font-size="11">Master</text>
                
                <rect x="1430" y="500" width="120" height="60" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="525" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1490" y="545" text-anchor="middle" font-family="Georgia, serif" font-size="11">Local</text>
                
                <!-- Procese -->
                <circle cx="200" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">1.0</text>
                <text x="200" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="200" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">Sheet-uri</text>
                
                <circle cx="400" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">2.0</text>
                <text x="400" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Concatenare</text>
                <text x="400" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">Sheet-uri</text>
                
                <circle cx="600" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">3.0</text>
                <text x="600" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Filtrare</text>
                <text x="600" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">CATEGORIE_GARANTIE</text>
                
                <circle cx="800" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">4.0</text>
                <text x="800" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Filtrare</text>
                <text x="800" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">AUCTION_NO</text>
                
                <circle cx="200" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">5.0</text>
                <text x="200" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">Filtrare</text>
                <text x="200" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">TASK_PRINCIPAL</text>
                
                <circle cx="400" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">6.0</text>
                <text x="400" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">Eliminare</text>
                <text x="400" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">Duplicate</text>
                
                <circle cx="600" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">7.0</text>
                <text x="600" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">CurÄƒÈ›are</text>
                <text x="600" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">AUCTION_NO</text>
                
                <circle cx="800" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">8.0</text>
                <text x="800" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="800" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">Pivot Table</text>
                
                <circle cx="1000" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="1000" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">9.0</text>
                <text x="1000" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="1000" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">Raport Excel</text>
                
                <circle cx="800" cy="700" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="690" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">10.0</text>
                <text x="800" y="705" text-anchor="middle" font-family="Georgia, serif" font-size="11">Trimitere</text>
                <text x="800" y="720" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <!-- Stocuri de date -->
                <rect x="50" y="850" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="50" y1="875" x2="250" y2="875" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="150" y="895" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D1</text>
                <text x="150" y="915" text-anchor="middle" font-family="Georgia, serif" font-size="12">FiÈ™ier Master</text>
                <text x="150" y="930" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(raportGarantiiExecutareICC)</text>
                
                <rect x="600" y="850" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="600" y1="875" x2="800" y2="875" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="700" y="895" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D2</text>
                <text x="700" y="915" text-anchor="middle" font-family="Georgia, serif" font-size="12">Date Procesate</text>
                <text x="700" y="930" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(DataFrame)</text>
                
                <rect x="1150" y="850" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1150" y1="875" x2="1350" y2="875" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1250" y="895" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D3</text>
                <text x="1250" y="915" text-anchor="middle" font-family="Georgia, serif" font-size="12">Raport Final</text>
                <text x="1250" y="930" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Excel)</text>
                
                <!-- Fluxuri principale -->
                <path d="M 170 110 L 150 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="140" y="200" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">selecÈ›ie folder</text>
                
                <path d="M 150 1100 L 150 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="130" y="720" font-family="Georgia, serif" font-size="10" fill="#3576b0">raportGarantiiExecutareICC.xlsx</text>
                
                <path d="M 250 300 L 350 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="300" y="290" font-family="Georgia, serif" font-size="10" fill="#3576b0">date sheet-uri</text>
                
                <path d="M 450 300 L 550 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="500" y="290" font-family="Georgia, serif" font-size="10" fill="#3576b0">date concatenate</text>
                
                <path d="M 650 300 L 750 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="700" y="290" font-family="Georgia, serif" font-size="10" fill="#3576b0">date filtrate categorie</text>
                
                <path d="M 850 300 L 750 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="800" y="400" font-family="Georgia, serif" font-size="10" fill="#3576b0">date cu AUCTION_NO</text>
                
                <path d="M 250 500 L 350 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="300" y="490" font-family="Georgia, serif" font-size="10" fill="#3576b0">date cu task-uri</text>
                
                <path d="M 450 500 L 550 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="500" y="490" font-family="Georgia, serif" font-size="10" fill="#3576b0">date fÄƒrÄƒ duplicate</text>
                
                <path d="M 650 500 L 750 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="700" y="490" font-family="Georgia, serif" font-size="10" fill="#3576b0">AUCTION_NO curÄƒÈ›at</text>
                
                <path d="M 850 500 L 700 850" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="775" y="680" font-family="Georgia, serif" font-size="10" fill="#3576b0">date pentru pivot</text>
                
                <path d="M 700 850 L 650 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="675" y="680" font-family="Georgia, serif" font-size="10" fill="#3576b0">date pentru pivot</text>
                
                <path d="M 850 500 L 1050 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="950" y="490" font-family="Georgia, serif" font-size="10" fill="#3576b0">pivot table</text>
                
                <path d="M 1050 500 L 1250 850" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="1150" y="680" font-family="Georgia, serif" font-size="10" fill="#3576b0">raport Excel</text>
                
                <path d="M 850 700 L 1430 110" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="1140" y="400" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">email cu raport</text>
                
                <path d="M 850 750 L 1430 530" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="1140" y="650" font-family="Georgia, serif" font-size="10" fill="#3576b0">comandÄƒ trimitere</text>
                
                <path d="M 1350 890 L 1490 1100" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="1420" y="1000" font-family="Georgia, serif" font-size="10" fill="#3576b0">salvare localÄƒ</text>
                
                <!-- Legenda -->
                <rect x="50" y="1150" width="1500" height="40" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="5"/>
                <path d="M 100 1170 L 200 1170" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-TermeneLicIdentif)"/>
                <text x="220" y="1175" font-family="Georgia, serif" font-size="11">Flux de date normal</text>
                <text x="800" y="1175" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Procese:</tspan> 1.0-Citire | 2.0-Concatenare | 3.0-Filtrare Categorie | 4.0-Filtrare AUCTION_NO | 5.0-Filtrare Task | 6.0-Eliminare Duplicate | 7.0-CurÄƒÈ›are | 8.0-Pivot | 9.0-Generare | 10.0-Trimitere</text>
                <text x="800" y="1190" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Stocuri:</tspan> D1-FiÈ™ier Master | D2-Date Procesate | D3-Raport Final</text>
              </svg>
            </div>
            
            <h4>12.3. Tabel de Fluxuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Flux</th>
                  <th>Nume Flux</th>
                  <th>SursÄƒ</th>
                  <th>DestinaÈ›ie</th>
                  <th>ConÈ›inut</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>F1</td>
                  <td>SelecÈ›ie Folder Master</td>
                  <td>Utilizator ICC</td>
                  <td>Proces 1.0</td>
                  <td>SelecÈ›ie folder Master cu fiÈ™ier Excel raportGarantiiExecutareICC</td>
                </tr>
                <tr>
                  <td>F2</td>
                  <td>FiÈ™ier raportGarantiiExecutareICC</td>
                  <td>D1 (FiÈ™ier Master)</td>
                  <td>Proces 1.0</td>
                  <td>FiÈ™ier Excel cu 2 sheet-uri (Sheet 1 cu skiprows=1, Sheet 2 fÄƒrÄƒ skiprows)</td>
                </tr>
                <tr>
                  <td>F3</td>
                  <td>Date Sheet-uri</td>
                  <td>Proces 1.0</td>
                  <td>Proces 2.0</td>
                  <td>2 DataFrame-uri pandas cu date din fiecare sheet</td>
                </tr>
                <tr>
                  <td>F4</td>
                  <td>Date Concatenate</td>
                  <td>Proces 2.0</td>
                  <td>Proces 3.0</td>
                  <td>DataFrame unificat cu date concatenate din ambele sheet-uri</td>
                </tr>
                <tr>
                  <td>F5</td>
                  <td>Date Filtrate Categorie</td>
                  <td>Proces 3.0</td>
                  <td>Proces 4.0</td>
                  <td>DataFrame filtrat dupÄƒ CATEGORIE_GARANTIE = "Bun identificat Imobil"</td>
                </tr>
                <tr>
                  <td>F6</td>
                  <td>Date cu AUCTION_NO</td>
                  <td>Proces 4.0</td>
                  <td>Proces 5.0</td>
                  <td>DataFrame filtrat cu doar cazurile care au AUCTION_NO completat (notna)</td>
                </tr>
                <tr>
                  <td>F7</td>
                  <td>Date cu Task-uri</td>
                  <td>Proces 5.0</td>
                  <td>Proces 6.0</td>
                  <td>DataFrame filtrat dupÄƒ TASK_PRINCIPAL Ã®n lista de task-uri acceptate (EXEC Decizie reluare licitatie, EXEC Pregatire licitatie, EXEC Publ vanz, EXEC PV Licitatie, etc.)</td>
                </tr>
                <tr>
                  <td>F8</td>
                  <td>Date fÄƒrÄƒ Duplicate</td>
                  <td>Proces 6.0</td>
                  <td>Proces 7.0</td>
                  <td>DataFrame cu duplicatele eliminate dupÄƒ "ID garantie Capone" (pÄƒstreazÄƒ prima apariÈ›ie)</td>
                </tr>
                <tr>
                  <td>F9</td>
                  <td>AUCTION_NO CurÄƒÈ›at</td>
                  <td>Proces 7.0</td>
                  <td>Proces 8.0</td>
                  <td>DataFrame cu coloana AUCTION_NO_CLEANED adÄƒugatÄƒ (extrage doar cifrele Ã®ntre 1-1000, eliminÄƒ "?", "reevaluare", "tert", "-")</td>
                </tr>
                <tr>
                  <td>F10</td>
                  <td>Pivot Table</td>
                  <td>Proces 8.0</td>
                  <td>Proces 9.0</td>
                  <td>DataFrame pivot cu intervale de 10 (1-10, 11-20, ..., 101-110) pentru AUCTION_NO_CLEANED, cu numÄƒr active È™i procentaje</td>
                </tr>
                <tr>
                  <td>F11</td>
                  <td>Raport Excel</td>
                  <td>Proces 9.0</td>
                  <td>D3 (Raport Final)</td>
                  <td>FiÈ™ier Excel formatat cu font Georgia 11: Raport_Imobile_Identificate_Final.xlsx cu 2 sheet-uri (ImobileIdentificate_Data, Pivot_Intervale_Imobile)</td>
                </tr>
                <tr>
                  <td>F12</td>
                  <td>Email cu Raport</td>
                  <td>Proces 10.0</td>
                  <td>Destinatari Email</td>
                  <td>Email HTML cu font Georgia 11pt, tabel pivot pentru imobile identificate, grafice comparativ (garantii vs imobile identificate), ataÈ™ament Excel</td>
                </tr>
                <tr>
                  <td>F13</td>
                  <td>ComandÄƒ Trimitere</td>
                  <td>Proces 10.0</td>
                  <td>Outlook</td>
                  <td>ComandÄƒ COM pentru trimitere email prin Outlook local</td>
                </tr>
                <tr>
                  <td>F14</td>
                  <td>Salvare LocalÄƒ</td>
                  <td>D3 (Raport Final)</td>
                  <td>Folder Output</td>
                  <td>FiÈ™ier Excel salvat Ã®n rapoarte_generate/</td>
                </tr>
              </tbody>
            </table>
            
            <h4>12.4. Tabel de Stocuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Stoc</th>
                  <th>Nume Stoc</th>
                  <th>Descriere</th>
                  <th>StructurÄƒ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>D1</td>
                  <td>FiÈ™ier Master</td>
                  <td>FiÈ™ier Excel raportGarantiiExecutareICC din folderul Master/</td>
                  <td>Excel cu 2 sheet-uri: Sheet 1 (skiprows=1 pentru a È™terge Report Title), Sheet 2 (fÄƒrÄƒ skiprows)</td>
                </tr>
                <tr>
                  <td>D2</td>
                  <td>Date Procesate</td>
                  <td>DataFrame pandas cu date procesate È™i filtrate</td>
                  <td>DataFrame cu coloane: ID garantie Capone, CATEGORIE_GARANTIE, AUCTION_NO, AUCTION_NO_CLEANED, TASK_PRINCIPAL, etc.</td>
                </tr>
                <tr>
                  <td>D3</td>
                  <td>Raport Final</td>
                  <td>FiÈ™ier Excel final cu raport imobile identificate</td>
                  <td>Raport_Imobile_Identificate_Final.xlsx cu 2 sheet-uri: ImobileIdentificate_Data (date complete), Pivot_Intervale_Imobile (pivot table cu intervale 1-110 È™i procentaje)</td>
                </tr>
              </tbody>
            </table>
            
            <h4>12.5. Descriere DetaliatÄƒ a Proceselor</h4>
            <table>
              <thead>
                <tr>
                  <th>Proces</th>
                  <th>Descriere</th>
                  <th>Input</th>
                  <th>Output</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>1.0 - Citire Sheet-uri</strong></td>
                  <td>CiteÈ™te fiÈ™ierul raportGarantiiExecutareICC din folderul Master/, identificÄƒ cele 2 sheet-uri, proceseazÄƒ Sheet 1 cu skiprows=1 (È™terge Report Title), proceseazÄƒ Sheet 2 fÄƒrÄƒ skiprows, detecteazÄƒ engine-ul corespunzÄƒtor (.xls, .xlsx, .xlsb)</td>
                  <td>raportGarantiiExecutareICC.xlsx (D1)</td>
                  <td>2 DataFrame-uri pandas</td>
                </tr>
                <tr>
                  <td><strong>2.0 - Concatenare Sheet-uri</strong></td>
                  <td>ConcateneazÄƒ cele 2 DataFrame-uri Ã®ntr-un singur DataFrame unificat, pÄƒstreazÄƒ toate coloanele</td>
                  <td>2 DataFrame-uri</td>
                  <td>DataFrame unificat</td>
                </tr>
                <tr>
                  <td><strong>3.0 - Filtrare CATEGORIE_GARANTIE</strong></td>
                  <td>FiltreazÄƒ datele dupÄƒ CATEGORIE_GARANTIE = "Bun identificat Imobil" (case-insensitive), pÄƒstreazÄƒ doar cazurile cu aceastÄƒ categorie</td>
                  <td>DataFrame concatenat</td>
                  <td>DataFrame filtrat dupÄƒ categorie</td>
                </tr>
                <tr>
                  <td><strong>4.0 - Filtrare AUCTION_NO</strong></td>
                  <td>FiltreazÄƒ datele pentru a pÄƒstra doar cazurile care au AUCTION_NO completat (notna), eliminÄƒ cazurile cu AUCTION_NO gol</td>
                  <td>DataFrame filtrat dupÄƒ categorie</td>
                  <td>DataFrame cu AUCTION_NO completat</td>
                </tr>
                <tr>
                  <td><strong>5.0 - Filtrare TASK_PRINCIPAL</strong></td>
                  <td>FiltreazÄƒ datele dupÄƒ TASK_PRINCIPAL Ã®n lista de task-uri acceptate: EXEC Decizie reluare licitatie (TERTI), EXEC Decizie reluare licitatie IMOB, EXEC Gen cerere reluare licitatie & informare BEJ, EXEC Generare cerere staruire si info BEJ, EXEC Pregatire licitatie (TERTI), EXEC Pregatire licitatie IMOB, EXEC Publ vanz, data, detalii & atasament (TERTI), EXEC Publicatie vanzare, data, detalii & atasament, EXEC PV Licitatie (TERTI), EXEC PV licitatie IMOB</td>
                  <td>DataFrame cu AUCTION_NO</td>
                  <td>DataFrame filtrat dupÄƒ task-uri acceptate</td>
                </tr>
                <tr>
                  <td><strong>6.0 - Eliminare Duplicate</strong></td>
                  <td>EliminÄƒ duplicatele dupÄƒ coloana "ID garantie Capone", pÄƒstreazÄƒ prima apariÈ›ie (keep='first'), calculeazÄƒ statistici despre duplicate eliminate</td>
                  <td>DataFrame filtrat dupÄƒ task-uri</td>
                  <td>DataFrame fÄƒrÄƒ duplicate</td>
                </tr>
                <tr>
                  <td><strong>7.0 - CurÄƒÈ›are AUCTION_NO</strong></td>
                  <td>CurÄƒÈ›Äƒ coloana AUCTION_NO: extrage doar cifrele din valoare, pÄƒstreazÄƒ doar numere Ã®ntre 1-1000, eliminÄƒ valori invalide ("?", "reevaluare", "tert", "-"), creeazÄƒ coloana AUCTION_NO_CLEANED cu valorile curÄƒÈ›ate, filtreazÄƒ pentru a pÄƒstra doar cazurile cu AUCTION_NO_CLEANED valid</td>
                  <td>DataFrame fÄƒrÄƒ duplicate</td>
                  <td>DataFrame cu AUCTION_NO_CLEANED valid (1-1000)</td>
                </tr>
                <tr>
                  <td><strong>8.0 - Generare Pivot Table</strong></td>
                  <td>CreeazÄƒ pivot table cu intervale de 10 pentru AUCTION_NO_CLEANED: grupeazÄƒ Ã®n intervale (1-10, 11-20, ..., 101-110), calculeazÄƒ numÄƒr active per interval, calculeazÄƒ procentaje, afiÈ™eazÄƒ toate intervalele chiar dacÄƒ sunt goale, adaugÄƒ rÃ¢ndul Grand Total</td>
                  <td>DataFrame cu AUCTION_NO_CLEANED</td>
                  <td>DataFrame pivot cu coloane: Numar termene licitatii, Nr active, Procent (%)</td>
                </tr>
                <tr>
                  <td><strong>9.0 - Generare Raport Excel</strong></td>
                  <td>GenereazÄƒ fiÈ™ier Excel formatat cu font Georgia 11: salveazÄƒ DataFrame-ul filtrat Ã®n sheet "ImobileIdentificate_Data", salveazÄƒ pivot table Ã®n sheet "Pivot_Intervale_Imobile", aplicÄƒ formatare profesionalÄƒ, salveazÄƒ cu nume: Raport_Imobile_Identificate_Final.xlsx</td>
                  <td>DataFrame filtrat + Pivot Table</td>
                  <td>FiÈ™ier Excel formatat salvat Ã®n D3</td>
                </tr>
                <tr>
                  <td><strong>10.0 - Trimitere Email</strong></td>
                  <td>Trimite email prin Outlook local cÄƒtre destinatari (juridic@iccollect.ro, rpa@iccollect.ro): genereazÄƒ corp email HTML cu font Georgia 11pt, include tabel pivot pentru imobile identificate, include grafice comparativ (garantii vs imobile identificate), ataÈ™eazÄƒ fiÈ™ierul Excel generat</td>
                  <td>Raport Excel (D3)</td>
                  <td>Email trimis cÄƒtre destinatari prin Outlook</td>
                </tr>
              </tbody>
            </table>
            
            <h4>12.6. Note Importante</h4>
            <ul>
              <li><strong>Procesare LocalÄƒ:</strong> Toate procesele se desfÄƒÈ™oarÄƒ local pe staÈ›ia de lucru a utilizatorului ICC, fÄƒrÄƒ transmitere cÄƒtre servere externe.</li>
              <li><strong>FÄƒrÄƒ Stocare PersistentÄƒ:</strong> Datele sunt procesate exclusiv Ã®n memorie temporarÄƒ (RAM). FiÈ™ierul final este salvat doar pentru utilizare ulterioarÄƒ.</li>
              <li><strong>Filtrare Multi-Criteriu:</strong> Raportul aplicÄƒ filtre multiple pentru identificarea precisÄƒ a imobilelor identificate: CATEGORIE_GARANTIE = "Bun identificat Imobil", AUCTION_NO completat, TASK_PRINCIPAL Ã®n lista acceptatÄƒ.</li>
              <li><strong>Eliminare Duplicate:</strong> Eliminarea duplicatelor dupÄƒ "ID garantie Capone" asigurÄƒ cÄƒ fiecare imobil identificat apare o singurÄƒ datÄƒ Ã®n raport, permiÈ›Ã¢nd analizÄƒ corectÄƒ.</li>
              <li><strong>CurÄƒÈ›are AUCTION_NO:</strong> CurÄƒÈ›area coloanei AUCTION_NO pÄƒstreazÄƒ doar numerele valide (1-1000), eliminÃ¢nd caractere speciale È™i valori invalide, asigurÃ¢nd acurateÈ›e Ã®n analizÄƒ.</li>
              <li><strong>Pivot Table cu Intervale:</strong> Pivot table-ul grupeazÄƒ termenele de licitaÈ›ie Ã®n intervale de 10 (1-10, 11-20, ..., 101-110), afiÈ™Ã¢nd toate intervalele chiar dacÄƒ sunt goale, permiÈ›Ã¢nd analizÄƒ completÄƒ a distribuÈ›iei.</li>
              <li><strong>Formatare ProfesionalÄƒ:</strong> Raportul Excel este formatat cu font Georgia 11, asigurÃ¢nd consistenÈ›Äƒ cu celelalte rapoarte È™i prezentare profesionalÄƒ.</li>
              <li><strong>Email cu Grafice Comparativ:</strong> Email-ul include grafice comparativ Ã®ntre garantii BT È™i imobile identificate, oferind o vedere completÄƒ a termenelor de licitaÈ›ie.</li>
              <li><strong>Eliminare AutomatÄƒ:</strong> DupÄƒ finalizarea procesÄƒrii È™i trimiterii email-ului, datele din memorie sunt eliminate automat, aplicaÈ›ia revenind la starea iniÈ›ialÄƒ.</li>
            </ul>
          </div>

          <!-- DFD Raport 13: Dosare Active -->
          <div class="dfd-report" id="dfd-report-13">
            <h3>ğŸ“Š 13. Raport Dosare Active - Fluxuri de Date</h3>
            
            <h4>13.1. DFD Nivel 0 - DiagramÄƒ Context</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1200" height="700" viewBox="0 0 1200 700" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD-DosareActive" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Proces central -->
                <circle cx="600" cy="350" r="90" fill="#fff3e0" stroke="#ff9800" stroke-width="3"/>
                <text x="600" y="330" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Raport</text>
                <text x="600" y="355" text-anchor="middle" font-family="Georgia, serif" font-size="18" font-weight="bold">Dosare</text>
                <text x="600" y="380" text-anchor="middle" font-family="Georgia, serif" font-size="14">Active</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="300" width="140" height="70" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="120" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">Utilizator</text>
                <text x="120" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">ICC</text>
                <text x="120" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Selectare folder)</text>
                
                <rect x="1010" y="100" width="140" height="70" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1080" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1080" y="145" text-anchor="middle" font-family="Georgia, serif" font-size="12">Email</text>
                <text x="1080" y="160" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(per Creditor)</text>
                
                <rect x="1010" y="530" width="140" height="70" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1080" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Output</text>
                <text x="1080" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Rapoarte Excel)</text>
                
                <rect x="50" y="530" width="140" height="70" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="120" y="555" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="120" y="575" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Master</text>
                <text x="120" y="590" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Raport_Master)</text>
                
                <rect x="1010" y="300" width="140" height="70" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1080" y="325" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1080" y="345" text-anchor="middle" font-family="Georgia, serif" font-size="12">Local</text>
                <text x="1080" y="360" text-anchor="middle" font-family="Georgia, serif" font-size="11" fill="#666">(Trimitere email)</text>
                
                <!-- Fluxuri de date -->
                <path d="M 190 335 L 510 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-DosareActive)"/>
                <text x="350" y="330" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">SelecÈ›ie folder Master</text>
                
                <path d="M 190 565 L 510 410" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-DosareActive)"/>
                <text x="300" y="500" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">FiÈ™ier Raport_Master</text>
                <text x="300" y="515" font-family="Georgia, serif" font-size="10" fill="#666">(2 sheet-uri)</text>
                
                <path d="M 690 350 L 1010 135" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-DosareActive)"/>
                <text x="850" y="220" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email-uri cu rapoarte</text>
                <text x="850" y="235" font-family="Georgia, serif" font-size="10" fill="#666">(per Creditor)</text>
                
                <path d="M 690 380 L 1010 565" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-DosareActive)"/>
                <text x="850" y="480" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Rapoarte Excel</text>
                <text x="850" y="495" font-family="Georgia, serif" font-size="10" fill="#666">(Salvare localÄƒ)</text>
                
                <path d="M 690 320 L 1010 335" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD-DosareActive)"/>
                <text x="850" y="315" font-family="Georgia, serif" font-size="12" fill="#3576b0" font-weight="bold">Email-uri cu ataÈ™amente</text>
                <text x="850" y="330" font-family="Georgia, serif" font-size="10" fill="#666">(Raport Excel parolat)</text>
              </svg>
            </div>
            
            <h4>13.2. DFD Nivel 1 - Flux Detaliat de Procesare</h4>
            <div class="diagram-container" style="margin: 30px 0;">
              <svg width="1600" height="1400" viewBox="0 0 1600 1400" style="display:block; margin: 0 auto; background: #fafafa; border-radius: 8px;">
                <defs>
                  <marker id="arrowDFD1-DosareActive" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#3576b0" />
                  </marker>
                </defs>
                
                <!-- Titlu -->
                <text x="800" y="40" text-anchor="middle" font-family="Georgia, serif" font-size="22" font-weight="bold" fill="#22507a">ğŸ“Š RAPORT DOSARE ACTIVE - FLUXURI DE DATE DETALIATE</text>
                
                <!-- EntitÄƒÈ›i externe -->
                <rect x="50" y="80" width="120" height="60" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
                <text x="110" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Utilizator</text>
                <text x="110" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">ICC</text>
                
                <rect x="1430" y="80" width="120" height="60" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="1490" y="105" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Destinatari</text>
                <text x="1490" y="125" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <rect x="1430" y="1300" width="120" height="60" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="1325" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="1490" y="1345" text-anchor="middle" font-family="Georgia, serif" font-size="11">Output</text>
                
                <rect x="50" y="1300" width="120" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="110" y="1325" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Folder</text>
                <text x="110" y="1345" text-anchor="middle" font-family="Georgia, serif" font-size="11">Master</text>
                
                <rect x="1430" y="500" width="120" height="60" fill="#e1bee7" stroke="#9c27b0" stroke-width="2" rx="5"/>
                <text x="1490" y="525" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">Outlook</text>
                <text x="1490" y="545" text-anchor="middle" font-family="Georgia, serif" font-size="11">Local</text>
                
                <!-- Procese -->
                <circle cx="200" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">1.0</text>
                <text x="200" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Citire</text>
                <text x="200" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">Sheet-uri</text>
                
                <circle cx="400" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">2.0</text>
                <text x="400" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Concatenare</text>
                <text x="400" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">Sheet-uri</text>
                
                <circle cx="600" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">3.0</text>
                <text x="600" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Filtrare</text>
                <text x="600" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">PORTFOLIO</text>
                
                <circle cx="800" cy="300" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="290" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">4.0</text>
                <text x="800" y="305" text-anchor="middle" font-family="Georgia, serif" font-size="11">Completare</text>
                <text x="800" y="320" text-anchor="middle" font-family="Georgia, serif" font-size="11">DATA_PREDARE_BEJ</text>
                
                <circle cx="200" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="200" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">5.0</text>
                <text x="200" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">Formatare</text>
                <text x="200" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">Font Georgia</text>
                
                <circle cx="400" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="400" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">6.0</text>
                <text x="400" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">CurÄƒÈ›are</text>
                <text x="400" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">PORTFOLIO</text>
                
                <circle cx="600" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="600" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">7.0</text>
                <text x="600" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">Filtrare</text>
                <text x="600" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">per Creditor</text>
                
                <circle cx="800" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">8.0</text>
                <text x="800" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">Separare</text>
                <text x="800" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">Active/Ãnchise</text>
                
                <circle cx="1000" cy="500" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="1000" y="490" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">9.0</text>
                <text x="1000" y="505" text-anchor="middle" font-family="Georgia, serif" font-size="11">Generare</text>
                <text x="1000" y="520" text-anchor="middle" font-family="Georgia, serif" font-size="11">Raport Excel</text>
                
                <circle cx="800" cy="700" r="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2.5"/>
                <text x="800" y="690" text-anchor="middle" font-family="Georgia, serif" font-size="13" font-weight="bold">10.0</text>
                <text x="800" y="705" text-anchor="middle" font-family="Georgia, serif" font-size="11">Trimitere</text>
                <text x="800" y="720" text-anchor="middle" font-family="Georgia, serif" font-size="11">Email</text>
                
                <!-- Stocuri de date -->
                <rect x="50" y="900" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="50" y1="925" x2="250" y2="925" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="150" y="945" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D1</text>
                <text x="150" y="965" text-anchor="middle" font-family="Georgia, serif" font-size="12">FiÈ™ier Master</text>
                <text x="150" y="980" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Raport_Master)</text>
                
                <rect x="600" y="900" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="600" y1="925" x2="800" y2="925" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="700" y="945" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D2</text>
                <text x="700" y="965" text-anchor="middle" font-family="Georgia, serif" font-size="12">Date Procesate</text>
                <text x="700" y="980" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(DataFrame)</text>
                
                <rect x="1150" y="900" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2.5"/>
                <line x1="1150" y1="925" x2="1350" y2="925" stroke="#9c27b0" stroke-width="2.5"/>
                <text x="1250" y="945" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="bold">D3</text>
                <text x="1250" y="965" text-anchor="middle" font-family="Georgia, serif" font-size="12">Rapoarte Finale</text>
                <text x="1250" y="980" text-anchor="middle" font-family="Georgia, serif" font-size="10" fill="#666">(Excel parolat)</text>
                
                <!-- Fluxuri principale -->
                <path d="M 170 110 L 150 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="140" y="200" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">selecÈ›ie folder</text>
                
                <path d="M 150 1300 L 150 350" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="130" y="820" font-family="Georgia, serif" font-size="10" fill="#3576b0">Raport_Master.xlsx</text>
                
                <path d="M 250 300 L 350 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="300" y="290" font-family="Georgia, serif" font-size="10" fill="#3576b0">date sheet-uri</text>
                
                <path d="M 450 300 L 550 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="500" y="290" font-family="Georgia, serif" font-size="10" fill="#3576b0">date concatenate</text>
                
                <path d="M 650 300 L 750 300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="700" y="290" font-family="Georgia, serif" font-size="10" fill="#3576b0">date filtrate</text>
                
                <path d="M 850 300 L 750 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="800" y="400" font-family="Georgia, serif" font-size="10" fill="#3576b0">date cu DATA_PREDARE_BEJ</text>
                
                <path d="M 250 500 L 350 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="300" y="490" font-family="Georgia, serif" font-size="10" fill="#3576b0">date formatate</text>
                
                <path d="M 450 500 L 550 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="500" y="490" font-family="Georgia, serif" font-size="10" fill="#3576b0">portofolio curÄƒÈ›at</text>
                
                <path d="M 650 500 L 700 900" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="675" y="700" font-family="Georgia, serif" font-size="10" fill="#3576b0">date procesate</text>
                
                <path d="M 700 900 L 650 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="675" y="700" font-family="Georgia, serif" font-size="10" fill="#3576b0">date pentru filtrare</text>
                
                <path d="M 850 500 L 1050 500" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="950" y="490" font-family="Georgia, serif" font-size="10" fill="#3576b0">dosare active/Ã®nchise</text>
                
                <path d="M 1050 500 L 1250 900" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="1150" y="700" font-family="Georgia, serif" font-size="10" fill="#3576b0">raport Excel</text>
                
                <path d="M 850 700 L 1430 110" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="1140" y="400" font-family="Georgia, serif" font-size="11" fill="#3576b0" font-weight="bold">email-uri cu rapoarte</text>
                
                <path d="M 850 750 L 1430 530" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="1140" y="650" font-family="Georgia, serif" font-size="10" fill="#3576b0">comandÄƒ trimitere</text>
                
                <path d="M 1350 940 L 1490 1300" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="1420" y="1120" font-family="Georgia, serif" font-size="10" fill="#3576b0">salvare localÄƒ</text>
                
                <!-- Legenda -->
                <rect x="50" y="1350" width="1500" height="40" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="5"/>
                <path d="M 100 1370 L 200 1370" stroke="#3576b0" stroke-width="2.5" fill="none" marker-end="url(#arrowDFD1-DosareActive)"/>
                <text x="220" y="1375" font-family="Georgia, serif" font-size="11">Flux de date normal</text>
                <text x="800" y="1375" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Procese:</tspan> 1.0-Citire | 2.0-Concatenare | 3.0-Filtrare | 4.0-Completare | 5.0-Formatare | 6.0-CurÄƒÈ›are | 7.0-Filtrare Creditor | 8.0-Separare | 9.0-Generare | 10.0-Trimitere</text>
                <text x="800" y="1390" font-family="Georgia, serif" font-size="11"><tspan font-weight="bold">Stocuri:</tspan> D1-FiÈ™ier Master | D2-Date Procesate | D3-Rapoarte Finale</text>
              </svg>
            </div>
            
            <h4>13.3. Tabel de Fluxuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Flux</th>
                  <th>Nume Flux</th>
                  <th>SursÄƒ</th>
                  <th>DestinaÈ›ie</th>
                  <th>ConÈ›inut</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>F1</td>
                  <td>SelecÈ›ie Folder Master</td>
                  <td>Utilizator ICC</td>
                  <td>Proces 1.0</td>
                  <td>SelecÈ›ie folder Master cu fiÈ™ier Excel Raport_Master</td>
                </tr>
                <tr>
                  <td>F2</td>
                  <td>FiÈ™ier Raport_Master</td>
                  <td>D1 (FiÈ™ier Master)</td>
                  <td>Proces 1.0</td>
                  <td>FiÈ™ier Excel cu 2 sheet-uri (Sheet 1 cu skiprows=1, Sheet 2 fÄƒrÄƒ skiprows)</td>
                </tr>
                <tr>
                  <td>F3</td>
                  <td>Date Sheet-uri</td>
                  <td>Proces 1.0</td>
                  <td>Proces 2.0</td>
                  <td>2 DataFrame-uri pandas cu date din fiecare sheet</td>
                </tr>
                <tr>
                  <td>F4</td>
                  <td>Date Concatenate</td>
                  <td>Proces 2.0</td>
                  <td>Proces 3.0</td>
                  <td>DataFrame unificat cu date concatenate din ambele sheet-uri</td>
                </tr>
                <tr>
                  <td>F5</td>
                  <td>Date Filtrate</td>
                  <td>Proces 3.0</td>
                  <td>Proces 4.0</td>
                  <td>DataFrame filtrat dupÄƒ PORTFOLIO (eliminÄƒ BANCPOST, GB01, AXIOMA, CdF, Idea Leasing, GDPR, blank)</td>
                </tr>
                <tr>
                  <td>F6</td>
                  <td>Date cu DATA_PREDARE_BEJ</td>
                  <td>Proces 4.0</td>
                  <td>Proces 5.0</td>
                  <td>DataFrame cu DATA_PREDARE_BEJ completat pentru cazurile cu ambele cÃ¢mpuri blank (foloseÈ™te DATA_RAPORT)</td>
                </tr>
                <tr>
                  <td>F7</td>
                  <td>Date Formate</td>
                  <td>Proces 5.0</td>
                  <td>Proces 6.0</td>
                  <td>DataFrame cu font Georgia 11 aplicat È™i date formatate (dd.mm.yyyy)</td>
                </tr>
                <tr>
                  <td>F8</td>
                  <td>Portofolio CurÄƒÈ›at</td>
                  <td>Proces 6.0</td>
                  <td>D2 (Date Procesate)</td>
                  <td>DataFrame cu PORTFOLIO curÄƒÈ›at (eliminÄƒ duplicate cu "|") È™i redenumit conform mapping-ului (ABSOLUT â†’ SALT, BTD â†’ BTD CRED, etc.)</td>
                </tr>
                <tr>
                  <td>F9</td>
                  <td>Date per Creditor</td>
                  <td>D2 (Date Procesate)</td>
                  <td>Proces 7.0</td>
                  <td>DataFrame-uri separate filtrate pe fiecare creditor (EOS, BTD CREDITE, BTD CARDURI, SALT, BT MIC, BT LEASING)</td>
                </tr>
                <tr>
                  <td>F10</td>
                  <td>Dosare Active/Ãnchise</td>
                  <td>Proces 8.0</td>
                  <td>Proces 9.0</td>
                  <td>DataFrame-uri separate: dosare active (fÄƒrÄƒ DATA_INCHEIERE_DOSAR È™i DATA_PREDARE_BEJ != luna curentÄƒ) È™i dosare Ã®nchise (cu DATA_INCHEIERE_DOSAR)</td>
                </tr>
                <tr>
                  <td>F11</td>
                  <td>Raport Excel</td>
                  <td>Proces 9.0</td>
                  <td>D3 (Rapoarte Finale)</td>
                  <td>FiÈ™ier Excel parolat (parola "administrare") cu 2 sheet-uri: "ds active" È™i "ds inchise", formatat cu font Georgia 11</td>
                </tr>
                <tr>
                  <td>F12</td>
                  <td>Email-uri cu Rapoarte</td>
                  <td>Proces 10.0</td>
                  <td>Destinatari Email</td>
                  <td>Email-uri HTML cu font Georgia 11pt, trimise per creditor cu raport Excel parolat ataÈ™at</td>
                </tr>
                <tr>
                  <td>F13</td>
                  <td>ComandÄƒ Trimitere</td>
                  <td>Proces 10.0</td>
                  <td>Outlook</td>
                  <td>ComandÄƒ COM pentru trimitere email prin Outlook local</td>
                </tr>
                <tr>
                  <td>F14</td>
                  <td>Salvare LocalÄƒ</td>
                  <td>D3 (Rapoarte Finale)</td>
                  <td>Folder Output</td>
                  <td>FiÈ™iere Excel parolate salvate Ã®n Rapoarte_Creditori/</td>
                </tr>
              </tbody>
            </table>
            
            <h4>13.4. Tabel de Stocuri de Date</h4>
            <table>
              <thead>
                <tr>
                  <th>ID Stoc</th>
                  <th>Nume Stoc</th>
                  <th>Descriere</th>
                  <th>StructurÄƒ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>D1</td>
                  <td>FiÈ™ier Master</td>
                  <td>FiÈ™ier Excel Raport_Master din folderul Master/</td>
                  <td>Excel cu 2 sheet-uri: Sheet 1 (skiprows=1), Sheet 2 (fÄƒrÄƒ skiprows)</td>
                </tr>
                <tr>
                  <td>D2</td>
                  <td>Date Procesate</td>
                  <td>DataFrame pandas cu date procesate È™i filtrate</td>
                  <td>DataFrame cu coloane: PORTFOLIO, NUME_TITULAR, DATA_PREDARE_BEJ, DATA_INCHEIERE_DOSAR, etc.</td>
                </tr>
                <tr>
                  <td>D3</td>
                  <td>Rapoarte Finale</td>
                  <td>FiÈ™iere Excel finale cu rapoarte dosare active per creditor</td>
                  <td>Raport_EOS.xlsx, Raport_BTD_CREDITE.xlsx, Raport_BTD_CARDURI.xlsx, Raport_SALT.xlsx, Raport_BT_MIC.xlsx, Raport_BT_LEASING.xlsx (toate parolate cu "administrare")</td>
                </tr>
              </tbody>
            </table>
            
            <h4>13.5. Descriere DetaliatÄƒ a Proceselor</h4>
            <table>
              <thead>
                <tr>
                  <th>Proces</th>
                  <th>Descriere</th>
                  <th>Input</th>
                  <th>Output</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>1.0 - Citire Sheet-uri</strong></td>
                  <td>CiteÈ™te fiÈ™ierul Raport_Master din folderul Master/, identificÄƒ cele 2 sheet-uri, proceseazÄƒ Sheet 1 cu skiprows=1 (È™terge primul rÃ¢nd), proceseazÄƒ Sheet 2 fÄƒrÄƒ skiprows</td>
                  <td>Raport_Master.xlsx (D1)</td>
                  <td>2 DataFrame-uri pandas</td>
                </tr>
                <tr>
                  <td><strong>2.0 - Concatenare Sheet-uri</strong></td>
                  <td>ConcateneazÄƒ cele 2 DataFrame-uri Ã®ntr-un singur DataFrame unificat, pÄƒstreazÄƒ toate coloanele</td>
                  <td>2 DataFrame-uri</td>
                  <td>DataFrame unificat</td>
                </tr>
                <tr>
                  <td><strong>3.0 - Filtrare PORTFOLIO</strong></td>
                  <td>FiltreazÄƒ datele dupÄƒ PORTFOLIO: eliminÄƒ BANCPOST, GB01, AXIOMA, CdF, Idea Leasing, GDPR, blank (NaN, string gol, "BLANKS")</td>
                  <td>DataFrame concatenat</td>
                  <td>DataFrame filtrat</td>
                </tr>
                <tr>
                  <td><strong>4.0 - Completare DATA_PREDARE_BEJ</strong></td>
                  <td>CompleteazÄƒ DATA_PREDARE_BEJ pentru cazurile cu ambele cÃ¢mpuri blank (DATA_PREDARE_BEJ È™i DATA_INCHEIERE_DOSAR): foloseÈ™te data din prima coloanÄƒ DATA_RAPORT sau data curentÄƒ</td>
                  <td>DataFrame filtrat</td>
                  <td>DataFrame cu DATA_PREDARE_BEJ completat</td>
                </tr>
                <tr>
                  <td><strong>5.0 - Formatare Font Georgia</strong></td>
                  <td>AplicÄƒ font Georgia 11 pe toate celulele, formateazÄƒ coloanele de tip datÄƒ cu formatul dd.mm.yyyy (MM/DD/YYYY Ã®n Excel), salveazÄƒ fiÈ™ier temporar</td>
                  <td>DataFrame cu date completate</td>
                  <td>FiÈ™ier Excel formatat (Raport_Master_Concatenat_Filtrat.xlsx)</td>
                </tr>
                <tr>
                  <td><strong>6.0 - CurÄƒÈ›are PORTFOLIO</strong></td>
                  <td>CurÄƒÈ›Äƒ coloana PORTFOLIO: eliminÄƒ duplicate cu "|" (pÄƒstreazÄƒ doar valori unice), aplicÄƒ mapping (ABSOLUT â†’ SALT, BTD â†’ BTD CRED, ERS â†’ BTD CARD, BT MICROFINANTARE IFN S.A â†’ BT MIC, BT LEASING â†’ BT LEASIN, IDEA LEASING â†’ AVANT)</td>
                  <td>FiÈ™ier Excel formatat</td>
                  <td>DataFrame cu PORTFOLIO curÄƒÈ›at È™i redenumit</td>
                </tr>
                <tr>
                  <td><strong>7.0 - Filtrare per Creditor</strong></td>
                  <td>FiltreazÄƒ datele pentru fiecare creditor unic (EOS, BTD CREDITE, BTD CARDURI, SALT, BT MIC, BT LEASING), creeazÄƒ DataFrame separat pentru fiecare creditor</td>
                  <td>DataFrame cu PORTFOLIO curÄƒÈ›at (D2)</td>
                  <td>DataFrame-uri separate pe creditor</td>
                </tr>
                <tr>
                  <td><strong>8.0 - Separare Active/Ãnchise</strong></td>
                  <td>SeparÄƒ dosarele active de cele Ã®nchise pentru fiecare creditor: dosare active = fÄƒrÄƒ DATA_INCHEIERE_DOSAR È™i DATA_PREDARE_BEJ != luna curentÄƒ, dosare Ã®nchise = cu DATA_INCHEIERE_DOSAR completatÄƒ</td>
                  <td>DataFrame-uri per creditor</td>
                  <td>2 DataFrame-uri per creditor: dosare active È™i dosare Ã®nchise</td>
                </tr>
                <tr>
                  <td><strong>9.0 - Generare Raport Excel</strong></td>
                  <td>GenereazÄƒ fiÈ™ier Excel parolat (parola "administrare") cu 2 sheet-uri: "ds active" (dosare active) È™i "ds inchise" (dosare Ã®nchise), aplicÄƒ formatare profesionalÄƒ (font Georgia 11, header-uri colorate, border-uri), cripteazÄƒ cu msoffcrypto-tool</td>
                  <td>DataFrame-uri active/Ã®nchise per creditor</td>
                  <td>FiÈ™ier Excel parolat salvat Ã®n D3</td>
                </tr>
                <tr>
                  <td><strong>10.0 - Trimitere Email</strong></td>
                  <td>Trimite email prin Outlook local cÄƒtre fiecare creditor: pentru fiecare creditor, trimite email cu raport Excel parolat ataÈ™at, corp email HTML cu font Georgia 11pt, mesaj personalizat per creditor</td>
                  <td>Raport Excel parolat (D3)</td>
                  <td>Email-uri trimise cÄƒtre destinatari prin Outlook</td>
                </tr>
              </tbody>
            </table>
            
            <h4>13.6. Note Importante</h4>
            <ul>
              <li><strong>Procesare LocalÄƒ:</strong> Toate procesele se desfÄƒÈ™oarÄƒ local pe staÈ›ia de lucru a utilizatorului ICC, fÄƒrÄƒ transmitere cÄƒtre servere externe.</li>
              <li><strong>FÄƒrÄƒ Stocare PersistentÄƒ:</strong> Datele sunt procesate exclusiv Ã®n memorie temporarÄƒ (RAM). FiÈ™ierele finale sunt salvate doar pentru utilizare ulterioarÄƒ.</li>
              <li><strong>Procesare Multi-Sheet:</strong> Raportul proceseazÄƒ automat ambele sheet-uri din fiÈ™ierul Raport_Master, combinÃ¢ndu-le Ã®ntr-un singur DataFrame pentru analizÄƒ unificatÄƒ.</li>
              <li><strong>Filtrare Multi-Criteriu:</strong> Raportul aplicÄƒ filtre multiple pentru eliminarea portofoliilor nerelevante (BANCPOST, GB01, AXIOMA, CdF, Idea Leasing, GDPR, blank), asigurÃ¢nd doar date relevante.</li>
              <li><strong>Completare AutomatÄƒ DATA_PREDARE_BEJ:</strong> Raportul completeazÄƒ automat DATA_PREDARE_BEJ pentru cazurile cu ambele cÃ¢mpuri blank, folosind data din DATA_RAPORT sau data curentÄƒ, asigurÃ¢nd consistenÈ›Äƒ.</li>
              <li><strong>Formatare ProfesionalÄƒ:</strong> Raportul aplicÄƒ font Georgia 11 È™i formatare de date (dd.mm.yyyy) pe toate coloanele relevante, asigurÃ¢nd prezentare profesionalÄƒ.</li>
              <li><strong>CurÄƒÈ›are È™i Mapping PORTFOLIO:</strong> CurÄƒÈ›area È™i mapping-ul PORTFOLIO asigurÄƒ normalizarea denumirilor È™i filtrarea doar a portofoliilor relevante (EOS, BTD CREDITE, BTD CARDURI, SALT, BT MIC, BT LEASING).</li>
              <li><strong>Separare Active/Ãnchise:</strong> Separarea dosarelor active de cele Ã®nchise permite analizÄƒ precisÄƒ a portofoliului per creditor, identificÃ¢nd dosarele Ã®n curs de procesare.</li>
              <li><strong>ProtecÈ›ie ParolÄƒ Excel:</strong> Rapoartele Excel sunt protejate cu parola "administrare" folosind msoffcrypto-tool, asigurÃ¢nd confidenÈ›ialitate.</li>
              <li><strong>Email-uri Personalizate per Creditor:</strong> Email-urile sunt trimise individual cÄƒtre fiecare creditor cu doar rapoartele relevante pentru acel creditor, asigurÃ¢nd confidenÈ›ialitate È™i relevanÈ›Äƒ.</li>
              <li><strong>Eliminare AutomatÄƒ:</strong> DupÄƒ finalizarea procesÄƒrii È™i trimiterii email-urilor, datele din memorie sunt eliminate automat, aplicaÈ›ia revenind la starea iniÈ›ialÄƒ.</li>
            </ul>
          </div>

        </section>
      </div>
    </section>

    <section class="content-section hidden" id="secAcces">
      <div class="section-head">
        <div class="title">ğŸ” Nivele Acces &amp; Securitate</div>
        <div style="opacity:.75; font-weight:700; color:#22507a;">Nivele de acces, autentificare È™i protecÈ›ie credenÈ›iale</div>
      </div>
      <div class="section-body">
        <section class="doc-section">
          <h2>Descrierea Nivelurilor de Acces ale Utilizatorilor</h2>
          <p>AplicaÈ›ia Roboescu este instalatÄƒ local pe staÈ›ia de lucru Windows a utilizatorului ICC desemnat È™i este accesibilÄƒ exclusiv acestuia. Nu existÄƒ acces pentru clienÈ›i sau utilizatori externi - aplicaÈ›ia ruleazÄƒ doar pe desktop-ul utilizatorului autorizat.</p>

          <h3>1. Utilizatori AplicaÈ›ie</h3>
          <p><strong>Tip Utilizator:</strong> Utilizator ICC desemnat</p>
          <p>AplicaÈ›ia este destinatÄƒ exclusiv utilizatorului ICC care are acces la staÈ›ia de lucru Windows pe care este instalatÄƒ. Nu existÄƒ:</p>
          <ul>
            <li>ClienÈ›i - aplicaÈ›ia nu este accesibilÄƒ clienÈ›ilor</li>
            <li>Utilizatori externi - nu existÄƒ acces extern sau remote</li>
            <li>Utilizatori multipli - aplicaÈ›ia ruleazÄƒ local pentru un singur utilizator</li>
            <li>Autentificare web - nu existÄƒ sistem de login web sau JWT</li>
            <li>BazÄƒ de date utilizatori - nu existÄƒ gestionare utilizatori Ã®n aplicaÈ›ie</li>
          </ul>

          <h3>2. Control Acces la Nivel Windows</h3>
          <p>AplicaÈ›ia nu implementeazÄƒ verificare utilizator Ã®n cod. Controlul accesului se face exclusiv la nivel Windows prin:</p>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Descriere</th>
                <th>Responsabil</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Autentificare Windows</strong></td>
                <td>Utilizatorul trebuie sÄƒ fie autentificat Ã®n Windows cu contul autorizat ICC pentru a accesa staÈ›ia de lucru</td>
                <td>IT GFBT (Configurare Windows)</td>
              </tr>
              <tr>
                <td><strong>Permisiuni Executare</strong></td>
                <td>Doar utilizatorul autorizat ICC poate rula aplicaÈ›ia (<code>main.py</code>)</td>
                <td>IT GFBT (Permisiuni Windows)</td>
              </tr>
              <tr>
                <td><strong>Permisiuni FiÈ™iere NTFS</strong></td>
                <td>Doar utilizatorul autorizat ICC poate accesa fiÈ™ierele de intrare (Master/) È™i rezultatele (Rezultate/)</td>
                <td>IT GFBT (Permisiuni NTFS)</td>
              </tr>
              <tr>
                <td><strong>RestricÈ›ie Alte Conturi</strong></td>
                <td>Alte conturi Windows (locale sau de domeniu) nu pot accesa aplicaÈ›ia sau fiÈ™ierele asociate</td>
                <td>IT GFBT (Configurare Windows)</td>
              </tr>
            </tbody>
          </table>
          <p><strong>NotÄƒ:</strong> AplicaÈ›ia porneÈ™te direct fÄƒrÄƒ verificare utilizator Ã®n cod. Controlul accesului trebuie configurat manual la nivel Windows de cÄƒtre IT GFBT.</p>

          <h3>3. Control Acces la Nivel AplicaÈ›ie (Parole SecÈ›iuni)</h3>
          <p>AplicaÈ›ia implementeazÄƒ control acces prin parole pentru secÈ›iuni sensibile. La accesarea unei secÈ›iuni protejate, utilizatorul trebuie sÄƒ introducÄƒ parola dedicatÄƒ.</p>
          
          <h4>3.1. SecÈ›iuni Protejate cu ParolÄƒ</h4>
          <table>
            <thead>
              <tr>
                <th>SecÈ›iune</th>
                <th>ParolÄƒ</th>
                <th>FuncÈ›ionalitate</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Juridic ICC</strong></td>
                <td>ParolÄƒ dedicatÄƒ</td>
                <td>Acces la rapoarte juridice (13 rapoarte implementate)</td>
                <td>Dialog parolÄƒ Ã®n <code>main.py</code> (linia 163)</td>
              </tr>
              <tr>
                <td><strong>InsolvenÈ›Äƒ ICC</strong></td>
                <td>ParolÄƒ dedicatÄƒ</td>
                <td>Rapoarte insolvenÈ›Äƒ (Ã®n dezvoltare)</td>
                <td>Dialog parolÄƒ Ã®n <code>main.py</code> (linia 170)</td>
              </tr>
              <tr>
                <td><strong>Executare silitÄƒ ICC</strong></td>
                <td>ParolÄƒ dedicatÄƒ</td>
                <td>Rapoarte executare silitÄƒ (Ã®n dezvoltare)</td>
                <td>Dialog parolÄƒ Ã®n <code>main.py</code> (linia 177)</td>
              </tr>
              <tr>
                <td><strong>Conformitate</strong></td>
                <td>ParolÄƒ dedicatÄƒ</td>
                <td>Rapoarte conformitate (Ã®n dezvoltare)</td>
                <td>Dialog parolÄƒ Ã®n <code>main.py</code> (linia 184)</td>
              </tr>
              <tr>
                <td><strong>Amiabil ICC</strong></td>
                <td>ParolÄƒ dedicatÄƒ</td>
                <td>Rapoarte soluÈ›ii amiabile (Ã®n dezvoltare)</td>
                <td>Dialog parolÄƒ Ã®n <code>main.py</code> (linia 191)</td>
              </tr>
              <tr>
                <td><strong>Raportare CRC BNR</strong></td>
                <td>ParolÄƒ dedicatÄƒ</td>
                <td>Rapoarte BNR (Ã®n dezvoltare)</td>
                <td>Dialog parolÄƒ Ã®n <code>main.py</code> (linia 198)</td>
              </tr>
              <tr>
                <td><strong>Audit/Administrativ</strong></td>
                <td>ParolÄƒ dedicatÄƒ</td>
                <td>Rapoarte audit È™i administrative (Ã®n dezvoltare)</td>
                <td>Dialog parolÄƒ Ã®n <code>main.py</code> (linia 205)</td>
              </tr>
            </tbody>
          </table>

          <h4>3.2. SecÈ›iuni FÄƒrÄƒ ParolÄƒ</h4>
          <p>UrmÄƒtoarele secÈ›iuni nu necesitÄƒ parolÄƒ È™i sunt accesibile direct:</p>
          <ul>
            <li><strong>Meniu Principal</strong> - Ecranul iniÈ›ial al aplicaÈ›iei</li>
            <li><strong>SelecÈ›ie SecÈ›iune</strong> - Ecranul de selecÈ›ie a secÈ›iunilor</li>
            <li><strong>Configurare AplicaÈ›ie</strong> - SetÄƒri generale (dacÄƒ existÄƒ)</li>
          </ul>

          <h3>4. FuncÈ›ionare Dialog ParolÄƒ</h3>
          <p>La accesarea unei secÈ›iuni protejate, aplicaÈ›ia afiÈ™eazÄƒ un dialog modal pentru introducerea parolei.</p>
          <table>
            <thead>
              <tr>
                <th>EtapÄƒ</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>1. Trigger Dialog</strong></td>
                <td>Utilizatorul apasÄƒ pe o secÈ›iune protejatÄƒ din meniul principal</td>
                <td>Callback Ã®n <code>main.py</code> (linia 163-206):<br>
                  â€¢ <code>show_password_dialog(section_name, password, callback)</code>
                </td>
              </tr>
              <tr>
                <td><strong>2. AfiÈ™are Dialog</strong></td>
                <td>Se deschide fereastrÄƒ modalÄƒ CustomTkinter cu cÃ¢mp parolÄƒ</td>
                <td>Implementare Ã®n <code>main.py</code> (linia 328-390):<br>
                  â€¢ <code>ctk.CTkToplevel()</code> - fereastrÄƒ modalÄƒ<br>
                  â€¢ <code>dialog.grab_set()</code> - blocheazÄƒ interacÈ›iunea cu fereastra principalÄƒ<br>
                  â€¢ CÃ¢mp parolÄƒ cu <code>show="*"</code> pentru ascundere
                </td>
              </tr>
              <tr>
                <td><strong>3. Verificare ParolÄƒ</strong></td>
                <td>La apÄƒsarea butonului "Autentificare", se comparÄƒ parola introdusÄƒ</td>
                <td>FuncÈ›ie <code>check_password()</code> (linia 370-378):<br>
                  â€¢ <code>password_var.get() == password</code> - comparare directÄƒ<br>
                  â€¢ DacÄƒ corectÄƒ: <code>dialog.destroy()</code> È™i <code>action_callback()</code><br>
                  â€¢ DacÄƒ incorectÄƒ: Mesaj eroare "âŒ ParolÄƒ incorectÄƒ! ÃncercaÈ›i din nou."
                </td>
              </tr>
              <tr>
                <td><strong>4. Acces SecÈ›iune</strong></td>
                <td>DupÄƒ autentificare corectÄƒ, utilizatorul acceseazÄƒ secÈ›iunea</td>
                <td>Callback executat:<br>
                  â€¢ Pentru "Juridic ICC": <code>self.master._show_juridic_menu()</code><br>
                  â€¢ Pentru "Audit/Administrativ": <code>self.master._show_administrative_audit_menu()</code><br>
                  â€¢ Pentru alte secÈ›iuni: <code>self.show_coming_soon(section_name)</code>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>5. Rezumat Control Acces</h3>
          <table>
            <thead>
              <tr>
                <th>Categorie</th>
                <th>MÄƒsurÄƒ</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="2"><strong>Control Acces OS</strong></td>
                <td>Acces limitat la utilizatorul Windows autorizat ICC</td>
                <td>Configurare Windows (IT GFBT)</td>
              </tr>
              <tr>
                <td>Permisiuni NTFS pentru fiÈ™iere È™i directoare</td>
                <td>Configurare Windows (IT GFBT)</td>
              </tr>
              <tr>
                <td rowspan="2"><strong>Control Acces AplicaÈ›ie</strong></td>
                <td>Parole pentru secÈ›iuni sensibile (7 secÈ›iuni)</td>
                <td>âœ… Implementat Ã®n <code>main.py</code></td>
              </tr>
              <tr>
                <td>Dialog modal pentru introducere parolÄƒ</td>
                <td>âœ… Implementat Ã®n <code>main.py</code> (linia 328-390)</td>
              </tr>
              <tr>
                <td><strong>Utilizatori</strong></td>
                <td>Un singur utilizator ICC desemnat per staÈ›ie de lucru</td>
                <td>Deployment local</td>
              </tr>
            </tbody>
          </table>

          <h3>6. Caracteristici Acces</h3>
          <ul>
            <li><strong>Un singur utilizator:</strong> AplicaÈ›ia este destinatÄƒ unui singur utilizator ICC per staÈ›ie de lucru</li>
            <li><strong>FÄƒrÄƒ gestionare utilizatori:</strong> Nu existÄƒ sistem de creare/È™tergere utilizatori Ã®n aplicaÈ›ie</li>
            <li><strong>FÄƒrÄƒ autentificare la pornire:</strong> AplicaÈ›ia porneÈ™te direct fÄƒrÄƒ verificare utilizator Ã®n cod</li>
            <li><strong>Parole secÈ›iuni:</strong> 7 secÈ›iuni protejate cu parole dedicate (Juridic, InsolvenÈ›Äƒ, Executare, Conformitate, Amiabil, Raportare CRC BNR, Audit/Administrativ)</li>
            <li><strong>Dialog parolÄƒ:</strong> La accesare secÈ›iune sensibilÄƒ, se afiÈ™eazÄƒ dialog modal CustomTkinter pentru introducere parolÄƒ</li>
            <li><strong>Verificare simplÄƒ:</strong> Comparare directÄƒ parolÄƒ introdusÄƒ cu parola configuratÄƒ Ã®n cod</li>
            <li><strong>FÄƒrÄƒ hash-uire:</strong> Parolele nu sunt hash-uite - comparare directÄƒ pentru simplitate</li>
            <li><strong>FÄƒrÄƒ expirare:</strong> Parolele nu expirÄƒ - rÄƒmÃ¢n valide pÃ¢nÄƒ la modificare Ã®n cod</li>
          </ul>
        </section>
      </div>
    </section>

    <section class="content-section hidden" id="secProtectie">
      <div class="section-head">
        <div class="title">ğŸ›¡ï¸ ProtecÈ›ie &amp; Validare</div>
        <div style="opacity:.75; font-weight:700; color:#22507a;">Validare input, protecÈ›ie date, securitate aplicaÈ›ie desktop</div>
      </div>
      <div class="section-body">
        <section class="doc-section">
          <h2>Descrierea Metodelor de ProtecÈ›ie È™i Validare</h2>
          <p>Acest document descrie mÄƒsurile implementate pentru validare input, protecÈ›ie date È™i securitate Ã®n aplicaÈ›ia desktop Roboescu.</p>
          <p><strong>NotÄƒ:</strong> AplicaÈ›ia Roboescu este o aplicaÈ›ie desktop localÄƒ Python</p>

          <h3>1. Validare Input Utilizator</h3>

          <h4>1.1. Validare CÄƒi FiÈ™iere</h4>
          <table>
            <thead>
              <tr>
                <th>Tip Validare</th>
                <th>Status</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Verificare ExistenÈ›Äƒ FiÈ™ier</strong></td>
                <td>âœ… Implementat</td>
                <td>Se verificÄƒ dacÄƒ fiÈ™ierul sau folderul selectat existÄƒ Ã®nainte de procesare</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Utilizare <code>os.path.exists()</code> pentru verificare existenÈ›Äƒ</li>
                    <li>Validare Ã®nainte de pornirea procesÄƒrii</li>
                    <li>Mesaje de eroare clare pentru utilizator</li>
                    <li>Exemplu: <code>if not self.input_path or not os.path.exists(self.input_path):</code></li>
                    <li>FiÈ™iere: <code>raport_productivitate/screen.py</code>, <code>raport_incidente_riscuri/screen.py</code>, <code>raport_interogare_siui/screen.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Validare Tip FiÈ™ier</strong></td>
                <td>âœ… Implementat</td>
                <td>Se verificÄƒ cÄƒ fiÈ™ierul selectat este de tip Excel (.xlsx, .xls)</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Validare extensie fiÈ™ier Ã®n dialogurile de selecÈ›ie</li>
                    <li>Filtrare automatÄƒ pentru tipurile de fiÈ™iere acceptate</li>
                    <li>Verificare la deschiderea fiÈ™ierului cu pandas/openpyxl</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Validare Permisiuni Acces</strong></td>
                <td>âœ… Implementat</td>
                <td>Se verificÄƒ cÄƒ aplicaÈ›ia are permisiuni de citire pentru fiÈ™ierele de input È™i scriere pentru folderele de output</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Verificare implicitÄƒ prin Ã®ncercarea de deschidere/scriere</td>
                    <li>Gestionare excepÈ›ii pentru erori de acces</li>
                    <li>Mesaje de eroare descriptive pentru utilizator</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h4>1.2. Validare StructurÄƒ Excel</h4>
          <table>
            <thead>
              <tr>
                <th>Tip Validare</th>
                <th>Status</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Validare Sheet-uri</strong></td>
                <td>âœ… Implementat</td>
                <td>Se verificÄƒ cÄƒ fiÈ™ierul Excel conÈ›ine sheet-urile aÈ™teptate</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FuncÈ›ie <code>validate_excel_structure()</code> Ã®n <code>utils/excel_processor.py</code></li>
                    <li>Verificare numÄƒr È™i nume de sheet-uri</li>
                    <li>Logging pentru probleme de structurÄƒ</li>
                    <li>Returnare boolean pentru validitate</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Validare Coloane</strong></td>
                <td>âœ… Implementat</td>
                <td>Se verificÄƒ prezenÈ›a coloanelor necesare Ã®n fiecare sheet</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Verificare coloane obligatorii Ã®nainte de procesare</li>
                    <li>Validare tipuri de date Ã®n coloane</li>
                    <li>Gestionare erori pentru coloane lipsÄƒ</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>CurÄƒÈ›are Date</strong></td>
                <td>âœ… Implementat</td>
                <td>Eliminare rÃ¢nduri È™i coloane goale, normalizare date</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FuncÈ›ie <code>clean_data()</code> Ã®n <code>utils/excel_processor.py</code></li>
                    <li>Eliminare rÃ¢nduri complet goale cu <code>dropna(how='all')</code></li>
                    <li>Eliminare coloane complet goale</li>
                    <li>Resetare index dupÄƒ curÄƒÈ›are</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h4>1.3. Validare CNP (Cod Numeric Personal)</h4>
          <table>
            <thead>
              <tr>
                <th>Tip Validare</th>
                <th>Status</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Validare Format</strong></td>
                <td>âœ… Implementat</td>
                <td>Se verificÄƒ cÄƒ CNP-ul are exact 13 cifre</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Verificare lungime: <code>len(str(cnp).strip()) == 13</code></li>
                    <li>Verificare cÄƒ toate caracterele sunt cifre: <code>cnp_str.isdigit()</code></li>
                    <li>Eliminare spaÈ›ii Ã®nainte de validare</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Validare CifrÄƒ Control</strong></td>
                <td>âœ… Implementat</td>
                <td>Se verificÄƒ cifra de control conform algoritmului oficial</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FuncÈ›ie <code>valid_cnp()</code> Ã®n <code>raport_interogare_siui/processor.py</code></li>
                    <li>Calcul cifrÄƒ control cu constanta "279146358279"</li>
                    <li>Verificare modulo 11 (dacÄƒ restul este 10, se foloseÈ™te 1)</li>
                    <li>Comparare cu ultima cifrÄƒ a CNP-ului</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Marcare CNP Invalid</strong></td>
                <td>âœ… Implementat</td>
                <td>CNP-urile invalide sunt marcate Ã®n Excel fÄƒrÄƒ a opri procesarea</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>CNP-urile invalide primesc valoarea "CNP INVALID" Ã®n coloana de rezultat</li>
                    <li>Procesarea continuÄƒ pentru urmÄƒtoarele CNP-uri</li>
                    <li>Logging pentru CNP-uri invalide</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h4>1.4. Validare ConfiguraÈ›ie</h4>
          <table>
            <thead>
              <tr>
                <th>Tip Validare</th>
                <th>Status</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Validare Config Email</strong></td>
                <td>âœ… Implementat</td>
                <td>Se verificÄƒ cÄƒ configuraÈ›ia email este completÄƒ dacÄƒ trimiterea automatÄƒ este activatÄƒ</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FuncÈ›ie <code>validate_config()</code> Ã®n <code>config.py</code></li>
                    <li>Verificare prezenÈ›Äƒ destinatari dacÄƒ <code>auto_send</code> este True</li>
                    <li>Validare format email destinatari</li>
                    <li>FuncÈ›ie <code>validate_email_config()</code> Ã®n <code>utils/email_sender.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Validare Config Scheduler</strong></td>
                <td>âœ… Implementat</td>
                <td>Se verificÄƒ cÄƒ scheduler-ul are ora configuratÄƒ dacÄƒ este activat</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Verificare prezenÈ›Äƒ <code>default_time</code> dacÄƒ <code>enabled</code> este True</li>
                    <li>Validare format orÄƒ (HH:MM)</li>
                    <li>Returnare listÄƒ de erori pentru toate problemele gÄƒsite</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Validare Dimensiune FiÈ™ier</strong></td>
                <td>âœ… Implementat</td>
                <td>Se verificÄƒ cÄƒ dimensiunea maximÄƒ a fiÈ™ierului este validÄƒ</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Verificare <code>max_file_size_mb > 0</code></li>
                    <li>Validare cÄƒ valoarea este un numÄƒr pozitiv</li>
                    <li>AdÄƒugare eroare Ã®n listÄƒ dacÄƒ validarea eÈ™ueazÄƒ</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>2. ProtecÈ›ie Procesare</h3>

          <h4>2.1. Prevenire Procesare ConcurrentÄƒ</h4>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Status</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Flag Procesare</strong></td>
                <td>âœ… Implementat</td>
                <td>Se foloseÈ™te un flag <code>is_processing</code> pentru a preveni pornirea simultanÄƒ a mai multor procesÄƒri</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Verificare <code>if self.is_processing:</code> Ã®nainte de pornire</li>
                    <li>Setare flag la <code>True</code> la Ã®nceputul procesÄƒrii</li>
                    <li>Resetare flag la <code>False</code> la finalizare sau eroare</li>
                    <li>Mesaj de atenÈ›ie dacÄƒ procesarea este deja Ã®n curs</li>
                    <li>FiÈ™iere: toate screen-urile (screen.py) din modulele de rapoarte</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Dezactivare Butoane</strong></td>
                <td>âœ… Implementat</td>
                <td>Butoanele de procesare sunt dezactivate Ã®n timpul procesÄƒrii</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Butonul de procesare primeÈ™te text "â³ PROCESARE ÃN CURS..."</li>
                    <li>Butonul este dezactivat: <code>state="disabled"</code></li>
                    <li>Culoare buton schimbatÄƒ pentru feedback vizual</li>
                    <li>Reactivare buton la finalizare</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Thread Separare</strong></td>
                <td>âœ… Implementat</td>
                <td>Procesarea ruleazÄƒ Ã®n thread separat pentru a nu bloca interfaÈ›a</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Utilizare <code>threading.Thread</code> pentru procesare</li>
                    <li>Thread daemon pentru terminare automatÄƒ la Ã®nchidere aplicaÈ›ie</li>
                    <li>InterfaÈ›a rÄƒmÃ¢ne responsivÄƒ Ã®n timpul procesÄƒrii</li>
                    <li>Gestionare sigurÄƒ a erorilor Ã®n thread</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h4>2.2. Gestionare Erori È™i ExcepÈ›ii</h4>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Status</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Try-Except Blocks</strong></td>
                <td>âœ… Implementat</td>
                <td>Toate operaÈ›iile critice sunt Ã®ncadrate Ã®n blocuri try-except</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Gestionare excepÈ›ii pentru operaÈ›ii I/O (fiÈ™iere, Excel)</li>
                    <li>Gestionare excepÈ›ii pentru operaÈ›ii de reÈ›ea (email, API-uri)</li>
                    <li>Gestionare excepÈ›ii pentru operaÈ›ii de procesare date</li>
                    <li>Logging detaliat pentru toate excepÈ›iile</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Mesaje Eroare Utilizator</strong></td>
                <td>âœ… Implementat</td>
                <td>Utilizatorul primeÈ™te mesaje clare È™i utile pentru erori</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FuncÈ›ie <code>_show_error_message()</code> Ã®n <code>main.py</code></li>
                    <li>Dialoguri modale pentru erori critice</li>
                    <li>Mesaje descriptive Ã®n limba romÃ¢nÄƒ</li>
                    <li>Utilizare <code>messagebox.showerror()</code> pentru erori simple</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Logging Erori</strong></td>
                <td>âœ… Implementat</td>
                <td>Toate erorile sunt Ã®nregistrate Ã®n log-uri pentru debugging</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Utilizare modul <code>logging</code> Python</li>
                    <li>Niveluri diferite: DEBUG, INFO, WARNING, ERROR, CRITICAL</li>
                    <li>Logging Ã®n fiÈ™iere È™i consolÄƒ</li>
                    <li>Format structurat pentru uÈ™urinÈ›a analizei</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Recuperare la Eroare</strong></td>
                <td>âœ… Implementat</td>
                <td>AplicaÈ›ia se recupereazÄƒ graÈ›ios din erori fÄƒrÄƒ a crashe</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Resetare flag-uri de procesare la eroare</li>
                    <li>Reactivare butoane dupÄƒ eroare</li>
                    <li>Salvare progres parÈ›ial (checkpoint) pentru procesÄƒri lungi</li>
                    <li>Posibilitate reluare de la checkpoint</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>3. ProtecÈ›ie Date È™i FiÈ™iere</h3>

          <h4>3.1. Validare SelecÈ›ie Input</h4>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Status</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Verificare Pre-Procesare</strong></td>
                <td>âœ… Implementat</td>
                <td>Se verificÄƒ cÄƒ toate input-urile necesare sunt selectate Ã®nainte de procesare</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Verificare cÄƒ cel puÈ›in un raport este selectat</li>
                    <li>Verificare cÄƒ fiÈ™ierele/folderele necesare sunt selectate</li>
                    <li>Mesaje specifice pentru fiecare tip de input lipsÄƒ</li>
                    <li>Exemplu: <code>if not self.cesionate_var.get() and not self.bt_var.get():</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Confirmare Utilizator</strong></td>
                <td>âœ… Implementat</td>
                <td>Utilizatorul trebuie sÄƒ confirme Ã®nainte de pornirea procesÄƒrii</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Dialog de confirmare cu <code>show_confirm_dialog()</code></li>
                    <li>Posibilitate anulare procesare</li>
                    <li>OpÈ›iune skip confirmation pentru rulÄƒri automate</li>
                    <li>Mesaj clar despre acÈ›iunea care va fi executatÄƒ</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h4>3.2. ProtecÈ›ie FiÈ™iere Output</h4>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Status</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Verificare Folder Output</strong></td>
                <td>âœ… Implementat</td>
                <td>Se verificÄƒ cÄƒ folderul de output existÄƒ È™i este accesibil</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Validare existenÈ›Äƒ folder Ã®nainte de scriere</li>
                    <li>Creare automatÄƒ folder dacÄƒ nu existÄƒ (unde este cazul)</li>
                    <li>Verificare permisiuni de scriere</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Nume FiÈ™iere Unice</strong></td>
                <td>âœ… Implementat</td>
                <td>FiÈ™ierele generate au nume unice pentru a evita suprascrierea</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>AdÄƒugare timestamp Ã®n numele fiÈ™ierelor</li>
                    <li>Format: <code>Raport_Nume_YYYYMMDD_HHMMSS.xlsx</code></li>
                    <li>Verificare existenÈ›Äƒ Ã®nainte de scriere</li>
                    <li>Incrementare numÄƒr dacÄƒ fiÈ™ierul existÄƒ deja</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Salvare PeriodicÄƒ</strong></td>
                <td>âœ… Implementat</td>
                <td>Pentru procesÄƒri lungi, datele sunt salvate periodic</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FuncÈ›ii <code>save_checkpoint()</code> È™i <code>load_checkpoint()</code></li>
                    <li>Salvare progres la intervale configurate</li>
                    <li>Posibilitate reluare de la ultimul checkpoint</li>
                    <li>Implementare Ã®n <code>raport_portal_just/actualizare_portal_just.py</code></li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>4. ProtecÈ›ie Autentificare</h3>

          <h4>4.1. Validare ParolÄƒ</h4>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Status</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Dialog Autentificare</strong></td>
                <td>âœ… Implementat</td>
                <td>SecÈ›iunile protejate necesitÄƒ introducere parolÄƒ</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FuncÈ›ie <code>show_password_dialog()</code> Ã®n <code>main.py</code></li>
                    <li>Dialog modal care blocheazÄƒ interacÈ›iunea cu restul aplicaÈ›iei</li>
                    <li>Camp parolÄƒ cu mascare (<code>show="*"</code>)</li>
                    <li>Validare parolÄƒ la apÄƒsare buton sau Enter</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Verificare ParolÄƒ</strong></td>
                <td>âœ… Implementat</td>
                <td>Parola introdusÄƒ este comparatÄƒ cu parola corectÄƒ</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FuncÈ›ie <code>check_password()</code> Ã®n dialog</li>
                    <li>Comparare directÄƒ (pentru aplicaÈ›ie desktop localÄƒ)</li>
                    <li>Mesaj de eroare dacÄƒ parola este incorectÄƒ</li>
                    <li>Golire cÃ¢mp È™i refocalizare dupÄƒ eroare</li>
                    <li>Posibilitate anulare autentificare</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>ProtecÈ›ie SecÈ›iuni</strong></td>
                <td>âœ… Implementat</td>
                <td>Diferite secÈ›iuni au parole diferite</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Parole separate pentru: Juridic ICC, InsolvenÈ›Äƒ ICC, Executare silitÄƒ ICC, Conformitate, Amiabil ICC, Raportare CRC BNR, Audit/Administrativ</li>
                    <li>Acces controlat per secÈ›iune</li>
                    <li>Parole hardcodate Ã®n cod (pentru aplicaÈ›ie desktop localÄƒ)</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>5. Validare Date Procesate</h3>

          <h4>5.1. Validare Date Excel</h4>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Status</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Validare Tipuri Date</strong></td>
                <td>âœ… Implementat</td>
                <td>Se verificÄƒ cÄƒ datele din coloane au tipurile aÈ™teptate</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Conversie automatÄƒ tipuri date (string, numeric, date)</li>
                    <li>Gestionare valori NaN È™i None</li>
                    <li>Normalizare date (trim whitespace, uppercase/lowercase)</li>
                    <li>Validare format date pentru coloane de tip datÄƒ</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Validare Interval Valori</strong></td>
                <td>âœ… Implementat</td>
                <td>Se verificÄƒ cÄƒ valorile numerice sunt Ã®n intervale valide</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Validare valori pozitive pentru sume È™i cantitÄƒÈ›i</li>
                    <li>Validare intervale pentru procente (0-100)</li>
                    <li>Validare format pentru coduri È™i identificatori</li>
                    <li>Marcare valori invalide pentru corecÈ›ie manualÄƒ</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Deduplicare Date</strong></td>
                <td>âœ… Implementat</td>
                <td>Eliminare duplicate pentru a preveni procesare dublÄƒ</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Utilizare <code>drop_duplicates()</code> pandas</li>
                    <li>Identificare duplicate pe baza coloanelor cheie</li>
                    <li>PÄƒstrare primul rÃ¢nd Ã®n caz de duplicate</li>
                    <li>Logging pentru duplicate eliminate</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>6. Rezumat MÄƒsuri de ProtecÈ›ie Implementate</h3>
          <table>
            <thead>
              <tr>
                <th>Categorie</th>
                <th>MÄƒsurÄƒ</th>
                <th>Descriere</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="5"><strong>Validare Input</strong></td>
                <td>Validare cÄƒi fiÈ™iere</td>
                <td>Verificare existenÈ›Äƒ È™i acces pentru fiÈ™iere È™i foldere</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>Validare structurÄƒ Excel</td>
                <td>Verificare sheet-uri È™i coloane necesare</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>Validare CNP</td>
                <td>Verificare format È™i cifrÄƒ control pentru CNP-uri</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>Validare configuraÈ›ie</td>
                <td>Verificare completitudine È™i corectitudine configuraÈ›ie</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>CurÄƒÈ›are date</td>
                <td>Eliminare rÃ¢nduri/coloane goale, normalizare</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td rowspan="3"><strong>ProtecÈ›ie Procesare</strong></td>
                <td>Prevenire procesare concurrentÄƒ</td>
                <td>Flag de procesare È™i dezactivare butoane</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>Thread separare</td>
                <td>Procesare Ã®n thread separat pentru interfaÈ›Äƒ responsivÄƒ</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>Gestionare erori</td>
                <td>Try-except blocks, mesaje utilizator, logging</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td rowspan="3"><strong>ProtecÈ›ie Date</strong></td>
                <td>Verificare selecÈ›ie input</td>
                <td>Validare cÄƒ toate input-urile necesare sunt selectate</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>ProtecÈ›ie fiÈ™iere output</td>
                <td>Nume unice, verificare permisiuni, salvare periodicÄƒ</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>Validare date procesate</td>
                <td>Validare tipuri, intervale, deduplicare</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td><strong>Autentificare</strong></td>
                <td>Validare parolÄƒ</td>
                <td>Dialog autentificare, verificare parolÄƒ, protecÈ›ie secÈ›iuni</td>
                <td>âœ… Implementat</td>
              </tr>
            </tbody>
          </table>

          <h3>7. Note Importante</h3>
          <ul>
            <li><strong>AplicaÈ›ie Desktop LocalÄƒ:</strong> AplicaÈ›ia Roboescu este o aplicaÈ›ie desktop localÄƒ Python care ruleazÄƒ pe staÈ›ia de lucru a utilizatorului. Toate datele sunt procesate local, fÄƒrÄƒ transmitere cÄƒtre servere externe (cu excepÈ›ia trimiterii email-urilor È™i interogÄƒrilor API externe configurate).</li>
            <li><strong>Validare CompletÄƒ Input:</strong> Toate input-urile utilizatorului (fiÈ™iere, foldere, configuraÈ›ii) sunt validate Ã®nainte de procesare, prevenind erori È™i comportamente neaÈ™teptate.</li>
            <li><strong>Gestionare RobustÄƒ Erori:</strong> AplicaÈ›ia gestioneazÄƒ graÈ›ios toate tipurile de erori, oferind mesaje clare utilizatorului È™i Ã®nregistrÃ¢nd detalii Ã®n log-uri pentru debugging.</li>
            <li><strong>ProtecÈ›ie Procesare:</strong> Mecanismele de prevenire a procesÄƒrii concurrente asigurÄƒ cÄƒ aplicaÈ›ia nu Ã®ncearcÄƒ sÄƒ proceseze mai multe rapoarte simultan, prevenind conflicte È™i erori.</li>
            <li><strong>Validare Date:</strong> Toate datele procesate (CNP-uri, structuri Excel, configuraÈ›ii) sunt validate conform standardelor È™i regulilor de business, asigurÃ¢nd calitatea rezultatelor.</li>
            <li><strong>Autentificare SimplÄƒ:</strong> Pentru aplicaÈ›ia desktop localÄƒ, autentificarea se face prin comparare directÄƒ a parolei, fÄƒrÄƒ necesitatea unui sistem complex de autentificare web.</li>
            <li><strong>Salvare SigurÄƒ:</strong> FiÈ™ierele generate au nume unice È™i sunt salvate Ã®n locaÈ›ii validate, prevenind pierderea datelor È™i suprascrierea accidentalÄƒ.</li>
          </ul>

        </section>
      </div>
    </section>

    <section class="content-section hidden" id="secObfuscare">
      <div class="section-head">
        <div class="title">ğŸ”’ ProtecÈ›ie &amp; Obfuscare</div>
        <div style="opacity:.75; font-weight:700; color:#22507a;">Metode protejare È™i obfuscare aplicaÈ›ie</div>
      </div>
      <div class="section-body">
        <section class="doc-section">
          <h2>Metode Protejare/Obfuscare AplicaÈ›ie</h2>
          <p>Acest document descrie mÄƒsurile implementate pentru protecÈ›ia codului sursÄƒ È™i secretelor Ã®n aplicaÈ›ia desktop Roboescu.</p>

          <h3>1. ProtecÈ›ie Parole È™i CredenÈ›iale</h3>

          <h4>1.1. Parole Hardcodate Ã®n Cod</h4>
          <table>
            <thead>
              <tr>
                <th>SecÈ›iune</th>
                <th>ParolÄƒ</th>
                <th>ProtecÈ›ie</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Juridic ICC</strong></td>
                <td>ParolÄƒ dedicatÄƒ</td>
                <td>Control acces la nivel aplicaÈ›ie</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>ParolÄƒ hardcodatÄƒ Ã®n <code>main.py</code> (linia 163)</li>
                    <li>Verificare parolÄƒ Ã®nainte de accesare secÈ›iune</li>
                    <li>Dialog modal pentru introducere parolÄƒ</li>
                    <li>Blocare acces dacÄƒ parolÄƒ incorectÄƒ</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>InsolvenÈ›Äƒ ICC</strong></td>
                <td>ParolÄƒ dedicatÄƒ</td>
                <td>Control acces la nivel aplicaÈ›ie</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>ParolÄƒ hardcodatÄƒ Ã®n <code>main.py</code> (linia 170)</li>
                    <li>ParolÄƒ unicÄƒ pentru fiecare secÈ›iune</td>
                    <li>Verificare Ã®n funcÈ›ie <code>show_password_dialog()</code></li>
                    <li>FuncÈ›ie <code>check_password()</code> pentru validare</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Executare silitÄƒ ICC</strong></td>
                <td>ParolÄƒ dedicatÄƒ</td>
                <td>Control acces la nivel aplicaÈ›ie</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>ParolÄƒ hardcodatÄƒ Ã®n <code>main.py</code> (linia 177)</li>
                    <li>SecÈ›iuni sensibile protejate individual</li>
                    <li>Mesaj de eroare dacÄƒ parolÄƒ incorectÄƒ</li>
                    <li>Golire cÃ¢mp È™i refocalizare dupÄƒ eroare</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Conformitate</strong></td>
                <td>ParolÄƒ dedicatÄƒ</td>
                <td>Control acces la nivel aplicaÈ›ie</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>ParolÄƒ hardcodatÄƒ Ã®n <code>main.py</code> (linia 184)</li>
                    <li>ProtecÈ›ie pentru secÈ›iuni cu date sensibile</li>
                    <li>Dialog modal care blocheazÄƒ interacÈ›iunea</li>
                    <li>Posibilitate anulare autentificare</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Amiabil ICC</strong></td>
                <td>ParolÄƒ dedicatÄƒ</td>
                <td>Control acces la nivel aplicaÈ›ie</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>ParolÄƒ hardcodatÄƒ Ã®n <code>main.py</code> (linia 191)</li>
                    <li>Verificare la apÄƒsare buton sau Enter</li>
                    <li>Camp parolÄƒ cu mascare (<code>show="*"</code>)</li>
                    <li>Securitate prin izolare acces</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Raportare CRC BNR</strong></td>
                <td>ParolÄƒ dedicatÄƒ</td>
                <td>Control acces la nivel aplicaÈ›ie</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>ParolÄƒ hardcodatÄƒ Ã®n <code>main.py</code> (linia 198)</li>
                    <li>ProtecÈ›ie pentru rapoarte sensibile</li>
                    <li>Verificare Ã®nainte de accesare funcÈ›ionalitÄƒÈ›i</li>
                    <li>Gestionare sigurÄƒ a erorilor de autentificare</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Audit/Administrativ</strong></td>
                <td>ParolÄƒ dedicatÄƒ</td>
                <td>Control acces la nivel aplicaÈ›ie</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>ParolÄƒ hardcodatÄƒ Ã®n <code>main.py</code> (linia 205)</li>
                    <li>ProtecÈ›ie pentru activitÄƒÈ›i administrative</li>
                    <li>Acces controlat per secÈ›iune</li>
                    <li>Parole configurate Ã®n cod pentru securitate</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h4>1.2. ProtecÈ›ie Parole Excel</h4>
          <table>
            <thead>
              <tr>
                <th>Raport</th>
                <th>ParolÄƒ</th>
                <th>MetodÄƒ Criptare</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Raport Creditori</strong></td>
                <td>Parole per creditor</td>
                <td>Criptare realÄƒ cu msoffcrypto</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FuncÈ›ie <code>save_protected_excel()</code> Ã®n <code>raport_creditori/processor.py</code></li>
                    <li>BibliotecÄƒ: <code>xlsxwriter</code> + <code>msoffcrypto-tool</code></li>
                    <li>Criptare realÄƒ Excel cu <code>msoffcrypto.OfficeFile()</code></li>
                    <li>Parole configurate Ã®n cod pentru securitate</li>
                    <li>Excel-urile nu pot fi deschise fÄƒrÄƒ parolÄƒ</li>
                    <li>6 Excel-uri parolate per raport</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Raport Termene LicitaÈ›ie</strong></td>
                <td>ParolÄƒ per raport</td>
                <td>Criptare realÄƒ cu msoffcrypto</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FuncÈ›ie <code>save_protected_excel()</code> Ã®n <code>raport_termene_licitatie_garantii/processor.py</code></li>
                    <li>Proces: creare fiÈ™ier temporar â†’ criptare â†’ È™tergere temporar</li>
                    <li>Excel-uri parolate Ã®nainte de salvare</li>
                    <li>ProtecÈ›ie date sensibile Ã®n fiÈ™iere generate</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Raport Incidente Riscuri</strong></td>
                <td>ParolÄƒ per raport</td>
                <td>Criptare realÄƒ cu msoffcrypto</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FuncÈ›ie de criptare Ã®n <code>raport_incidente_riscuri/processor.py</code></li>
                    <li>Utilizare <code>office_file.encrypt(password, fout)</code></li>
                    <li>ProtecÈ›ie pentru rapoarte cu date confidenÈ›iale</li>
                    <li>Toate Excel-urile transmise prin email sunt parolate</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>2. StructurÄƒ ModularÄƒ È™i Izolare</h3>

          <h4>2.1. Separare Module</h4>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Descriere</th>
                <th>Beneficii</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Foldere Separate</strong></td>
                <td>Fiecare modul de raport este Ã®ntr-un folder separat</td>
                <td>Izolare cod, procesare independentÄƒ, erori izolate</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>StructurÄƒ: <code>raport_creditori/</code>, <code>raport_productivitate/</code>, etc.</li>
                    <li>Fiecare modul are propriile fiÈ™iere: <code>processor.py</code>, <code>screen.py</code>, <code>config.json</code></li>
                    <li>Module independente, fÄƒrÄƒ dependenÈ›e cross-module</li>
                    <li>ProtecÈ›ie prin separare logicÄƒ</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Procese Independente</strong></td>
                <td>Fiecare modul ruleazÄƒ Ã®n proces Python separat</td>
                <td>Izolare execuÈ›ie, prevenire crash-uri globale</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Utilizare <code>subprocess.run()</code> pentru rulare module</li>
                    <li>Eroarea Ã®ntr-un modul nu afecteazÄƒ altele</li>
                    <li>Gestionare independentÄƒ a resurselor</li>
                    <li>ProtecÈ›ie prin izolare proces</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>ConfiguraÈ›ii Separate</strong></td>
                <td>Fiecare modul are propriul fiÈ™ier de configuraÈ›ie</td>
                <td>Izolare configuraÈ›ii, protecÈ›ie date sensibile</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FiÈ™iere <code>config.json</code> per modul</li>
                    <li>ConfiguraÈ›ii locale, fÄƒrÄƒ partajare</li>
                    <li>ProtecÈ›ie prin separare configuraÈ›ii</li>
                    <li>FÄƒrÄƒ dependenÈ›e Ã®ntre configuraÈ›ii</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>3. ProtecÈ›ie FiÈ™iere È™i Date</h3>

          <h4>3.1. Criptare Excel cu msoffcrypto</h4>
          <table>
            <thead>
              <tr>
                <th>EtapÄƒ</th>
                <th>Descriere</th>
                <th>ProtecÈ›ie</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Creare Temporar</strong></td>
                <td>Se creeazÄƒ un fiÈ™ier Excel temporar neparolat</td>
                <td>Procesare sigurÄƒ Ã®nainte de criptare</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Utilizare <code>xlsxwriter</code> pentru creare Excel</li>
                    <li>FiÈ™ier temporar: <code>output_file.replace('.xlsx', '_temp.xlsx')</code></li>
                    <li>Procesare completÄƒ Ã®nainte de criptare</li>
                    <li>Formatare È™i stiluri aplicate</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Criptare RealÄƒ</strong></td>
                <td>FiÈ™ierul temporar este criptat cu parolÄƒ</td>
                <td>Criptare realÄƒ Excel, nu doar protecÈ›ie worksheet</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Utilizare <code>msoffcrypto.OfficeFile()</code></li>
                    <li>MetodÄƒ: <code>office_file.encrypt(password, fout)</code></li>
                    <li>Criptare la nivel de fiÈ™ier, nu doar protecÈ›ie sheet</li>
                    <li>Excel-urile nu pot fi deschise fÄƒrÄƒ parolÄƒ</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>È˜tergere Temporar</strong></td>
                <td>FiÈ™ierul temporar este È™ters dupÄƒ criptare</td>
                <td>Eliminare versiune neparolatÄƒ</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Utilizare <code>os.remove(temp_file)</code></li>
                    <li>Doar versiunea criptatÄƒ rÄƒmÃ¢ne</li>
                    <li>ProtecÈ›ie Ã®mpotriva accesului la date necriptate</li>
                    <li>Gestionare erori dacÄƒ criptarea eÈ™ueazÄƒ</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Gestionare Erori</strong></td>
                <td>DacÄƒ criptarea eÈ™ueazÄƒ, se salveazÄƒ versiunea necriptatÄƒ</td>
                <td>RobustezÄƒ, nu pierdere date</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Try-except pentru gestionare erori</li>
                    <li>Fallback: copiere fiÈ™ier temporar dacÄƒ criptarea eÈ™ueazÄƒ</li>
                    <li>Logging pentru erori de criptare</li>
                    <li>Procesare continuÄƒ chiar dacÄƒ criptarea eÈ™ueazÄƒ</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h4>3.2. Stocare LocalÄƒ ExclusivÄƒ</h4>
          <table>
            <thead>
              <tr>
                <th>Tip Date</th>
                <th>LocaÈ›ie</th>
                <th>ProtecÈ›ie</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>FiÈ™iere Input</strong></td>
                <td>StaÈ›ie de lucru localÄƒ</td>
                <td>FÄƒrÄƒ partajare reÈ›ea sau cloud</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Toate fiÈ™ierele Master stocate local</td>
                    <li>FÄƒrÄƒ acces din reÈ›ea sau cloud</li>
                    <li>ProtecÈ›ie prin izolare fizicÄƒ</li>
                    <li>Selectare manualÄƒ de cÄƒtre utilizator</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>FiÈ™iere Output</strong></td>
                <td>Foldere locale configurate</td>
                <td>Stocare localÄƒ, fÄƒrÄƒ transmisie automatÄƒ</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Foldere output configurate per modul</li>
                    <li>Stocare Ã®n <code>rapoarte_generate/</code> sau foldere dedicate</li>
                    <li>FÄƒrÄƒ sincronizare automatÄƒ cloud</li>
                    <li>Control complet asupra locaÈ›iei</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>ConfiguraÈ›ii</strong></td>
                <td>FiÈ™iere JSON locale</td>
                <td>FÄƒrÄƒ servicii externe pentru configuraÈ›ii</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FiÈ™iere <code>config.json</code> Ã®n fiecare modul</li>
                    <li>Stocare localÄƒ, fÄƒrÄƒ sincronizare</li>
                    <li>ProtecÈ›ie prin acces local exclusiv</li>
                    <li>FÄƒrÄƒ expunere cÄƒtre servicii externe</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Log-uri</strong></td>
                <td>FiÈ™iere locale</td>
                <td>Logging local cu encoding UTF-8</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Logging detaliat Ã®n fiÈ™iere locale</li>
                    <li>Encoding UTF-8 pentru caractere speciale</li>
                    <li>Stocare localÄƒ, fÄƒrÄƒ transmisie</li>
                    <li>ProtecÈ›ie prin izolare log-uri</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>4. ProtecÈ›ie Cod SursÄƒ</h3>

          <h4>4.1. StructurÄƒ Cod</h4>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Descriere</th>
                <th>ProtecÈ›ie</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Cod Python Plain</strong></td>
                <td>Codul sursÄƒ este Ã®n Python, fÄƒrÄƒ compilare</td>
                <td>TransparenÈ›Äƒ, uÈ™urinÈ›Äƒ mentenanÈ›Äƒ</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>AplicaÈ›ie desktop Python cu CustomTkinter</li>
                    <li>Cod sursÄƒ accesibil pentru mentenanÈ›Äƒ</li>
                    <li>FÄƒrÄƒ obfuscare cod (nu este necesarÄƒ pentru aplicaÈ›ie localÄƒ)</li>
                    <li>ProtecÈ›ie prin control acces la nivel sistem operare</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Parole Ã®n Cod</strong></td>
                <td>Parolele pentru secÈ›iuni sunt hardcodate Ã®n cod</td>
                <td>ProtecÈ›ie prin control acces aplicaÈ›ie</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Parole definite Ã®n <code>main.py</code> (linia 163-206)</li>
                    <li>Comparare directÄƒ Ã®n funcÈ›ie <code>check_password()</code></li>
                    <li>Pentru aplicaÈ›ie desktop localÄƒ, acest approach este adecvat</li>
                    <li>ProtecÈ›ie prin control acces la nivel aplicaÈ›ie</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Separare LogicÄƒ</strong></td>
                <td>Logica de business este separatÄƒ Ã®n module</td>
                <td>Izolare funcÈ›ionalitÄƒÈ›i, protecÈ›ie prin separare</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Fiecare raport are propriul modul</li>
                    <li>Logica de procesare izolatÄƒ per modul</li>
                    <li>FÄƒrÄƒ dependenÈ›e cross-module complexe</li>
                    <li>ProtecÈ›ie prin separare logicÄƒ</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>5. ProtecÈ›ie Transmitere Date</h3>

          <h4>5.1. Email Security</h4>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Descriere</th>
                <th>ProtecÈ›ie</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Integrare Outlook Local</strong></td>
                <td>Email-urile sunt trimise prin Outlook local (COM Interface)</td>
                <td>FÄƒrÄƒ servicii externe, control local</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Utilizare COM Interface pentru Outlook</li>
                    <li>Trimitere prin clientul Outlook local</td>
                    <li>FÄƒrÄƒ credenÈ›iale stocate Ã®n aplicaÈ›ie</li>
                    <li>ProtecÈ›ie prin utilizare infrastructurÄƒ localÄƒ</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Destinatari Hardcodate</strong></td>
                <td>Destinatarii email-urilor sunt configuraÈ›i Ã®n cod</td>
                <td>Prevenire trimitere accidentalÄƒ cÄƒtre destinatari greÈ™iÈ›i</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Destinatari definiÈ›i Ã®n <code>email_config.json</code></li>
                    <li>Liste de destinatari per tip raport</li>
                    <li>FÄƒrÄƒ posibilitate modificare din interfaÈ›Äƒ</li>
                    <li>ProtecÈ›ie prin limitare destinatari</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>AtaÈ™amente Excel Parolate</strong></td>
                <td>Toate Excel-urile trimise prin email sunt parolate</td>
                <td>ProtecÈ›ie date Ã®n transmitere</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Excel-urile sunt criptate Ã®nainte de trimitere</li>
                    <li>Parole configurate Ã®n cod</li>
                    <li>ProtecÈ›ie date sensibile Ã®n transmitere</li>
                    <li>Destinatarii primesc parola separat (prin alt canal)</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Transmitere LimitatÄƒ</strong></td>
                <td>Doar subset strict definit de rezultate este transmis automat</td>
                <td>Minimizare expunere date</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Trimitere automatÄƒ doar pentru rapoarte configurate</li>
                    <li>Destinatari: interni ICC È™i creditori GFBT</li>
                    <li>FÄƒrÄƒ trimitere automatÄƒ pentru toate rapoartele</li>
                    <li>ProtecÈ›ie prin limitare transmitere</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>6. Rezumat MÄƒsuri de ProtecÈ›ie È™i Obfuscare</h3>
          <table>
            <thead>
              <tr>
                <th>Categorie</th>
                <th>MÄƒsurÄƒ</th>
                <th>Descriere</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="7"><strong>ProtecÈ›ie Parole</strong></td>
                <td>Parole secÈ›iuni sensibile</td>
                <td>Parole hardcodate Ã®n cod pentru control acces</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>Criptare Excel cu msoffcrypto</td>
                <td>Criptare realÄƒ Excel cu parolÄƒ Ã®nainte de salvare</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>Parole per creditor</td>
                <td>Parole diferite pentru fiecare creditor Ã®n Raport Creditori</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>ProtecÈ›ie fiÈ™iere output</td>
                <td>Toate Excel-urile generate sunt parolate</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>ProtecÈ›ie Ã®n transmitere</td>
                <td>Excel-urile trimise prin email sunt parolate</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>È˜tergere fiÈ™iere temporare</td>
                <td>FiÈ™ierele temporare neparolate sunt È™terse dupÄƒ criptare</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>Gestionare erori criptare</td>
                <td>Fallback dacÄƒ criptarea eÈ™ueazÄƒ</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td rowspan="3"><strong>StructurÄƒ ModularÄƒ</strong></td>
                <td>Foldere separate</td>
                <td>Fiecare modul Ã®n folder separat pentru izolare</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>Procese independente</td>
                <td>Fiecare modul ruleazÄƒ Ã®n proces Python separat</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>ConfiguraÈ›ii separate</td>
                <td>Fiecare modul are propriul fiÈ™ier de configuraÈ›ie</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td rowspan="4"><strong>ProtecÈ›ie Date</strong></td>
                <td>Stocare localÄƒ exclusivÄƒ</td>
                <td>Toate datele stocate local, fÄƒrÄƒ partajare reÈ›ea sau cloud</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>Logging local</td>
                <td>Logging detaliat Ã®n fiÈ™iere locale cu encoding UTF-8</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>Transmitere limitatÄƒ</td>
                <td>Doar subset strict definit de rezultate transmis automat</td>
                <td>âœ… Implementat</td>
              </tr>
              <tr>
                <td>Email security</td>
                <td>Integrare Outlook local, destinatari hardcodate, ataÈ™amente parolate</td>
                <td>âœ… Implementat</td>
              </tr>
            </tbody>
          </table>

          <h3>7. Note Importante</h3>
          <ul>
            <li><strong>AplicaÈ›ie Desktop LocalÄƒ:</strong> AplicaÈ›ia Roboescu este o aplicaÈ›ie desktop localÄƒ Python care ruleazÄƒ pe staÈ›ia de lucru a utilizatorului. Toate datele sunt procesate local, fÄƒrÄƒ transmitere cÄƒtre servere externe (cu excepÈ›ia trimiterii email-urilor prin Outlook local).</li>
            <li><strong>Parole Hardcodate:</strong> Pentru aplicaÈ›ia desktop localÄƒ, parolele sunt hardcodate Ã®n cod pentru control acces la nivel aplicaÈ›ie. Acest approach este adecvat pentru aplicaÈ›ii desktop locale, unde utilizatorii au deja acces la sistemul de operare.</li>
            <li><strong>Criptare Excel RealÄƒ:</strong> AplicaÈ›ia foloseÈ™te <code>msoffcrypto-tool</code> pentru criptare realÄƒ a fiÈ™ierelor Excel, nu doar protecÈ›ie la nivel de worksheet. Excel-urile criptate nu pot fi deschise fÄƒrÄƒ parolÄƒ, asigurÃ¢nd protecÈ›ie realÄƒ a datelor.</li>
            <li><strong>StructurÄƒ ModularÄƒ:</strong> AplicaÈ›ia este structuratÄƒ modular, cu fiecare raport Ã®ntr-un folder separat. AceastÄƒ structurÄƒ asigurÄƒ izolare cod, procesare independentÄƒ È™i prevenirea propagÄƒrii erorilor Ã®ntre module.</li>
            <li><strong>Stocare LocalÄƒ:</strong> Toate datele (fiÈ™iere input, output, configuraÈ›ii, log-uri) sunt stocate local pe staÈ›ia de lucru, fÄƒrÄƒ partajare reÈ›ea sau cloud. Aceasta asigurÄƒ control complet asupra datelor È™i minimizarea expunerii.</li>
            <li><strong>Email Security:</strong> Email-urile sunt trimise prin Outlook local (COM Interface), fÄƒrÄƒ necesitatea stocÄƒrii credenÈ›ialelor Ã®n aplicaÈ›ie. Toate Excel-urile trimise prin email sunt parolate, asigurÃ¢nd protecÈ›ie date Ã®n transmitere.</li>
            <li><strong>Transmitere LimitatÄƒ:</strong> Doar un subset strict definit de rezultate este transmis automat prin email cÄƒtre interni ICC È™i creditori GFBT. Aceasta minimizeazÄƒ expunerea datelor È™i asigurÄƒ cÄƒ doar datele necesare sunt transmise.</li>
            <li><strong>Obfuscare Cod (PlanificatÄƒ):</strong> Ãn faza actualÄƒ de dezvoltare, codul sursÄƒ este Ã®n Python plain, fÄƒrÄƒ compilare sau obfuscare. La finalizarea proiectului integral, vom implementa obfuscarea codului sursÄƒ pentru protecÈ›ie suplimentarÄƒ Ã®mpotriva ingineriei inverse È™i accesului neautorizat la logica de business.</li>
          </ul>

          <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 20px; margin: 30px 0; border-radius: 4px;">
            <h3 style="margin-top: 0; color: #856404;">ğŸ“Œ NotÄƒ PunctualÄƒ: Obfuscare Cod la Finalizarea Proiectului</h3>
            
            <h4 style="color: #856404; margin-top: 20px;">MetodÄƒ de Obfuscare: PyArmor</h4>
            <p style="font-size: 16px; line-height: 1.6; margin: 15px 0; font-family: Georgia, serif;">
              La finalizarea proiectului integral, vom implementa obfuscarea codului sursÄƒ utilizÃ¢nd <strong>PyArmor</strong>, un instrument profesional de protecÈ›ie È™i obfuscare pentru aplicaÈ›ii Python.
            </p>

            <h4 style="color: #856404; margin-top: 25px;">Caracteristici PyArmor:</h4>
            <table style="margin: 20px 0; width: 100%; border-collapse: collapse;">
              <thead>
                <tr style="background-color: #ffc107; color: #856404;">
                  <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">CaracteristicÄƒ</th>
                  <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Descriere</th>
                  <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Beneficii</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding: 12px; border: 1px solid #ddd;"><strong>Criptare Bytecode</strong></td>
                  <td style="padding: 12px; border: 1px solid #ddd;">PyArmor cripteazÄƒ bytecode-ul Python, transformÃ¢ndu-l Ã®ntr-o formÄƒ neinteligibilÄƒ</td>
                  <td style="padding: 12px; border: 1px solid #ddd;">ProtecÈ›ie Ã®mpotriva decompilÄƒrii È™i ingineriei inverse</td>
                </tr>
                <tr style="background-color: #fffbf0;">
                  <td style="padding: 12px; border: 1px solid #ddd;"><strong>Obfuscare Variabile È™i FuncÈ›ii</strong></td>
                  <td style="padding: 12px; border: 1px solid #ddd;">Redenumire automatÄƒ a variabilelor È™i funcÈ›iilor cu nume aleatorii</td>
                  <td style="padding: 12px; border: 1px solid #ddd;">Cod dificil de citit È™i Ã®nÈ›eles fÄƒrÄƒ decompilare</td>
                </tr>
                <tr>
                  <td style="padding: 12px; border: 1px solid #ddd;"><strong>ProtecÈ›ie Runtime</strong></td>
                  <td style="padding: 12px; border: 1px solid #ddd;">Verificare integritate la runtime, prevenire modificÄƒri cod</td>
                  <td style="padding: 12px; border: 1px solid #ddd;">ProtecÈ›ie Ã®mpotriva modificÄƒrilor neautorizate</td>
                </tr>
                <tr style="background-color: #fffbf0;">
                  <td style="padding: 12px; border: 1px solid #ddd;"><strong>Binding la MaÈ™inÄƒ</strong></td>
                  <td style="padding: 12px; border: 1px solid #ddd;">OpÈ›ional: legare cod la hardware specific (MAC address, disk serial)</td>
                  <td style="padding: 12px; border: 1px solid #ddd;">Prevenire rulare pe maÈ™ini neautorizate</td>
                </tr>
                <tr>
                  <td style="padding: 12px; border: 1px solid #ddd;"><strong>Expirare LicenÈ›Äƒ</strong></td>
                  <td style="padding: 12px; border: 1px solid #ddd;">Suport pentru licenÈ›e cu expirare È™i verificare online</td>
                  <td style="padding: 12px; border: 1px solid #ddd;">Control distribuÈ›ie È™i utilizare aplicaÈ›ie</td>
                </tr>
                <tr style="background-color: #fffbf0;">
                  <td style="padding: 12px; border: 1px solid #ddd;"><strong>Compatibilitate</strong></td>
                  <td style="padding: 12px; border: 1px solid #ddd;">Suport Python 3.6+, Windows, Linux, macOS</td>
                  <td style="padding: 12px; border: 1px solid #ddd;">FuncÈ›ioneazÄƒ pe toate platformele desktop</td>
                </tr>
              </tbody>
            </table>

            <h4 style="color: #856404; margin-top: 25px;">Proces de Implementare:</h4>
            <ol style="font-size: 16px; line-height: 1.8; margin: 15px 0; padding-left: 30px; font-family: Georgia, serif;">
              <li><strong>Instalare PyArmor:</strong> <code>pip install pyarmor</code></li>
              <li><strong>Obfuscare Module:</strong> Fiecare modul de raport va fi obfuscat individual pentru izolare maximÄƒ</li>
              <li><strong>Obfuscare Main:</strong> FiÈ™ierul principal <code>main.py</code> va fi obfuscat cu protecÈ›ie maximÄƒ</li>
              <li><strong>Generare DistribuÈ›ie:</strong> Creare pachet distributabil cu toate modulele obfuscate</li>
              <li><strong>Testare Post-Obfuscare:</strong> Testare completÄƒ pentru asigurarea funcÈ›ionalitÄƒÈ›ii dupÄƒ obfuscare</li>
            </ol>

            <h4 style="color: #856404; margin-top: 25px;">ConfiguraÈ›ie PyArmor PlanificatÄƒ:</h4>
            <div style="background-color: #f8f9fa; padding: 15px; border-radius: 4px; margin: 15px 0; font-family: 'Consolas', 'Monaco', monospace; font-size: 14px; overflow-x: auto;">
              <pre style="margin: 0; white-space: pre-wrap;"># Exemplu comandÄƒ PyArmor pentru obfuscare
pyarmor gen --enable-rft --enable-jit --restrict main.py
pyarmor gen --enable-rft --enable-jit raport_creditori/processor.py
pyarmor gen --enable-rft --enable-jit raport_productivitate/processor.py
# ... pentru toate modulele

# OpÈ›iuni utilizate:
# --enable-rft: Runtime protection (verificare integritate)
# --enable-jit: Just-In-Time compilation pentru performanÈ›Äƒ
# --restrict: RestricÈ›ii suplimentare de securitate</pre>
      </div>

            <h4 style="color: #856404; margin-top: 25px;">Niveluri de ProtecÈ›ie:</h4>
            <table style="margin: 20px 0; width: 100%; border-collapse: collapse;">
              <thead>
                <tr style="background-color: #ffc107; color: #856404;">
                  <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Nivel</th>
                  <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Descriere</th>
                  <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Aplicare</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding: 12px; border: 1px solid #ddd;"><strong>Nivel 1: Obfuscare Basic</strong></td>
                  <td style="padding: 12px; border: 1px solid #ddd;">Criptare bytecode È™i redenumire variabile</td>
                  <td style="padding: 12px; border: 1px solid #ddd;">Toate modulele de rapoarte</td>
                </tr>
                <tr style="background-color: #fffbf0;">
                  <td style="padding: 12px; border: 1px solid #ddd;"><strong>Nivel 2: ProtecÈ›ie Runtime</strong></td>
                  <td style="padding: 12px; border: 1px solid #ddd;">Verificare integritate È™i protecÈ›ie anti-debug</td>
                  <td style="padding: 12px; border: 1px solid #ddd;">Module critice (main.py, processor.py)</td>
                </tr>
                <tr>
                  <td style="padding: 12px; border: 1px solid #ddd;"><strong>Nivel 3: Binding Hardware</strong></td>
                  <td style="padding: 12px; border: 1px solid #ddd;">Legare cod la maÈ™inÄƒ specificÄƒ (opÈ›ional)</td>
                  <td style="padding: 12px; border: 1px solid #ddd;">Doar dacÄƒ este necesar pentru distribuÈ›ie controlatÄƒ</td>
                </tr>
              </tbody>
            </table>

            <h4 style="color: #856404; margin-top: 25px;">Avantaje PyArmor:</h4>
            <ul style="font-size: 16px; line-height: 1.8; margin: 15px 0; padding-left: 30px; font-family: Georgia, serif;">
              <li><strong>ProtecÈ›ie EficientÄƒ:</strong> Criptare realÄƒ a bytecode-ului, nu doar ofuscare textualÄƒ</li>
              <li><strong>PerformanÈ›Äƒ:</strong> Impact minim asupra performanÈ›ei aplicaÈ›iei (overhead < 5%)</li>
              <li><strong>Compatibilitate:</strong> FuncÈ›ioneazÄƒ cu toate bibliotecile Python utilizate (pandas, openpyxl, customtkinter, etc.)</li>
              <li><strong>UÈ™urinÈ›Äƒ Utilizare:</strong> Proces simplu de obfuscare, fÄƒrÄƒ modificÄƒri majore Ã®n cod</li>
              <li><strong>MentenanÈ›Äƒ:</strong> Codul sursÄƒ original rÄƒmÃ¢ne neschimbat, obfuscarea se aplicÄƒ la build</li>
              <li><strong>Suport:</strong> DocumentaÈ›ie completÄƒ È™i comunitate activÄƒ</li>
            </ul>

            <h4 style="color: #856404; margin-top: 25px;">ConsideraÈ›ii Importante:</h4>
            <ul style="font-size: 16px; line-height: 1.8; margin: 15px 0; padding-left: 30px; font-family: Georgia, serif;">
              <li><strong>ProtecÈ›ie RelativÄƒ:</strong> Obfuscarea adaugÄƒ un strat de securitate, dar nu oferÄƒ protecÈ›ie absolutÄƒ. Este recomandat sÄƒ se combine cu alte mÄƒsuri (control acces, criptare date).</li>
              <li><strong>Backup Cod SursÄƒ:</strong> Codul sursÄƒ original va fi pÄƒstrat Ã®n siguranÈ›Äƒ pentru mentenanÈ›Äƒ È™i actualizÄƒri viitoare.</li>
              <li><strong>Testare ExtensivÄƒ:</strong> DupÄƒ obfuscare, se va efectua testare completÄƒ pentru asigurarea funcÈ›ionalitÄƒÈ›ii corecte.</li>
              <li><strong>Versionare:</strong> Versiunile obfuscate vor fi marcate distinct Ã®n sistemul de versionare.</li>
            </ul>

            <p style="font-size: 16px; line-height: 1.6; margin: 20px 0 0 0; font-family: Georgia, serif; font-weight: bold; color: #856404;">
              <strong>Concluzie:</strong> La finalizarea proiectului integral, implementarea obfuscarei codului cu PyArmor va asigura un nivel suplimentar de protecÈ›ie pentru logica de business È™i proprietatea intelectualÄƒ a aplicaÈ›iei Roboescu, completÃ¢nd mÄƒsurile de securitate existente (parole, criptare Excel, structurÄƒ modularÄƒ).
            </p>
          </div>

        </section>
      </div>
    </section>

    <section class="content-section hidden" id="secDatePersonale">
      <div class="section-head">
        <div class="title">ğŸ“‹ ProtecÈ›ie Date Personale</div>
        <div style="opacity:.75; font-weight:700; color:#22507a;">Metode protejare/reducere expunere date cu caracter personal/financiare/confidenÈ›iale</div>
      </div>
      <div class="section-body">
        <section class="doc-section">
          <h2>Metode de Protejare/Reducere Expunere pentru Datele cu Caracter Personal È™i/sau Financiare/ConfidenÈ›iale</h2>
          
          <div style="background: #e8f5e9; border-left: 4px solid #4caf50; padding: 20px; margin: 20px 0; border-radius: 4px;">
            <h3 style="margin-top: 0; color: #2e7d32;">âœ… DeclaraÈ›ie FundamentalÄƒ: Model de Procesare FÄƒrÄƒ Colectare È™i Stocare</h3>
            <p style="font-size: 16px; line-height: 1.6; margin: 0; font-family: Georgia, serif;">
              <strong>AplicaÈ›ia Roboescu NU colecteazÄƒ, NU stocheazÄƒ È™i NU reÈ›ine date cu caracter personal, date financiare sau informaÈ›ii confidenÈ›iale.</strong> AplicaÈ›ia acÈ›ioneazÄƒ exclusiv ca un <strong>filtru de procesare</strong> care prelucreazÄƒ date brute conferite de utilizator conform criteriilor stabilite, fÄƒrÄƒ a reÈ›ine sau stoca aceste date dupÄƒ finalizarea prelucrÄƒrii.
            </p>
            <p style="font-size: 16px; line-height: 1.6; margin: 15px 0 0 0; font-family: Georgia, serif;">
              Toate datele sunt procesate <strong>exclusiv Ã®n memorie temporarÄƒ</strong> pe staÈ›ia de lucru localÄƒ a utilizatorului desemnat ICC. DupÄƒ finalizarea procesÄƒrii È™i generÄƒrii rapoartelor, toate datele sunt eliminate din memorie, aplicaÈ›ia revenind la starea iniÈ›ialÄƒ fÄƒrÄƒ reÈ›inerea vreunei informaÈ›ii.
            </p>
            <p style="font-size: 16px; line-height: 1.6; margin: 15px 0 0 0; font-family: Georgia, serif;">
              Rezultatele prelucrÄƒrii datelor care se transmit prin email sunt comunicate <strong>exclusiv cÄƒtre utilizatori ICC</strong> È™i cÄƒtre entitÄƒÈ›i din grupul financiar BT (BT MicrofinanÈ›are, BT Direct, Salt Bank etc.), Ã®n conformitate cu acordurile È™i protocolurile stabilite. Transmiterea se face prin intermediul clientului Outlook local al utilizatorului, fÄƒrÄƒ utilizarea de servicii externe de email sau cloud.
            </p>
          </div>

          <h3>1. Conformitate cu Cadrul Legal de ProtecÈ›ie a Datelor</h3>

          <h4>1.1. Respectarea Regulamentului General privind ProtecÈ›ia Datelor (GDPR)</h4>
          <table>
            <thead>
              <tr>
                <th>Principiu GDPR</th>
                <th>Conformitate AplicaÈ›ie Roboescu</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Minimizare Date (Art. 5(1)(c))</strong></td>
                <td>AplicaÈ›ia proceseazÄƒ doar datele strict necesare pentru generarea rapoartelor solicitate</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Procesare doar a coloanelor relevante din fiÈ™ierele Excel introduse</li>
                    <li>Filtrare automatÄƒ a datelor neesenÈ›iale</li>
                    <li>Eliminare date redundante Ã®nainte de procesare</li>
                    <li>FÄƒrÄƒ colectare de date suplimentare</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Limitare Scop (Art. 5(1)(b))</strong></td>
                <td>Datele sunt procesate exclusiv pentru scopul declarat: generarea rapoartelor</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Procesare strictÄƒ conform criteriilor stabilite de utilizator</li>
                    <li>FÄƒrÄƒ utilizare secundarÄƒ a datelor</li>
                    <li>FÄƒrÄƒ profilare sau analizÄƒ comportamentalÄƒ</li>
                    <li>FÄƒrÄƒ partajare cu terÈ›i</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Limitare Stocare (Art. 5(1)(e))</strong></td>
                <td>Datele nu sunt stocate dupÄƒ finalizarea procesÄƒrii</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Procesare exclusiv Ã®n memorie temporarÄƒ (RAM)</li>
                    <li>Eliminare automatÄƒ a datelor din memorie dupÄƒ generarea rapoartelor</li>
                    <li>FÄƒrÄƒ stocare persistentÄƒ Ã®n baze de date</li>
                    <li>FÄƒrÄƒ fiÈ™iere cache sau temporare care reÈ›in date</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Integritate È™i ConfidenÈ›ialitate (Art. 5(1)(f))</strong></td>
                <td>Datele sunt protejate Ã®mpotriva accesului neautorizat È™i pierderii</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Procesare localÄƒ exclusivÄƒ pe staÈ›ia utilizatorului</li>
                    <li>FÄƒrÄƒ transmitere cÄƒtre servere externe</li>
                    <li>ProtecÈ›ie fiÈ™iere Excel generate cu criptare È™i parole</li>
                    <li>Acces controlat prin parole pentru secÈ›iuni sensibile</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>2. Model de Procesare: AplicaÈ›ie ca Filtru de Prelucrare</h3>

          <h4>2.1. Flux de Procesare FÄƒrÄƒ Stocare</h4>
          <table>
            <thead>
              <tr>
                <th>EtapÄƒ</th>
                <th>Descriere</th>
                <th>Stocare Date</th>
                <th>DuratÄƒ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>1. Introducere Date</strong></td>
                <td>Utilizatorul selecteazÄƒ fiÈ™iere Excel cu date brute pentru procesare</td>
                <td>FÄƒrÄƒ stocare - doar citire directÄƒ din fiÈ™ier</td>
                <td>MomentanÄƒ</td>
              </tr>
              <tr>
                <td><strong>2. ÃncÄƒrcare Ã®n Memorie</strong></td>
                <td>Datele sunt Ã®ncÄƒrcate Ã®n memorie temporarÄƒ (RAM) pentru procesare</td>
                <td>Memorie temporarÄƒ (RAM) - eliminatÄƒ automat la finalizare</td>
                <td>Doar Ã®n timpul procesÄƒrii</td>
              </tr>
              <tr>
                <td><strong>3. Procesare Conform Criteriilor</strong></td>
                <td>AplicaÈ›ia aplicÄƒ filtre, calcule È™i transformÄƒri conform criteriilor stabilite</td>
                <td>Memorie temporarÄƒ (RAM) - date procesate, nu stocate</td>
                <td>Doar Ã®n timpul procesÄƒrii</td>
              </tr>
              <tr>
                <td><strong>4. Generare Rapoarte</strong></td>
                <td>Rapoartele sunt generate È™i salvate Ã®n fiÈ™iere Excel parolate</td>
                <td>FÄƒrÄƒ stocare - doar scriere directÄƒ Ã®n fiÈ™ier output</td>
                <td>MomentanÄƒ</td>
              </tr>
              <tr>
                <td><strong>5. Eliminare Date din Memorie</strong></td>
                <td>Toate datele sunt eliminate automat din memorie dupÄƒ finalizare</td>
                <td>FÄƒrÄƒ stocare - memorie eliberatÄƒ complet</td>
                <td>Imediat dupÄƒ finalizare</td>
              </tr>
              <tr>
                <td><strong>6. Stare IniÈ›ialÄƒ</strong></td>
                <td>AplicaÈ›ia revine la starea iniÈ›ialÄƒ, fÄƒrÄƒ reÈ›inerea vreunei informaÈ›ii</td>
                <td>FÄƒrÄƒ stocare - aplicaÈ›ia gata pentru urmÄƒtoarea procesare</td>
                <td>PermanentÄƒ</td>
              </tr>
            </tbody>
          </table>

          <h4>2.2. Caracteristici Modelului de Procesare</h4>
          <table>
            <thead>
              <tr>
                <th>CaracteristicÄƒ</th>
                <th>Descriere</th>
                <th>Beneficii ProtecÈ›ie Date</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>FÄƒrÄƒ Colectare</strong></td>
                <td>AplicaÈ›ia nu colecteazÄƒ date din surse externe sau automat</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FÄƒrÄƒ risc de colectare neautorizatÄƒ</li>
                    <li>Control total asupra datelor de cÄƒtre utilizator</li>
                    <li>FÄƒrÄƒ tracking sau monitorizare</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>FÄƒrÄƒ Stocare PersistentÄƒ</strong></td>
                <td>Datele nu sunt salvate Ã®n baze de date, fiÈ™iere cache sau sisteme de stocare</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FÄƒrÄƒ risc de acces ulterior la date</li>
                    <li>FÄƒrÄƒ posibilitate de recuperare date È™terse</li>
                    <li>Conformitate cu principiul limitÄƒrii stocÄƒrii</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Procesare Exclusiv Ã®n Memorie</strong></td>
                <td>Toate operaÈ›iile se desfÄƒÈ™oarÄƒ Ã®n memorie temporarÄƒ (RAM)</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Eliminare automatÄƒ la Ã®nchidere aplicaÈ›ie</li>
                    <li>FÄƒrÄƒ urme persistente pe disc</li>
                    <li>ProtecÈ›ie Ã®mpotriva accesului ulterior</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Eliminare AutomatÄƒ</strong></td>
                <td>Datele sunt eliminate automat din memorie dupÄƒ finalizarea procesÄƒrii</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FÄƒrÄƒ necesitate intervenÈ›ie manualÄƒ</li>
                    <li>Conformitate automatÄƒ cu GDPR</li>
                    <li>Reducere risc de expunere accidentalÄƒ</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>FÄƒrÄƒ Transmitere ExternÄƒ</strong></td>
                <td>Datele nu sunt transmise cÄƒtre servere externe sau servicii cloud</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FÄƒrÄƒ risc de interceptare Ã®n tranzit</li>
                    <li>FÄƒrÄƒ dependenÈ›Äƒ de servicii terÈ›e</li>
                    <li>Control complet asupra datelor</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>3. Tipuri de Date Procesate (FÄƒrÄƒ Stocare)</h3>

          <h4>3.1. Date din FiÈ™iere Excel Introduse de Utilizator</h4>
          <table>
            <thead>
              <tr>
                <th>Tip Date</th>
                <th>Origine</th>
                <th>Procesare</th>
                <th>Stocare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Date Identificare</strong></td>
                <td>FiÈ™iere Excel Master selectate de utilizator</td>
                <td>Procesare conform criteriilor (filtrare, sortare, calcul)</td>
                <td>âŒ FÄƒrÄƒ stocare - procesare exclusiv Ã®n memorie temporarÄƒ</td>
              </tr>
              <tr>
                <td><strong>Date Financiare</strong></td>
                <td>Coloane cu sume, creanÈ›e, datorii din Excel</td>
                <td>Calcule, agregÄƒri, analize pentru rapoarte</td>
                <td>âŒ FÄƒrÄƒ stocare - eliminare automatÄƒ dupÄƒ procesare</td>
              </tr>
              <tr>
                <td><strong>Date Procedurale</strong></td>
                <td>InformaÈ›ii despre dosare, proceduri, termene</td>
                <td>Filtrare, grupare, raportare conform criteriilor</td>
                <td>âŒ FÄƒrÄƒ stocare - procesare temporarÄƒ doar</td>
              </tr>
              <tr>
                <td><strong>Date Identificare Persoane</strong></td>
                <td>CNP-uri, nume, identificatori (dacÄƒ prezente Ã®n Excel)</td>
                <td>Validare CNP, procesare pentru rapoarte</td>
                <td>âŒ FÄƒrÄƒ stocare - procesare exclusiv Ã®n memorie</td>
              </tr>
            </tbody>
          </table>

          <h4>3.2. Date Generate (Rapoarte Output)</h4>
          <table>
            <thead>
              <tr>
                <th>Tip Date</th>
                <th>Generare</th>
                <th>Stocare</th>
                <th>ProtecÈ›ie</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Rapoarte Excel</strong></td>
                <td>Generate din datele procesate conform criteriilor</td>
                <td>Salvate Ã®n foldere locale selectate de utilizator</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Criptare realÄƒ cu parolÄƒ (msoffcrypto)</li>
                    <li>ProtecÈ›ie la nivel de fiÈ™ier</li>
                    <li>Control utilizator asupra locaÈ›iei</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Log-uri Procesare</strong></td>
                <td>InformaÈ›ii despre procesare (fÄƒrÄƒ date sensibile)</td>
                <td>FiÈ™iere log locale (opÈ›ional)</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FÄƒrÄƒ date cu caracter personal Ã®n log-uri</li>
                    <li>Doar informaÈ›ii tehnice (timp procesare, numÄƒr rÃ¢nduri)</li>
                    <li>Stocare localÄƒ exclusivÄƒ</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>4. MÄƒsuri de ProtecÈ›ie Implementate</h3>

          <h4>4.1. ProtecÈ›ie la Nivel de Procesare</h4>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Procesare LocalÄƒ ExclusivÄƒ</strong></td>
                <td>Toate datele sunt procesate doar pe staÈ›ia de lucru localÄƒ</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FÄƒrÄƒ conexiuni externe pentru procesare</li>
                    <li>FÄƒrÄƒ servicii cloud sau servere remote</li>
                    <li>Control complet asupra locaÈ›iei procesÄƒrii</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Eliminare AutomatÄƒ Memorie</strong></td>
                <td>Datele sunt eliminate automat din memorie dupÄƒ procesare</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Garbage collection automat Python</li>
                    <li>Eliberare explicitÄƒ a variabilelor dupÄƒ procesare</li>
                    <li>FÄƒrÄƒ reÈ›inere referinÈ›e la date</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>FÄƒrÄƒ Cache Persistent</strong></td>
                <td>AplicaÈ›ia nu creeazÄƒ fiÈ™iere cache sau temporare cu date</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FÄƒrÄƒ stocare intermediarÄƒ pe disc</li>
                    <li>Procesare directÄƒ din fiÈ™ier Ã®n memorie</li>
                    <li>FÄƒrÄƒ fiÈ™iere temporare care reÈ›in date</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Validare Input</strong></td>
                <td>Validare strictÄƒ a datelor introduse pentru prevenire erori</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Validare structurÄƒ Excel</li>
                    <li>Validare CNP-uri (dacÄƒ aplicabil)</li>
                    <li>Validare tipuri de date</li>
                    <li>FÄƒrÄƒ procesare date invalide</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h4>4.2. ProtecÈ›ie FiÈ™iere Output</h4>
          <table>
            <thead>
              <tr>
                <th>MÄƒsurÄƒ</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Criptare Excel cu ParolÄƒ</strong></td>
                <td>Toate rapoartele Excel generate sunt criptate cu parolÄƒ</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Criptare realÄƒ cu msoffcrypto-tool</li>
                    <li>Parole configurate Ã®n cod</li>
                    <li>Excel-urile nu pot fi deschise fÄƒrÄƒ parolÄƒ</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Control LocaÈ›ie Output</strong></td>
                <td>Utilizatorul controleazÄƒ complet unde sunt salvate rapoartele</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Selectare manualÄƒ folder output</li>
                    <li>FÄƒrÄƒ salvare automatÄƒ Ã®n locaÈ›ii fixe</li>
                    <li>Control utilizator asupra distribuÈ›iei</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Nume FiÈ™iere Unice</strong></td>
                <td>FiÈ™ierele generate au nume unice pentru a preveni suprascrierea</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Timestamp Ã®n numele fiÈ™ierelor</li>
                    <li>FÄƒrÄƒ reutilizare nume fiÈ™iere</li>
                    <li>Istoric clar al rapoartelor generate</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>5. Rezumat: Conformitate È™i ProtecÈ›ie</h3>
          <table>
            <thead>
              <tr>
                <th>Aspect</th>
                <th>Status</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Colectare Date</strong></td>
                <td>âŒ NU</td>
                <td>AplicaÈ›ia nu colecteazÄƒ date din surse externe sau automat</td>
              </tr>
              <tr>
                <td><strong>Stocare Date</strong></td>
                <td>âŒ NU</td>
                <td>AplicaÈ›ia nu stocheazÄƒ date Ã®n baze de date sau sisteme persistente</td>
              </tr>
              <tr>
                <td><strong>Procesare Date</strong></td>
                <td>âœ… DA (Temporar)</td>
                <td>Datele sunt procesate exclusiv Ã®n memorie temporarÄƒ conform criteriilor stabilite</td>
              </tr>
              <tr>
                <td><strong>ReÈ›inere Date</strong></td>
                <td>âŒ NU</td>
                <td>DupÄƒ finalizarea procesÄƒrii, aplicaÈ›ia nu reÈ›ine nicio datÄƒ</td>
              </tr>
              <tr>
                <td><strong>Transmitere Date</strong></td>
                <td>âŒ NU</td>
                <td>Datele nu sunt transmise cÄƒtre servere externe sau servicii cloud</td>
              </tr>
              <tr>
                <td><strong>Conformitate GDPR</strong></td>
                <td>âœ… DA</td>
                <td>Modelul de procesare respectÄƒ principiile GDPR (minimizare, limitare scop, limitare stocare)</td>
              </tr>
              <tr>
                <td><strong>Model AplicaÈ›ie</strong></td>
                <td>âœ… Filtru de Prelucrare</td>
                <td>AplicaÈ›ia acÈ›ioneazÄƒ ca un filtru care prelucreazÄƒ date brute È™i genereazÄƒ rapoarte, fÄƒrÄƒ reÈ›inere date</td>
              </tr>
            </tbody>
          </table>

          <h3>6. Note Importante</h3>
          <ul>
            <li><strong>Model FÄƒrÄƒ Stocare:</strong> AplicaÈ›ia Roboescu este conceputÄƒ ca un instrument de procesare temporarÄƒ, nu ca un sistem de stocare. Toate datele sunt procesate exclusiv Ã®n memorie temporarÄƒ È™i eliminate automat dupÄƒ finalizarea procesÄƒrii.</li>
            <li><strong>Control Utilizator:</strong> Utilizatorul are control complet asupra datelor: selecteazÄƒ ce fiÈ™iere proceseazÄƒ, unde salveazÄƒ rezultatele È™i cÃ¢nd È™terge fiÈ™ierele generate.</li>
            <li><strong>Conformitate GDPR:</strong> Modelul de procesare fÄƒrÄƒ colectare È™i stocare asigurÄƒ conformitate naturalÄƒ cu principiile GDPR, minimizÃ¢nd riscurile de expunere a datelor.</li>
            <li><strong>ProtecÈ›ie Output:</strong> Rapoartele generate sunt protejate prin criptare cu parolÄƒ, asigurÃ¢nd cÄƒ doar persoanele autorizate pot accesa rezultatele.</li>
            <li><strong>FÄƒrÄƒ Tracking:</strong> AplicaÈ›ia nu urmÄƒreÈ™te, nu monitorizeazÄƒ È™i nu analizeazÄƒ comportamentul utilizatorului sau datele procesate Ã®n scopuri secundare.</li>
            <li><strong>Izolare CompletÄƒ:</strong> Fiecare sesiune de procesare este complet izolatÄƒ - datele dintr-o sesiune nu influenÈ›eazÄƒ sau nu sunt accesibile Ã®n alte sesiuni.</li>
          </ul>
        </section>
      </div>
    </section>

    <section class="content-section hidden" id="secFunctionala">
      <div class="section-head">
        <div class="title">âš™ï¸ Descriere FuncÈ›ionalÄƒ</div>
        <div style="opacity:.75; font-weight:700; color:#22507a;">FuncÈ›ionalitÄƒÈ›i È™i fluxuri de lucru ale aplicaÈ›iei</div>
      </div>
      <div class="section-body">
        <section class="doc-section">
          <h2>Descrierea FuncÈ›ionalÄƒ a AplicaÈ›iei Roboescu</h2>
          
          <h3>1. FuncÈ›ionalitÄƒÈ›i Principale</h3>

          <h4>1.1. InterfaÈ›Äƒ GraficÄƒ PrincipalÄƒ (main.py)</h4>
          <table>
            <thead>
              <tr>
                <th>FuncÈ›ionalitate</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Ecran de Start</strong></td>
                <td>Ecran de bun venit cu imagine de fundal È™i buton de acces la meniul principal</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Design modern cu CustomTkinter (dark theme)</li>
                    <li>Imagine de fundal personalizatÄƒ</li>
                    <li>Buton "Start" pentru acces la meniul principal</li>
                    <li>AnimaÈ›ii È™i efecte de tranziÈ›ie</li>
                    <li>FiÈ™ier: <code>main.py</code> (clasa StartScreen)</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Meniu Principal</strong></td>
                <td>InterfaÈ›Äƒ principalÄƒ cu lista tuturor rapoartelor disponibile</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Tabel cu 13 rapoarte organizate pe categorii</li>
                    <li>Status tracking: Activ / Ãn mentenanÈ›Äƒ / Dezactivat</li>
                    <li>Ultima rulare afiÈ™atÄƒ pentru fiecare raport</li>
                    <li>Butoane de acces pentru fiecare raport</li>
                    <li>SecÈ›iuni: Raportare ICC, Juridic ICC, InsolvenÈ›Äƒ ICC, etc.</li>
                    <li>FiÈ™ier: <code>main.py</code> (clasa MainMenuScreen)</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>ProtecÈ›ie SecÈ›iuni</strong></td>
                <td>SecÈ›iuni protejate cu parolÄƒ pentru acces restricÈ›ionat</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Dialog de autentificare pentru secÈ›iuni protejate</li>
                    <li>Verificare parolÄƒ hardcodatÄƒ Ã®n aplicaÈ›ie</li>
                    <li>Acces permis doar dupÄƒ autentificare reuÈ™itÄƒ</li>
                    <li>FiÈ™ier: <code>main.py</code> (funcÈ›ia show_password_dialog)</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>PersistenÈ›Äƒ ConfiguraÈ›ie</strong></td>
                <td>Salvare È™i Ã®ncÄƒrcare configuraÈ›ie persistentÄƒ</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FiÈ™ier JSON pentru status rapoarte (rapoarte_status.json)</li>
                    <li>ConfiguraÈ›ie globalÄƒ (config.json)</li>
                    <li>ConfiguraÈ›ie per modul (config.json Ã®n fiecare modul)</li>
                    <li>Salvare automatÄƒ la modificÄƒri</li>
                    <li>FiÈ™ier: <code>config.py</code>, <code>config.json</code></li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h4>1.2. InterfeÈ›e Rapoarte (screen.py)</h4>
          <table>
            <thead>
              <tr>
                <th>FuncÈ›ionalitate</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>InterfaÈ›Äƒ UnificatÄƒ per Raport</strong></td>
                <td>Fiecare raport are o interfaÈ›Äƒ graficÄƒ dedicatÄƒ pentru configurare È™i rulare</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Selectare folder Master (input)</li>
                    <li>Selectare folder Output (rezultate)</li>
                    <li>Checkbox pentru activare/dezactivare trimitere email</li>
                    <li>Buton "Start Procesare" pentru iniÈ›iere raport</li>
                    <li>Progress bar pentru progres procesare</li>
                    <li>Log viewer Ã®n timp real</li>
                    <li>FiÈ™ier: <code>raport_[nume]/screen.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Validare Input</strong></td>
                <td>Validare cÄƒutare fiÈ™iere È™i configuraÈ›ie Ã®nainte de procesare</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Verificare existenÈ›Äƒ folder Master</li>
                    <li>Verificare existenÈ›Äƒ fiÈ™iere Excel necesare</li>
                    <li>Validare structurÄƒ Excel (sheet-uri, coloane)</li>
                    <li>Mesaje de eroare clare pentru utilizator</li>
                    <li>FiÈ™ier: <code>raport_[nume]/processor.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Procesare AsincronÄƒ</strong></td>
                <td>Procesare rapoarte Ã®n threaduri separate pentru a nu bloca interfaÈ›a</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Threading pentru execuÈ›ie paralelÄƒ</li>
                    <li>Update progres Ã®n timp real</li>
                    <li>Logging Ã®n interfaÈ›Äƒ graficÄƒ</li>
                    <li>Gestionare erori fÄƒrÄƒ blocare UI</li>
                    <li>FiÈ™ier: <code>raport_[nume]/screen.py</code></li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h4>1.3. Procesare Rapoarte (processor.py)</h4>
          <table>
            <thead>
              <tr>
                <th>FuncÈ›ionalitate</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Citire FiÈ™iere Master</strong></td>
                <td>Citire È™i procesare fiÈ™iere Excel din folderul Master</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Detectare automatÄƒ engine (xlrd, openpyxl, pyxlsb)</li>
                    <li>Citire multiple sheet-uri</li>
                    <li>Concatenare È™i aliniere coloane</li>
                    <li>Skiprows pentru eliminare rÃ¢nduri header</li>
                    <li>FiÈ™ier: <code>raport_[nume]/processor.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Filtrare È™i Procesare Date</strong></td>
                <td>Filtrare date dupÄƒ criterii specifice fiecÄƒrui raport</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Filtrare dupÄƒ PORTFOLIO, valoare, datÄƒ, stadiu</li>
                    <li>Mapping È™i normalizare portofolio</li>
                    <li>Eliminare duplicate</li>
                    <li>Validare CNP, date, structurÄƒ Excel</li>
                    <li>FiÈ™ier: <code>raport_[nume]/processor.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Generare Rapoarte Excel</strong></td>
                <td>Creare fiÈ™iere Excel formatate cu date procesate</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Formatare font Georgia 11pt</li>
                    <li>ProtecÈ›ie parolÄƒ Excel (msoffcrypto-tool)</li>
                    <li>Multiple sheet-uri per raport</li>
                    <li>Pivot tables È™i grafice</li>
                    <li>Salvare cu nume unic (timestamp)</li>
                    <li>FiÈ™ier: <code>raport_[nume]/processor.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Trimitere Email</strong></td>
                <td>Trimitere automatÄƒ email-uri cu rapoarte Excel ataÈ™ate</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Integrare Outlook local (win32com.client)</li>
                    <li>Email-uri HTML cu font Georgia 11pt</li>
                    <li>Destinatari hardcodaÈ›i per raport</li>
                    <li>AtaÈ™amente Excel parolate</li>
                    <li>Grafice È™i tabele Ã®ncorporate</li>
                    <li>FiÈ™ier: <code>raport_[nume]/processor.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Integrare API Externe</strong></td>
                <td>Integrare cu servicii externe pentru date suplimentare</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>API portal.just.ro (SOAP cu Zeep)</li>
                    <li>Web scraping CASAN (Playwright + OCR)</li>
                    <li>Rezolvare CAPTCHA automatÄƒ (Tesseract + OpenCV)</li>
                    <li>Retry logic È™i gestionare erori</li>
                    <li>FiÈ™ier: <code>raport_portal_just/actualizare_portal_just.py</code>, <code>raport_interogare_siui/processor.py</code></li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h4>1.4. Scheduler Automat (scheduler.py)</h4>
          <table>
            <thead>
              <tr>
                <th>FuncÈ›ionalitate</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Programare RulÄƒri Automate</strong></td>
                <td>Sistem de programare pentru rulÄƒri periodice ale rapoartelor</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>BibliotecÄƒ: <code>schedule</code> pentru programare</li>
                    <li>Rulare lunarÄƒ (a 2-a zi lucrÄƒtoare a lunii)</li>
                    <li>Rulare zilnicÄƒ sau sÄƒptÄƒmÃ¢nalÄƒ (configurabil)</li>
                    <li>Threading pentru execuÈ›ie Ã®n background</li>
                    <li>FiÈ™ier: <code>raport_[nume]/scheduler.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Configurare FlexibilÄƒ</strong></td>
                <td>Configurare programare per raport Ã®n fiÈ™ier JSON</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Configurare Ã®n <code>config.json</code> per modul</li>
                    <li>Specificare zi, orÄƒ, frecvenÈ›Äƒ</li>
                    <li>Activare/dezactivare programare</li>
                    <li>PersistenÈ›Äƒ configuraÈ›ie</li>
                    <li>FiÈ™ier: <code>raport_[nume]/config.json</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Gestionare Erori Scheduler</strong></td>
                <td>Gestionare robustÄƒ a erorilor Ã®n rulÄƒrile automate</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Logging detaliat pentru debugging</li>
                    <li>Retry logic pentru erori temporare</li>
                    <li>NotificÄƒri pentru erori critice</li>
                    <li>Continuare execuÈ›ie dupÄƒ erori</li>
                    <li>FiÈ™ier: <code>raport_[nume]/scheduler.py</code></li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>2. Fluxuri FuncÈ›ionale</h3>

          <h4>2.1. Flux de IniÈ›ializare AplicaÈ›ie</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>ComponentÄƒ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Lansare aplicaÈ›ie (main.py)</td>
                <td>Python - ExecuÈ›ie script</td>
              </tr>
              <tr>
                <td>2</td>
                <td>ÃncÄƒrcare configuraÈ›ie globalÄƒ</td>
                <td>config.py - Citire config.json</td>
              </tr>
              <tr>
                <td>3</td>
                <td>ÃncÄƒrcare status rapoarte</td>
                <td>rapoarte_status.json - Status activ/mentenanÈ›Äƒ</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Creare interfaÈ›Äƒ graficÄƒ (CustomTkinter)</td>
                <td>main.py - IniÈ›ializare App</td>
              </tr>
              <tr>
                <td>5</td>
                <td>AfiÈ™are ecran de start</td>
                <td>StartScreen - Imagine fundal, buton Start</td>
              </tr>
              <tr>
                <td>6</td>
                <td>La click "Start": AfiÈ™are meniu principal</td>
                <td>MainMenuScreen - Tabel cu rapoarte</td>
              </tr>
            </tbody>
          </table>

          <h4>2.2. Flux de Rulare Raport</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>ComponentÄƒ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Utilizator selecteazÄƒ raport din meniu</td>
                <td>MainMenuScreen - Click pe raport</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Verificare protecÈ›ie parolÄƒ (dacÄƒ necesarÄƒ)</td>
                <td>main.py - show_password_dialog</td>
              </tr>
              <tr>
                <td>3</td>
                <td>Deschidere interfaÈ›Äƒ raport (screen.py)</td>
                <td>RaportScreen - InterfaÈ›Äƒ configurare</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Utilizator selecteazÄƒ folder Master</td>
                <td>RaportScreen - Dialog selectare folder</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Utilizator selecteazÄƒ folder Output</td>
                <td>RaportScreen - Dialog selectare folder</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Utilizator configureazÄƒ opÈ›iuni (email, etc.)</td>
                <td>RaportScreen - Checkbox-uri È™i cÃ¢mpuri</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Utilizator apasÄƒ "Start Procesare"</td>
                <td>RaportScreen - Buton start</td>
              </tr>
              <tr>
                <td>8</td>
                <td>Validare input (fiÈ™iere, configuraÈ›ie)</td>
                <td>processor.py - Validare fiÈ™iere È™i structurÄƒ</td>
              </tr>
              <tr>
                <td>9</td>
                <td>Lansare procesare Ã®n thread separat</td>
                <td>RaportScreen - Threading</td>
              </tr>
              <tr>
                <td>10</td>
                <td>Citire È™i procesare fiÈ™iere Master</td>
                <td>processor.py - Citire Excel, filtrare, procesare</td>
              </tr>
              <tr>
                <td>11</td>
                <td>Generare raport Excel formatat</td>
                <td>processor.py - Creare Excel cu formatare</td>
              </tr>
              <tr>
                <td>12</td>
                <td>ProtecÈ›ie parolÄƒ Excel (dacÄƒ necesarÄƒ)</td>
                <td>processor.py - msoffcrypto-tool</td>
              </tr>
              <tr>
                <td>13</td>
                <td>Trimitere email (dacÄƒ activatÄƒ)</td>
                <td>processor.py - win32com.client (Outlook)</td>
              </tr>
              <tr>
                <td>14</td>
                <td>Actualizare status È™i ultima rulare</td>
                <td>rapoarte_status.json - Salvare timestamp</td>
              </tr>
              <tr>
                <td>15</td>
                <td>AfiÈ™are mesaj succes/eroare</td>
                <td>RaportScreen - Mesaje Ã®n interfaÈ›Äƒ</td>
              </tr>
            </tbody>
          </table>

          <h4>2.3. Flux de Trimitere Email</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>ComponentÄƒ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Verificare checkbox "Trimite email"</td>
                <td>RaportScreen - Verificare opÈ›iune</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Generare corp email HTML</td>
                <td>processor.py - Creare HTML cu font Georgia 11pt</td>
              </tr>
              <tr>
                <td>3</td>
                <td>PregÄƒtire ataÈ™amente Excel</td>
                <td>processor.py - CÄƒi cÄƒtre fiÈ™iere Excel generate</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Conectare Outlook local</td>
                <td>win32com.client - Dispatch('outlook.application')</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Creare email nou</td>
                <td>Outlook - CreateItem(0)</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Configurare destinatari (To, CC)</td>
                <td>processor.py - Destinatari hardcodaÈ›i per raport</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Setare subiect È™i corp HTML</td>
                <td>Outlook - Subject, HTMLBody</td>
              </tr>
              <tr>
                <td>8</td>
                <td>AdÄƒugare ataÈ™amente Excel</td>
                <td>Outlook - Attachments.Add()</td>
              </tr>
              <tr>
                <td>9</td>
                <td>Trimitere email</td>
                <td>Outlook - Send()</td>
              </tr>
              <tr>
                <td>10</td>
                <td>Logging rezultat trimitere</td>
                <td>processor.py - Logging succes/eroare</td>
              </tr>
            </tbody>
          </table>

          <h3>3. Caracteristici FuncÈ›ionale Avansate</h3>

          <h4>3.1. Validare È™i Securitate</h4>
          <table>
            <thead>
              <tr>
                <th>CaracteristicÄƒ</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Validare FiÈ™iere Input</strong></td>
                <td>Verificare existenÈ›Äƒ È™i structurÄƒ fiÈ™iere Excel</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Verificare existenÈ›Äƒ folder Master</li>
                    <li>Verificare existenÈ›Äƒ fiÈ™iere necesare</li>
                    <li>Validare structurÄƒ Excel (sheet-uri, coloane)</li>
                    <li>Validare format CNP (algoritm complet)</li>
                    <li>FiÈ™ier: <code>raport_[nume]/processor.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Validare ConfiguraÈ›ie</strong></td>
                <td>Verificare validitate configuraÈ›ie Ã®nainte de procesare</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Validare email destinatari</li>
                    <li>Validare setÄƒri scheduler</li>
                    <li>Validare dimensiune fiÈ™iere</li>
                    <li>Mesaje de eroare clare</li>
                    <li>FiÈ™ier: <code>config.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>ProtecÈ›ie ParolÄƒ Excel</strong></td>
                <td>Criptare fiÈ™iere Excel cu parolÄƒ pentru confidenÈ›ialitate</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>BibliotecÄƒ: msoffcrypto-tool</li>
                    <li>Parole hardcodaÈ›i per raport</li>
                    <li>Criptare realÄƒ (nu doar protecÈ›ie UI)</li>
                    <li>FiÈ™ier: <code>raport_[nume]/processor.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>ProtecÈ›ie SecÈ›iuni UI</strong></td>
                <td>Dialoguri de autentificare pentru secÈ›iuni protejate</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Parole hardcodaÈ›i Ã®n aplicaÈ›ie</li>
                    <li>Dialoguri CustomTkinter</li>
                    <li>Verificare parolÄƒ Ã®nainte de acces</li>
                    <li>FiÈ™ier: <code>main.py</code> (show_password_dialog)</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h4>3.2. Gestionare Erori È™i Logging</h4>
          <table>
            <thead>
              <tr>
                <th>Tip Eroare</th>
                <th>Gestionare</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>FiÈ™ier Nu ExistÄƒ</strong></td>
                <td>Mesaj de eroare clar, oprire procesare</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FileNotFoundError cu mesaj descriptiv</li>
                    <li>AfiÈ™are Ã®n interfaÈ›Äƒ graficÄƒ</li>
                    <li>Logging Ã®n fiÈ™ier log</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>StructurÄƒ Excel InvalidÄƒ</strong></td>
                <td>Validare È™i mesaje de eroare specifice</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Verificare coloane necesare</li>
                    <li>Verificare sheet-uri necesare</li>
                    <li>Mesaje de eroare cu detalii</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Eroare Procesare</strong></td>
                <td>Try-except cu logging detaliat</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Logging cu traceback complet</li>
                    <li>Mesaje utilizator prietenoase</li>
                    <li>Continuare execuÈ›ie dupÄƒ erori non-critice</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Eroare Trimitere Email</strong></td>
                <td>Fallback la printare È™i logging</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Verificare disponibilitate Outlook</li>
                    <li>Printare detalii email dacÄƒ trimiterea eÈ™ueazÄƒ</li>
                    <li>Logging erori pentru debugging</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>4. Rezumat FuncÈ›ionalitÄƒÈ›i</h3>
          <ul>
            <li><strong>InterfaÈ›Äƒ GraficÄƒ ModernÄƒ:</strong> CustomTkinter cu dark theme, ecran de start, meniu principal organizat, interfeÈ›e dedicate per raport</li>
            <li><strong>13 Module Rapoarte:</strong> Fiecare modul independent cu procesare, validare, generare Excel, trimitere email</li>
            <li><strong>Procesare Excel AvansatÄƒ:</strong> Citire multiple sheet-uri, filtrare multi-criteriu, mapping portofolio, formatare profesionalÄƒ</li>
            <li><strong>Integrare Email:</strong> Trimitere automatÄƒ prin Outlook local, email-uri HTML personalizate, ataÈ™amente Excel parolate</li>
            <li><strong>Scheduler Automat:</strong> Programare rulÄƒri periodice (lunar, zilnic, sÄƒptÄƒmÃ¢nal), execuÈ›ie Ã®n background</li>
            <li><strong>Integrare API Externe:</strong> API portal.just.ro (SOAP), web scraping CASAN cu OCR pentru CAPTCHA</li>
            <li><strong>Securitate:</strong> Validare input, protecÈ›ie parolÄƒ Excel, protecÈ›ie secÈ›iuni UI, gestionare erori robustÄƒ</li>
            <li><strong>Procesare LocalÄƒ:</strong> Toate procesele se desfÄƒÈ™oarÄƒ local, fÄƒrÄƒ transmitere cÄƒtre servere externe, fÄƒrÄƒ stocare persistentÄƒ date</li>
          </ul>
        </section>
      </div>
    </section>

    <section class="content-section hidden" id="secProcese">
      <div class="section-head">
        <div class="title">ğŸ”„ Descrierea Proceselor</div>
        <div style="opacity:.75; font-weight:700; color:#22507a;">Procese È™i secvenÈ›e de operare ale aplicaÈ›iei</div>
      </div>
      <div class="section-body">
        <section class="doc-section">
          <h2>Descrierea Proceselor Roboescu</h2>
          
          <h3>1. Procesul de IniÈ›ializare a AplicaÈ›iei</h3>

          <h4>1.1. Pornirea AplicaÈ›iei Desktop (main.py)</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>ExecuÈ›ie Script Python</td>
                <td>Lansare aplicaÈ›ie prin execuÈ›ie <code>python main.py</code> sau dublu-click pe executabil</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FiÈ™ier: <code>main.py</code> (entry point)</li>
                    <li>Verificare versiune Python (3.x)</li>
                    <li>Import module necesare (customtkinter, etc.)</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td>2</td>
                <td>ÃncÄƒrcare ConfiguraÈ›ie GlobalÄƒ</td>
                <td>Citire È™i validare configuraÈ›ie din <code>config.json</code></td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FiÈ™ier: <code>config.py</code> - clasa Config</li>
                    <li>Validare structurÄƒ JSON</li>
                    <li>Verificare setÄƒri email, scheduler, etc.</li>
                    <li>DacÄƒ config.json lipseÈ™te: Se creeazÄƒ cu valori default</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td>3</td>
                <td>ÃncÄƒrcare Status Rapoarte</td>
                <td>Citire status rapoarte din <code>rapoarte_status.json</code></td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Status: Activ / Ãn mentenanÈ›Äƒ / Dezactivat</li>
                    <li>Ultima rulare per raport</li>
                    <li>DacÄƒ fiÈ™ierul lipseÈ™te: Se creeazÄƒ cu valori default</li>
                    <li>FiÈ™ier: <code>rapoarte_status.json</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td>4</td>
                <td>IniÈ›ializare CustomTkinter</td>
                <td>Creare aplicaÈ›ie graficÄƒ cu CustomTkinter</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Configurare dark theme</li>
                    <li>Setare dimensiuni fereastrÄƒ (1024x768, maximizatÄƒ)</li>
                    <li>Configurare fonturi (Georgia pentru text)</li>
                    <li>FiÈ™ier: <code>main.py</code> (clasa App)</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td>5</td>
                <td>Creare Ecran de Start</td>
                <td>AfiÈ™are ecran de bun venit cu imagine de fundal</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Clasa StartScreen</li>
                    <li>Imagine de fundal personalizatÄƒ</li>
                    <li>Buton "Start" pentru acces la meniu</li>
                    <li>AnimaÈ›ii È™i efecte de tranziÈ›ie</li>
                    <li>FiÈ™ier: <code>main.py</code> (StartScreen)</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td>6</td>
                <td>La Click "Start": AfiÈ™are Meniu Principal</td>
                <td>Schimbare ecran cÄƒtre meniul principal cu lista rapoartelor</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Clasa MainMenuScreen</li>
                    <li>Tabel cu 13 rapoarte organizate pe categorii</li>
                    <li>Status tracking È™i ultima rulare</li>
                    <li>Butoane de acces pentru fiecare raport</li>
                    <li>FiÈ™ier: <code>main.py</code> (MainMenuScreen)</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td>7</td>
                <td>Pornire Loop Principal</td>
                <td>Pornire event loop pentru interfaÈ›Äƒ graficÄƒ</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>app.mainloop() - CustomTkinter event loop</li>
                    <li>AplicaÈ›ia rÄƒmÃ¢ne deschisÄƒ pÃ¢nÄƒ la Ã®nchidere</li>
                    <li>Gestionare evenimente (click, keyboard, etc.)</li>
                    <li>FiÈ™ier: <code>main.py</code> (if __name__ == "__main__")</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h4>1.2. Procesul de ÃncÄƒrcare ConfiguraÈ›ie</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>Descriere</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Citire config.json</td>
                <td>Citire fiÈ™ier JSON cu configuraÈ›ie globalÄƒ</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FiÈ™ier: <code>config.py</code> - metoda load_config()</li>
                    <li>Parsare JSON È™i validare structurÄƒ</li>
                    <li>DacÄƒ fiÈ™ierul lipseÈ™te: Creare cu valori default</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td>2</td>
                <td>Validare ConfiguraÈ›ie</td>
                <td>Verificare validitate setÄƒri (email, scheduler, etc.)</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Metoda validate_config()</li>
                    <li>Verificare format email destinatari</li>
                    <li>Verificare setÄƒri scheduler</li>
                    <li>Mesaje de eroare pentru configuraÈ›ie invalidÄƒ</li>
                    <li>FiÈ™ier: <code>config.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td>3</td>
                <td>ÃncÄƒrcare ConfiguraÈ›ie per Modul</td>
                <td>Citire config.json din fiecare modul raport</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Pentru fiecare modul: <code>raport_[nume]/config.json</code></li>
                    <li>Configurare specificÄƒ per raport (scheduler, email, etc.)</li>
                    <li>Merge cu configuraÈ›ia globalÄƒ</li>
                    <li>FiÈ™ier: <code>raport_[nume]/config.json</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td>4</td>
                <td>ÃncÄƒrcare Status Rapoarte</td>
                <td>Citire status È™i ultima rulare pentru fiecare raport</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>FiÈ™ier: <code>rapoarte_status.json</code></li>
                    <li>Status: Activ / Ãn mentenanÈ›Äƒ / Dezactivat</li>
                    <li>Timestamp ultima rulare</li>
                    <li>Actualizare Ã®n interfaÈ›Äƒ graficÄƒ</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>2. Procesul de Rulare Raport</h3>

          <h4>2.1. Procesul Complet de Rulare Raport</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>ComponentÄƒ</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Utilizator selecteazÄƒ raport</td>
                <td>MainMenuScreen - Click pe raport</td>
                <td>Utilizatorul selecteazÄƒ un raport din meniul principal</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Verificare protecÈ›ie parolÄƒ</td>
                <td>main.py - show_password_dialog</td>
                <td>DacÄƒ raportul este protejat: Dialog de autentificare cu parolÄƒ hardcodatÄƒ</td>
              </tr>
              <tr>
                <td>3</td>
                <td>Deschidere interfaÈ›Äƒ raport</td>
                <td>RaportScreen - screen.py</td>
                <td>Creare interfaÈ›Äƒ graficÄƒ dedicatÄƒ pentru raportul selectat</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Selectare folder Master</td>
                <td>RaportScreen - Dialog selectare folder</td>
                <td>Utilizatorul selecteazÄƒ folderul cu fiÈ™iere Excel de intrare</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Selectare folder Output</td>
                <td>RaportScreen - Dialog selectare folder</td>
                <td>Utilizatorul selecteazÄƒ folderul pentru salvare rapoarte generate</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Configurare opÈ›iuni</td>
                <td>RaportScreen - Checkbox-uri È™i cÃ¢mpuri</td>
                <td>Utilizatorul configureazÄƒ opÈ›iuni (trimite email, etc.)</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Click "Start Procesare"</td>
                <td>RaportScreen - Buton start</td>
                <td>Utilizatorul iniÈ›iazÄƒ procesarea raportului</td>
              </tr>
              <tr>
                <td>8</td>
                <td>Validare input</td>
                <td>processor.py - Validare fiÈ™iere</td>
                <td>Verificare existenÈ›Äƒ folder Master, fiÈ™iere Excel, structurÄƒ validÄƒ</td>
              </tr>
              <tr>
                <td>9</td>
                <td>Lansare procesare Ã®n thread</td>
                <td>RaportScreen - Threading</td>
                <td>Procesare Ã®n thread separat pentru a nu bloca interfaÈ›a</td>
              </tr>
              <tr>
                <td>10</td>
                <td>Citire fiÈ™iere Master</td>
                <td>processor.py - pd.read_excel()</td>
                <td>Citire È™i concatenare sheet-uri Excel din folderul Master</td>
              </tr>
              <tr>
                <td>11</td>
                <td>Filtrare È™i procesare date</td>
                <td>processor.py - Filtrare pandas</td>
                <td>Filtrare dupÄƒ criterii specifice (PORTFOLIO, valoare, datÄƒ, etc.)</td>
              </tr>
              <tr>
                <td>12</td>
                <td>Generare raport Excel</td>
                <td>processor.py - openpyxl/xlsxwriter</td>
                <td>Creare fiÈ™ier Excel formatat cu font Georgia 11pt, multiple sheet-uri</td>
              </tr>
              <tr>
                <td>13</td>
                <td>ProtecÈ›ie parolÄƒ Excel</td>
                <td>processor.py - msoffcrypto-tool</td>
                <td>Criptare Excel cu parolÄƒ hardcodatÄƒ per raport</td>
              </tr>
              <tr>
                <td>14</td>
                <td>Trimitere email (dacÄƒ activatÄƒ)</td>
                <td>processor.py - win32com.client</td>
                <td>Trimitere email prin Outlook local cu raport Excel ataÈ™at</td>
              </tr>
              <tr>
                <td>15</td>
                <td>Actualizare status</td>
                <td>rapoarte_status.json</td>
                <td>Salvare timestamp ultima rulare È™i status succes/eroare</td>
              </tr>
              <tr>
                <td>16</td>
                <td>AfiÈ™are rezultat</td>
                <td>RaportScreen - Mesaje Ã®n interfaÈ›Äƒ</td>
                <td>AfiÈ™are mesaj succes sau eroare Ã®n interfaÈ›Äƒ graficÄƒ</td>
              </tr>
            </tbody>
          </table>

          <h3>3. Procesul de Procesare Excel</h3>

          <h4>3.1. Procesul de Citire È™i Concatenare Excel</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>ComponentÄƒ</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Localizare fiÈ™iere Master</td>
                <td>processor.py - glob/os</td>
                <td>CÄƒutare fiÈ™iere Excel Ã®n folderul Master (pattern: *Raport_Master*.xlsx)</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Selectare fiÈ™ier cel mai recent</td>
                <td>processor.py - os.path.getmtime()</td>
                <td>DacÄƒ multiple fiÈ™iere: Selectare cel mai recent modificat</td>
              </tr>
              <tr>
                <td>3</td>
                <td>Detectare engine Excel</td>
                <td>processor.py - pandas</td>
                <td>Detectare automatÄƒ engine (xlrd, openpyxl, pyxlsb) Ã®n funcÈ›ie de extensie</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Citire Sheet 1</td>
                <td>processor.py - pd.read_excel()</td>
                <td>Citire primul sheet cu skiprows=1 (eliminare primul rÃ¢nd header)</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Citire Sheet 2</td>
                <td>processor.py - pd.read_excel()</td>
                <td>Citire al doilea sheet fÄƒrÄƒ skiprows sau cu skiprows=1</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Aliniere coloane</td>
                <td>processor.py - reindex()</td>
                <td>Aliniere coloane dacÄƒ sheet-urile au numÄƒr diferit de coloane</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Concatenare sheet-uri</td>
                <td>processor.py - pd.concat()</td>
                <td>Concatenare verticalÄƒ a celor 2 DataFrame-uri Ã®ntr-unul singur</td>
              </tr>
              <tr>
                <td>8</td>
                <td>Mapare coloane</td>
                <td>processor.py - df.columns</td>
                <td>Mapare coloane generice la nume specifice (PORTFOLIO, NUME_TITULAR, etc.)</td>
              </tr>
            </tbody>
          </table>

          <h4>3.2. Procesul de Filtrare È™i Procesare Date</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>ComponentÄƒ</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Filtrare PORTFOLIO</td>
                <td>processor.py - pandas filtering</td>
                <td>Eliminare portofolii nerelevante (BANCPOST, GB01, AXIOMA, CdF, Idea Leasing, GDPR, blank)</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Normalizare PORTFOLIO</td>
                <td>processor.py - clean_pipes()</td>
                <td>CurÄƒÈ›are duplicate cu "|", eliminare spaÈ›ii, normalizare format</td>
              </tr>
              <tr>
                <td>3</td>
                <td>Mapping PORTFOLIO</td>
                <td>processor.py - rename_portfolio()</td>
                <td>Redenumire conform mapping-ului (ABSOLUT â†’ SALT, BTD â†’ BTD CRED, etc.)</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Completare DATA_PREDARE_BEJ</td>
                <td>processor.py - mask_both_blank</td>
                <td>Completare automatÄƒ cu DATA_RAPORT sau data curentÄƒ pentru cazurile cu ambele cÃ¢mpuri blank</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Filtrare dupÄƒ criterii specifice</td>
                <td>processor.py - pandas filtering</td>
                <td>Filtrare dupÄƒ valoare (EXP_TOT_CLIENT_RON <= 500), datÄƒ, stadiu, etc. (per raport)</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Eliminare duplicate</td>
                <td>processor.py - drop_duplicates()</td>
                <td>Eliminare Ã®nregistrÄƒri duplicate bazate pe coloane cheie</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Validare CNP (dacÄƒ necesar)</td>
                <td>processor.py - valid_cnp()</td>
                <td>Validare format È™i cifrÄƒ de control CNP folosind algoritm complet</td>
              </tr>
              <tr>
                <td>8</td>
                <td>Parsare CNP (dacÄƒ necesar)</td>
                <td>processor.py - parse_cnp()</td>
                <td>Extragere Sex, Data naÈ™terii, VÃ¢rstÄƒ, JudeÈ›, CJP din CNP valid</td>
              </tr>
            </tbody>
          </table>

          <h4>3.3. Procesul de Formatare È™i Generare Excel</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>ComponentÄƒ</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Creare workbook Excel</td>
                <td>processor.py - openpyxl/xlsxwriter</td>
                <td>Creare fiÈ™ier Excel nou sau deschidere existent pentru modificare</td>
              </tr>
              <tr>
                <td>2</td>
                <td>AdÄƒugare sheet-uri</td>
                <td>processor.py - add_worksheet()</td>
                <td>Creare multiple sheet-uri per raport (ex: "ds active", "ds inchise", "Sumar")</td>
              </tr>
              <tr>
                <td>3</td>
                <td>Scriere date Ã®n sheet-uri</td>
                <td>processor.py - to_excel() / write()</td>
                <td>Scriere DataFrame-uri pandas Ã®n fiecare sheet</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Aplicare font Georgia 11pt</td>
                <td>processor.py - Font(name="Georgia", size=11)</td>
                <td>Aplicare font Georgia 11 pe toate celulele din toate sheet-urile</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Formatare date</td>
                <td>processor.py - NamedStyle</td>
                <td>Formatare coloane de tip datÄƒ cu formatul dd.mm.yyyy (MM/DD/YYYY Ã®n Excel)</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Formatare header-uri</td>
                <td>processor.py - header_format</td>
                <td>Formatare header-uri cu fundal colorat, bold, border-uri, aliniere centratÄƒ</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Ajustare lÄƒÈ›ime coloane</td>
                <td>processor.py - set_column()</td>
                <td>Ajustare automatÄƒ lÄƒÈ›ime coloane pentru vizibilitate optimÄƒ</td>
              </tr>
              <tr>
                <td>8</td>
                <td>Generare pivot tables (dacÄƒ necesar)</td>
                <td>processor.py - pd.pivot_table()</td>
                <td>Creare pivot tables pentru analizÄƒ agregatÄƒ (ex: per creditor, per interval)</td>
              </tr>
              <tr>
                <td>9</td>
                <td>Generare grafice (dacÄƒ necesar)</td>
                <td>processor.py - matplotlib/plotly</td>
                <td>Creare grafice (bar charts, line charts) È™i salvare Ã®n Excel sau separat</td>
              </tr>
              <tr>
                <td>10</td>
                <td>Salvare Excel temporar</td>
                <td>processor.py - save()</td>
                <td>Salvare fiÈ™ier Excel neparolat temporar pentru criptare</td>
              </tr>
              <tr>
                <td>11</td>
                <td>Criptare cu parolÄƒ</td>
                <td>processor.py - msoffcrypto-tool</td>
                <td>Criptare Excel cu parolÄƒ hardcodatÄƒ folosind msoffcrypto.encrypt()</td>
              </tr>
              <tr>
                <td>12</td>
                <td>Salvare finalÄƒ</td>
                <td>processor.py - os.rename()</td>
                <td>Salvare Excel parolat cu nume unic (timestamp) Ã®n folderul Output</td>
              </tr>
            </tbody>
          </table>

          <h3>4. Procesul de Trimitere Email</h3>

          <h4>4.1. Procesul Complet de Trimitere Email</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>ComponentÄƒ</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Verificare checkbox "Trimite email"</td>
                <td>RaportScreen - Verificare opÈ›iune</td>
                <td>Verificare dacÄƒ utilizatorul a activat opÈ›iunea de trimitere email</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Generare corp email HTML</td>
                <td>processor.py - Creare HTML</td>
                <td>Creare corp email HTML cu font Georgia 11pt, mesaj personalizat per raport</td>
              </tr>
              <tr>
                <td>3</td>
                <td>PregÄƒtire ataÈ™amente</td>
                <td>processor.py - CÄƒi cÄƒtre fiÈ™iere</td>
                <td>Identificare cÄƒi cÄƒtre fiÈ™iere Excel generate pentru ataÈ™are</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Conectare Outlook local</td>
                <td>win32com.client - Dispatch()</td>
                <td>Creare conexiune la Outlook prin COM Interface: Dispatch('outlook.application')</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Creare email nou</td>
                <td>Outlook - CreateItem(0)</td>
                <td>Creare obiect MailItem nou Ã®n Outlook</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Configurare destinatari</td>
                <td>processor.py - Destinatari hardcodaÈ›i</td>
                <td>Setare To È™i CC cu adrese email hardcodaÈ›i per raport (ICC È™i entitÄƒÈ›i BT)</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Setare subiect</td>
                <td>Outlook - Subject</td>
                <td>Setare subiect email personalizat per raport</td>
              </tr>
              <tr>
                <td>8</td>
                <td>Setare corp HTML</td>
                <td>Outlook - HTMLBody</td>
                <td>Setare corp email HTML cu formatare Georgia 11pt</td>
              </tr>
              <tr>
                <td>9</td>
                <td>AdÄƒugare ataÈ™amente</td>
                <td>Outlook - Attachments.Add()</td>
                <td>AdÄƒugare fiÈ™iere Excel parolate ca ataÈ™amente</td>
              </tr>
              <tr>
                <td>10</td>
                <td>Salvare Ã®n Sent (opÈ›ional)</td>
                <td>Outlook - Save()</td>
                <td>Salvare email Ã®n folderul Sent Ã®nainte de trimitere</td>
              </tr>
              <tr>
                <td>11</td>
                <td>Trimitere email</td>
                <td>Outlook - Send()</td>
                <td>Trimitere email cÄƒtre destinatari prin Outlook</td>
              </tr>
              <tr>
                <td>12</td>
                <td>Gestionare erori</td>
                <td>processor.py - try-except</td>
                <td>DacÄƒ trimiterea eÈ™ueazÄƒ: Fallback la printare detalii email È™i logging</td>
              </tr>
            </tbody>
          </table>

          <h4>5.1. Procesul de Validare FiÈ™iere Excel</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>ComponentÄƒ</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Verificare existenÈ›Äƒ folder Master</td>
                <td>processor.py - os.path.exists()</td>
                <td>Verificare cÄƒ folderul Master existÄƒ È™i este accesibil</td>
              </tr>
              <tr>
                <td>2</td>
                <td>CÄƒutare fiÈ™iere Excel</td>
                <td>processor.py - glob/os.listdir()</td>
                <td>CÄƒutare fiÈ™iere Excel Ã®n folderul Master (pattern: *Raport_Master*.xlsx)</td>
              </tr>
              <tr>
                <td>3</td>
                <td>Verificare existenÈ›Äƒ fiÈ™ier</td>
                <td>processor.py - os.path.isfile()</td>
                <td>DacÄƒ fiÈ™ierul nu existÄƒ: FileNotFoundError cu mesaj descriptiv</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Validare structurÄƒ Excel</td>
                <td>processor.py - validate_excel_structure()</td>
                <td>Verificare existenÈ›Äƒ sheet-uri necesare È™i numÄƒr coloane</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Validare coloane necesare</td>
                <td>processor.py - Verificare df.columns</td>
                <td>Verificare cÄƒ toate coloanele necesare existÄƒ (PORTFOLIO, NUME_TITULAR, etc.)</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Validare format CNP (dacÄƒ necesar)</td>
                <td>processor.py - valid_cnp()</td>
                <td>Validare format CNP (13 cifre) È™i cifrÄƒ de control folosind algoritm complet</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Validare dimensiune fiÈ™ier</td>
                <td>processor.py - os.path.getsize()</td>
                <td>Verificare dimensiune fiÈ™ier (max limit per raport)</td>
              </tr>
              <tr>
                <td>8</td>
                <td>Mesaje de eroare</td>
                <td>processor.py - ExcepÈ›ii</td>
                <td>AfiÈ™are mesaje de eroare clare Ã®n interfaÈ›Äƒ graficÄƒ È™i logging</td>
              </tr>
            </tbody>
          </table>

          <h4>5.2. Procesul de Validare ConfiguraÈ›ie</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>ComponentÄƒ</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Citire config.json</td>
                <td>config.py - load_config()</td>
                <td>Citire È™i parsare configuraÈ›ie globalÄƒ</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Validare structurÄƒ JSON</td>
                <td>config.py - validate_config()</td>
                <td>Verificare cÄƒ JSON este valid È™i conÈ›ine toate cÃ¢mpurile necesare</td>
              </tr>
              <tr>
                <td>3</td>
                <td>Validare email destinatari</td>
                <td>config.py - Validare format</td>
                <td>Verificare format email pentru toÈ›i destinatarii (regex sau validare simplÄƒ)</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Validare setÄƒri scheduler</td>
                <td>config.py - Validare frecvenÈ›Äƒ</td>
                <td>Verificare frecvenÈ›Äƒ validÄƒ (lunar, zilnic, sÄƒptÄƒmÃ¢nal) È™i format datÄƒ/orÄƒ</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Validare dimensiune fiÈ™iere</td>
                <td>config.py - Validare limit</td>
                <td>Verificare limitÄƒ dimensiune fiÈ™ier (dacÄƒ configuratÄƒ)</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Mesaje de eroare</td>
                <td>config.py - ExcepÈ›ii</td>
                <td>AfiÈ™are mesaje de eroare clare pentru configuraÈ›ie invalidÄƒ</td>
              </tr>
            </tbody>
          </table>

          <h3>6. Procesul de Scheduler Automat</h3>

          <h4>6.1. Procesul de Programare RulÄƒri Automate</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>ComponentÄƒ</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>ÃncÄƒrcare configuraÈ›ie scheduler</td>
                <td>scheduler.py - Citire config.json</td>
                <td>Citire setÄƒri programare din config.json per modul</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Verificare activare scheduler</td>
                <td>scheduler.py - Verificare flag</td>
                <td>Verificare dacÄƒ scheduler-ul este activat pentru acest raport</td>
              </tr>
              <tr>
                <td>3</td>
                <td>Programare job</td>
                <td>schedule - schedule.every()</td>
                <td>Programare job folosind biblioteca schedule (ex: every().month.do())</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Lansare thread scheduler</td>
                <td>scheduler.py - threading.Thread</td>
                <td>Lansare thread separat pentru execuÈ›ie scheduler Ã®n background</td>
              </tr>
              <tr>
                <td>5</td>
                <td>ExecuÈ›ie periodicÄƒ</td>
                <td>schedule - run_pending()</td>
                <td>ExecuÈ›ie job-uri programate la intervalele configurate</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Lansare procesare raport</td>
                <td>processor.py - main()</td>
                <td>Lansare procesare raport automatÄƒ la momentul programat</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Gestionare erori</td>
                <td>scheduler.py - try-except</td>
                <td>Logging erori È™i continuare execuÈ›ie pentru alte job-uri</td>
              </tr>
            </tbody>
          </table>

          <h3>7. Procesul de Integrare API Externe</h3>

          <h4>7.1. Procesul de Integrare portal.just.ro (SOAP)</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>ComponentÄƒ</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>IniÈ›ializare client SOAP</td>
                <td>actualizare_portal_just.py - zeep.Client</td>
                <td>Creare client SOAP folosind biblioteca Zeep cu WSDL portal.just.ro</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Autentificare API</td>
                <td>actualizare_portal_just.py - init_api_client()</td>
                <td>Autentificare cu credenÈ›iale API (username, password) pentru portal.just.ro</td>
              </tr>
              <tr>
                <td>3</td>
                <td>Citire dosare din Excel</td>
                <td>actualizare_portal_just.py - Citire Excel</td>
                <td>Citire lista dosare (numÄƒr dosar) din fiÈ™ier Excel Master</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Interogare API per dosar</td>
                <td>actualizare_portal_just.py - prelucreaza_dosar_api()</td>
                <td>Apel API SOAP pentru fiecare dosar pentru a obÈ›ine informaÈ›ii actualizate</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Procesare rÄƒspuns API</td>
                <td>actualizare_portal_just.py - Parsare XML</td>
                <td>Parsare rÄƒspuns XML/SOAP È™i extragere informaÈ›ii relevante</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Generare HTML sumar</td>
                <td>actualizare_portal_just.py - genereaza_html_sumar_total()</td>
                <td>Generare fiÈ™ier HTML cu sumar total litigii naÈ›ionale È™i grafice</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Gestionare erori È™i retry</td>
                <td>actualizare_portal_just.py - try-except</td>
                <td>Retry logic pentru erori temporare, logging detaliat</td>
              </tr>
            </tbody>
          </table>

          <h4>7.2. Procesul de Interogare CASAN (Web Scraping + OCR)</h4>
          <table>
            <thead>
              <tr>
                <th>Pas</th>
                <th>AcÈ›iune</th>
                <th>ComponentÄƒ</th>
                <th>Descriere</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Lansare browser Playwright</td>
                <td>processor.py - playwright</td>
                <td>Lansare browser headless cu Playwright pentru navigare CASAN</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Navigare cÄƒtre pagina CASAN</td>
                <td>playwright - goto()</td>
                <td>Navigare cÄƒtre pagina de interogare CASAN</td>
              </tr>
              <tr>
                <td>3</td>
                <td>Detectare CAPTCHA</td>
                <td>processor.py - Verificare imagini</td>
                <td>Detectare existenÈ›Äƒ imagini CAPTCHA pe paginÄƒ</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Extragere imagine CAPTCHA</td>
                <td>playwright - screenshot()</td>
                <td>Salvare imagine CAPTCHA pentru procesare OCR</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Preprocesare imagine</td>
                <td>processor.py - OpenCV</td>
                <td>Denoising, thresholding, morfologie pentru Ã®mbunÄƒtÄƒÈ›ire recunoaÈ™tere</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Rezolvare CAPTCHA cu OCR</td>
                <td>processor.py - pytesseract</td>
                <td>Rezolvare CAPTCHA folosind Tesseract OCR cu configurÄƒri multiple PSM</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Completare formular</td>
                <td>playwright - fill()</td>
                <td>Completare cÃ¢mpuri CNP È™i CAPTCHA rezolvat</td>
              </tr>
              <tr>
                <td>8</td>
                <td>Submit formular</td>
                <td>playwright - click()</td>
                <td>Trimitere formular È™i aÈ™teptare rÄƒspuns</td>
              </tr>
              <tr>
                <td>9</td>
                <td>Verificare rezultat</td>
                <td>processor.py - Verificare paginÄƒ</td>
                <td>Verificare dacÄƒ interogarea a reuÈ™it sau dacÄƒ CAPTCHA a fost incorect</td>
              </tr>
              <tr>
                <td>10</td>
                <td>Retry logic (dacÄƒ necesar)</td>
                <td>processor.py - Loop retry</td>
                <td>DacÄƒ CAPTCHA incorect: Retry pÃ¢nÄƒ la 3 Ã®ncercÄƒri cu nouÄƒ rezolvare CAPTCHA</td>
              </tr>
              <tr>
                <td>11</td>
                <td>Extragere informaÈ›ii</td>
                <td>processor.py - Parsare HTML</td>
                <td>Extragere informaÈ›ii despre status asigurat din rÄƒspunsul CASAN</td>
              </tr>
              <tr>
                <td>12</td>
                <td>Actualizare Excel</td>
                <td>processor.py - openpyxl</td>
                <td>Actualizare coloanÄƒ "Status CASAN" Ã®n fiÈ™ierul Master</td>
              </tr>
            </tbody>
          </table>

          <h3>8. Procesul de Gestionare Erori</h3>

          <h4>8.1. Procesul de Gestionare Erori Ã®n Procesare</h4>
          <table>
            <thead>
              <tr>
                <th>Tip Eroare</th>
                <th>Proces de Gestionare</th>
                <th>RÄƒspuns</th>
                <th>Implementare</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>FiÈ™ier Nu ExistÄƒ</strong></td>
                <td>Verificare existenÈ›Äƒ Ã®nainte de procesare</td>
                <td>FileNotFoundError cu mesaj descriptiv</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Verificare os.path.exists() Ã®nainte de citire</li>
                    <li>Mesaje clare: "FiÈ™ierul X nu a fost gÄƒsit Ã®n folderul Y"</li>
                    <li>AfiÈ™are Ã®n interfaÈ›Äƒ graficÄƒ È™i logging</li>
                    <li>FiÈ™ier: <code>raport_[nume]/processor.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>StructurÄƒ Excel InvalidÄƒ</strong></td>
                <td>Validare structurÄƒ Ã®nainte de procesare</td>
                <td>ValueError cu mesaj specific</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Verificare existenÈ›Äƒ sheet-uri necesare</li>
                    <li>Verificare existenÈ›Äƒ coloane necesare</li>
                    <li>Mesaje: "Sheet-ul X lipseÈ™te" sau "Coloana Y lipseÈ™te"</li>
                    <li>FiÈ™ier: <code>raport_[nume]/processor.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Eroare Procesare</strong></td>
                <td>Try-except cu logging detaliat</td>
                <td>Exception cu traceback complet</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Try-except pentru toate operaÈ›iile critice</li>
                    <li>Logging cu traceback complet pentru debugging</li>
                    <li>Mesaje utilizator prietenoase (fÄƒrÄƒ stack trace)</li>
                    <li>Continuare execuÈ›ie pentru erori non-critice</li>
                    <li>FiÈ™ier: <code>raport_[nume]/processor.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Eroare Trimitere Email</strong></td>
                <td>Fallback la printare È™i logging</td>
                <td>Exception cu detalii email</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Verificare disponibilitate Outlook</li>
                    <li>DacÄƒ trimiterea eÈ™ueazÄƒ: Printare detalii email Ã®n consolÄƒ</li>
                    <li>Logging erori pentru debugging</li>
                    <li>Nu opreÈ™te procesarea dacÄƒ email-ul eÈ™ueazÄƒ</li>
                    <li>FiÈ™ier: <code>raport_[nume]/processor.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Eroare API ExternÄƒ</strong></td>
                <td>Retry logic È™i gestionare timeout</td>
                <td>Exception cu detaliile erorii</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Retry logic pentru erori temporare (max 3 Ã®ncercÄƒri)</li>
                    <li>Timeout pentru request-uri API</li>
                    <li>Logging detaliat pentru debugging</li>
                    <li>Continuare procesare pentru alte dosare</li>
                    <li>FiÈ™ier: <code>raport_portal_just/actualizare_portal_just.py</code>, <code>raport_interogare_siui/processor.py</code></li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td><strong>Eroare OCR CAPTCHA</strong></td>
                <td>Retry logic cu noi imagini</td>
                <td>Exception dacÄƒ toate Ã®ncercÄƒrile eÈ™ueazÄƒ</td>
                <td>
                  <ul style="margin: 0; padding-left: 20px;">
                    <li>Retry pÃ¢nÄƒ la 3 Ã®ncercÄƒri cu nouÄƒ imagini CAPTCHA</li>
                    <li>Diferite configurÄƒri PSM pentru Tesseract</li>
                    <li>Preprocesare imagini avansatÄƒ (denoising, thresholding)</li>
                    <li>DacÄƒ toate Ã®ncercÄƒrile eÈ™ueazÄƒ: Logging È™i continuare cu urmÄƒtorul CNP</li>
                    <li>FiÈ™ier: <code>raport_interogare_siui/processor.py</code></li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>

          <h3>9. Rezumat Procese</h3>
          <ul>
            <li><strong>IniÈ›ializare AplicaÈ›ie:</strong> AplicaÈ›ia se iniÈ›ializeazÄƒ Ã®ncÄƒrcÃ¢nd configuraÈ›ia globalÄƒ, status rapoarte, creÃ¢nd interfaÈ›a graficÄƒ CustomTkinter È™i afiÈ™Ã¢nd ecranul de start</li>
            <li><strong>Rulare Raport:</strong> Proces complet de selectare raport, verificare protecÈ›ie parolÄƒ, configurare input/output, validare, procesare Excel, generare raport, trimitere email È™i actualizare status</li>
            <li><strong>Procesare Excel:</strong> Proces de citire È™i concatenare sheet-uri, filtrare È™i procesare date, formatare È™i generare Excel cu protecÈ›ie parolÄƒ</li>
            <li><strong>Trimitere Email:</strong> Proces de generare email HTML, conectare Outlook local, configurare destinatari, adÄƒugare ataÈ™amente È™i trimitere automatÄƒ</li>
            <li><strong>Validare Input:</strong> Proces de validare fiÈ™iere Excel (existenÈ›Äƒ, structurÄƒ, coloane) È™i configuraÈ›ie (email, scheduler, dimensiune)</li>
            <li><strong>Scheduler Automat:</strong> Proces de programare rulÄƒri periodice, execuÈ›ie Ã®n background È™i gestionare erori</li>
            <li><strong>Integrare API Externe:</strong> Proces de integrare SOAP (portal.just.ro) È™i web scraping cu OCR (CASAN) pentru obÈ›inere date suplimentare</li>
            <li><strong>Gestionare Erori:</strong> Proces robust de gestionare erori cu logging detaliat, retry logic È™i mesaje utilizator prietenoase</li>
          </ul>
        </section>
      </div>
    </section>

    <section class="content-section hidden" id="secContact">
      <div class="section-head">
        <div class="title">ğŸ“§ Contact</div>
        <div style="opacity:.75; font-weight:700; color:#22507a;">InformaÈ›ii de contact pentru clarificÄƒri</div>
      </div>
      <div class="section-body">
        <section class="doc-section">
          <h2>Contact</h2>
          <p>Pentru orice clarificÄƒri sau Ã®ntrebÄƒri legate de aplicaÈ›ia Roboescu, vÄƒ rugÄƒm sÄƒ contactaÈ›i:</p>
          
          <div style="background: #f8f9fa; border-left: 4px solid #22507a; padding: 25px; margin: 25px 0; border-radius: 8px; font-family: Georgia, serif;">
            <h3 style="color: #22507a; margin-top: 0; margin-bottom: 15px;">Improvement Credit Collection SRL</h3>
            <p style="margin: 10px 0; font-size: 16px; line-height: 1.8;">
              <strong>PersoanÄƒ de contact:</strong> Constantin BÄƒdescu<br>
              <strong>E-mail:</strong> <a href="mailto:constantin.badescu@iccollect.ro" style="color: #22507a; text-decoration: none; border-bottom: 1px dotted #22507a;">constantin.badescu@iccollect.ro</a><br>
              <strong>Telefon:</strong> <a href="tel:0751756541" style="color: #22507a; text-decoration: none; border-bottom: 1px dotted #22507a;">0751756541</a>
            </p>
          </div>

          <p style="margin-top: 20px; font-style: italic; color: #666;">
            VÄƒ rugÄƒm sÄƒ ne contactaÈ›i pentru orice Ã®ntrebÄƒri, sugestii sau clarificÄƒri legate de funcÈ›ionarea aplicaÈ›iei Roboescu.
          </p>
        </section>
      </div>
    </section>

    <!-- DeclaraÈ›ie de Conformitate -->
    <div style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border: 2px solid #22507a; border-left: 6px solid #22507a; padding: 40px; margin: 50px 0; border-radius: 12px; box-shadow: 0 4px 15px rgba(34, 80, 122, 0.15); position: relative; overflow: hidden;">
      <!-- Decorative element -->
      <div style="position: absolute; top: 0; right: 0; width: 200px; height: 200px; background: radial-gradient(circle, rgba(34, 80, 122, 0.05) 0%, transparent 70%); border-radius: 50%; transform: translate(30%, -30%);"></div>
      
      <div style="max-width: 1000px; margin: 0 auto; font-family: Georgia, serif; position: relative; z-index: 1;">
        <div style="text-align: center; margin-bottom: 25px;">
          <div style="display: inline-block; background: linear-gradient(135deg, #22507a 0%, #3576b0 100%); color: white; padding: 12px 24px; border-radius: 8px; margin-bottom: 15px; box-shadow: 0 3px 10px rgba(34, 80, 122, 0.3);">
            <h2 style="color: white; margin: 0; font-size: 22px; font-weight: bold; letter-spacing: 0.5px;">
              âœ“ DeclaraÈ›ie de Conformitate
            </h2>
          </div>
        </div>
        
        <div style="background: white; padding: 30px; border-radius: 8px; border-left: 4px solid #4caf50; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);">
          <p style="font-size: 17px; line-height: 2; text-align: justify; color: #2c3e50; margin: 0; font-weight: 500;">
            <span style="font-size: 24px; color: #22507a; font-weight: bold; margin-right: 8px; vertical-align: middle;">"</span>
            Prezenta documentaÈ›ie reflectÄƒ fidel arhitectura È™i funcÈ›ionarea aplicaÈ›iei la data redactÄƒrii È™i poate fi pusÄƒ la dispoziÈ›ia organelor de control, audit sau evaluare IT.
            <span style="font-size: 24px; color: #22507a; font-weight: bold; margin-left: 8px; vertical-align: middle;">"</span>
          </p>
        </div>
        
        <div style="text-align: center; margin-top: 20px;">
          <div style="display: inline-flex; align-items: center; gap: 8px; color: #666; font-size: 14px; font-style: italic;">
            <i class="fas fa-shield-alt" style="color: #4caf50;"></i>
            <span>Document oficial pentru audit È™i evaluare</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function(){
      const btn = document.getElementById('docToggle');
      const body = document.getElementById('docBody');
      const icon = document.getElementById('docIcon');
      if(!btn || !body) return;
      btn.addEventListener('click', () => {
        const isHidden = body.style.display === 'none';
        body.style.display = isHidden ? 'block' : 'none';
        btn.setAttribute('aria-expanded', isHidden ? 'true' : 'false');
        if(icon){
          icon.classList.toggle('fa-chevron-up', isHidden);
          icon.classList.toggle('fa-chevron-down', !isHidden);
        }
      });
    })();

    // Nav tabs: Context & Scop vs DiagramÄƒ LogicÄƒ vs DiagramÄƒ FizicÄƒ vs Registru vs Firewall vs Software vs DFD vs Acces vs ProtecÈ›ie vs Obfuscare vs Date Personale vs FuncÈ›ionalÄƒ vs Procese vs Contact
    (function(){
      const tabDoc = document.getElementById('tabDoc');
      const tabDiag = document.getElementById('tabDiag');
      const tabFizic = document.getElementById('tabFizic');
      const tabRegistru = document.getElementById('tabRegistru');
      const tabFirewall = document.getElementById('tabFirewall');
      const tabSoftware = document.getElementById('tabSoftware');
      const tabDFD = document.getElementById('tabDFD');
      const tabAcces = document.getElementById('tabAcces');
      const tabProtectie = document.getElementById('tabProtectie');
      const tabObfuscare = document.getElementById('tabObfuscare');
      const tabDatePersonale = document.getElementById('tabDatePersonale');
      const tabFunctionala = document.getElementById('tabFunctionala');
      const tabProcese = document.getElementById('tabProcese');
      const tabContact = document.getElementById('tabContact');
      const secDoc = document.getElementById('secDoc');
      const secDiag = document.getElementById('secDiag');
      const secFizic = document.getElementById('secFizic');
      const secRegistru = document.getElementById('secRegistru');
      const secFirewall = document.getElementById('secFirewall');
      const secSoftware = document.getElementById('secSoftware');
      const secDFD = document.getElementById('secDFD');
      const secAcces = document.getElementById('secAcces');
      const secProtectie = document.getElementById('secProtectie');
      const secObfuscare = document.getElementById('secObfuscare');
      const secDatePersonale = document.getElementById('secDatePersonale');
      const secFunctionala = document.getElementById('secFunctionala');
      const secProcese = document.getElementById('secProcese');
      const secContact = document.getElementById('secContact');
      if(!tabDoc || !tabDiag || !tabFizic || !tabRegistru || !tabFirewall || !tabSoftware || !tabDFD || !tabAcces || !tabProtectie || !tabObfuscare || !tabDatePersonale || !tabFunctionala || !tabProcese || !tabContact || !secDoc || !secDiag || !secFizic || !secRegistru || !secFirewall || !secSoftware || !secDFD || !secAcces || !secProtectie || !secObfuscare || !secDatePersonale || !secFunctionala || !secProcese || !secContact) return;

      const setActive = (which) => {
        const showDoc = which === 'doc';
        const showDiag = which === 'diag';
        const showFizic = which === 'fizic';
        const showRegistru = which === 'registru';
        const showFirewall = which === 'firewall';
        const showSoftware = which === 'software';
        const showDFD = which === 'dfd';
        const showAcces = which === 'acces';
        const showProtectie = which === 'protectie';
        const showObfuscare = which === 'obfuscare';
        const showDatePersonale = which === 'datepersonale';
        const showFunctionala = which === 'functionala';
        const showProcese = which === 'procese';
        const showContact = which === 'contact';

        secDoc.classList.toggle('hidden', !showDoc);
        secDiag.classList.toggle('hidden', !showDiag);
        secFizic.classList.toggle('hidden', !showFizic);
        secRegistru.classList.toggle('hidden', !showRegistru);
        secFirewall.classList.toggle('hidden', !showFirewall);
        secSoftware.classList.toggle('hidden', !showSoftware);
        secDFD.classList.toggle('hidden', !showDFD);
        secAcces.classList.toggle('hidden', !showAcces);
        secProtectie.classList.toggle('hidden', !showProtectie);
        secObfuscare.classList.toggle('hidden', !showObfuscare);
        secDatePersonale.classList.toggle('hidden', !showDatePersonale);
        secFunctionala.classList.toggle('hidden', !showFunctionala);
        secProcese.classList.toggle('hidden', !showProcese);
        secContact.classList.toggle('hidden', !showContact);

        tabDoc.classList.toggle('active', showDoc);
        tabDiag.classList.toggle('active', showDiag);
        tabFizic.classList.toggle('active', showFizic);
        tabRegistru.classList.toggle('active', showRegistru);
        tabFirewall.classList.toggle('active', showFirewall);
        tabSoftware.classList.toggle('active', showSoftware);
        tabDFD.classList.toggle('active', showDFD);
        tabAcces.classList.toggle('active', showAcces);
        tabProtectie.classList.toggle('active', showProtectie);
        tabObfuscare.classList.toggle('active', showObfuscare);
        tabDatePersonale.classList.toggle('active', showDatePersonale);
        tabFunctionala.classList.toggle('active', showFunctionala);
        tabProcese.classList.toggle('active', showProcese);
        tabContact.classList.toggle('active', showContact);

        tabDoc.setAttribute('aria-selected', showDoc ? 'true' : 'false');
        tabDiag.setAttribute('aria-selected', showDiag ? 'true' : 'false');
        tabFizic.setAttribute('aria-selected', showFizic ? 'true' : 'false');
        tabRegistru.setAttribute('aria-selected', showRegistru ? 'true' : 'false');
        tabFirewall.setAttribute('aria-selected', showFirewall ? 'true' : 'false');
        tabSoftware.setAttribute('aria-selected', showSoftware ? 'true' : 'false');
        tabDFD.setAttribute('aria-selected', showDFD ? 'true' : 'false');
        tabAcces.setAttribute('aria-selected', showAcces ? 'true' : 'false');
        tabProtectie.setAttribute('aria-selected', showProtectie ? 'true' : 'false');
        tabObfuscare.setAttribute('aria-selected', showObfuscare ? 'true' : 'false');
        tabDatePersonale.setAttribute('aria-selected', showDatePersonale ? 'true' : 'false');
        tabFunctionala.setAttribute('aria-selected', showFunctionala ? 'true' : 'false');
        tabProcese.setAttribute('aria-selected', showProcese ? 'true' : 'false');
        tabContact.setAttribute('aria-selected', showContact ? 'true' : 'false');
      };

      tabDoc.addEventListener('click', () => setActive('doc'));
      tabDiag.addEventListener('click', () => setActive('diag'));
      tabFizic.addEventListener('click', () => setActive('fizic'));
      tabRegistru.addEventListener('click', () => setActive('registru'));
      tabFirewall.addEventListener('click', () => setActive('firewall'));
      tabSoftware.addEventListener('click', () => setActive('software'));
      tabDFD.addEventListener('click', () => setActive('dfd'));
      tabAcces.addEventListener('click', () => setActive('acces'));
      tabProtectie.addEventListener('click', () => setActive('protectie'));
      tabObfuscare.addEventListener('click', () => setActive('obfuscare'));
      tabDatePersonale.addEventListener('click', () => setActive('datepersonale'));
      tabFunctionala.addEventListener('click', () => setActive('functionala'));
      tabProcese.addEventListener('click', () => setActive('procese'));
      tabContact.addEventListener('click', () => setActive('contact'));

      setActive('doc');

      // Gestionare tab-uri rapoarte Ã®n secÈ›iunea DiagramÄƒ LogicÄƒ
      const reportTabButtons = document.querySelectorAll('.report-tab-btn');
      const reportDiagrams = document.querySelectorAll('.report-diagram');

      if (reportTabButtons.length > 0 && reportDiagrams.length > 0) {
        const setActiveReport = (reportNumber) => {
          // Ascunde toate diagramele (folosind clasa active)
          reportDiagrams.forEach(diag => {
            diag.classList.remove('active');
          });

          // AratÄƒ diagrama activÄƒ
          const activeDiagram = document.getElementById(`diagram-report-${reportNumber}`);
          if (activeDiagram) {
            activeDiagram.classList.add('active');
          }

          // ActualizeazÄƒ stilul butoanelor
          reportTabButtons.forEach(btn => {
            const btnReport = btn.getAttribute('data-report');
            if (btnReport === reportNumber.toString()) {
              btn.classList.add('active');
            } else {
              btn.classList.remove('active');
            }
          });
        };

        // AdaugÄƒ event listeners pentru fiecare buton
        reportTabButtons.forEach(btn => {
          btn.addEventListener('click', () => {
            const reportNumber = btn.getAttribute('data-report');
            setActiveReport(reportNumber);
          });
        });

        // SeteazÄƒ primul raport ca activ la Ã®ncÄƒrcare
        setActiveReport('1');
      }

      // Gestionare tab-uri diagrame fizice
      const physicalTabButtons = document.querySelectorAll('.physical-tab-btn');
      const physicalDiagrams = document.querySelectorAll('.physical-diagram');

      if (physicalTabButtons.length > 0 && physicalDiagrams.length > 0) {
        const setActivePhysical = (physicalNumber) => {
          // Ascunde toate diagramele fizice
          physicalDiagrams.forEach(diag => {
            diag.classList.remove('active');
          });

          // AratÄƒ diagrama fizicÄƒ activÄƒ
          const activeDiagram = document.getElementById(`physical-diagram-${physicalNumber}`);
          if (activeDiagram) {
            activeDiagram.classList.add('active');
          }

          // ActualizeazÄƒ stilul butoanelor
          physicalTabButtons.forEach(btn => {
            const btnPhysical = btn.getAttribute('data-physical');
            if (btnPhysical === physicalNumber.toString()) {
              btn.classList.add('active');
            } else {
              btn.classList.remove('active');
            }
          });
        };

        // AdaugÄƒ event listeners pentru fiecare buton fizic
        physicalTabButtons.forEach(btn => {
          btn.addEventListener('click', () => {
            const physicalNumber = btn.getAttribute('data-physical');
            setActivePhysical(physicalNumber);
          });
        });

        // SeteazÄƒ prima diagramÄƒ fizicÄƒ ca activÄƒ la Ã®ncÄƒrcare
        setActivePhysical('1');
      }

      // Gestionare tab-uri rapoarte DFD
      const dfdTabButtons = document.querySelectorAll('.dfd-tab-btn');
      const dfdReports = document.querySelectorAll('.dfd-report');

      if (dfdTabButtons.length > 0 && dfdReports.length > 0) {
        const setActiveDFD = (dfdNumber) => {
          // Ascunde toate secÈ›iunile DFD
          dfdReports.forEach(report => {
            report.classList.remove('active');
          });

          // AratÄƒ secÈ›iunea DFD activÄƒ
          const activeReport = document.getElementById(`dfd-report-${dfdNumber}`);
          if (activeReport) {
            activeReport.classList.add('active');
          }

          // ActualizeazÄƒ stilul butoanelor
          dfdTabButtons.forEach(btn => {
            const btnDFD = btn.getAttribute('data-dfd');
            if (btnDFD === dfdNumber.toString()) {
              btn.classList.add('active');
            } else {
              btn.classList.remove('active');
            }
          });
        };

        // AdaugÄƒ event listeners pentru fiecare buton DFD
        dfdTabButtons.forEach(btn => {
          btn.addEventListener('click', () => {
            const dfdNumber = btn.getAttribute('data-dfd');
            setActiveDFD(dfdNumber);
          });
        });

        // SeteazÄƒ primul raport DFD ca activ la Ã®ncÄƒrcare
        setActiveDFD('1');
      }
    })();

  </script>

</body>
</html>
